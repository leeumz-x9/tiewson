/*! For license information please see main.cfe89eee.js.LICENSE.txt */
(()=>{var e={356(e,t,n){e.exports=n(9645).last},418(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toString=function e(t){if(null==t)return"";if("string"===typeof t)return t;if(Array.isArray(t))return t.map(e).join(",");const n=String(t);return"0"===n&&Object.is(Number(t),-0)?"-0":n}},579(e,t,n){"use strict";e.exports=n(1153)},745(){},870(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObject=function(e){return null!==e&&("object"===typeof e||"function"===typeof e)}},1153(e,t,n){"use strict";var r=n(5043),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!u.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},1203(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8420);t.isArrayLike=function(e){return null!=e&&"function"!==typeof e&&r.isLength(e.length)}},1293(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4830);t.debounce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"!==typeof n&&(n={});const{leading:i=!1,trailing:o=!0,maxWait:a}=n,s=Array(2);let u;i&&(s[0]="leading"),o&&(s[1]="trailing");let l=null;const c=r.debounce(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];u=e.apply(this,n),l=null},t,{edges:s}),h=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=a&&(null===l&&(l=Date.now()),Date.now()-l>=a)?(u=e.apply(this,n),l=Date.now(),c.cancel(),c.schedule(),u):(c.apply(this,n),u)};return h.cancel=c.cancel,h.flush=()=>(c.flush(),u),h}},1444(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(418),i=n(3272);t.toPath=function(e){if(Array.isArray(e))return e.map(i.toKey);if("symbol"===typeof e)return[e];const t=[],n=(e=r.toString(e)).length;if(0===n)return t;let o=0,a="",s="",u=!1;for(46===e.charCodeAt(0)&&(t.push(""),o++);o<n;){const r=e[o];s?"\\"===r&&o+1<n?(o++,a+=e[o]):r===s?s="":a+=r:u?'"'===r||"'"===r?s=r:"]"===r?(u=!1,t.push(a),a=""):a+=r:"["===r?(u=!0,a&&(t.push(a),a="")):"."===r?a&&(t.push(a),a=""):a+=r,o++}return a&&t.push(a),t}},1591(){},2086(e,t,n){"use strict";e.exports=n(5082)},2104(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1203),i=n(9921);t.isArrayLikeObject=function(e){return i.isObjectLike(e)&&r.isArrayLike(e)}},2132(e,t,n){"use strict";var r=n(2897).default;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const i=n(870),o=n(4803),a=n(5093);function s(e,t,n,c){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,n,r){if(null==t)return!0;if(Array.isArray(t))return u(e,t,n,r);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[i,o]of t.entries()){if(!1===n(e.get(i),o,i,e,t,r))return!1}return!0}(e,t,n,r);if(t instanceof Set)return l(e,t,n,r);const i=Object.keys(t);if(null==e||o.isPrimitive(e))return 0===i.length;if(0===i.length)return!0;if(null!==r&&void 0!==r&&r.has(t))return r.get(t)===e;null===r||void 0===r||r.set(t,e);try{for(let a=0;a<i.length;a++){const s=i[a];if(!o.isPrimitive(e)&&!(s in e))return!1;if(void 0===t[s]&&void 0!==e[s])return!1;if(null===t[s]&&null!==e[s])return!1;if(!n(e[s],t[s],s,e,t,r))return!1}return!0}finally{null===r||void 0===r||r.delete(t)}}(e,t,n,c);case"function":return Object.keys(t).length>0?s(e,r({},t),n,c):a.isEqualsSameValueZero(e,t);default:return i.isObject(e)?"string"!==typeof t||""===t:a.isEqualsSameValueZero(e,t)}}function u(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const i=new Set;for(let o=0;o<t.length;o++){const a=t[o];let s=!1;for(let u=0;u<e.length;u++){if(i.has(u))continue;let l=!1;if(n(e[u],a,o,e,t,r)&&(l=!0),l){i.add(u),s=!0;break}}if(!s)return!1}return!0}function l(e,t,n,r){return 0===t.size||e instanceof Set&&u([...e],[...t],n,r)}t.isMatchWith=function e(t,n,r){return"function"!==typeof r?e(t,n,()=>{}):s(t,n,function e(t,n,i,o,a,u){const l=r(t,n,i,o,a,u);return void 0!==l?Boolean(l):s(t,n,e,u)},new Map)},t.isSetMatch=l},2204(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5316),i=n(7312),o=n(3799);t.sortBy=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];const s=n.length;return s>1&&o.isIterateeCall(e,n[0],n[1])?n=[]:s>2&&o.isIterateeCall(n[0],n[1],n[2])&&(n=[n[0]]),r.orderBy(e,i.flatten(n),["asc"])}},2330(e,t,n){"use strict";var r=n(5043);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,a=r.useEffect,s=r.useLayoutEffect,u=r.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,c=r[1];return s(function(){i.value=n,i.getSnapshot=t,l(i)&&c({inst:i})},[e,n,t]),a(function(){return l(i)&&c({inst:i}),e(function(){l(i)&&c({inst:i})})},[e]),u(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},2489(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},2682(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPlainObject=function(e){if("object"!==typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t;const n=e[Symbol.toStringTag];if(null==n)return!1;return!!(null!==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))&&void 0!==t&&t.writable)&&e.toString()==="[object ".concat(n,"]")}let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}},2715(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9599),i=n(7330),o=n(3808),a=n(8845);t.iteratee=function(e){if(null==e)return r.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?a.matchesProperty(e[0],e[1]):o.matches(e);case"string":case"symbol":case"number":return i.property(e)}}},2730(e,t,n){"use strict";var r=n(5043),i=n(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),E=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var j,F=Object.assign;function L(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var B=!1;function z(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var u="\n"+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function U(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case E:return"Portal";case k:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){$(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function oe(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ce(e,t)})}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,_e=null,Se=null;function ke(e){if(e=bi(e)){if("function"!==typeof Ee)throw Error(o(280));var t=e.stateNode;t&&(t=wi(t),Ee(e.stateNode,e.type,t))}}function Ce(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ie(){if(_e){var e=_e,t=Se;if(Se=_e=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Te(e,t){return e(t)}function Ae(){}var Oe=!1;function Ne(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Te(e,t,n)}finally{Oe=!1,(null!==_e||null!==Se)&&(Ae(),Ie())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var De=!1;if(c)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){De=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ce){De=!1}function Me(e,t,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var je=!1,Fe=null,Le=!1,Be=null,ze={onError:function(e){je=!0,Fe=e}};function Ue(e,t,n,r,i,o,a,s,u){je=!1,Fe=null,Me.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(o(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return He(i),e;if(a===r)return He(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Qe=i.unstable_requestPaint,$e=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=ht(s):0!==(o&=a)&&(r=ht(o))}else 0!==(a=n&~i)?r=ht(a):0!==o&&(r=ht(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Et,_t,St,kt,Ct=!1,It=[],Tt=null,At=null,Ot=null,Nt=new Map,Pt=new Map,Dt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function jt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=yi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void kt(e.priority,function(){_t(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){Lt(e)&&n.delete(t)}function zt(){Ct=!1,null!==Tt&&Lt(Tt)&&(Tt=null),null!==At&&Lt(At)&&(At=null),null!==Ot&&Lt(Ot)&&(Ot=null),Nt.forEach(Bt),Pt.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<It.length){Ut(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Ut(Tt,e),null!==At&&Ut(At,e),null!==Ot&&Ut(Ot,e),Nt.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Wt=x.ReactCurrentBatchConfig,Ht=!0;function qt(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Gt(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Kt(e,t,n,r){if(Ht){var i=Yt(e,t,n,r);if(null===i)Hr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=jt(Tt,e,t,n,r,i),!0;case"dragenter":return At=jt(At,e,t,n,r,i),!0;case"mouseover":return Ot=jt(Ot,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Nt.set(o,jt(Nt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Pt.set(o,jt(Pt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&wt(o),null===(o=Yt(e,t,n,r))&&Hr(e,t,r,Xt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=yi(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Zt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Zt,r=n.length,i="value"in $t?$t.value:$t.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(ln),hn=F({},ln,{view:0,detail:0}),dn=on(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=on(fn),mn=on(F({},fn,{dataTransfer:0})),gn=on(F({},hn,{relatedTarget:0})),vn=on(F({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),xn=on(F({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function kn(){return Sn}var Cn=F({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=on(Cn),Tn=on(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=on(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),On=on(F({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Nn),Dn=[9,13,27,32],Rn=c&&"CompositionEvent"in window,Mn=null;c&&"documentMode"in document&&(Mn=document.documentMode);var jn=c&&"TextEvent"in window&&!Mn,Fn=c&&(!Rn||Mn&&8<Mn&&11>=Mn),Ln=String.fromCharCode(32),Bn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){Ce(r),0<(t=Gr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Xn(e){Lr(e,0)}function Yn(e){if(K(xi(e)))return e}function Qn(e,t){if("change"===e)return t}var $n=!1;if(c){var Zn;if(c){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Zn=Jn}else Zn=!1;$n=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];qn(t,Kn,e,we(e)),Ne(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},_r={},Sr={};function kr(e){if(_r[e])return _r[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return _r[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Cr=kr("animationend"),Ir=kr("animationiteration"),Tr=kr("animationstart"),Ar=kr("transitionend"),Or=new Map,Nr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Or.set(e,t),u(t,[e])}for(var Dr=0;Dr<Nr.length;Dr++){var Rr=Nr[Dr];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(Cr,"onAnimationEnd"),Pr(Ir,"onAnimationIteration"),Pr(Tr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Ar,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,u,l){if(Ue.apply(this,arguments),je){if(!je)throw Error(o(198));var c=Fe;je=!1,Fe=null,Le||(Le=!0,Be=c)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;Fr(i,s,l),o=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;Fr(i,s,l),o=u}}}if(Le)throw e=Be,Le=!1,Be=null,e}function Br(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Ur]){e[Ur]=!0,a.forEach(function(t){"selectionchange"!==t&&(jr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Qt(t)){case 1:var i=qt;break;case 4:i=Gt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(u=a.tag)||6===u){r=o=a;continue e}s=s.parentNode}}r=r.return}Ne(function(){var r=o,i=we(n),a=[];e:{var s=Or.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=In;break;case"focusin":l="focus",u=gn;break;case"focusout":l="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=An;break;case Cr:case Ir:case Tr:u=vn;break;case Ar:u=On;break;case"scroll":u=dn;break;case"wheel":u=Pn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Tn}var c=0!==(4&t),h=!c&&"scroll"===e,d=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Pe(p,d))&&c.push(qr(p,m,f)))),h)break;p=p.return}0<c.length&&(s=new u(s,l,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(l=n.relatedTarget||n.fromElement)||!yi(l)&&!l[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?yi(l):null)&&(l!==(h=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Tn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==u?s:xi(u),f=null==l?s:xi(l),(s=new c(m,p+"leave",u,n,i)).target=h,s.relatedTarget=f,m=null,yi(i)===r&&((c=new c(d,p+"enter",l,n,i)).target=f,c.relatedTarget=h,m=c),h=m,u&&l)e:{for(d=l,p=0,f=c=u;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)c=Kr(c),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break e;c=Kr(c),d=Kr(d)}c=null}else c=null;null!==u&&Xr(a,s,u,c,!1),null!==l&&null!==h&&Xr(a,h,l,c,!0)}if("select"===(u=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Qn;else if(Hn(s))if($n)g=ar;else{g=ir;var v=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?qn(a,g,n,i):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?xi(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Zt="value"in($t=i)?$t.value:$t.textContent,Vn=!0)),0<(v=Gr(r,b)).length&&(b=new xn(b,e,null,n,i),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=jn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),Jt=Zt=$t=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Lr(a,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Pe(e,n))&&r.unshift(qr(e,o,i)),null!=(o=Pe(e,t))&&r.push(qr(e,o,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Pe(n,o))&&a.unshift(qr(n,u,s)):i||null!=(u=Pe(n,o))&&a.push(qr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function Zr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(o(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout(function(){throw e})}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[di])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wi(e){return e[fi]||null}var Ei=[],_i=-1;function Si(e){return{current:e}}function ki(e){0>_i||(e.current=Ei[_i],Ei[_i]=null,_i--)}function Ci(e,t){_i++,Ei[_i]=e.current,e.current=t}var Ii={},Ti=Si(Ii),Ai=Si(!1),Oi=Ii;function Ni(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){ki(Ai),ki(Ti)}function Ri(e,t,n){if(Ti.current!==Ii)throw Error(o(168));Ci(Ti,t),Ci(Ai,n)}function Mi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,W(e)||"Unknown",i));return F({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Oi=Ti.current,Ci(Ti,e),Ci(Ai,Ai.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Mi(e,t,Oi),r.__reactInternalMemoizedMergedChildContext=e,ki(Ai),ki(Ti),Ci(Ti,e)):ki(Ai),Ci(Ai,n)}var Li=null,Bi=!1,zi=!1;function Ui(e){null===Li?Li=[e]:Li.push(e)}function Vi(){if(!zi&&null!==Li){zi=!0;var e=0,t=bt;try{var n=Li;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Li=null,Bi=!1}catch(i){throw null!==Li&&(Li=Li.slice(e+1)),Ke(Je,Vi),i}finally{bt=t,zi=!1}}return null}var Wi=[],Hi=0,qi=null,Gi=0,Ki=[],Xi=0,Yi=null,Qi=1,$i="";function Zi(e,t){Wi[Hi++]=Gi,Wi[Hi++]=qi,qi=e,Gi=t}function Ji(e,t,n){Ki[Xi++]=Qi,Ki[Xi++]=$i,Ki[Xi++]=Yi,Yi=e;var r=Qi;e=$i;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Qi=1<<32-at(t)+i|n<<i|r,$i=o+e}else Qi=1<<o|n<<i|r,$i=e}function eo(e){null!==e.return&&(Zi(e,1),Ji(e,1,0))}function to(e){for(;e===qi;)qi=Wi[--Hi],Wi[Hi]=null,Gi=Wi[--Hi],Wi[Hi]=null;for(;e===Yi;)Yi=Ki[--Xi],Ki[Xi]=null,$i=Ki[--Xi],Ki[Xi]=null,Qi=Ki[--Xi],Ki[Xi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Ol(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Qi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ol(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function uo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(uo(e))throw Error(o(418));t=li(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(uo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(uo(e))throw fo(),Error(o(418));for(;t;)ao(e,t),t=li(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?li(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=ro;e;)e=li(e.nextSibling)}function po(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pl(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=jl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===_?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&bo(o)===t.type)?((r=i(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Dl(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Rl(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Dl(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case E:return(t=Fl(t,e.mode,n)).return=e,t;case P:return d(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Rl(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?l(e,t,n,r):null;case E:return n.key===i?c(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||M(n))return null!==i?null:h(e,t,n,r,null);yo(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||M(r))return h(t,e=e.get(n)||null,r,i,null);yo(t,r)}return null}function m(i,o,s,u){for(var l=null,c=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,s[m],u);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),o=a(v,o,m),null===c?l=v:c.sibling=v,c=v,h=g}if(m===s.length)return n(i,h),io&&Zi(i,m),l;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],u))&&(o=a(h,o,m),null===c?l=h:c.sibling=h,c=h);return io&&Zi(i,m),l}for(h=r(i,h);m<s.length;m++)null!==(g=p(h,i,m,s[m],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?l=g:c.sibling=g,c=g);return e&&h.forEach(function(e){return t(i,e)}),io&&Zi(i,m),l}function g(i,s,u,l){var c=M(u);if("function"!==typeof c)throw Error(o(150));if(null==(u=c.call(u)))throw Error(o(151));for(var h=c=null,m=s,g=s=0,v=null,y=u.next();null!==m&&!y.done;g++,y=u.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),s=a(b,s,g),null===h?c=b:h.sibling=b,h=b,m=v}if(y.done)return n(i,m),io&&Zi(i,g),c;if(null===m){for(;!y.done;g++,y=u.next())null!==(y=d(i,y.value,l))&&(s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return io&&Zi(i,g),c}for(m=r(i,m);!y.done;g++,y=u.next())null!==(y=p(m,i,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return e&&m.forEach(function(e){return t(i,e)}),io&&Zi(i,g),c}return function e(r,o,a,u){if("object"===typeof a&&null!==a&&a.type===_&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var l=a.key,c=o;null!==c;){if(c.key===l){if((l=a.type)===_){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===P&&bo(l)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=vo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===_?((o=Rl(a.props.children,r.mode,u,a.key)).return=r,r=o):((u=Dl(a.type,a.key,a.props,null,r.mode,u)).ref=vo(r,o,a),u.return=r,r=u)}return s(r);case E:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Fl(a,r.mode,u)).return=r,r=o}return s(r);case P:return e(r,o,(c=a._init)(a._payload),u)}if(te(a))return m(r,o,a,u);if(M(a))return g(r,o,a,u);yo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=jl(a,r.mode,u)).return=r,r=o),s(r)):n(r,o)}}var wo=xo(!0),Eo=xo(!1),_o=Si(null),So=null,ko=null,Co=null;function Io(){Co=ko=So=null}function To(e){var t=_o.current;ki(_o),e._currentValue=t}function Ao(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Oo(e,t){So=e,Co=ko=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function No(e){var t=e._currentValue;if(Co!==e)if(e={context:e,memoizedValue:t,next:null},null===ko){if(null===So)throw Error(o(308));ko=e,So.dependencies={lanes:0,firstContext:e}}else ko=ko.next=e;return t}var Po=null;function Do(e){null===Po?Po=[e]:Po.push(e)}function Ro(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Do(t)):(n.next=i.next,i.next=n),t.interleaved=n,Mo(e,r)}function Mo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var jo=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Iu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Mo(e,n)}return null===(i=r.interleaved)?(t.next=t,Do(r)):(t.next=i.next,i.next=t),r.interleaved=t,Mo(e,n)}function Uo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Vo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,r){var i=e.updateQueue;jo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===a?o=l:a.next=l,a=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==o){var h=i.baseState;for(a=0,c=l=u=null,s=o;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:jo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=f,u=h):c=c.next=f,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Mu|=a,e.lanes=a,e.memoizedState=h}}function Ho(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var qo={},Go=Si(qo),Ko=Si(qo),Xo=Si(qo);function Yo(e){if(e===qo)throw Error(o(174));return e}function Qo(e,t){switch(Ci(Xo,t),Ci(Ko,e),Ci(Go,qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Go),Ci(Go,t)}function $o(){ki(Go),ki(Ko),ki(Xo)}function Zo(e){Yo(Xo.current);var t=Yo(Go.current),n=ue(t,e.type);t!==n&&(Ci(Ko,e),Ci(Go,n))}function Jo(e){Ko.current===e&&(ki(Go),ki(Ko))}var ea=Si(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=x.ReactCurrentDispatcher,oa=x.ReactCurrentBatchConfig,aa=0,sa=null,ua=null,la=null,ca=!1,ha=!1,da=0,fa=0;function pa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:es,e=n(r,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,la=ua=null,t.updateQueue=null,ia.current=ts,e=n(r,i)}while(ha)}if(ia.current=Za,t=null!==ua&&null!==ua.next,aa=0,la=ua=sa=null,ca=!1,t)throw Error(o(300));return e}function va(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?sa.memoizedState=la=e:la=la.next=e,la}function ba(){if(null===ua){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=ua.next;var t=null===la?sa.memoizedState:la.next;if(null!==t)la=t,ua=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ua=e).memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},null===la?sa.memoizedState=la=e:la=la.next=e}return la}function xa(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ua,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var u=s=null,l=null,c=a;do{var h=c.lane;if((aa&h)===h)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=d,s=r):l=l.next=d,sa.lanes|=h,Mu|=h}c=c.next}while(null!==c&&c!==a);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Mu|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ea(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function _a(){}function Sa(e,t){var n=sa,r=ba(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,ja(Ia.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Na(9,Ca.bind(null,n,r,i,t),void 0,null),null===Tu)throw Error(o(349));0!==(30&aa)||ka(n,t,i)}return i}function ka(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ca(e,t,n,r){t.value=n,t.getSnapshot=r,Ta(t)&&Aa(e)}function Ia(e,t,n){return n(function(){Ta(t)&&Aa(e)})}function Ta(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Aa(e){var t=Mo(e,1);null!==t&&tl(t,e,1,-1)}function Oa(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:e},t.queue=e,e=e.dispatch=Xa.bind(null,sa,e),[t.memoizedState,e]}function Na(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Pa(){return ba().memoizedState}function Da(e,t,n,r){var i=ya();sa.flags|=e,i.memoizedState=Na(1|t,n,void 0,void 0===r?null:r)}function Ra(e,t,n,r){var i=ba();r=void 0===r?null:r;var o=void 0;if(null!==ua){var a=ua.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Na(t,n,o,r))}sa.flags|=e,i.memoizedState=Na(1|t,n,o,r)}function Ma(e,t){return Da(8390656,8,e,t)}function ja(e,t){return Ra(2048,8,e,t)}function Fa(e,t){return Ra(4,2,e,t)}function La(e,t){return Ra(4,4,e,t)}function Ba(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function za(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ra(4,4,Ba.bind(null,t,e),n)}function Ua(){}function Va(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wa(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),sa.lanes|=n,Mu|=n,e.baseState=!0),t)}function qa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=oa.transition;oa.transition={};try{e(!1),t()}finally{bt=n,oa.transition=r}}function Ga(){return ba().memoizedState}function Ka(e,t,n){var r=el(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Qa(t,n);else if(null!==(n=Ro(e,t,n,r))){tl(n,e,r,Ju()),$a(n,t,r)}}function Xa(e,t,n){var r=el(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Qa(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var u=t.interleaved;return null===u?(i.next=i,Do(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Ro(e,t,i,r))&&(tl(n,e,r,i=Ju()),$a(n,t,r))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Qa(e,t){ha=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $a(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Za={readContext:No,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Ja={readContext:No,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:No,useEffect:Ma,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4194308,4,Ba.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ka.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Oa,useDebugValue:Ua,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Oa(!1),t=e[0];return e=qa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,i=ya();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Tu)throw Error(o(349));0!==(30&aa)||ka(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ma(Ia.bind(null,r,a,e),[e]),r.flags|=2048,Na(9,Ca.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Tu.identifierPrefix;if(io){var n=$i;t=":"+t+"R"+(n=(Qi&~(1<<32-at(Qi)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:No,useCallback:Va,useContext:No,useEffect:ja,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:La,useMemo:Wa,useReducer:wa,useRef:Pa,useState:function(){return wa(xa)},useDebugValue:Ua,useDeferredValue:function(e){return Ha(ba(),ua.memoizedState,e)},useTransition:function(){return[wa(xa)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Ga,unstable_isNewReconciler:!1},ts={readContext:No,useCallback:Va,useContext:No,useEffect:ja,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:La,useMemo:Wa,useReducer:Ea,useRef:Pa,useState:function(){return Ea(xa)},useDebugValue:Ua,useDeferredValue:function(e){var t=ba();return null===ua?t.memoizedState=e:Ha(t,ua.memoizedState,e)},useTransition:function(){return[Ea(xa)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Ga,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ju(),i=el(e),o=Bo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(tl(t,e,i,r),Uo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ju(),i=el(e),o=Bo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(tl(t,e,i,r),Uo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ju(),r=el(e),i=Bo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=zo(e,i,r))&&(tl(t,e,r,n),Uo(t,e,r))}};function os(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,o))}function as(e,t,n){var r=!1,i=Ii,o=t.contextType;return"object"===typeof o&&null!==o?o=No(o):(i=Pi(t)?Oi:Ti.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ni(e,i):Ii),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function us(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Fo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=No(o):(o=Pi(t)?Oi:Ti.current,i.context=Ni(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Wo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function cs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Bo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wu||(Wu=!0,Hu=r),hs(0,t)},n}function ps(e,t,n){(n=Bo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sl.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ys=x.ReactCurrentOwner,bs=!1;function xs(e,t,n,r){t.child=null===e?Eo(t,null,n,r):wo(t,e.child,n,r)}function ws(e,t,n,r,i){n=n.render;var o=t.ref;return Oo(t,i),r=ga(e,t,n,r,o,i),n=va(),null===e||bs?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function Es(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Nl(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,_s(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(a,r)&&e.ref===t.ref)return Ws(e,t,i)}return t.flags|=1,(e=Pl(o,r)).ref=t.ref,e.return=t,t.child=e}function _s(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(ur(o,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Ws(e,t,i);0!==(131072&e.flags)&&(bs=!0)}}return Cs(e,t,n,r,i)}function Ss(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Pu,Nu),Nu|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Pu,Nu),Nu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ci(Pu,Nu),Nu|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ci(Pu,Nu),Nu|=r;return xs(e,t,i,n),t.child}function ks(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cs(e,t,n,r,i){var o=Pi(n)?Oi:Ti.current;return o=Ni(t,o),Oo(t,i),n=ga(e,t,n,r,o,i),r=va(),null===e||bs?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function Is(e,t,n,r,i){if(Pi(n)){var o=!0;ji(t)}else o=!1;if(Oo(t,i),null===t.stateNode)Vs(e,t),as(t,n,r),us(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=No(l):l=Ni(t,l=Pi(n)?Oi:Ti.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==l)&&ss(t,a,r,l),jo=!1;var d=t.memoizedState;a.state=d,Wo(t,r,a,i),u=t.memoizedState,s!==r||d!==u||Ai.current||jo?("function"===typeof c&&(rs(t,n,c,r),u=t.memoizedState),(s=jo||os(t,n,s,r,d,u,l))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Lo(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:ns(t.type,s),a.props=l,h=t.pendingProps,d=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=No(u):u=Ni(t,u=Pi(n)?Oi:Ti.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==u)&&ss(t,a,r,u),jo=!1,d=t.memoizedState,a.state=d,Wo(t,r,a,i);var p=t.memoizedState;s!==h||d!==p||Ai.current||jo?("function"===typeof f&&(rs(t,n,f,r),p=t.memoizedState),(l=jo||os(t,n,l,r,d,p,u)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,o,i)}function Ts(e,t,n,r,i,o){ks(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Fi(t,n,!1),Ws(e,t,o);r=t.stateNode,ys.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),Qo(e,t.containerInfo)}function Os(e,t,n,r,i){return po(),mo(i),t.flags|=256,xs(e,t,n,r),t.child}var Ns,Ps,Ds,Rs={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var r,i=t.pendingProps,a=ea.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ci(ea,1&a),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Ml(u,i,0,null),e=Rl(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(n),t.memoizedState=Rs,e):Fs(t,u));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Ls(e,t,s,r=cs(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Ml({mode:"visible",children:r.children},i,0,null),(a=Rl(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&wo(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Rs,a);if(0===(1&t.mode))return Ls(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Ls(e,t,s,r=cs(a=Error(o(419)),r,void 0))}if(u=0!==(s&e.childLanes),bs||u){if(null!==(r=Tu)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Mo(e,i),tl(r,e,i,-1))}return pl(),Ls(e,t,s,r=cs(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cl.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=li(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Ki[Xi++]=Qi,Ki[Xi++]=$i,Ki[Xi++]=Yi,Qi=e.id,$i=e.overflow,Yi=t),t=Fs(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,a,n);if(s){s=i.fallback,u=t.mode,r=(a=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Pl(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Pl(r,s):(s=Rl(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Ms(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Rs,i}return e=(s=e.child).sibling,i=Pl(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fs(e,t){return(t=Ml({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ls(e,t,n,r){return null!==r&&mo(r),wo(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ao(e.return,t,n)}function zs(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Us(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zs(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zs(t,!0,n,null,o);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Mu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Pl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Pi(t.type)&&Di(),qs(t),null;case 3:return r=t.stateNode,$o(),ki(Ai),ki(Ti),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ol(oo),oo=null))),qs(t),null;case 5:Jo(t);var i=Yo(Xo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qs(t),null}if(e=Yo(Go.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[di]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<Mr.length;i++)Br(Mr[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":ie(r,a),Br("invalid",r)}for(var u in ye(n,a),i=null,a)if(a.hasOwnProperty(u)){var l=a[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":G(r),J(r,a,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[di]=t,e[fi]=r,Ns(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<Mr.length;i++)Br(Mr[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":Q(e,r),i=Y(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(a in ye(n,i),l=i)if(l.hasOwnProperty(a)){var c=l[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Br("scroll",e):null!=c&&b(e,a,c,u))}switch(n){case"input":G(e),J(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ds(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo(Xo.current),Yo(Go.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return qs(t),null;case 13:if(ki(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))fo(),po(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=t}else po(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),a=!1}else null!==oo&&(ol(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Du&&(Du=3):pl())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return $o(),null===e&&Vr(t.stateNode.containerInfo),qs(t),null;case 10:return To(t.type._context),qs(t),null;case 19:if(ki(ea),null===(a=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=a.rendering))if(r)Hs(a,!1);else{if(0!==Du||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ta(e))){for(t.flags|=128,Hs(a,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Uu&&(t.flags|=128,r=!0,Hs(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!io)return qs(t),null}else 2*$e()-a.renderingStartTime>Uu&&1073741824!==n&&(t.flags|=128,r=!0,Hs(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=a.last)?n.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=ea.current,Ci(ea,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return cl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nu)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ks(e,t){switch(to(t),t.tag){case 1:return Pi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $o(),ki(Ai),ki(Ti),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Jo(t),null;case 13:if(ki(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(ea),null;case 4:return $o(),null;case 10:return To(t.type._context),null;case 22:case 23:return cl(),null;default:return null}}Ns=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(Go.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(o in u)!u.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&u[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(a||(a=[]),a.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(a=a||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Br("scroll",e),a||u===l||(a=[])):(a=a||[]).push(c,l))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Ds=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xs=!1,Ys=!1,Qs="function"===typeof WeakSet?WeakSet:Set,$s=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_l(e,t,r)}else n.current=null}function Js(e,t,n){try{n()}catch(r){_l(e,t,r)}}var eu=!1;function tu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&Js(t,n,o)}i=i.next}while(i!==r)}}function nu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ru(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function au(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function su(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(su(e,t,n),e=e.sibling;null!==e;)su(e,t,n),e=e.sibling}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}var lu=null,cu=!1;function hu(e,t,n){for(n=n.child;null!==n;)du(e,t,n),n=n.sibling}function du(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Ys||Zs(n,t);case 6:var r=lu,i=cu;lu=null,hu(e,t,n),cu=i,null!==(lu=r)&&(cu?(e=lu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):lu.removeChild(n.stateNode));break;case 18:null!==lu&&(cu?(e=lu,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),Vt(e)):ui(lu,n.stateNode));break;case 4:r=lu,i=cu,lu=n.stateNode.containerInfo,cu=!0,hu(e,t,n),lu=r,cu=i;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&Js(n,t,a),i=i.next}while(i!==r)}hu(e,t,n);break;case 1:if(!Ys&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){_l(n,t,s)}hu(e,t,n);break;case 21:hu(e,t,n);break;case 22:1&n.mode?(Ys=(r=Ys)||null!==n.memoizedState,hu(e,t,n),Ys=r):hu(e,t,n);break;default:hu(e,t,n)}}function fu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qs),t.forEach(function(t){var r=Il.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function pu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:lu=u.stateNode,cu=!1;break e;case 3:case 4:lu=u.stateNode.containerInfo,cu=!0;break e}u=u.return}if(null===lu)throw Error(o(160));du(a,s,i),lu=null,cu=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){_l(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pu(t,e),gu(e),4&r){try{tu(3,e,e.return),nu(3,e)}catch(g){_l(e,e.return,g)}try{tu(5,e,e.return)}catch(g){_l(e,e.return,g)}}break;case 1:pu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(pu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){_l(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===a.type&&null!=a.name&&$(i,a),be(u,s);var c=be(u,a);for(s=0;s<l.length;s+=2){var h=l[s],d=l[s+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,c)}switch(u){case"input":Z(i,a);break;case"textarea":oe(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){_l(e,e.return,g)}}break;case 6:if(pu(t,e),gu(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){_l(e,e.return,g)}}break;case 3:if(pu(t,e),gu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){_l(e,e.return,g)}break;case 4:default:pu(t,e),gu(e);break;case 13:pu(t,e),gu(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(zu=$e())),4&r&&fu(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ys=(c=Ys)||h,pu(t,e),Ys=c):pu(t,e),gu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for($s=e,h=e.child;null!==h;){for(d=$s=h;null!==$s;){switch(p=(f=$s).child,f.tag){case 0:case 11:case 14:case 15:tu(4,f,f.return);break;case 1:Zs(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){_l(r,n,g)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){xu(d);continue}}null!==p?(p.return=f,$s=p):xu(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=d.stateNode,s=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=me("display",s))}catch(g){_l(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){_l(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pu(t,e),gu(e),4&r&&fu(e);case 21:}}function gu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ou(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),uu(e,au(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;su(e,au(e),a);break;default:throw Error(o(161))}}catch(s){_l(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vu(e,t,n){$s=e,yu(e,t,n)}function yu(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var i=$s,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Xs;if(!a){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Ys;s=Xs;var l=Ys;if(Xs=a,(Ys=u)&&!l)for($s=i;null!==$s;)u=(a=$s).child,22===a.tag&&null!==a.memoizedState?wu(i):null!==u?(u.return=a,$s=u):wu(i);for(;null!==o;)$s=o,yu(o,t,n),o=o.sibling;$s=i,Xs=s,Ys=l}bu(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,$s=o):bu(e)}}function bu(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||nu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ys)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ho(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ho(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(o(163))}Ys||512&t.flags&&ru(t)}catch(f){_l(t,t.return,f)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function xu(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function wu(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nu(4,t)}catch(u){_l(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){_l(t,i,u)}}var o=t.return;try{ru(t)}catch(u){_l(t,o,u)}break;case 5:var a=t.return;try{ru(t)}catch(u){_l(t,a,u)}}}catch(u){_l(t,t.return,u)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var Eu,_u=Math.ceil,Su=x.ReactCurrentDispatcher,ku=x.ReactCurrentOwner,Cu=x.ReactCurrentBatchConfig,Iu=0,Tu=null,Au=null,Ou=0,Nu=0,Pu=Si(0),Du=0,Ru=null,Mu=0,ju=0,Fu=0,Lu=null,Bu=null,zu=0,Uu=1/0,Vu=null,Wu=!1,Hu=null,qu=null,Gu=!1,Ku=null,Xu=0,Yu=0,Qu=null,$u=-1,Zu=0;function Ju(){return 0!==(6&Iu)?$e():-1!==$u?$u:$u=$e()}function el(e){return 0===(1&e.mode)?1:0!==(2&Iu)&&0!==Ou?Ou&-Ou:null!==go.transition?(0===Zu&&(Zu=mt()),Zu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function tl(e,t,n,r){if(50<Yu)throw Yu=0,Qu=null,Error(o(185));vt(e,n,r),0!==(2&Iu)&&e===Tu||(e===Tu&&(0===(2&Iu)&&(ju|=n),4===Du&&al(e,Ou)),nl(e,r),1===n&&0===Iu&&0===(1&t.mode)&&(Uu=$e()+500,Bi&&Vi()))}function nl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,u=i[a];-1===u?0!==(s&n)&&0===(s&r)||(i[a]=ft(s,t)):u<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=dt(e,e===Tu?Ou:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Bi=!0,Ui(e)}(sl.bind(null,e)):Ui(sl.bind(null,e)),ai(function(){0===(6&Iu)&&Vi()}),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tl(n,rl.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rl(e,t){if($u=-1,Zu=0,0!==(6&Iu))throw Error(o(327));var n=e.callbackNode;if(wl()&&e.callbackNode!==n)return null;var r=dt(e,e===Tu?Ou:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=Iu;Iu|=2;var a=fl();for(Tu===e&&Ou===t||(Vu=null,Uu=$e()+500,hl(e,t));;)try{vl();break}catch(u){dl(e,u)}Io(),Su.current=a,Iu=i,null!==Au?t=0:(Tu=null,Ou=0,t=Du)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=il(e,i))),1===t)throw n=Ru,hl(e,0),al(e,r),nl(e,$e()),n;if(6===t)al(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(a=pt(e))&&(r=a,t=il(e,a))),1===t))throw n=Ru,hl(e,0),al(e,r),nl(e,$e()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:xl(e,Bu,Vu);break;case 3:if(al(e,r),(130023424&r)===r&&10<(t=zu+500-$e())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Ju(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(xl.bind(null,e,Bu,Vu),t);break}xl(e,Bu,Vu);break;case 4:if(al(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_u(r/1960))-r)){e.timeoutHandle=ri(xl.bind(null,e,Bu,Vu),r);break}xl(e,Bu,Vu);break;default:throw Error(o(329))}}}return nl(e,$e()),e.callbackNode===n?rl.bind(null,e):null}function il(e,t){var n=Lu;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Bu,Bu=n,null!==t&&ol(t)),e}function ol(e){null===Bu?Bu=e:Bu.push.apply(Bu,e)}function al(e,t){for(t&=~Fu,t&=~ju,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function sl(e){if(0!==(6&Iu))throw Error(o(327));wl();var t=dt(e,0);if(0===(1&t))return nl(e,$e()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=il(e,r))}if(1===n)throw n=Ru,hl(e,0),al(e,t),nl(e,$e()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xl(e,Bu,Vu),nl(e,$e()),null}function ul(e,t){var n=Iu;Iu|=1;try{return e(t)}finally{0===(Iu=n)&&(Uu=$e()+500,Bi&&Vi())}}function ll(e){null!==Ku&&0===Ku.tag&&0===(6&Iu)&&wl();var t=Iu;Iu|=1;var n=Cu.transition,r=bt;try{if(Cu.transition=null,bt=1,e)return e()}finally{bt=r,Cu.transition=n,0===(6&(Iu=t))&&Vi()}}function cl(){Nu=Pu.current,ki(Pu)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:$o(),ki(Ai),ki(Ti),ra();break;case 5:Jo(r);break;case 4:$o();break;case 13:case 19:ki(ea);break;case 10:To(r.type._context);break;case 22:case 23:cl()}n=n.return}if(Tu=e,Au=e=Pl(e.current,null),Ou=Nu=t,Du=0,Ru=null,Fu=ju=Mu=0,Bu=Lu=null,null!==Po){for(t=0;t<Po.length;t++)if(null!==(r=(n=Po[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Po=null}return e}function dl(e,t){for(;;){var n=Au;try{if(Io(),ia.current=Za,ca){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(aa=0,la=ua=sa=null,ha=!1,da=0,ku.current=null,null===n||null===n.return){Du=1,Ru=t,Au=null;break}e:{var a=e,s=n.return,u=n,l=t;if(t=Ou,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,h=u,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,vs(p,s,u,0,t),1&p.mode&&ms(a,c,t),l=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ms(a,c,t),pl();break e}l=Error(o(426))}else if(io&&1&u.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,u,0,t),mo(ls(l,u));break e}}a=l=ls(l,u),4!==Du&&(Du=2),null===Lu?Lu=[a]:Lu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Vo(a,fs(0,l,t));break e;case 1:u=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Vo(a,ps(a,u,t));break e}}a=a.return}while(null!==a)}bl(n)}catch(x){t=x,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function fl(){var e=Su.current;return Su.current=Za,null===e?Za:e}function pl(){0!==Du&&3!==Du&&2!==Du||(Du=4),null===Tu||0===(268435455&Mu)&&0===(268435455&ju)||al(Tu,Ou)}function ml(e,t){var n=Iu;Iu|=2;var r=fl();for(Tu===e&&Ou===t||(Vu=null,hl(e,t));;)try{gl();break}catch(i){dl(e,i)}if(Io(),Iu=n,Su.current=r,null!==Au)throw Error(o(261));return Tu=null,Ou=0,Du}function gl(){for(;null!==Au;)yl(Au)}function vl(){for(;null!==Au&&!Ye();)yl(Au)}function yl(e){var t=Eu(e.alternate,e,Nu);e.memoizedProps=e.pendingProps,null===t?bl(e):Au=t,ku.current=null}function bl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gs(n,t,Nu)))return void(Au=n)}else{if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Au=n);if(null===e)return Du=6,void(Au=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Au=t);Au=t=e}while(null!==t);0===Du&&(Du=5)}function xl(e,t,n){var r=bt,i=Cu.transition;try{Cu.transition=null,bt=1,function(e,t,n,r){do{wl()}while(null!==Ku);if(0!==(6&Iu))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Tu&&(Au=Tu=null,Ou=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gu||(Gu=!0,Tl(tt,function(){return wl(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Cu.transition,Cu.transition=null;var s=bt;bt=1;var u=Iu;Iu|=4,ku.current=null,function(e,t){if(ei=Ht,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var s=0,u=-1,l=-1,c=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(u=s+i),d!==a||0!==r&&3!==d.nodeType||(l=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++c===i&&(u=s),f===a&&++h===r&&(l=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(w){_l(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}m=eu,eu=!1}(e,n),mu(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,vu(n,e,i),Qe(),Iu=u,bt=s,Cu.transition=a}else e.current=n;if(Gu&&(Gu=!1,Ku=e,Xu=i),a=e.pendingLanes,0===a&&(qu=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nl(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wu)throw Wu=!1,e=Hu,Hu=null,e;0!==(1&Xu)&&0!==e.tag&&wl(),a=e.pendingLanes,0!==(1&a)?e===Qu?Yu++:(Yu=0,Qu=e):Yu=0,Vi()}(e,t,n,r)}finally{Cu.transition=i,bt=r}return null}function wl(){if(null!==Ku){var e=xt(Xu),t=Cu.transition,n=bt;try{if(Cu.transition=null,bt=16>e?16:e,null===Ku)var r=!1;else{if(e=Ku,Ku=null,Xu=0,0!==(6&Iu))throw Error(o(331));var i=Iu;for(Iu|=4,$s=e.current;null!==$s;){var a=$s,s=a.child;if(0!==(16&$s.flags)){var u=a.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for($s=c;null!==$s;){var h=$s;switch(h.tag){case 0:case 11:case 15:tu(8,h,a)}var d=h.child;if(null!==d)d.return=h,$s=d;else for(;null!==$s;){var f=(h=$s).sibling,p=h.return;if(iu(h),h===c){$s=null;break}if(null!==f){f.return=p,$s=f;break}$s=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}$s=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,$s=s;else e:for(;null!==$s;){if(0!==(2048&(a=$s).flags))switch(a.tag){case 0:case 11:case 15:tu(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,$s=y;break e}$s=a.return}}var b=e.current;for($s=b;null!==$s;){var x=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,$s=x;else e:for(s=b;null!==$s;){if(0!==(2048&(u=$s).flags))try{switch(u.tag){case 0:case 11:case 15:nu(9,u)}}catch(E){_l(u,u.return,E)}if(u===s){$s=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,$s=w;break e}$s=u.return}}if(Iu=i,Vi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{bt=n,Cu.transition=t}}return!1}function El(e,t,n){e=zo(e,t=fs(0,t=ls(n,t),1),1),t=Ju(),null!==e&&(vt(e,1,t),nl(e,t))}function _l(e,t,n){if(3===e.tag)El(e,e,n);else for(;null!==t;){if(3===t.tag){El(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=zo(t,e=ps(t,e=ls(n,e),1),1),e=Ju(),null!==t&&(vt(t,1,e),nl(t,e));break}}t=t.return}}function Sl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ju(),e.pingedLanes|=e.suspendedLanes&n,Tu===e&&(Ou&n)===n&&(4===Du||3===Du&&(130023424&Ou)===Ou&&500>$e()-zu?hl(e,0):Fu|=n),nl(e,t)}function kl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=Ju();null!==(e=Mo(e,t))&&(vt(e,t,n),nl(e,n))}function Cl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kl(e,n)}function Il(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),kl(e,n)}function Tl(e,t){return Ke(e,t)}function Al(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ol(e,t,n,r){return new Al(e,t,n,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pl(e,t){var n=e.alternate;return null===n?((n=Ol(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dl(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Nl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case _:return Rl(n.children,i,a,t);case S:s=8,i|=8;break;case k:return(e=Ol(12,n,t,2|i)).elementType=k,e.lanes=a,e;case A:return(e=Ol(13,n,t,i)).elementType=A,e.lanes=a,e;case O:return(e=Ol(19,n,t,i)).elementType=O,e.lanes=a,e;case D:return Ml(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case I:s=9;break e;case T:s=11;break e;case N:s=14;break e;case P:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ol(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Rl(e,t,n,r){return(e=Ol(7,e,r,t)).lanes=n,e}function Ml(e,t,n,r){return(e=Ol(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function jl(e,t,n){return(e=Ol(6,e,null,t)).lanes=n,e}function Fl(e,t,n){return(t=Ol(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ll(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bl(e,t,n,r,i,o,a,s,u){return e=new Ll(e,t,n,s,u),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Ol(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),e}function zl(e){if(!e)return Ii;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Mi(e,n,t)}return t}function Ul(e,t,n,r,i,o,a,s,u){return(e=Bl(n,r,!0,e,0,o,0,s,u)).context=zl(null),n=e.current,(o=Bo(r=Ju(),i=el(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,i),e.current.lanes=i,vt(e,i,r),nl(e,r),e}function Vl(e,t,n,r){var i=t.current,o=Ju(),a=el(i);return n=zl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(i,t,a))&&(tl(e,i,a,o),Uo(e,i,a)),a}function Wl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ql(e,t){Hl(e,t),(e=e.alternate)&&Hl(e,t)}Eu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:As(t),po();break;case 5:Zo(t);break;case 1:Pi(t.type)&&ji(t);break;case 4:Qo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(_o,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?js(e,t,n):(Ci(ea,1&ea.current),null!==(e=Ws(e,t,n))?e.sibling:null);Ci(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Us(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,n)}return Ws(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,io&&0!==(1048576&t.flags)&&Ji(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vs(e,t),e=t.pendingProps;var i=Ni(t,Ti.current);Oo(t,n),i=ga(null,t,r,e,i,n);var a=va();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(a=!0,ji(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Fo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,us(t,r,e,n),t=Ts(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===N)return 14}return 2}(r),e=ns(r,e),i){case 0:t=Cs(null,t,r,e,n);break e;case 1:t=Is(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Es(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Cs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,Is(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(As(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Lo(e,t),Wo(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Os(e,t,r,n,i=ls(Error(o(423)),t));break e}if(r!==i){t=Os(e,t,r,n,i=ls(Error(o(424)),t));break e}for(ro=li(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Eo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){t=Ws(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return Zo(t),null===e&&lo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),ks(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&lo(t),null;case 13:return js(e,t,n);case 4:return Qo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ws(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ci(_o,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Ai.current){t=Ws(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=Bo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ao(a.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ao(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Oo(t,n),r=r(i=No(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),Es(e,t,r,i=ns(r.type,i),n);case 15:return _s(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Vs(e,t),t.tag=1,Pi(r)?(e=!0,ji(t)):e=!1,Oo(t,n),as(t,r,i),us(t,r,i,n),Ts(null,t,r,!0,e,n);case 19:return Us(e,t,n);case 22:return Ss(e,t,n)}throw Error(o(156,t.tag))};var Gl="function"===typeof reportError?reportError:function(e){console.error(e)};function Kl(e){this._internalRoot=e}function Xl(e){this._internalRoot=e}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function Zl(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Wl(a);s.call(e)}}Vl(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Wl(a);o.call(e)}}var a=Ul(t,r,e,0,null,!1,0,"",$l);return e._reactRootContainer=a,e[pi]=a.current,Vr(8===e.nodeType?e.parentNode:e),ll(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Wl(u);s.call(e)}}var u=Bl(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=u,e[pi]=u.current,Vr(8===e.nodeType?e.parentNode:e),ll(function(){Vl(t,u,n,r)}),u}(n,t,e,i,r);return Wl(a)}Xl.prototype.render=Kl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vl(e,t,null,null)},Xl.prototype.unmount=Kl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ll(function(){Vl(null,e,null,null)}),t[pi]=null}},Xl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),nl(t,$e()),0===(6&Iu)&&(Uu=$e()+500,Vi()))}break;case 13:ll(function(){var t=Mo(e,1);if(null!==t){var n=Ju();tl(t,e,1,n)}}),ql(e,1)}},Et=function(e){if(13===e.tag){var t=Mo(e,134217728);if(null!==t)tl(t,e,134217728,Ju());ql(e,134217728)}},_t=function(e){if(13===e.tag){var t=el(e),n=Mo(e,t);if(null!==n)tl(n,e,t,Ju());ql(e,t)}},St=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(o(90));K(r),Z(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=ul,Ae=ll;var Jl={usingClientEntryPoint:!1,Events:[bi,xi,wi,Ce,Ie,ul]},ec={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tc={bundleType:ec.bundleType,version:ec.version,rendererPackageName:ec.rendererPackageName,rendererConfig:ec.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:ec.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{it=nc.inject(tc),ot=nc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yl(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yl(e))throw Error(o(299));var n=!1,r="",i=Gl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bl(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Kl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return ll(e)},t.hydrate=function(e,t,n){if(!Ql(t))throw Error(o(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yl(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Gl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Ul(t,null,e,1,null!=n?n:null,i,0,a,s),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xl(t)},t.render=function(e,t,n){if(!Ql(t))throw Error(o(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ql(e))throw Error(o(40));return!!e._reactRootContainer&&(ll(function(){Zl(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ql(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Zl(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2777(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isSymbol=function(e){return"symbol"===typeof e||e instanceof Symbol}},2897(e,t,n){var r=n(3693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},3272(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toKey=function(e){var t;return"string"===typeof e||"symbol"===typeof e?e:Object.is(null===e||void 0===e||null===(t=e.valueOf)||void 0===t?void 0:t.call(e),-0)?"-0":String(e)}},3693(e,t,n){var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3757(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},3799(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4704),i=n(1203),o=n(870),a=n(5093);t.isIterateeCall=function(e,t,n){return!!o.isObject(n)&&(!!("number"===typeof t&&i.isArrayLike(n)&&r.isIndex(t)&&t<n.length||"string"===typeof t&&t in n)&&a.isEqualsSameValueZero(n[t],e))}},3808(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),i=n(5261);t.matches=function(e){return e=i.cloneDeep(e),t=>r.isMatch(t,e)}},3821(e,t,n){e.exports=n(2204).sortBy},4202(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,E=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)E.call(t,i)&&!S.hasOwnProperty(i)&&(o[i]=t[i]);var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===o[i]&&(o[i]=u[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:_.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return a=a(u=e),e=""===o?"."+T(u,0):o,w(a)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),A(a,t,i,"",function(e){return e})):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(u=0,o=""===o?".":o+":",w(e))for(var l=0;l<e.length;l++){var c=o+T(s=e[l],l);u+=A(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=A(s=s.value,t,i,c=o+T(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function O(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",function(e){return t.call(n,e,i++)}),r}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return O(e,function(){t++}),t},toArray:function(e){return O(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=_.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)E.call(t,l)&&!S.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},4208(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const i=e[r],o=t(i,r,e);n.has(o)||n.set(o,i)}return Array.from(n.values())}},4332(e,t,n){e.exports=n(5053).uniqBy},4391(e,t,n){"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4704(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;t.isIndex=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return n.test(e)}}},4803(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPrimitive=function(e){return null==e||"object"!==typeof e&&"function"!==typeof e}},4830(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.debounce=function(e,t){let n,{signal:r,edges:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null;const a=null!=i&&i.includes("leading"),s=null==i||i.includes("trailing"),u=()=>{null!==o&&(e.apply(n,o),n=void 0,o=null)};let l=null;const c=()=>{null!=l&&clearTimeout(l),l=setTimeout(()=>{l=null,s&&u(),h()},t)},h=()=>{null!==l&&(clearTimeout(l),l=null),n=void 0,o=null},d=function(){if(null!==r&&void 0!==r&&r.aborted)return;n=this;for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];o=t;const s=null==l;c(),a&&s&&u()};return d.schedule=c,d.cancel=h,d.flush=()=>{u()},null===r||void 0===r||r.addEventListener("abort",h,{once:!0}),d}},4879(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6770);t.toFinite=function(e){if(!e)return 0===e?e:0;if((e=r.toNumber(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e===e?e:0}},5043(e,t,n){"use strict";e.exports=n(4202)},5053(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4208),i=n(9903),o=n(9599),a=n(2104),s=n(2715);t.uniqBy=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.identity;return a.isArrayLikeObject(e)?r.uniqBy(Array.from(e),i.ary(s.iteratee(t),1)):[]}},5082(e,t){"use strict";var n=60103,r=60106,i=60107,o=60108,a=60114,s=60109,u=60110,l=60112,c=60113,h=60120,d=60115,f=60116,p=60121,m=60122,g=60117,v=60129,y=60131;if("function"===typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),r=b("react.portal"),i=b("react.fragment"),o=b("react.strict_mode"),a=b("react.profiler"),s=b("react.provider"),u=b("react.context"),l=b("react.forward_ref"),c=b("react.suspense"),h=b("react.suspense_list"),d=b("react.memo"),f=b("react.lazy"),p=b("react.block"),m=b("react.server.block"),g=b("react.fundamental"),v=b("react.debug_trace_mode"),y=b("react.legacy_hidden")}function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case a:case o:case c:case h:return e;default:switch(e=e&&e.$$typeof){case u:case l:case f:case d:case s:return e;default:return t}}case r:return t}}}t.isFragment=function(e){return x(e)===i}},5093(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isEqualsSameValueZero=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}},5261(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433);t.cloneDeep=function(e){return r.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},5303(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2489),i=n(4704),o=n(6321),a=n(1444);t.has=function(e,t){let n;if(n=Array.isArray(t)?t:"string"===typeof t&&r.isDeepKey(t)&&null==(null===e||void 0===e?void 0:e[t])?a.toPath(t):[t],0===n.length)return!1;let s=e;for(let r=0;r<n.length;r++){const e=n[r];if(null==s||!Object.hasOwn(s,e)){if(!((Array.isArray(s)||o.isArguments(s))&&i.isIndex(e)&&e<s.length))return!1}s=s[e]}return!0}},5316(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9709),i=n(7043),o=n(1444);t.orderBy=function(e,t,n,a){if(null==e)return[];n=a?void 0:n,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(n)||(n=null==n?[]:[n]),n=n.map(e=>String(e));const s=(e,t)=>{let n=e;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n},u=t.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"===typeof e||Array.isArray(e)||i.isKey(e)?e:{key:e,path:o.toPath(e)}));return e.map(e=>({original:e,criteria:u.map(t=>((e,t)=>null==t||null==e?t:"object"===typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:s(t,e.path):"function"===typeof e?e(t):Array.isArray(e)?s(t,e):"object"===typeof t?t[e]:t)(t,e))})).slice().sort((e,t)=>{for(let i=0;i<u.length;i++){const o=r.compareValues(e.criteria[i],t.criteria[i],n[i]);if(0!==o)return o}return 0}).map(e=>e.original)}},5414(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1293);t.throttle=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{leading:i=!0,trailing:o=!0}=n;return r.debounce(e,t,{leading:i,maxWait:t,trailing:o})}},5508(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433),i=n(5990),o=n(7599);t.cloneDeepWith=function(e,t){return r.cloneDeepWith(e,(n,a,s,u)=>{const l=null===t||void 0===t?void 0:t(n,a,s,u);if(void 0!==l)return l;if("object"===typeof e){if(i.getTag(e)===o.objectTag&&"function"!==typeof e.constructor){const t={};return u.set(e,t),r.copyProperties(t,e,s,u),t}switch(Object.prototype.toString.call(e)){case o.numberTag:case o.stringTag:case o.booleanTag:{const t=new e.constructor(null===e||void 0===e?void 0:e.valueOf());return r.copyProperties(t,e),t}case o.argumentsTag:{const t={};return r.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}}})}},5990(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},6321(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5990);t.isArguments=function(e){return null!==e&&"object"===typeof e&&"[object Arguments]"===r.getTag(e)}},6392(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.last=function(e){return e[e.length-1]}},6433(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6443),i=n(5990),o=n(7599),a=n(4803),s=n(3757);function u(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const h=null===c||void 0===c?void 0:c(e,t,n,r);if(void 0!==h)return h;if(a.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const t=new Array(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=u(e[i],i,n,r,c);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;r.set(e,t);for(const[i,o]of e)t.set(i,u(o,i,n,r,c));return t}if(e instanceof Set){const t=new Set;r.set(e,t);for(const i of e)t.add(u(i,void 0,n,r,c));return t}if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(s.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=u(e[i],i,n,r,c);return t}if(e instanceof ArrayBuffer||"undefined"!==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),l(t,e,n,r,c),t}if("undefined"!==typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return r.set(e,t),l(t,e,n,r,c),t}if("undefined"!==typeof Blob&&e instanceof Blob){const t=new Blob([e],{type:e.type});return r.set(e,t),l(t,e,n,r,c),t}if(e instanceof Error){const t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,l(t,e,n,r,c),t}if(e instanceof Boolean){const t=new Boolean(e.valueOf());return r.set(e,t),l(t,e,n,r,c),t}if(e instanceof Number){const t=new Number(e.valueOf());return r.set(e,t),l(t,e,n,r,c),t}if(e instanceof String){const t=new String(e.valueOf());return r.set(e,t),l(t,e,n,r,c),t}if("object"===typeof e&&function(e){switch(i.getTag(e)){case o.argumentsTag:case o.arrayTag:case o.arrayBufferTag:case o.dataViewTag:case o.booleanTag:case o.dateTag:case o.float32ArrayTag:case o.float64ArrayTag:case o.int8ArrayTag:case o.int16ArrayTag:case o.int32ArrayTag:case o.mapTag:case o.numberTag:case o.objectTag:case o.regexpTag:case o.setTag:case o.stringTag:case o.symbolTag:case o.uint8ArrayTag:case o.uint8ClampedArrayTag:case o.uint16ArrayTag:case o.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),l(t,e,n,r,c),t}return e}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const a=[...Object.keys(t),...r.getSymbols(t)];for(let r=0;r<a.length;r++){const s=a[r],l=Object.getOwnPropertyDescriptor(e,s);(null==l||l.writable)&&(e[s]=u(t[s],s,n,i,o))}}t.cloneDeepWith=function(e,t){return u(e,void 0,e,new Map,t)},t.cloneDeepWithImpl=u,t.copyProperties=l},6443(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}},6770(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777);t.toNumber=function(e){return r.isSymbol(e)?NaN:Number(e)}},7043(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.isKey=function(e,t){return!Array.isArray(e)&&(!("number"!==typeof e&&"boolean"!==typeof e&&null!=e&&!r.isSymbol(e))||("string"===typeof e&&(o.test(e)||!i.test(e))||null!=t&&Object.hasOwn(t,e)))}},7231(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(3799),i=n(4879);t.range=function(e,t,n){n&&"number"!==typeof n&&r.isIterateeCall(e,t,n)&&(t=n=void 0),e=i.toFinite(e),void 0===t?(t=e,e=0):t=i.toFinite(t),n=void 0===n?e<t?1:-1:i.toFinite(n);const o=Math.max(Math.ceil((t-e)/(n||1)),0),a=new Array(o);for(let r=0;r<o;r++)a[r]=e,e+=n;return a}},7234(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>o(u,n))l<i&&0>o(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<i&&0>o(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function w(e){if(g=!1,x(e),!m)if(null!==r(l))m=!0,D(E);else{var t=r(c);null!==t&&R(w,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,y(C),C=-1),p=!0;var o=f;try{for(x(n),d=r(l);null!==d&&(!(d.expirationTime>n)||e&&!A());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var s=a(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(l)&&i(l),x(n)}else i(l);d=r(l)}if(null!==d)var u=!0;else{var h=r(c);null!==h&&R(w,h.startTime-n),u=!1}return u}finally{d=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,k=null,C=-1,I=5,T=-1;function A(){return!(t.unstable_now()-T<I)}function O(){if(null!==k){var e=t.unstable_now();T=e;var n=!0;try{n=k(!0,e)}finally{n?_():(S=!1,k=null)}}else S=!1}if("function"===typeof b)_=function(){b(O)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,P=N.port2;N.port1.onmessage=O,_=function(){P.postMessage(null)}}else _=function(){v(O,0)};function D(e){k=e,S||(S=!0,_())}function R(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(l)&&e===r(c)&&(g?(y(C),C=-1):g=!0,R(w,o-a))):(e.sortIndex=s,n(l,e),m||p||(m=!0,D(E))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7237(e,t,n){"use strict";n(8365)},7260(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isUnsafeProperty=function(e){return"__proto__"===e}},7312(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.flatten=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=[],r=Math.floor(t),i=(e,t)=>{for(let o=0;o<e.length;o++){const a=e[o];Array.isArray(a)&&t<r?i(a,t+1):n.push(a)}};return i(e,0),n}},7318(){},7330(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9323);t.property=function(e){return function(t){return r.get(t,e)}}},7599(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.argumentsTag="[object Arguments]",t.arrayBufferTag="[object ArrayBuffer]",t.arrayTag="[object Array]",t.bigInt64ArrayTag="[object BigInt64Array]",t.bigUint64ArrayTag="[object BigUint64Array]",t.booleanTag="[object Boolean]",t.dataViewTag="[object DataView]",t.dateTag="[object Date]",t.errorTag="[object Error]",t.float32ArrayTag="[object Float32Array]",t.float64ArrayTag="[object Float64Array]",t.functionTag="[object Function]",t.int16ArrayTag="[object Int16Array]",t.int32ArrayTag="[object Int32Array]",t.int8ArrayTag="[object Int8Array]",t.mapTag="[object Map]",t.numberTag="[object Number]",t.objectTag="[object Object]",t.regexpTag="[object RegExp]",t.setTag="[object Set]",t.stringTag="[object String]",t.symbolTag="[object Symbol]",t.uint16ArrayTag="[object Uint16Array]",t.uint32ArrayTag="[object Uint32Array]",t.uint8ArrayTag="[object Uint8Array]",t.uint8ClampedArrayTag="[object Uint8ClampedArray]"},7736(e,t,n){var r=n(3738).default,i=n(9045);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7770(e,t,n){e.exports=n(9323).get},7820(e,t,n){e.exports=n(5414).throttle},7950(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8082(){},8210(e,t,n){var r;!function(){"use strict";var i,o=1e9,a={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},s=!0,u="[DecimalError] ",l=u+"Invalid argument: ",c=u+"Exponent out of range: ",h=Math.floor,d=Math.pow,f=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,p=1e7,m=9007199254740991,g=h(1286742750677284.5),v={};function y(e,t){var n,r,i,o,a,u,l,c,h=e.constructor,d=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),s?T(t,d):t;if(l=e.d,c=t.d,a=e.e,i=t.e,l=l.slice(),o=a-i){for(o<0?(r=l,o=-o,u=c.length):(r=c,i=a,u=l.length),o>(u=(a=Math.ceil(d/7))>u?a+1:u+1)&&(o=u,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for((u=l.length)-(o=c.length)<0&&(o=u,r=c,c=l,l=r),n=0;o;)n=(l[--o]=l[o]+c[o]+n)/p|0,l[o]%=p;for(n&&(l.unshift(n),++i),u=l.length;0==l[--u];)l.pop();return t.d=l,t.e=i,s?T(t,d):t}function b(e,t,n){if(e!==~~e||e<t||e>n)throw Error(l+e)}function x(e){var t,n,r,i=e.length-1,o="",a=e[0];if(i>0){for(o+=a,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(o+=k(n)),o+=r;(n=7-(r=(a=e[t])+"").length)&&(o+=k(n))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}v.absoluteValue=v.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},v.comparedTo=v.cmp=function(e){var t,n,r,i,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(t=0,n=(r=o.d.length)<(i=e.d.length)?r:i;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===i?0:r>i^o.s<0?1:-1},v.decimalPlaces=v.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},v.dividedBy=v.div=function(e){return w(this,new this.constructor(e))},v.dividedToIntegerBy=v.idiv=function(e){var t=this.constructor;return T(w(this,new t(e),0,1),t.precision)},v.equals=v.eq=function(e){return!this.cmp(e)},v.exponent=function(){return _(this)},v.greaterThan=v.gt=function(e){return this.cmp(e)>0},v.greaterThanOrEqualTo=v.gte=function(e){return this.cmp(e)>=0},v.isInteger=v.isint=function(){return this.e>this.d.length-2},v.isNegative=v.isneg=function(){return this.s<0},v.isPositive=v.ispos=function(){return this.s>0},v.isZero=function(){return 0===this.s},v.lessThan=v.lt=function(e){return this.cmp(e)<0},v.lessThanOrEqualTo=v.lte=function(e){return this.cmp(e)<1},v.logarithm=v.log=function(e){var t,n=this,r=n.constructor,o=r.precision,a=o+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(i))throw Error(u+"NaN");if(n.s<1)throw Error(u+(n.s?"NaN":"-Infinity"));return n.eq(i)?new r(0):(s=!1,t=w(C(n,a),C(e,a),a),s=!0,T(t,o))},v.minus=v.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?A(t,e):y(t,(e.s=-e.s,e))},v.modulo=v.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(!(e=new r(e)).s)throw Error(u+"NaN");return n.s?(s=!1,t=w(n,e,0,1).times(e),s=!0,n.minus(t)):T(new r(n),i)},v.naturalExponential=v.exp=function(){return E(this)},v.naturalLogarithm=v.ln=function(){return C(this)},v.negated=v.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},v.plus=v.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?y(t,e):A(t,(e.s=-e.s,e))},v.precision=v.sd=function(e){var t,n,r,i=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(l+e);if(t=_(i)+1,n=7*(r=i.d.length-1)+1,r=i.d[r]){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},v.squareRoot=v.sqrt=function(){var e,t,n,r,i,o,a,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(u+"NaN")}for(e=_(l),s=!1,0==(i=Math.sqrt(+l))||i==1/0?(((t=x(l.d)).length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=h((e+1)/2)-(e<0||e%2),r=new c(t=i==1/0?"5e"+e:(t=i.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new c(i.toString()),i=a=(n=c.precision)+3;;)if(r=(o=r).plus(w(l,o,a+2)).times(.5),x(o.d).slice(0,a)===(t=x(r.d)).slice(0,a)){if(t=t.slice(a-3,a+1),i==a&&"4999"==t){if(T(o,n+1,0),o.times(o).eq(l)){r=o;break}}else if("9999"!=t)break;a+=4}return s=!0,T(r,n)},v.times=v.mul=function(e){var t,n,r,i,o,a,u,l,c,h=this,d=h.constructor,f=h.d,m=(e=new d(e)).d;if(!h.s||!e.s)return new d(0);for(e.s*=h.s,n=h.e+e.e,(l=f.length)<(c=m.length)&&(o=f,f=m,m=o,a=l,l=c,c=a),o=[],r=a=l+c;r--;)o.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)u=o[i]+m[r]*f[i-r-1]+t,o[i--]=u%p|0,t=u/p|0;o[i]=(o[i]+t)%p|0}for(;!o[--a];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,s?T(e,d.precision):e},v.toDecimalPlaces=v.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(b(e,0,o),void 0===t?t=r.rounding:b(t,0,8),T(n,e+_(n)+1,t))},v.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=O(r,!0):(b(e,0,o),void 0===t?t=i.rounding:b(t,0,8),n=O(r=T(new i(r),e+1,t),!0,e+1)),n},v.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?O(i):(b(e,0,o),void 0===t?t=a.rounding:b(t,0,8),n=O((r=T(new a(i),e+_(i)+1,t)).abs(),!1,e+_(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)},v.toInteger=v.toint=function(){var e=this,t=e.constructor;return T(new t(e),_(e)+1,t.rounding)},v.toNumber=function(){return+this},v.toPower=v.pow=function(e){var t,n,r,o,a,l,c=this,d=c.constructor,f=+(e=new d(e));if(!e.s)return new d(i);if(!(c=new d(c)).s){if(e.s<1)throw Error(u+"Infinity");return c}if(c.eq(i))return c;if(r=d.precision,e.eq(i))return T(c,r);if(l=(t=e.e)>=(n=e.d.length-1),a=c.s,l){if((n=f<0?-f:f)<=m){for(o=new d(i),t=Math.ceil(r/7+4),s=!1;n%2&&N((o=o.times(c)).d,t),0!==(n=h(n/2));)N((c=c.times(c)).d,t);return s=!0,e.s<0?new d(i).div(o):T(o,r)}}else if(a<0)throw Error(u+"NaN");return a=a<0&&1&e.d[Math.max(t,n)]?-1:1,c.s=1,s=!1,o=e.times(C(c,r+12)),s=!0,(o=E(o)).s=a,o},v.toPrecision=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?r=O(i,(n=_(i))<=a.toExpNeg||n>=a.toExpPos):(b(e,1,o),void 0===t?t=a.rounding:b(t,0,8),r=O(i=T(new a(i),e,t),e<=(n=_(i))||n<=a.toExpNeg,e)),r},v.toSignificantDigits=v.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(b(e,1,o),void 0===t?t=n.rounding:b(t,0,8)),T(new n(this),e,t)},v.toString=v.valueOf=v.val=v.toJSON=function(){var e=this,t=_(e),n=e.constructor;return O(e,t<=n.toExpNeg||t>=n.toExpPos)};var w=function(){function e(e,t){var n,r=0,i=e.length;for(e=e.slice();i--;)n=e[i]*t+r,e[i]=n%p|0,r=n/p|0;return r&&e.unshift(r),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*p+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,o,a){var s,l,c,h,d,f,m,g,v,y,b,x,w,E,S,k,C,I,A=r.constructor,O=r.s==i.s?1:-1,N=r.d,P=i.d;if(!r.s)return new A(r);if(!i.s)throw Error(u+"Division by zero");for(l=r.e-i.e,C=P.length,S=N.length,g=(m=new A(O)).d=[],c=0;P[c]==(N[c]||0);)++c;if(P[c]>(N[c]||0)&&--l,(x=null==o?o=A.precision:a?o+(_(r)-_(i))+1:o)<0)return new A(0);if(x=x/7+2|0,c=0,1==C)for(h=0,P=P[0],x++;(c<S||h)&&x--;c++)w=h*p+(N[c]||0),g[c]=w/P|0,h=w%P|0;else{for((h=p/(P[0]+1)|0)>1&&(P=e(P,h),N=e(N,h),C=P.length,S=N.length),E=C,y=(v=N.slice(0,C)).length;y<C;)v[y++]=0;(I=P.slice()).unshift(0),k=P[0],P[1]>=p/2&&++k;do{h=0,(s=t(P,v,C,y))<0?(b=v[0],C!=y&&(b=b*p+(v[1]||0)),(h=b/k|0)>1?(h>=p&&(h=p-1),1==(s=t(d=e(P,h),v,f=d.length,y=v.length))&&(h--,n(d,C<f?I:P,f))):(0==h&&(s=h=1),d=P.slice()),(f=d.length)<y&&d.unshift(0),n(v,d,y),-1==s&&(s=t(P,v,C,y=v.length))<1&&(h++,n(v,C<y?I:P,y)),y=v.length):0===s&&(h++,v=[0]),g[c++]=h,s&&v[0]?v[y++]=N[E]||0:(v=[N[E]],y=1)}while((E++<S||void 0!==v[0])&&x--)}return g[0]||g.shift(),m.e=l,T(m,a?o+_(m)+1:o)}}();function E(e,t){var n,r,o,a,u,l=0,h=0,f=e.constructor,p=f.precision;if(_(e)>16)throw Error(c+_(e));if(!e.s)return new f(i);for(null==t?(s=!1,u=p):u=t,a=new f(.03125);e.abs().gte(.1);)e=e.times(a),h+=5;for(u+=Math.log(d(2,h))/Math.LN10*2+5|0,n=r=o=new f(i),f.precision=u;;){if(r=T(r.times(e),u),n=n.times(++l),x((a=o.plus(w(r,n,u))).d).slice(0,u)===x(o.d).slice(0,u)){for(;h--;)o=T(o.times(o),u);return f.precision=p,null==t?(s=!0,T(o,p)):o}o=a}}function _(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function S(e,t,n){if(t>e.LN10.sd())throw s=!0,n&&(e.precision=n),Error(u+"LN10 precision limit exceeded");return T(new e(e.LN10),t)}function k(e){for(var t="";e--;)t+="0";return t}function C(e,t){var n,r,o,a,l,c,h,d,f,p=1,m=e,g=m.d,v=m.constructor,y=v.precision;if(m.s<1)throw Error(u+(m.s?"NaN":"-Infinity"));if(m.eq(i))return new v(0);if(null==t?(s=!1,d=y):d=t,m.eq(10))return null==t&&(s=!0),S(v,d);if(d+=10,v.precision=d,r=(n=x(g)).charAt(0),a=_(m),!(Math.abs(a)<15e14))return h=S(v,d+2,y).times(a+""),m=C(new v(r+"."+n.slice(1)),d-10).plus(h),v.precision=y,null==t?(s=!0,T(m,y)):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=x((m=m.times(e)).d)).charAt(0),p++;for(a=_(m),r>1?(m=new v("0."+n),a++):m=new v(r+"."+n.slice(1)),c=l=m=w(m.minus(i),m.plus(i),d),f=T(m.times(m),d),o=3;;){if(l=T(l.times(f),d),x((h=c.plus(w(l,new v(o),d))).d).slice(0,d)===x(c.d).slice(0,d))return c=c.times(2),0!==a&&(c=c.plus(S(v,d+2,y).times(a+""))),c=w(c,new v(p),d),v.precision=y,null==t?(s=!0,T(c,y)):c;c=h,o+=2}}function I(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(i=t.length;48===t.charCodeAt(i-1);)--i;if(t=t.slice(r,i)){if(i-=r,n=n-r-1,e.e=h(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),s&&(e.e>g||e.e<-g))throw Error(c+n)}else e.s=0,e.e=0,e.d=[0];return e}function T(e,t,n){var r,i,o,a,u,l,f,m,v=e.d;for(a=1,o=v[0];o>=10;o/=10)a++;if((r=t-a)<0)r+=7,i=t,f=v[m=0];else{if((m=Math.ceil((r+1)/7))>=(o=v.length))return e;for(f=o=v[m],a=1;o>=10;o/=10)a++;i=(r%=7)-7+a}if(void 0!==n&&(u=f/(o=d(10,a-i-1))%10|0,l=t<0||void 0!==v[m+1]||f%o,l=n<4?(u||l)&&(0==n||n==(e.s<0?3:2)):u>5||5==u&&(4==n||l||6==n&&(r>0?i>0?f/d(10,a-i):0:v[m-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return l?(o=_(e),v.length=1,t=t-o-1,v[0]=d(10,(7-t%7)%7),e.e=h(-t/7)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(0==r?(v.length=m,o=1,m--):(v.length=m+1,o=d(10,7-r),v[m]=i>0?(f/d(10,a-i)%d(10,i)|0)*o:0),l)for(;;){if(0==m){(v[0]+=o)==p&&(v[0]=1,++e.e);break}if(v[m]+=o,v[m]!=p)break;v[m--]=0,o=1}for(r=v.length;0===v[--r];)v.pop();if(s&&(e.e>g||e.e<-g))throw Error(c+_(e));return e}function A(e,t){var n,r,i,o,a,u,l,c,h,d,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),s?T(t,m):t;if(l=e.d,d=t.d,r=t.e,c=e.e,l=l.slice(),a=c-r){for((h=a<0)?(n=l,a=-a,u=d.length):(n=d,r=c,u=l.length),a>(i=Math.max(Math.ceil(m/7),u)+2)&&(a=i,n.length=1),n.reverse(),i=a;i--;)n.push(0);n.reverse()}else{for((h=(i=l.length)<(u=d.length))&&(u=i),i=0;i<u;i++)if(l[i]!=d[i]){h=l[i]<d[i];break}a=0}for(h&&(n=l,l=d,d=n,t.s=-t.s),u=l.length,i=d.length-u;i>0;--i)l[u++]=0;for(i=d.length;i>a;){if(l[--i]<d[i]){for(o=i;o&&0===l[--o];)l[o]=p-1;--l[o],l[i]+=p}l[i]-=d[i]}for(;0===l[--u];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(t.d=l,t.e=r,s?T(t,m):t):new f(0)}function O(e,t,n){var r,i=_(e),o=x(e.d),a=o.length;return t?(n&&(r=n-a)>0?o=o.charAt(0)+"."+o.slice(1)+k(r):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+k(-i-1)+o,n&&(r=n-a)>0&&(o+=k(r))):i>=a?(o+=k(i+1-a),n&&(r=n-i-1)>0&&(o=o+"."+k(r))):((r=i+1)<a&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(o+="."),o+=k(r))),e.s<0?"-"+o:o}function N(e,t){if(e.length>t)return e.length=t,!0}function P(e){if(!e||"object"!==typeof e)throw Error(u+"Object expected");var t,n,r,i=["precision",1,o,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if(void 0!==(r=e[n=i[t]])){if(!(h(r)===r&&r>=i[t+1]&&r<=i[t+2]))throw Error(l+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(l+n+": "+r);this[n]=new this(r)}return this}a=function e(t){var n,r,i;function o(e){var t=this;if(!(t instanceof o))return new o(e);if(t.constructor=o,e instanceof o)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(l+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):I(t,e.toString())}if("string"!==typeof e)throw Error(l+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!f.test(e))throw Error(l+e);I(t,e)}if(o.prototype=v,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=e,o.config=o.set=P,void 0===t&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return o.config(t),o}(a),a.default=a.Decimal=a,i=new a(1),void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},8268(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2132);t.isMatch=function(e,t){return r.isMatchWith(e,t,()=>{})}},8346(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},8365(e,t,n){"use strict";var r=n(5043);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useSyncExternalStore,a=r.useRef,s=r.useEffect,u=r.useMemo,l=r.useDebugValue},8396(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5508);t.cloneDeep=function(e){return r.cloneDeepWith(e)}},8420(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},8443(e,t,n){"use strict";e.exports=n(9717)},8499(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(l=1,u=new Array(h-1);l<h;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var d,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!u)for(d=1,u=new Array(h-1);d<h;d++)u[d-1]=arguments[d];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},8845(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),i=n(3272),o=n(8396),a=n(9323),s=n(5303);t.matchesProperty=function(e,t){switch(typeof e){case"object":var n;Object.is(null===(n=e)||void 0===n?void 0:n.valueOf(),-0)&&(e="-0");break;case"number":e=i.toKey(e)}return t=o.cloneDeep(t),function(n){const i=a.get(n,e);return void 0===i?s.has(n,e):void 0===t?void 0===i:r.isMatch(i,t)}}},8853(e,t,n){"use strict";e.exports=n(7234)},9045(e,t,n){var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9323(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7260),i=n(2489),o=n(3272),a=n(1444);t.get=function e(t,n,s){if(null==t)return s;switch(typeof n){case"string":{if(r.isUnsafeProperty(n))return s;const o=t[n];return void 0===o?i.isDeepKey(n)?e(t,a.toPath(n),s):s:o}case"number":case"symbol":{"number"===typeof n&&(n=o.toKey(n));const e=t[n];return void 0===e?s:e}default:{var u;if(Array.isArray(n))return function(e,t,n){if(0===t.length)return n;let i=e;for(let o=0;o<t.length;o++){if(null==i)return n;if(r.isUnsafeProperty(t[o]))return n;i=i[t[o]]}if(void 0===i)return n;return i}(t,n,s);if(n=Object.is(null===(u=n)||void 0===u?void 0:u.valueOf(),-0)?"-0":String(n),r.isUnsafeProperty(n))return s;const e=t[n];return void 0===e?s:e}}}},9397(e,t,n){e.exports=n(2682).isPlainObject},9461(e,t,n){"use strict";e.exports=n(2330)},9599(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.identity=function(e){return e}},9645(e,t,n){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6392),i=n(8346),o=n(1203);t.last=function(e){if(o.isArrayLike(e))return r.last(i.toArray(e))}},9709(e,t){"use strict";function n(e){return"symbol"===typeof e?1:null===e?2:void 0===e?3:e!==e?4:0}Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.compareValues=(e,t,r)=>{if(e!==t){const i=n(e),o=n(t);if(i===o&&0===i){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?o-i:i-o}return 0}},9717(e,t,n){"use strict";var r=n(5043),i=n(9461);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=i.useSyncExternalStore,s=r.useRef,u=r.useEffect,l=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var h=s(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=l(function(){function e(e){if(!u){if(u=!0,a=e,e=r(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return s=t}return s=e}if(t=s,o(a,e))return t;var n=r(e);return void 0!==i&&i(t,n)?(a=e,t):(a=e,s=n)}var a,s,u=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,n,r,i]);var f=a(e,h[0],h[1]);return u(function(){d.hasValue=!0,d.value=f},[f]),c(f),f}},9859(e,t,n){e.exports=n(7231).range},9903(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.ary=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.apply(this,r.slice(0,t))}}},9921(e,t){"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObjectLike=function(e){return"object"===typeof e&&null!==e}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(o,a),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{scaleBand:()=>XM,scaleDiverging:()=>Vz,scaleDivergingLog:()=>Wz,scaleDivergingPow:()=>qz,scaleDivergingSqrt:()=>Gz,scaleDivergingSymlog:()=>Hz,scaleIdentity:()=>jF,scaleImplicit:()=>GM,scaleLinear:()=>MF,scaleLog:()=>qF,scaleOrdinal:()=>KM,scalePoint:()=>QM,scalePow:()=>eL,scaleQuantile:()=>dL,scaleQuantize:()=>fL,scaleRadial:()=>rL,scaleSequential:()=>Mz,scaleSequentialLog:()=>jz,scaleSequentialPow:()=>Lz,scaleSequentialQuantile:()=>zz,scaleSequentialSqrt:()=>Bz,scaleSequentialSymlog:()=>Fz,scaleSqrt:()=>tL,scaleSymlog:()=>YF,scaleThreshold:()=>pL,scaleTime:()=>Nz,scaleUtc:()=>Pz,tickFormat:()=>DF});var t=n(5043),r=n.t(t,2),i=n(4391);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const d=["color","size","strokeWidth","absoluteStrokeWidth","children"],f=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var p=(e,n)=>{const r=(0,t.forwardRef)((r,i)=>{let{color:o="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:u,children:p}=r,m=c(r,d);return(0,t.createElement)("svg",l(l({ref:i},h),{},{width:a,height:a,stroke:o,strokeWidth:u?24*Number(s)/Number(a):s,className:"lucide lucide-".concat(f(e))},m),[...n.map(e=>{let[n,r]=e;return(0,t.createElement)(n,r)}),...(Array.isArray(p)?p:[p])||[]])});return r.displayName="".concat(e),r};const m=p("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),g=p("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]);var v=n(579);const y=e=>{let{onAccept:t,onDecline:n,language:r,setLanguage:i}=e;const o={th:{title:"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e01\u0e25\u0e49\u0e2d\u0e07\u0e41\u0e25\u0e30\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e2a\u0e48\u0e27\u0e19\u0e1a\u0e38\u0e04\u0e04\u0e25",description:"\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32\u0e43\u0e0a\u0e49\u0e01\u0e25\u0e49\u0e2d\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e27\u0e34\u0e40\u0e04\u0e23\u0e32\u0e30\u0e2b\u0e4c\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1e\u0e37\u0e49\u0e19\u0e10\u0e32\u0e19 (\u0e40\u0e1e\u0e28\u0e41\u0e25\u0e30\u0e2d\u0e32\u0e22\u0e38\u0e42\u0e14\u0e22\u0e1b\u0e23\u0e30\u0e21\u0e32\u0e13) \u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e41\u0e2a\u0e14\u0e07\u0e40\u0e19\u0e37\u0e49\u0e2d\u0e2b\u0e32\u0e17\u0e35\u0e48\u0e40\u0e2b\u0e21\u0e32\u0e30\u0e2a\u0e21\u0e01\u0e31\u0e1a\u0e04\u0e38\u0e13 \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14\u0e08\u0e30\u0e44\u0e21\u0e48\u0e16\u0e39\u0e01\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e41\u0e25\u0e30\u0e08\u0e30\u0e16\u0e39\u0e01\u0e25\u0e1a\u0e17\u0e31\u0e19\u0e17\u0e35\u0e40\u0e21\u0e37\u0e48\u0e2d\u0e04\u0e38\u0e13\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e23\u0e30\u0e1a\u0e1a",consent:"\u0e02\u0e49\u0e32\u0e1e\u0e40\u0e08\u0e49\u0e32\u0e22\u0e34\u0e19\u0e22\u0e2d\u0e21\u0e43\u0e2b\u0e49\u0e43\u0e0a\u0e49\u0e01\u0e25\u0e49\u0e2d\u0e07\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e27\u0e34\u0e40\u0e04\u0e23\u0e32\u0e30\u0e2b\u0e4c\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1e\u0e37\u0e49\u0e19\u0e10\u0e32\u0e19",accept:"\u0e22\u0e2d\u0e21\u0e23\u0e31\u0e1a\u0e41\u0e25\u0e30\u0e40\u0e23\u0e34\u0e48\u0e21\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19",decline:"\u0e44\u0e21\u0e48\u0e22\u0e2d\u0e21\u0e23\u0e31\u0e1a\u0e41\u0e25\u0e30\u0e40\u0e23\u0e34\u0e48\u0e21\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19",privacy:"\ud83d\udd12 \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e08\u0e30\u0e16\u0e39\u0e01\u0e23\u0e31\u0e01\u0e29\u0e32\u0e04\u0e27\u0e32\u0e21\u0e1b\u0e25\u0e2d\u0e14\u0e20\u0e31\u0e22",mascot:"\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e40\u0e08\u0e49\u0e32! \u0e14\u0e34\u0e09\u0e31\u0e19\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19 \u0e22\u0e34\u0e19\u0e14\u0e35\u0e15\u0e49\u0e2d\u0e19\u0e23\u0e31\u0e1a\u0e2a\u0e39\u0e48\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32\u0e40\u0e08\u0e49\u0e32"},en:{title:"Camera & Personal Data Usage",description:"Lanna Polytechnic College uses camera to analyze basic information (gender and approximate age) to display appropriate content. All data will not be recorded and will be deleted immediately when you leave.",consent:"I consent to the use of camera for basic data analysis",accept:"Accept and Start",decline:"Decline and Start",privacy:"\ud83d\udd12 Your data will be kept secure",mascot:"Hello! I'm Tiew Son, welcome to Lanna Polytechnic College!"},zh:{title:"\u6444\u50cf\u5934\u548c\u4e2a\u4eba\u6570\u636e\u4f7f\u7528",description:"\u5170\u7eb3\u7406\u5de5\u5b66\u9662\u4f7f\u7528\u6444\u50cf\u5934\u5206\u6790\u57fa\u672c\u4fe1\u606f\uff08\u6027\u522b\u548c\u5927\u81f4\u5e74\u9f84\uff09\u4ee5\u663e\u793a\u9002\u5f53\u7684\u5185\u5bb9\u3002\u6240\u6709\u6570\u636e\u4e0d\u4f1a\u88ab\u8bb0\u5f55\uff0c\u5f53\u60a8\u79bb\u5f00\u65f6\u5c06\u7acb\u5373\u5220\u9664\u3002",consent:"\u6211\u540c\u610f\u4f7f\u7528\u6444\u50cf\u5934\u8fdb\u884c\u57fa\u672c\u6570\u636e\u5206\u6790",accept:"\u63a5\u53d7\u5e76\u5f00\u59cb",decline:"\u62d2\u7edd\u5e76\u5f00\u59cb",privacy:"\ud83d\udd12 \u60a8\u7684\u6570\u636e\u5c06\u5f97\u5230\u5b89\u5168\u4fdd\u62a4",mascot:"\u4f60\u597d\uff01\u6211\u662f\u5c0f\u677e\u9f20\uff0c\u6b22\u8fce\u6765\u5230\u5170\u7eb3\u7406\u5de5\u5b66\u9662\uff01"},ko:{title:"\uce74\uba54\ub77c \ubc0f \uac1c\uc778\uc815\ubcf4 \uc0ac\uc6a9",description:"\ub780\ub098 \ud3f4\ub9ac\ud14c\ud06c\ub2c9 \ub300\ud559\uc740 \uc801\uc808\ud55c \ucf58\ud150\uce20\ub97c \ud45c\uc2dc\ud558\uae30 \uc704\ud574 \uae30\ubcf8 \uc815\ubcf4(\uc131\ubcc4 \ubc0f \ub300\ub7b5\uc801\uc778 \ub098\uc774)\ub97c \ubd84\uc11d\ud558\ub294 \uce74\uba54\ub77c\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \ubaa8\ub4e0 \ub370\uc774\ud130\ub294 \uae30\ub85d\ub418\uc9c0 \uc54a\uc73c\uba70 \uc885\ub8cc \uc2dc \uc989\uc2dc \uc0ad\uc81c\ub429\ub2c8\ub2e4.",consent:"\uae30\ubcf8 \ub370\uc774\ud130 \ubd84\uc11d\uc744 \uc704\ud55c \uce74\uba54\ub77c \uc0ac\uc6a9\uc5d0 \ub3d9\uc758\ud569\ub2c8\ub2e4",accept:"\uc218\ub77d \ubc0f \uc2dc\uc791",decline:"\uac70\uc808 \ubc0f \uc2dc\uc791",privacy:"\ud83d\udd12 \uadc0\ud558\uc758 \ub370\uc774\ud130\ub294 \uc548\uc804\ud558\uac8c \ubcf4\ud638\ub429\ub2c8\ub2e4",mascot:"\uc548\ub155\ud558\uc138\uc694! \uc800\ub294 \ub760\uc6b0\uc190\uc785\ub2c8\ub2e4. \ub780\ub098 \ud3f4\ub9ac\ud14c\ud06c\ub2c9 \ub300\ud559\uc5d0 \uc624\uc2e0 \uac83\uc744 \ud658\uc601\ud569\ub2c8\ub2e4!"}},a=o[r]||o.th;return(0,v.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-900 via-blue-700 to-blue-500 flex items-center justify-center z-[9999] p-6 font-sans",children:(0,v.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl max-w-2xl w-full p-8 relative overflow-hidden text-center",children:[(0,v.jsx)("div",{className:"absolute top-4 right-4 z-20 flex bg-gray-100 rounded-full p-1 border border-gray-200 shadow-sm",children:["th","en","zh","ko"].map(e=>(0,v.jsx)("button",{onClick:()=>i(e),className:"px-3 py-1 rounded-full text-xs font-bold transition-all duration-200 ".concat(r===e?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-gray-600"),children:e.toUpperCase()},e))}),(0,v.jsxs)("div",{className:"relative z-10",children:[(0,v.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,v.jsx)("div",{className:"bg-blue-100 p-4 rounded-full shadow-inner",children:(0,v.jsx)(g,{className:"w-12 h-12 text-blue-600"})})}),(0,v.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 mb-4",children:a.title}),(0,v.jsx)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-4 mb-6 border-2 border-yellow-200 text-left",children:(0,v.jsxs)("div",{className:"flex items-start gap-3",children:[(0,v.jsx)("img",{src:"/tiewson.png",alt:"Mascot",className:"w-16 h-16 md:w-20 md:h-20 object-contain drop-shadow-md flex-shrink-0"}),(0,v.jsx)("p",{className:"text-gray-700 leading-relaxed pt-1 text-sm md:text-base font-medium",children:a.mascot})]})}),(0,v.jsx)("p",{className:"text-gray-600 mb-6 leading-relaxed text-sm md:text-base",children:a.description}),(0,v.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-8 p-4 bg-blue-50 rounded-xl border border-blue-100",children:[(0,v.jsx)(m,{className:"w-6 h-6 text-blue-600"}),(0,v.jsx)("span",{className:"text-sm text-gray-600 font-bold",children:a.consent})]}),(0,v.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,v.jsx)("button",{onClick:t,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-blue-500/30 active:scale-95",children:a.accept}),(0,v.jsx)("button",{onClick:n,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-gray-400/30 active:scale-95",children:a.decline})]}),(0,v.jsxs)("div",{className:"mt-8 text-[10px] text-gray-400 border-t border-gray-100 pt-4",children:[(0,v.jsx)("p",{className:"font-bold uppercase tracking-widest mb-2",children:a.privacy}),"\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32 \u0e40\u0e0a\u0e35\u0e22\u0e07\u0e43\u0e2b\u0e21\u0e48 ",(0,v.jsx)("br",{}),"Lanna Polytechnic Chiangmai Technological College"]})]})]})})},b=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,a=o?e[i+1]:0,s=i+2<e.length,u=s?e[i+2]:0,l=t>>2,c=(3&t)<<4|a>>4;let h=(15&a)<<2|u>>6,d=63&u;s||(d=64,o||(h=64)),r.push(n[l],n[c],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(b(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const s=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==a||null==s)throw new w;const u=t<<2|o>>4;if(r.push(u),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==s){const e=a<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class w extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E=function(e){return function(e){const t=b(e);return x.encodeByteArray(t,!0)}(e).replace(/\./g,"")},_=function(e){try{return x.decodeString(e,!0)}catch(Fd){console.error("base64Decode failed: ",Fd)}return null};const S=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,k=()=>{try{return S()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Fd){return}const t=e&&_(e[1]);return t&&JSON.parse(t)})()}catch(Fd){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(Fd))}},C=e=>{const t=(e=>{var t,n;return null===(n=null===(t=k())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},I=()=>{var e;return null===(e=k())||void 0===e?void 0:e.config};class T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function A(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[E(JSON.stringify({alg:"none",type:"JWT"})),E(JSON.stringify(o)),""].join(".")}function O(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function N(){return!function(){var e;const t=null===(e=k())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Fd){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function P(){try{return"object"===typeof indexedDB}catch(Fd){return!1}}function D(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class R extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,R.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,M.prototype.create)}}class M{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(j,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",o="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new R(n,o,t)}}const j=/\{\$([^}]+)}/g;function F(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(L(n)&&L(o)){if(!F(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function L(e){return null!==e&&"object"===typeof e}function B(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function z(e){return e&&e._delegate?e._delegate:e}class U{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const V="[DEFAULT]";class W{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new T;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Fd){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Fd){if(r)return null;throw Fd}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:V})}catch(Fd){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Fd){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(by){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===V?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(by){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return this.component?this.component.multipleInstances?e:V:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class H{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new W(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const q=[];var G;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(G||(G={}));const K={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},X=G.INFO,Y={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},Q=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Y[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...o)};class ${constructor(e){this.name=e,this._logLevel=X,this._logHandler=Q,this._userLogHandler=null,q.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?K[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...t),this._logHandler(this,G.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...t),this._logHandler(this,G.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,G.INFO,...t),this._logHandler(this,G.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,G.WARN,...t),this._logHandler(this,G.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,G.ERROR,...t),this._logHandler(this,G.ERROR,...t)}}let Z,J;const ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap,ie=new WeakMap;let oe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return te.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ne.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ue(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ae(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(J||(J=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(le(this),n),ue(ee.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ue(e.apply(le(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(le(this),t,...r);return ne.set(o,t.sort?t.sort():[t]),ue(o)}}function se(e){return"function"===typeof e?ae(e):(e instanceof IDBTransaction&&function(e){if(te.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});te.set(e,t)}(e),((e,t)=>t.some(t=>e instanceof t))(e,Z||(Z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,oe):e)}function ue(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(ue(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&ee.set(t,e)}).catch(()=>{}),ie.set(t,e),t}(e);if(re.has(e))return re.get(e);const t=se(e);return t!==e&&(re.set(e,t),ie.set(t,e)),t}const le=e=>ie.get(e);function ce(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),s=ue(a);return r&&a.addEventListener("upgradeneeded",e=>{r(ue(a.result),e.oldVersion,e.newVersion,ue(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}const he=["get","getKey","getAll","getAllKeys","count"],de=["put","add","delete","clear"],fe=new Map;function pe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(fe.get(t))return fe.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=de.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!he.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var a=arguments.length,s=new Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=arguments[u];return r&&(o=o.index(s.shift())),(await Promise.all([o[n](...s),i&&t.done]))[0]};return fe.set(t,o),o}oe=(e=>l(l({},e),{},{get:(t,n,r)=>pe(t,n)||e.get(t,n,r),has:(t,n)=>!!pe(t,n)||e.has(t,n)}))(oe);class me{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const ge="@firebase/app",ve="0.10.13",ye=new $("@firebase/app"),be="@firebase/app-compat",xe="@firebase/analytics-compat",we="@firebase/analytics",Ee="@firebase/app-check-compat",_e="@firebase/app-check",Se="@firebase/auth",ke="@firebase/auth-compat",Ce="@firebase/database",Ie="@firebase/data-connect",Te="@firebase/database-compat",Ae="@firebase/functions",Oe="@firebase/functions-compat",Ne="@firebase/installations",Pe="@firebase/installations-compat",De="@firebase/messaging",Re="@firebase/messaging-compat",Me="@firebase/performance",je="@firebase/performance-compat",Fe="@firebase/remote-config",Le="@firebase/remote-config-compat",Be="@firebase/storage",ze="@firebase/storage-compat",Ue="@firebase/firestore",Ve="@firebase/vertexai-preview",We="@firebase/firestore-compat",He="firebase",qe="[DEFAULT]",Ge={[ge]:"fire-core",[be]:"fire-core-compat",[we]:"fire-analytics",[xe]:"fire-analytics-compat",[_e]:"fire-app-check",[Ee]:"fire-app-check-compat",[Se]:"fire-auth",[ke]:"fire-auth-compat",[Ce]:"fire-rtdb",[Ie]:"fire-data-connect",[Te]:"fire-rtdb-compat",[Ae]:"fire-fn",[Oe]:"fire-fn-compat",[Ne]:"fire-iid",[Pe]:"fire-iid-compat",[De]:"fire-fcm",[Re]:"fire-fcm-compat",[Me]:"fire-perf",[je]:"fire-perf-compat",[Fe]:"fire-rc",[Le]:"fire-rc-compat",[Be]:"fire-gcs",[ze]:"fire-gcs-compat",[Ue]:"fire-fst",[We]:"fire-fst-compat",[Ve]:"fire-vertex","fire-js":"fire-js",[He]:"fire-js-all"},Ke=new Map,Xe=new Map,Ye=new Map;function Qe(e,t){try{e.container.addComponent(t)}catch(Fd){ye.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),Fd)}}function $e(e){const t=e.name;if(Ye.has(t))return ye.debug("There were multiple attempts to register component ".concat(t,".")),!1;Ye.set(t,e);for(const n of Ke.values())Qe(n,e);for(const n of Xe.values())Qe(n,e);return!0}function Ze(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Je=new M("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class et{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new U("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Je.create("app-deleted",{appName:this._name})}}const tt="10.14.1";function nt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:qe,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw Je.create("bad-app-name",{appName:String(i)});if(n||(n=I()),!n)throw Je.create("no-options");const o=Ke.get(i);if(o){if(F(n,o.options)&&F(r,o.config))return o;throw Je.create("duplicate-app",{appName:i})}const a=new H(i);for(const u of Ye.values())a.addComponent(u);const s=new et(n,r,a);return Ke.set(i,s),s}function rt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe;const t=Ke.get(e);if(!t&&e===qe&&I())return nt();if(!t)throw Je.create("no-app",{appName:e});return t}function it(e,t,n){var r;let i=null!==(r=Ge[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ye.warn(e.join(" "))}$e(new U("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const ot="firebase-heartbeat-store";let at=null;function st(){return at||(at=ce("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ot)}catch(Fd){console.warn(Fd)}}}).catch(e=>{throw Je.create("idb-open",{originalErrorMessage:e.message})})),at}async function ut(e,t){try{const n=(await st()).transaction(ot,"readwrite"),r=n.objectStore(ot);await r.put(t,lt(e)),await n.done}catch(Fd){if(Fd instanceof R)ye.warn(Fd.message);else{const t=Je.create("idb-set",{originalErrorMessage:null===Fd||void 0===Fd?void 0:Fd.message});ye.warn(t.message)}}}function lt(e){return"".concat(e.name,"!").concat(e.options.appId)}class ct{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ht();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(Fd){ye.warn(Fd)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ht(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),ft(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ft(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=E(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(Fd){return ye.warn(Fd),""}}}function ht(){return(new Date).toISOString().substring(0,10)}class dt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!P()&&D().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await st()).transaction(ot),n=await t.objectStore(ot).get(lt(e));return await t.done,n}catch(Fd){if(Fd instanceof R)ye.warn(Fd.message);else{const t=Je.create("idb-get",{originalErrorMessage:null===Fd||void 0===Fd?void 0:Fd.message});ye.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ft(e){return E(JSON.stringify({version:2,heartbeats:e})).length}var pt;pt="",$e(new U("platform-logger",e=>new me(e),"PRIVATE")),$e(new U("heartbeat",e=>new ct(e),"PRIVATE")),it(ge,ve,pt),it(ge,ve,"esm2017"),it("fire-js","");var mt,gt,vt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},yt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var o=e.g[3],a=t+(o^n&(i^o))+r[0]+3614090360&4294967295;a=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=n+(a<<7&4294967295|a>>>25))+((a=o+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(o^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(o^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(o^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(o^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(o^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^t&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(o^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^t&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(o^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^t&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(o^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^t&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=o+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=o+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=o+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=o+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((o=(t=n+((a=t+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=o+((a=i+(t^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,o=this.h,a=0;a<t;){if(0==o)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[o++]=e.charCodeAt(a++),o==this.blockSize){n(this,i),o=0;break}}else for(;a<t;)if(i[o++]=e[a++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function o(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return s;if(0>e)return d(a(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var s=o(0),u=o(1),l=o(16777216);function c(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(u)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(c(t))throw Error("division by zero");if(c(e))return new m(s,s);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=u,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),o=y(r,1);for(r=y(r,2),n=y(n,2);!c(r);){var l=o.add(r);0>=l.l(e)&&(i=i.add(n),o=l),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=s;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),l=(o=a(n)).j(t);h(l)||0<l.l(e);)l=(o=a(n-=r)).j(t);c(o)&&(o=u),i=i.add(o),e=f(e,l)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,o=[],a=0;a<i;a++)o[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(o,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(c(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,o=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(c(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:c(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,o=0;o<=t;o++){var a=i+(65535&this.i(o))+(65535&e.i(o)),s=(a>>>16)+(this.i(o)>>>16)+(e.i(o)>>>16);i=s>>>16,a&=65535,s&=65535,n[o]=s<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(c(this)||c(e))return s;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(l)&&0>e.l(l))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<e.g.length;o++){var u=this.i(i)>>>16,f=65535&this.i(i),m=e.i(o)>>>16,g=65535&e.i(o);n[2*i+2*o]+=f*g,p(n,2*i+2*o),n[2*i+2*o+1]+=u*g,p(n,2*i+2*o+1),n[2*i+2*o+1]+=f*m,p(n,2*i+2*o+1),n[2*i+2*o+2]+=u*m,p(n,2*i+2*o+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,gt=yt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),i=s,o=0;o<t.length;o+=8){var u=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+u),n);8>u?(u=a(Math.pow(n,u)),i=i.j(u).add(a(l))):i=(i=i.j(r)).add(a(l))}return i},mt=yt.Integer=r}).apply("undefined"!==typeof vt?vt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var bt,xt,wt,Et,_t,St,kt,Ct,It="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Tt={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof It&&It];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in i))break e;i=i[a]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function o(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function u(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function l(e,t,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:u).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(o(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function _(e){i.setTimeout(()=>{throw e},0)}function S(){var e=A;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new C,e=>e.reset());class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let I,T=!1,A=new class{constructor(){this.h=this.g=null}add(e,t){const n=k.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},O=()=>{const e=i.Promise.resolve(void 0);I=()=>{e.then(N)}};var N=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(Hd){_(Hd)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}T=!1};function P(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(Hd){}return e}();function M(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(Gd){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:j[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&M.aa.h.call(this)}}h(M,D);var j={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),L=0;function B(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++L,this.da=this.fa=!1}function z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e){this.src=e,this.g={},this.h=0}function V(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function W(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}U.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var a=W(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new B(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),q={};function G(e,t,n,r,i){if(r&&r.once)return X(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)G(e,t[o],n,r,i);return null}return n=te(n),e&&e[F]?e.K(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=a(i)?!!i.capture:!!i,u=J(e);if(u||(e[H]=u=new U(e)),(n=u.add(t,n,r,s,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Z;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)R||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent($(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function X(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)X(e,t[o],n,r,i);return null}return n=te(n),e&&e[F]?e.L(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Y(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)Y(e,t[o],n,r,i);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=W(o=e.g[t],n,r,i))&&(z(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=J(e))&&(t=e.g[t.toString()],e=-1,t&&(e=W(t,n,r,i)),(n=-1<e?t[e]:null)&&Q(n))}function Q(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])V(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent($(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=J(t))?(V(n,e),0==n.h&&(n.src=null,t[H]=null)):z(e)}}}function $(e){return e in q?q[e]:q[e]="on"+e}function Z(e,t){if(e.da)e=!0;else{t=new M(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Q(e),e=n.call(r,t)}return e}function J(e){return(e=e[H])instanceof U?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){P.call(this),this.i=new U(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;w(t=new D(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=t.g=n[o];i=ie(a,r,!0,t)&&i}if(i=ie(a=t.g=e,r,!0,t)&&i,i=ie(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=ie(a=t.g=n[o],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.da&&a.capture==n){var s=a.listener,u=a.ha||a.src;a.fa&&V(e.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function oe(e,t,n){if("function"===typeof e)n&&(e=l(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ae(e){e.g=oe(()=>{e.g=null,e.i&&(e.i=!1,ae(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,P),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Y(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)z(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class se extends P{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ue(e){P.call(this),this.h=e,this.g={}}h(ue,P);var le=[];function ce(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&Q(e)},e),e.g={}}ue.prototype.N=function(){ue.aa.N.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}h(ye,D),h(be,D);var xe={},we=null;function Ee(){return we=we||new ne}function _e(e){D.call(this,xe.La,e)}function Se(e){const t=Ee();re(t,new _e(t))}function ke(e,t){D.call(this,xe.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Ee();re(t,new ke(t,e))}function Ie(e,t){D.call(this,xe.Ma,e),this.size=t}function Te(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Ae(){this.g=!0}function Oe(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return he(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}xe.La="serverreachability",h(_e,D),xe.STAT_EVENT="statevent",h(ke,D),xe.Ma="timingevent",h(Ie,D),Ae.prototype.xa=function(){this.g=!1},Ae.prototype.info=function(){};var Ne,Pe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Re(){}function Me(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ue(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}h(Re,pe),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},Ne=new Re;var Fe={},Le={};function Be(e,t,n){e.L=1,e.v=ht(at(t)),e.m=n,e.P=!0,ze(e,null)}function ze(e,t){e.F=Date.now(),We(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),jt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new je,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new se(l(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(le[0]=i.toString()),i=le);for(var o=0;o<i.length;o++){var a=G(n,i[o],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var l=s[u].split("=");if(1<l.length){var c=l[0];l=l[1];var h=c.split("_");a=2<=h.length&&"type"==h[1]?a+(c+"=")+l+"&":a+(c+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ue(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ve(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Le:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?Le:(t=t.slice(r,r+n),e.C=r+n,t))}function We(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Te(l(e.ba,e),t)}function qe(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||bn(e.j,e)}function Ke(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ce(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Xe(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Je(n.h,e)))if(!e.K&&Je(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(qd){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;yn(n),un(n)}mn(n),Ce(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Te(l(n.Za,n),6e3));if(1>=Ze(n.h)&&n.ca){try{n.ca()}catch(qd){}n.ca=void 0}}else wn(n,11)}else if((e.K||n.g==e)&&yn(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const t=l[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=l[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const c=l[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=r.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(et(o,o.h),o.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ct(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=_n(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var s=a,u=r.L;u&&(s.I=u),s.B&&(qe(s),We(s)),r.g=a}else pn(r);0<n.i.length&&cn(n)}else"stop"!=l[0]&&"close"!=l[0]||wn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?wn(n,7):sn(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Se()}catch(qd){}}Me.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nn(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const d=nn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||rn(this.g)))){this.J||4!=d||7==t||Se(),qe(this);var n=this.g.Z();this.X=n;t:if(Ue(this)){var r=rn(this.g);e="";var o=r.length,a=4==nn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),Ge(this);var s="";break t}this.h.i=new i.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==o-1)});r.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,o,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(u)){var c=u;break t}}c=null}if(!(n=c)){this.o=!1,this.s=3,Ce(12),Ke(this),Ge(this);break e}Oe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xe(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;){if(e=Ve(this,s),e==Le){4==d&&(this.s=4,Ce(14),n=!1),Oe(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,Ce(15),Oe(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}Oe(this.i,this.l,e,null),Xe(this,e)}if(Ue(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=s.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),gn(h),h.M=!0,Ce(11))}}else Oe(this.i,this.l,s,"[Invalid Chunked Response]"),Ke(this),Ge(this)}else Oe(this.i,this.l,s,null),Xe(this,s);4==d&&Ke(this),this.o&&!this.J&&(4==d?bn(this.j,this):(this.o=!1,We(this)))}else(function(e){const t={};e=(e.g&&2<=nn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=E(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ke(this),Ge(this)}}}catch(At){}},Me.prototype.cancel=function(){this.J=!0,Ke(this)},Me.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Se(),Ce(17)),Ke(this),this.s=2,Ge(this)):He(this,this.S-e)};var Ye=class{constructor(e,t){this.g=e,this.map=t}};function Qe(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $e(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ze(e){return e.h?1:e.g?e.g.size:0}function Je(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(o(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(o(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(o(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}Qe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ot(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ot){this.h=e.h,st(this,e.j),this.o=e.o,this.g=e.g,ut(this,e.s),this.l=e.l;var t=e.i,n=new Nt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),lt(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,st(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),ut(this,t[4]),this.l=dt(t[5]||"",!0),lt(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new Nt(null,this.h))}function at(e){return new ot(e)}function st(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ut(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function lt(e,t,n){t instanceof Nt?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Rt(this,t),jt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,yt)),e.i=new Nt(t,e.h))}function ct(e,t,n){e.i.set(t,n)}function ht(e){return ct(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ot.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,mt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,mt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:gt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,Ot)),e.join("")};var mt=/[#\/\?@]/g,gt=/[#\?:]/g,vt=/[#\?]/g,yt=/[#\?@]/g,Ot=/#/g;function Nt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Rt(e,t){Dt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Mt(e,t){return Dt(e),t=Ft(e,t),e.g.has(t)}function jt(e,t,n){Rt(e,t),0<n.length&&(e.i=null,e.g.set(Ft(e,t),d(n)),e.h+=n.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Lt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(Gd){}}function Bt(){this.g=new fe}function zt(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;a(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(Fd){throw t.push(r+"type="+encodeURIComponent("_badmap")),Fd}}function Ut(e){this.l=e.Ub||null,this.j=e.eb||!1}function Vt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Wt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ht(e){e.readyState=4,e.l=null,e.j=null,e.v=null,qt(e)}function qt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Gt(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Gt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ct(e,t,n))}function Xt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Nt.prototype).add=function(e,t){Dt(this),this.i=null,e=Ft(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Mt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Dt(this),this.i=null,Mt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const o=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var i=o;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")},h(Ut,pe),Ut.prototype.g=function(){return new Vt(this.l,this.j)},Ut.prototype.i=function(e){return function(){return e}}({}),h(Vt,ne),(e=Vt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,qt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ht(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,qt(this)),this.g&&(this.readyState=3,qt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ht(this):qt(this),3==this.readyState&&Wt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ht(this))},e.Qa=function(e){this.g&&(this.response=e,Ht(this))},e.ga=function(){this.g&&Ht(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Vt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Xt,ne);var Yt=/^https?$/i,Qt=["POST","PUT"];function $t(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),en(e)}function Zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Jt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=nn(e)||2!=e.Z()))if(e.u&&4==nn(e))oe(e.Ea,0,e);else if(re(e,"readystatechange"),4==nn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var o;if(o=0===r){var a=String(e.D).match(it)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),o=!Yt.test(a?a.toLowerCase():"")}n=o}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var s=2<nn(e)?e.g.statusText:""}catch(u){s=""}e.l=s+" ["+e.Z()+"]",Zt(e)}}finally{en(e)}}}function en(e,t){if(e.g){tn(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(Fd){}}}function tn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function nn(e){return e.g?e.g.readyState:0}function rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Pt){return null}}function on(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function an(e){this.Aa=0,this.i=[],this.j=new Ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=on("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=on("baseRetryDelayMs",5e3,e),this.cb=on("retryDelaySeedMs",1e4,e),this.Wa=on("forwardChannelMaxRetries",2,e),this.wa=on("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Qe(e&&e.concurrentRequestLimit),this.Da=new Bt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function sn(e){if(ln(e),3==e.G){var t=e.U++,n=at(e.I);if(ct(n,"SID",e.K),ct(n,"RID",t),ct(n,"TYPE","terminate"),dn(e,n),(t=new Me(e,e.j,t)).L=2,t.v=ht(at(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(Kd){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),We(t)}En(e)}function un(e){e.g&&(gn(e),e.g.cancel(),e.g=null)}function ln(e){un(e),e.u&&(i.clearTimeout(e.u),e.u=null),yn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function cn(e){if(!$e(e.h)&&!e.s){e.s=!0;var t=e.Ga;I||O(),T||(I(),T=!0),A.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ct(r,"SID",e.K),ct(r,"RID",n),ct(r,"AID",e.T),dn(e,r),e.m&&e.o&&Kt(r,e.m,e.o),n=new Me(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Be(n,r,t)}function dn(e,t){e.H&&y(e.H,function(e,n){ct(t,n,e)}),e.l&&rt({},function(e,n){ct(t,n,e)})}function fn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?l(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const s=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{zt(s,e,"req"+n+"_")}catch(At){r&&r(s)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function pn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;I||O(),T||(I(),T=!0),A.add(t,e),e.v=0}}function mn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Te(l(e.Fa,e),xn(e,e.v)),e.v++,!0)}function gn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ct(t,"RID","rpc"),ct(t,"SID",e.K),ct(t,"AID",e.T),ct(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ct(t,"TO",e.ja),ct(t,"TYPE","xmlhttp"),dn(e,t),e.m&&e.o&&Kt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(at(t)),n.m=null,n.P=!0,ze(n,e)}function yn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){yn(e),gn(e),e.g=null;var r=2}else{if(!Je(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ee(),new Ie(r,n)),cn(e)}else pn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Ze(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Te(l(e.Ga,e,t),xn(e,e.B)),e.B++,!0))}(e,t)||2==r&&mn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:wn(e,5);break;case 4:wn(e,10);break;case 3:wn(e,6);break;default:wn(e,2)}}function xn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function wn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.fb,e),r=e.Xa;const t=!r;r=new ot(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||st(r,"https"),ht(r),t?function(e,t){const n=new Ae;if(i.Image){const r=new Image;r.onload=c(Lt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(Lt,n,"TestLoadImage: error",!1,t,r),r.onabort=c(Lt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(Lt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ae;const n=new AbortController,r=setTimeout(()=>{n.abort(),Lt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Lt(0,0,!0,t):Lt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Lt(0,0,!1,t)})}(r.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),En(e),ln(e)}function En(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function _n(e,t,n){var r=n instanceof ot?at(n):new ot(n);if(""!=r.g)t&&(r.g=t+"."+r.g),ut(r,r.s);else{var o=i.location;r=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var a=new ot(null);r&&st(a,r),t&&(a.g=t),o&&ut(a,o),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ct(r,n,t),ct(r,"VER",e.la),dn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Xt(new Ut({eb:n})):new Xt(e.pa)).Ha(e.J),t}function kn(){}function Cn(){}function In(e,t){ne.call(this),this.g=new an(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new On(this)}function Tn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){be.call(this),this.status=1}function On(e){this.g=e}(e=Xt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ne.g(),this.v=this.o?me(this.o):me(Ne),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(Gd){return void $t(this,Gd)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var o in r)n.set(o,r[o]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),o=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Qt,t,void 0))||r||o||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(e),this.u=!1}catch(Gd){$t(this,Gd)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),en(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),Xt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Jt(this):this.bb())},e.bb=function(){Jt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=an.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ce(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=_n(this,null,this.W),cn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Me(this,this.j,e);let o=this.o;if(this.S&&(o?(o=b(o),w(o,this.S)):o=this.S),null!==this.m||this.O||(i.H=o,o=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=fn(this,i,t),ct(n=at(this.I),"RID",e),ct(n,"CVER",22),this.D&&ct(n,"X-HTTP-Session-Id",this.D),dn(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(Gt(o)))+"&"+t:this.m&&Kt(n,this.m,o)),et(this.h,i),this.Ua&&ct(n,"TYPE","init"),this.P?(ct(n,"$req",t),ct(n,"SID","null"),i.T=!0,Be(i,n,null)):Be(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||$e(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Te(l(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),un(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,un(this),mn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=kn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Cn.prototype.g=function(e,t){return new In(e,t)},h(In,ne),In.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){sn(this.g)},In.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Ye(t.Ya++,e)),3==t.G&&cn(t)},In.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,In.aa.N.call(this)},h(Tn,ye),h(An,be),h(On,kn),On.prototype.ua=function(){re(this.g,"a")},On.prototype.ta=function(e){re(this.g,new Tn(e))},On.prototype.sa=function(e){re(this.g,new An)},On.prototype.ra=function(){re(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,Ct=Tt.createWebChannelTransport=function(){return new Cn},kt=Tt.getStatEventTarget=function(){return Ee()},St=Tt.Event=xe,_t=Tt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pe.NO_ERROR=0,Pe.TIMEOUT=8,Pe.HTTP_ERROR=6,Et=Tt.ErrorCode=Pe,De.COMPLETE="complete",wt=Tt.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,xt=Tt.WebChannel=ge,Tt.FetchXmlHttpFactory=Ut,Xt.prototype.listenOnce=Xt.prototype.L,Xt.prototype.getLastError=Xt.prototype.Ka,Xt.prototype.getLastErrorCode=Xt.prototype.Ba,Xt.prototype.getStatus=Xt.prototype.Z,Xt.prototype.getResponseJson=Xt.prototype.Oa,Xt.prototype.getResponseText=Xt.prototype.oa,Xt.prototype.send=Xt.prototype.ea,Xt.prototype.setWithCredentials=Xt.prototype.Ha,bt=Tt.XhrIo=Xt}).apply("undefined"!==typeof It?It:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const At="@firebase/firestore";class Ot{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");let Nt="10.14.0";const Pt=new $("@firebase/firestore");function Dt(){return Pt.logLevel}function Rt(e){if(Pt.logLevel<=G.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ft);Pt.debug("Firestore (".concat(Nt,"): ").concat(e),...i)}}function Mt(e){if(Pt.logLevel<=G.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ft);Pt.error("Firestore (".concat(Nt,"): ").concat(e),...i)}}function jt(e){if(Pt.logLevel<=G.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ft);Pt.warn("Firestore (".concat(Nt,"): ").concat(e),...i)}}function Ft(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(jd){return e}}function Lt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(Nt,") INTERNAL ASSERTION FAILED: ")+e;throw Mt(t),new Error(t)}function Bt(e,t){e||Lt()}function zt(e,t){return e}const Ut={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vt extends R{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Wt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ht{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class qt{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ot.UNAUTHENTICATED))}shutdown(){}}class Gt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Kt{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Bt(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Wt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Wt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{Rt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(Rt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Wt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Rt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Bt("string"==typeof t.accessToken),new Ht(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Bt(null===e||"string"==typeof e),new Ot(e)}}class Xt{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Yt{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Xt(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qt{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $t{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Bt(void 0===this.o);const n=e=>{null!=e.error&&Rt("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,Rt("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Rt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Rt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Bt("string"==typeof e.token),this.R=e.token,new Qt(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Zt(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Jt{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Zt(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function en(e,t){return e<t?-1:e>t?1:0}function tn(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class nn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Vt(Ut.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Vt(Ut.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Vt(Ut.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Vt(Ut.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return nn.fromMillis(Date.now())}static fromDate(e){return nn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new nn(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class rn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new rn(e)}static min(){return new rn(new nn(0,0))}static max(){return new rn(new nn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class on{constructor(e,t,n){void 0===t?t=0:t>e.length&&Lt(),void 0===n?n=e.length-t:n>e.length-t&&Lt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===on.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof on?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class an extends on{construct(e,t,n){return new an(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new an(e)}static emptyPath(){return new an([])}}const sn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends on{construct(e,t,n){return new un(e,t,n)}static isValidIdentifier(e){return sn.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new un(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Vt(Ut.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Vt(Ut.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new Vt(Ut.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(t)}static emptyPath(){return new un([])}}class ln{constructor(e){this.path=e}static fromPath(e){return new ln(an.fromString(e))}static fromName(e){return new ln(an.fromString(e).popFirst(5))}static empty(){return new ln(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===an.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return an.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ln(new an(e.slice()))}}class cn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}cn.UNKNOWN_ID=-1;function hn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=rn.fromTimestamp(1e9===r?new nn(n+1,0):new nn(n,r));return new fn(i,ln.empty(),t)}function dn(e){return new fn(e.readTime,e.key,-1)}class fn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new fn(rn.min(),ln.empty(),-1)}static max(){return new fn(rn.max(),ln.empty(),-1)}}function pn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ln.comparator(e.documentKey,t.documentKey),0!==n?n:en(e.largestBatchId,t.largestBatchId))}const mn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function vn(e){if(e.code!==Ut.FAILED_PRECONDITION||e.message!==mn)throw e;Rt("LocalStore","Unexpectedly lost primary lease")}class yn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new yn((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof yn?t:yn.resolve(t)}catch(e){return yn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):yn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):yn.reject(t)}static resolve(e){return new yn((t,n)=>{t(e)})}static reject(e){return new yn((t,n)=>{n(e)})}static waitFor(e){return new yn((t,n)=>{let r=0,i=0,o=!1;e.forEach(e=>{++r,e.next(()=>{++i,o&&i===r&&t()},e=>n(e))}),o=!0,i===r&&t()})}static or(e){let t=yn.resolve(!1);for(const n of e)t=t.next(e=>e?yn.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new yn((n,r)=>{const i=e.length,o=new Array(i);let a=0;for(let s=0;s<i;s++){const u=s;t(e[u]).next(e=>{o[u]=e,++a,a===i&&n(o)},e=>r(e))}})}static doWhile(e,t){return new yn((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function bn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xn(e){return"IndexedDbTransactionError"===e.name}class wn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function En(e){return null==e}function _n(e){return 0===e&&1/e==-1/0}function Sn(e){return"number"==typeof e&&Number.isInteger(e)&&!_n(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}wn.oe=-1;const kn=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Cn=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],In=Cn,Tn=[...In,"indexConfiguration","indexState","indexEntries"];function An(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function On(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Nn(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Pn{constructor(e,t){this.comparator=e,this.root=t||Rn.EMPTY}insert(e,t){return new Pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rn.BLACK,null,null))}remove(e){return new Pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dn(this.root,e,this.comparator,!0)}}class Dn{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rn{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Rn.RED,this.left=null!=r?r:Rn.EMPTY,this.right=null!=i?i:Rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Rn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Rn.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Lt();if(this.right.isRed())throw Lt();const e=this.left.check();if(e!==this.right.check())throw Lt();return e+(this.isRed()?0:1)}}Rn.EMPTY=null,Rn.RED=!0,Rn.BLACK=!1,Rn.EMPTY=new class{constructor(){this.size=0}get key(){throw Lt()}get value(){throw Lt()}get color(){throw Lt()}get left(){throw Lt()}get right(){throw Lt()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Mn{constructor(e){this.comparator=e,this.data=new Pn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jn(this.data.getIterator())}getIteratorFrom(e){return new jn(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Mn))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Mn(this.comparator);return t.data=e,t}}class jn{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Fn{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new Fn([])}unionWith(e){let t=new Mn(un.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tn(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ln extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Bn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ln("Invalid base64 string: "+e):e}}(e);return new Bn(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Bn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bn.EMPTY_BYTE_STRING=new Bn("");const zn=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Un(e){if(Bt(!!e),"string"==typeof e){let t=0;const n=zn.exec(e);if(Bt(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Vn(e.seconds),nanos:Vn(e.nanos)}}function Vn(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Wn(e){return"string"==typeof e?Bn.fromBase64String(e):Bn.fromUint8Array(e)}function Hn(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function qn(e){const t=e.mapValue.fields.__previous_value__;return Hn(t)?qn(t):t}function Gn(e){const t=Un(e.mapValue.fields.__local_write_time__.timestampValue);return new nn(t.seconds,t.nanos)}class Kn{constructor(e,t,n,r,i,o,a,s,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=s,this.useFetchStreams=u}}class Xn{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Xn("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Xn&&e.projectId===this.projectId&&e.database===this.database}}const Yn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Hn(e)?4:dr(e)?9007199254740991:cr(e)?10:11:Lt()}function $n(e,t){if(e===t)return!0;const n=Qn(e);if(n!==Qn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Gn(e).isEqual(Gn(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Un(e.timestampValue),r=Un(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Wn(e.bytesValue).isEqual(Wn(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Vn(e.geoPointValue.latitude)===Vn(t.geoPointValue.latitude)&&Vn(e.geoPointValue.longitude)===Vn(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Vn(e.integerValue)===Vn(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Vn(e.doubleValue),r=Vn(t.doubleValue);return n===r?_n(n)===_n(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return tn(e.arrayValue.values||[],t.arrayValue.values||[],$n);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(An(n)!==An(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!$n(n[i],r[i])))return!1;return!0}(e,t);default:return Lt()}}function Zn(e,t){return void 0!==(e.values||[]).find(e=>$n(e,t))}function Jn(e,t){if(e===t)return 0;const n=Qn(e),r=Qn(t);if(n!==r)return en(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return en(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Vn(e.integerValue||e.doubleValue),r=Vn(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return er(e.timestampValue,t.timestampValue);case 4:return er(Gn(e),Gn(t));case 5:return en(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Wn(e),r=Wn(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=en(n[i],r[i]);if(0!==e)return e}return en(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=en(Vn(e.latitude),Vn(t.latitude));return 0!==n?n:en(Vn(e.longitude),Vn(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return tr(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const a=e.fields||{},s=t.fields||{},u=null===(n=a.value)||void 0===n?void 0:n.arrayValue,l=null===(r=s.value)||void 0===r?void 0:r.arrayValue,c=en((null===(i=null==u?void 0:u.values)||void 0===i?void 0:i.length)||0,(null===(o=null==l?void 0:l.values)||void 0===o?void 0:o.length)||0);return 0!==c?c:tr(u,l)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Yn.mapValue&&t===Yn.mapValue)return 0;if(e===Yn.mapValue)return 1;if(t===Yn.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let a=0;a<r.length&&a<o.length;++a){const e=en(r[a],o[a]);if(0!==e)return e;const t=Jn(n[r[a]],i[o[a]]);if(0!==t)return t}return en(r.length,o.length)}(e.mapValue,t.mapValue);default:throw Lt()}}function er(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return en(e,t);const n=Un(e),r=Un(t),i=en(n.seconds,r.seconds);return 0!==i?i:en(n.nanos,r.nanos)}function tr(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Jn(n[i],r[i]);if(e)return e}return en(n.length,r.length)}function nr(e){return rr(e)}function rr(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Un(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Wn(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ln.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=rr(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(rr(e.fields[i]));return n+"}"}(e.mapValue):Lt()}function ir(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function or(e){return!!e&&"integerValue"in e}function ar(e){return!!e&&"arrayValue"in e}function sr(e){return!!e&&"nullValue"in e}function ur(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function lr(e){return!!e&&"mapValue"in e}function cr(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function hr(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return On(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=hr(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=hr(e.arrayValue.values[n]);return t}return Object.assign({},e)}function dr(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class fr{constructor(e){this.value=e}static empty(){return new fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!lr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hr(t)}setAll(e){let t=un.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=hr(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());lr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $n(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];lr(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){On(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new fr(hr(this.value))}}function pr(e){const t=[];return On(e.fields,(e,n)=>{const r=new un([e]);if(lr(n)){const e=pr(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Fn(t)}class mr{constructor(e,t,n,r,i,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new mr(e,0,rn.min(),rn.min(),rn.min(),fr.empty(),0)}static newFoundDocument(e,t,n,r){return new mr(e,1,t,rn.min(),n,r,0)}static newNoDocument(e,t){return new mr(e,2,t,rn.min(),rn.min(),fr.empty(),0)}static newUnknownDocument(e,t){return new mr(e,3,t,rn.min(),rn.min(),fr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(rn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class gr{constructor(e,t){this.position=e,this.inclusive=t}}function vr(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],a=e.position[i];if(r=o.field.isKeyField()?ln.comparator(ln.fromName(a.referenceValue),n.key):Jn(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function yr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!$n(e.position[n],t.position[n]))return!1;return!0}class br{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function xr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class wr{}class Er extends wr{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Or(e,t,n):"array-contains"===t?new Rr(e,n):"in"===t?new Mr(e,n):"not-in"===t?new jr(e,n):"array-contains-any"===t?new Fr(e,n):new Er(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Nr(e,n):new Pr(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Jn(t,this.value)):null!==t&&Qn(this.value)===Qn(t)&&this.matchesComparison(Jn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Lt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _r extends wr{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new _r(e,t)}matches(e){return Sr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Sr(e){return"and"===e.op}function kr(e){return Cr(e)&&Sr(e)}function Cr(e){for(const t of e.filters)if(t instanceof _r)return!1;return!0}function Ir(e){if(e instanceof Er)return e.field.canonicalString()+e.op.toString()+nr(e.value);if(kr(e))return e.filters.map(e=>Ir(e)).join(",");{const t=e.filters.map(e=>Ir(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Tr(e,t){return e instanceof Er?function(e,t){return t instanceof Er&&e.op===t.op&&e.field.isEqual(t.field)&&$n(e.value,t.value)}(e,t):e instanceof _r?function(e,t){return t instanceof _r&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Tr(n,t.filters[r]),!0)}(e,t):void Lt()}function Ar(e){return e instanceof Er?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(nr(e.value))}(e):e instanceof _r?function(e){return e.op.toString()+" {"+e.getFilters().map(Ar).join(" ,")+"}"}(e):"Filter"}class Or extends Er{constructor(e,t,n){super(e,t,n),this.key=ln.fromName(n.referenceValue)}matches(e){const t=ln.comparator(e.key,this.key);return this.matchesComparison(t)}}class Nr extends Er{constructor(e,t){super(e,"in",t),this.keys=Dr("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Pr extends Er{constructor(e,t){super(e,"not-in",t),this.keys=Dr("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Dr(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ln.fromName(e.referenceValue))}class Rr extends Er{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ar(t)&&Zn(t.arrayValue,this.value)}}class Mr extends Er{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Zn(this.value.arrayValue,t)}}class jr extends Er{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Zn(this.value.arrayValue,t)}}class Fr extends Er{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ar(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Zn(this.value.arrayValue,e))}}class Lr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Br(e){return new Lr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function zr(e){const t=zt(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Ir(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),En(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>nr(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>nr(e)).join(",")),t.ue=e}return t.ue}function Ur(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!xr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Tr(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!yr(e.startAt,t.startAt)&&yr(e.endAt,t.endAt)}function Vr(e){return ln.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Wr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Hr(e,t,n,r,i,o,a,s){return new Wr(e,t,n,r,i,o,a,s)}function qr(e){return new Wr(e)}function Gr(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Kr(e){return null!==e.collectionGroup}function Xr(e){const t=zt(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Mn(un.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new br(r,n))}),e.has(un.keyField().canonicalString())||t.ce.push(new br(un.keyField(),n))}return t.ce}function Yr(e){const t=zt(e);return t.le||(t.le=Qr(t,Xr(e))),t.le}function Qr(e,t){if("F"===e.limitType)return Br(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new br(e.field,t)});const n=e.endAt?new gr(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new gr(e.startAt.position,e.startAt.inclusive):null;return Br(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function $r(e,t){const n=e.filters.concat([t]);return new Wr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Zr(e,t,n){return new Wr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Jr(e,t){return Ur(Yr(e),Yr(t))&&e.limitType===t.limitType}function ei(e){return"".concat(zr(Yr(e)),"|lt:").concat(e.limitType)}function ti(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Ar(e)).join(", "),"]")),En(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>nr(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>nr(e)).join(",")),"Target(".concat(t,")")}(Yr(e)),"; limitType=").concat(e.limitType,")")}function ni(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ln.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Xr(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=vr(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Xr(e),t))&&!(e.endAt&&!function(e,t,n){const r=vr(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Xr(e),t))}(e,t)}function ri(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ii(e){return(t,n)=>{let r=!1;for(const i of Xr(e)){const e=oi(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function oi(e,t,n){const r=e.field.isKeyField()?ln.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Jn(r,i):Lt()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Lt()}}class ai{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){On(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Nn(this.inner)}size(){return this.innerSize}}const si=new Pn(ln.comparator);function ui(){return si}const li=new Pn(ln.comparator);function ci(){let e=li;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function hi(e){let t=li;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function di(){return pi()}function fi(){return pi()}function pi(){return new ai(e=>e.toString(),(e,t)=>e.isEqual(t))}const mi=new Pn(ln.comparator),gi=new Mn(ln.comparator);function vi(){let e=gi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const yi=new Mn(en);function bi(){return yi}function xi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_n(t)?"-0":t}}function wi(e){return{integerValue:""+e}}function Ei(e,t){return Sn(t)?wi(t):xi(e,t)}class _i{constructor(){this._=void 0}}function Si(e,t,n){return e instanceof Ii?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Hn(t)&&(t=qn(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ti?Ai(e,t):e instanceof Oi?Ni(e,t):function(e,t){const n=Ci(e,t),r=Di(n)+Di(e.Pe);return or(n)&&or(e.Pe)?wi(r):xi(e.serializer,r)}(e,t)}function ki(e,t,n){return e instanceof Ti?Ai(e,t):e instanceof Oi?Ni(e,t):n}function Ci(e,t){return e instanceof Pi?function(e){return or(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Ii extends _i{}class Ti extends _i{constructor(e){super(),this.elements=e}}function Ai(e,t){const n=Ri(t);for(const r of e.elements)n.some(e=>$n(e,r))||n.push(r);return{arrayValue:{values:n}}}class Oi extends _i{constructor(e){super(),this.elements=e}}function Ni(e,t){let n=Ri(t);for(const r of e.elements)n=n.filter(e=>!$n(e,r));return{arrayValue:{values:n}}}class Pi extends _i{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Di(e){return Vn(e.integerValue||e.doubleValue)}function Ri(e){return ar(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Mi{constructor(e,t){this.field=e,this.transform=t}}class ji{constructor(e,t){this.version=e,this.transformResults=t}}class Fi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Fi}static exists(e){return new Fi(void 0,e)}static updateTime(e){return new Fi(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Li(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Bi{}function zi(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Qi(e.key,Fi.none()):new qi(e.key,e.data,Fi.none());{const n=e.data,r=fr.empty();let i=new Mn(un.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Gi(e.key,r,new Fn(i.toArray()),Fi.none())}}function Ui(e,t,n){e instanceof qi?function(e,t,n){const r=e.value.clone(),i=Xi(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Gi?function(e,t,n){if(!Li(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Xi(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ki(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Vi(e,t,n,r){return e instanceof qi?function(e,t,n,r){if(!Li(e.precondition,t))return n;const i=e.value.clone(),o=Yi(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Gi?function(e,t,n,r){if(!Li(e.precondition,t))return n;const i=Yi(e.fieldTransforms,r,t),o=t.data;return o.setAll(Ki(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Li(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Wi(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ci(r.transform,e||null);null!=i&&(null===n&&(n=fr.empty()),n.set(r.field,i))}return n||null}function Hi(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&tn(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ti&&t instanceof Ti||e instanceof Oi&&t instanceof Oi?tn(e.elements,t.elements,$n):e instanceof Pi&&t instanceof Pi?$n(e.Pe,t.Pe):e instanceof Ii&&t instanceof Ii}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class qi extends Bi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Gi extends Bi{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ki(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Xi(e,t,n){const r=new Map;Bt(e.length===n.length);for(let i=0;i<n.length;i++){const o=e[i],a=o.transform,s=t.data.field(o.field);r.set(o.field,ki(a,s,n[i]))}return r}function Yi(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,Si(e,o,t))}return r}class Qi extends Bi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $i extends Bi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Zi{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Ui(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Vi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Vi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=fi();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(r.key)?null:a;const s=zi(o,a);null!==s&&n.set(r.key,s),o.isValidDocument()||o.convertToNoDocument(rn.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),vi())}isEqual(e){return this.batchId===e.batchId&&tn(this.mutations,e.mutations,(e,t)=>Hi(e,t))&&tn(this.baseMutations,e.baseMutations,(e,t)=>Hi(e,t))}}class Ji{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Bt(e.mutations.length===n.length);let r=mi;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Ji(e,t,n,r)}}class eo{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class to{constructor(e,t){this.count=e,this.unchangedNames=t}}var no,ro;function io(e){switch(e){default:return Lt();case Ut.CANCELLED:case Ut.UNKNOWN:case Ut.DEADLINE_EXCEEDED:case Ut.RESOURCE_EXHAUSTED:case Ut.INTERNAL:case Ut.UNAVAILABLE:case Ut.UNAUTHENTICATED:return!1;case Ut.INVALID_ARGUMENT:case Ut.NOT_FOUND:case Ut.ALREADY_EXISTS:case Ut.PERMISSION_DENIED:case Ut.FAILED_PRECONDITION:case Ut.ABORTED:case Ut.OUT_OF_RANGE:case Ut.UNIMPLEMENTED:case Ut.DATA_LOSS:return!0}}function oo(e){if(void 0===e)return Mt("GRPC error has no .code"),Ut.UNKNOWN;switch(e){case no.OK:return Ut.OK;case no.CANCELLED:return Ut.CANCELLED;case no.UNKNOWN:return Ut.UNKNOWN;case no.DEADLINE_EXCEEDED:return Ut.DEADLINE_EXCEEDED;case no.RESOURCE_EXHAUSTED:return Ut.RESOURCE_EXHAUSTED;case no.INTERNAL:return Ut.INTERNAL;case no.UNAVAILABLE:return Ut.UNAVAILABLE;case no.UNAUTHENTICATED:return Ut.UNAUTHENTICATED;case no.INVALID_ARGUMENT:return Ut.INVALID_ARGUMENT;case no.NOT_FOUND:return Ut.NOT_FOUND;case no.ALREADY_EXISTS:return Ut.ALREADY_EXISTS;case no.PERMISSION_DENIED:return Ut.PERMISSION_DENIED;case no.FAILED_PRECONDITION:return Ut.FAILED_PRECONDITION;case no.ABORTED:return Ut.ABORTED;case no.OUT_OF_RANGE:return Ut.OUT_OF_RANGE;case no.UNIMPLEMENTED:return Ut.UNIMPLEMENTED;case no.DATA_LOSS:return Ut.DATA_LOSS;default:return Lt()}}(ro=no||(no={}))[ro.OK=0]="OK",ro[ro.CANCELLED=1]="CANCELLED",ro[ro.UNKNOWN=2]="UNKNOWN",ro[ro.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ro[ro.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ro[ro.NOT_FOUND=5]="NOT_FOUND",ro[ro.ALREADY_EXISTS=6]="ALREADY_EXISTS",ro[ro.PERMISSION_DENIED=7]="PERMISSION_DENIED",ro[ro.UNAUTHENTICATED=16]="UNAUTHENTICATED",ro[ro.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ro[ro.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ro[ro.ABORTED=10]="ABORTED",ro[ro.OUT_OF_RANGE=11]="OUT_OF_RANGE",ro[ro.UNIMPLEMENTED=12]="UNIMPLEMENTED",ro[ro.INTERNAL=13]="INTERNAL",ro[ro.UNAVAILABLE=14]="UNAVAILABLE",ro[ro.DATA_LOSS=15]="DATA_LOSS";let ao=null;function so(){return new TextEncoder}const uo=new mt([4294967295,4294967295],0);function lo(e){const t=so().encode(e),n=new gt;return n.update(t),new Uint8Array(n.digest())}function co(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new mt([n,r],0),new mt([i,o],0)]}class ho{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new fo("Invalid padding: ".concat(t));if(n<0)throw new fo("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new fo("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new fo("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=mt.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(mt.fromNumber(n)));return 1===r.compare(uo)&&(r=new mt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=lo(e),[n,r]=co(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ho(i,r,t);return n.forEach(e=>o.insert(e)),o}insert(e){if(0===this.Ie)return;const t=lo(e),[n,r]=co(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class fo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class po{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,mo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new po(rn.min(),r,new Pn(en),ui(),vi())}}class mo{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new mo(n,t,vi(),vi(),vi())}}class go{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class vo{constructor(e,t){this.targetId=e,this.me=t}}class yo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bn.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class bo{constructor(){this.fe=0,this.ge=Eo(),this.pe=Bn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=vi(),t=vi(),n=vi();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Lt()}}),new mo(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Eo()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Bt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class xo{constructor(e){this.Le=e,this.Be=new Map,this.ke=ui(),this.qe=wo(),this.Qe=new Pn(en)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Lt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Vr(i))if(0===n){const e=new ln(i.path);this.Ue(t,e,mr.newNoDocument(e,rn.min()))}else Bt(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==ao||ao.et(function(e,t,n,r,i){var o,a,s,u,l,c;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(o=null==d?void 0:d.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(u=null===(s=null===(a=null==d?void 0:d.bits)||void 0===a?void 0:a.bitmap)||void 0===s?void 0:s.length)&&void 0!==u?u:0,padding:null!==(c=null===(l=null==d?void 0:d.bits)||void 0===l?void 0:l.padding)&&void 0!==c?c:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,a;try{o=Wn(n).toUint8Array()}catch(e){if(e instanceof Ln)return jt("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new ho(o,r,i)}catch(e){return jt(e instanceof fo?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Le.tt(),o="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(o)||(this.Ue(t,n,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Vr(i.target)){const t=new ln(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,mr.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}});let n=vi();this.qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const r=new po(e,t,this.Qe,this.ke,n);return this.ke=ui(),this.qe=wo(),this.Qe=new Pn(en),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new bo,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Mn(en),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Rt("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new bo),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function wo(){return new Pn(ln.comparator)}function Eo(){return new Pn(ln.comparator)}const _o={asc:"ASCENDING",desc:"DESCENDING"},So={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ko={and:"AND",or:"OR"};class Co{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Io(e,t){return e.useProto3Json||En(t)?t:{value:t}}function To(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ao(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Oo(e,t){return To(e,t.toTimestamp())}function No(e){return Bt(!!e),rn.fromTimestamp(function(e){const t=Un(e);return new nn(t.seconds,t.nanos)}(e))}function Po(e,t){return Do(e,t).canonicalString()}function Do(e,t){const n=function(e){return new an(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ro(e){const t=an.fromString(e);return Bt(ea(t)),t}function Mo(e,t){return Po(e.databaseId,t.path)}function jo(e,t){const n=Ro(t);if(n.get(1)!==e.databaseId.projectId)throw new Vt(Ut.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Vt(Ut.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ln(zo(n))}function Fo(e,t){return Po(e.databaseId,t)}function Lo(e){const t=Ro(e);return 4===t.length?an.emptyPath():zo(t)}function Bo(e){return new an(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function zo(e){return Bt(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Uo(e,t,n){return{name:Mo(e,t),fields:n.value.mapValue.fields}}function Vo(e,t){let n;if(t instanceof qi)n={update:Uo(e,t.key,t.value)};else if(t instanceof Qi)n={delete:Mo(e,t.key)};else if(t instanceof Gi)n={update:Uo(e,t.key,t.data),updateMask:Jo(t.fieldMask)};else{if(!(t instanceof $i))return Lt();n={verify:Mo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Ii)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ti)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Oi)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Pi)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Lt()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Oo(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Lt()}(e,t.precondition)),n}function Wo(e,t){return{documents:[Fo(e,t.path)]}}function Ho(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Fo(e,i);const o=function(e){if(0!==e.length)return Zo(_r.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Qo(e.field),direction:Ko(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const s=Io(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function qo(e){let t=Lo(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Bt(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=Go(e);return t instanceof _r&&kr(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new br($o(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,En(t)?null:t}(n.limit));let u=null;n.startAt&&(u=function(e){const t=!!e.before,n=e.values||[];return new gr(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new gr(n,t)}(n.endAt)),Hr(t,i,a,o,s,"F",u,l)}function Go(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=$o(e.unaryFilter.field);return Er.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=$o(e.unaryFilter.field);return Er.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=$o(e.unaryFilter.field);return Er.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=$o(e.unaryFilter.field);return Er.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Lt()}}(e):void 0!==e.fieldFilter?function(e){return Er.create($o(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Lt()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return _r.create(e.compositeFilter.filters.map(e=>Go(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Lt()}}(e.compositeFilter.op))}(e):Lt()}function Ko(e){return _o[e]}function Xo(e){return So[e]}function Yo(e){return ko[e]}function Qo(e){return{fieldPath:e.canonicalString()}}function $o(e){return un.fromServerFormat(e.fieldPath)}function Zo(e){return e instanceof Er?function(e){if("=="===e.op){if(ur(e.value))return{unaryFilter:{field:Qo(e.field),op:"IS_NAN"}};if(sr(e.value))return{unaryFilter:{field:Qo(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ur(e.value))return{unaryFilter:{field:Qo(e.field),op:"IS_NOT_NAN"}};if(sr(e.value))return{unaryFilter:{field:Qo(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qo(e.field),op:Xo(e.op),value:e.value}}}(e):e instanceof _r?function(e){const t=e.getFilters().map(e=>Zo(e));return 1===t.length?t[0]:{compositeFilter:{op:Yo(e.op),filters:t}}}(e):Lt()}function Jo(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function ea(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ta{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:rn.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:rn.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Bn.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=s}withSequenceNumber(e){return new ta(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class na{constructor(e){this.ct=e}}function ra(e){const t=qo({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Zr(t,t.limit,"L"):t}class ia{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Vn(e.integerValue));else if("doubleValue"in e){const n=Vn(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),_n(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Un(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Wn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?dr(e)?this.dt(t,Number.MAX_SAFE_INTEGER):cr(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Lt()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const o="value",a=(null===(r=null===(n=i[o].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Vn(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),ln.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ia.vt=new ia;class oa{constructor(){this.un=new aa}addToCollectionParentIndex(e,t){return this.un.add(t),yn.resolve()}getCollectionParents(e,t){return yn.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return yn.resolve()}deleteFieldIndex(e,t){return yn.resolve()}deleteAllFieldIndexes(e){return yn.resolve()}createTargetIndexes(e,t){return yn.resolve()}getDocumentsMatchingTarget(e,t){return yn.resolve(null)}getIndexType(e,t){return yn.resolve(0)}getFieldIndexes(e,t){return yn.resolve([])}getNextCollectionGroupToUpdate(e){return yn.resolve(null)}getMinOffset(e,t){return yn.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,t){return yn.resolve(fn.min())}updateCollectionGroup(e,t,n){return yn.resolve()}updateIndexEntries(e,t){return yn.resolve()}}class aa{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Mn(an.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Mn(an.comparator)).toArray()}}new Uint8Array(0);class sa{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new sa(e,sa.DEFAULT_COLLECTION_PERCENTILE,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}sa.DEFAULT_COLLECTION_PERCENTILE=10,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sa.DEFAULT=new sa(41943040,sa.DEFAULT_COLLECTION_PERCENTILE,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sa.DISABLED=new sa(-1,0,0);class ua{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ua(0)}static kn(){return new ua(-1)}}class la{constructor(){this.changes=new ai(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?yn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ca{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ha{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Vi(n.mutation,e,Fn.empty(),nn.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,vi()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vi();const r=di();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ci();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=di();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,vi()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=ui();const o=pi(),a=pi();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Gi)?i=i.insert(t.key,t):void 0!==a?(o.set(t.key,a.mutation.getFieldMask()),Vi(a.mutation,t,a.mutation.getFieldMask(),nn.now())):o.set(t.key,Fn.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>o.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new ca(t,null!==(n=o.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=pi();let r=new Pn((e,t)=>e-t),i=vi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const o=t.get(e);if(null===o)return;let a=n.get(e)||Fn.empty();a=i.applyToLocalView(o,a),n.set(e,a);const s=(r.get(i.batchId)||vi()).add(e);r=r.insert(i.batchId,s)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),s=r.key,u=r.value,l=fi();u.forEach(e=>{if(!i.has(e)){const r=zi(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}}),o.push(this.documentOverlayCache.saveOverlays(e,s,l))}return yn.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ln.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Kr(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):yn.resolve(di());let a=-1,s=i;return o.next(t=>yn.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?yn.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{s=s.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,s,t,vi())).next(e=>({batchId:a,changes:hi(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ln(t)).next(e=>{let t=ci();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=ci();return this.indexManager.getCollectionParents(e,i).next(a=>yn.forEach(a,a=>{const s=function(e,t){return new Wr(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next(e=>{e.forEach((e,t)=>{o=o.insert(e,t)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,mr.newInvalidDocument(r)))});let n=ci();return e.forEach((e,r)=>{const o=i.get(e);void 0!==o&&Vi(o.mutation,r,Fn.empty(),nn.now()),ni(t,r)&&(n=n.insert(e,r))}),n})}}class da{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return yn.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:No(e.createTime)}}(t)),yn.resolve()}getNamedQuery(e,t){return yn.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:ra(e.bundledQuery),readTime:No(e.readTime)}}(t)),yn.resolve()}}class fa{constructor(){this.overlays=new Pn(ln.comparator),this.Ir=new Map}getOverlay(e,t){return yn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=di();return yn.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),yn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),yn.resolve()}getOverlaysForCollection(e,t,n){const r=di(),i=t.length+1,o=new ln(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const e=a.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return yn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Pn((e,t)=>e-t);const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=di(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=di(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return yn.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new eo(t,n));let i=this.Ir.get(t);void 0===i&&(i=vi(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class pa{constructor(){this.sessionToken=Bn.EMPTY_BYTE_STRING}getSessionToken(e){return yn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,yn.resolve()}}class ma{constructor(){this.Tr=new Mn(ga.Er),this.dr=new Mn(ga.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new ga(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new ga(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new ln(new an([])),n=new ga(t,e),r=new ga(t,e+1),i=[];return this.dr.forEachInRange([n,r],e=>{this.Vr(e),i.push(e.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ln(new an([])),n=new ga(t,e),r=new ga(t,e+1);let i=vi();return this.dr.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new ga(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ga{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ln.comparator(e.key,t.key)||en(e.wr,t.wr)}static Ar(e,t){return en(e.wr,t.wr)||ln.comparator(e.key,t.key)}}class va{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Mn(ga.Er)}checkEmpty(e){return yn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Zi(i,t,n,r);this.mutationQueue.push(o);for(const a of r)this.br=this.br.add(new ga(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return yn.resolve(o)}lookupMutationBatch(e,t){return yn.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return yn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return yn.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return yn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ga(t,0),r=new ga(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],e=>{const t=this.Dr(e.wr);i.push(t)}),yn.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Mn(en);return t.forEach(e=>{const t=new ga(e,0),r=new ga(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],e=>{n=n.add(e.wr)})}),yn.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;ln.isDocumentKey(i)||(i=i.child(""));const o=new ga(new ln(i),0);let a=new Mn(en);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)},o),yn.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Bt(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return yn.forEach(t.mutations,r=>{const i=new ga(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new ga(t,0),r=this.br.firstAfterOrEqual(n);return yn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,yn.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ya{constructor(e){this.Mr=e,this.docs=new Pn(ln.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return yn.resolve(n?n.document.mutableCopy():mr.newInvalidDocument(t))}getEntries(e,t){let n=ui();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():mr.newInvalidDocument(e))}),yn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ui();const o=t.path,a=new ln(o.child("")),s=this.docs.getIteratorFrom(a);for(;s.hasNext();){const{key:e,value:{document:a}}=s.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||pn(dn(a),n)<=0||(r.has(a.key)||ni(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return yn.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Lt()}Or(e,t){return yn.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new ba(this)}getSize(e){return yn.resolve(this.size)}}class ba extends la{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)}),yn.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class xa{constructor(e){this.persistence=e,this.Nr=new ai(e=>zr(e),Ur),this.lastRemoteSnapshotVersion=rn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ma,this.targetCount=0,this.kr=ua.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),yn.resolve()}getLastRemoteSnapshotVersion(e){return yn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return yn.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),yn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),yn.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ua(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,yn.resolve()}updateTargetData(e,t){return this.Kn(t),yn.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,yn.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),yn.waitFor(i).next(()=>r)}getTargetCount(e){return yn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return yn.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),yn.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),yn.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),yn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return yn.resolve(n)}containsKey(e,t){return yn.resolve(this.Br.containsKey(t))}}class wa{constructor(e,t){this.qr={},this.overlays={},this.Qr=new wn(0),this.Kr=!1,this.Kr=!0,this.$r=new pa,this.referenceDelegate=e(this),this.Ur=new xa(this),this.indexManager=new oa,this.remoteDocumentCache=function(e){return new ya(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new na(t),this.Gr=new da(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new va(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){Rt("MemoryPersistence","Starting transaction:",e);const r=new Ea(this.Qr.next());return this.referenceDelegate.zr(),n(r).next(e=>this.referenceDelegate.jr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Hr(e,t){return yn.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class Ea extends gn{constructor(e){super(),this.currentSequenceNumber=e}}class _a{constructor(e){this.persistence=e,this.Jr=new ma,this.Yr=null}static Zr(e){return new _a(e)}get Xr(){if(this.Yr)return this.Yr;throw Lt()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),yn.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),yn.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),yn.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return yn.forEach(this.Xr,n=>{const r=ln.fromPath(n);return this.ei(e,r).next(e=>{e||t.removeEntry(r,rn.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return yn.or([()=>yn.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Sa{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=vi(),r=vi();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Sa(e,t.fromCache,n,r)}}class ka{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ca{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=N()?8:bn(O())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.Zi(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new ka;return this.Xi(e,t,n).next(r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)})}).next(()=>i.result)}es(e,t,n,r){return n.documentReadCount<this.ji?(Dt()<=G.DEBUG&&Rt("QueryEngine","SDK will not create cache indexes for query:",ti(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),yn.resolve()):(Dt()<=G.DEBUG&&Rt("QueryEngine","Query:",ti(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Dt()<=G.DEBUG&&Rt("QueryEngine","The SDK decides to create cache indexes for query:",ti(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yr(t))):yn.resolve())}Yi(e,t){if(Gr(t))return yn.resolve(null);let n=Yr(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Zr(t,null,"F"),n=Yr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=vi(...r);return this.Ji.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const o=this.ts(t,r);return this.ns(t,o,i,n.readTime)?this.Yi(e,Zr(t,null,"F")):this.rs(e,o,t,n)}))})))}Zi(e,t,n,r){return Gr(t)||r.isEqual(rn.min())?yn.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(t,i);return this.ns(t,o,n,r)?yn.resolve(null):(Dt()<=G.DEBUG&&Rt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ti(t)),this.rs(e,o,t,hn(r,-1)).next(e=>e))})}ts(e,t){let n=new Mn(ii(e));return t.forEach((t,r)=>{ni(e,r)&&(n=n.add(r))}),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Dt()<=G.DEBUG&&Rt("QueryEngine","Using full collection scan to execute query:",ti(t)),this.Ji.getDocumentsMatchingQuery(e,t,fn.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Ia{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Pn(en),this._s=new ai(e=>zr(e),Ur),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ha(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Ta(e,t,n,r){return new Ia(e,t,n,r)}async function Aa(e,t){const n=zt(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],o=[];let a=vi();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({hs:e,removedBatchIds:i,addedBatchIds:o}))})})}function Oa(e){const t=zt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Na(e,t,n){let r=vi(),i=vi();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=ui();return n.forEach((n,o)=>{const a=e.get(n);o.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(rn.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):Rt("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)}),{Ps:r,Is:i}})}function Pa(e,t){const n=zt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Da(e,t){const n=zt(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Ur.getTargetData(e,t).next(i=>i?(r=i,yn.resolve(r)):n.Ur.allocateTargetId(e).next(i=>(r=new ta(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function Ra(e,t,n){const r=zt(e),i=r.os.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!xn(e))throw e;Rt("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function Ma(e,t,n){const r=zt(e);let i=rn.min(),o=vi();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=zt(e),i=r._s.get(n);return void 0!==i?yn.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,Yr(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{o=e})}).next(()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:rn.min(),n?o:vi())).next(e=>(ja(r,ri(t),e),{documents:e,Ts:o})))}function ja(e,t,n){let r=e.us.get(t)||rn.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.us.set(t,r)}class Fa{constructor(){this.activeTargetIds=bi()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class La{constructor(){this.so=new Fa,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Fa,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ba{_o(e){}shutdown(){}}class za{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Rt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Rt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ua=null;function Va(){return null===Ua?Ua=268435456+Math.round(2147483648*Math.random()):Ua++,"0x"+Ua.toString(16)}const Wa={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ha{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const qa="WebChannelConnection";class Ga extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const o=Va(),a=this.xo(e,t.toUriEncodedString());Rt("RestConnection","Sending RPC '".concat(e,"' ").concat(o,":"),a,n);const s={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(s,r,i),this.No(e,a,s,n).then(t=>(Rt("RestConnection","Received RPC '".concat(e,"' ").concat(o,": "),t),t),t=>{throw jt("RestConnection","RPC '".concat(e,"' ").concat(o," failed with error: "),t,"url: ",a,"request:",n),t})}Lo(e,t,n,r,i,o){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Nt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=Wa[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Va();return new Promise((o,a)=>{const s=new bt;s.setWithCredentials(!0),s.listenOnce(wt.COMPLETE,()=>{try{switch(s.getLastErrorCode()){case Et.NO_ERROR:const t=s.getResponseJson();Rt(qa,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),o(t);break;case Et.TIMEOUT:Rt(qa,"RPC '".concat(e,"' ").concat(i," timed out")),a(new Vt(Ut.DEADLINE_EXCEEDED,"Request time out"));break;case Et.HTTP_ERROR:const n=s.getStatus();if(Rt(qa,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ut).indexOf(t)>=0?t:Ut.UNKNOWN}(t.status);a(new Vt(e,t.message))}else a(new Vt(Ut.UNKNOWN,"Server responded with status "+s.getStatus()))}else a(new Vt(Ut.UNAVAILABLE,"Connection failed."));break;default:Lt()}}finally{Rt(qa,"RPC '".concat(e,"' ").concat(i," completed."))}});const u=JSON.stringify(r);Rt(qa,"RPC '".concat(e,"' ").concat(i," sending request:"),r),s.send(t,"POST",u,n,15)})}Bo(e,t,n){const r=Va(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ct(),a=kt(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(s.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(s.useFetchStreams=!0),this.Oo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const l=i.join("");Rt(qa,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(l),s);const c=o.createWebChannel(l,s);let h=!1,d=!1;const f=new Ha({Io:t=>{d?Rt(qa,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Rt(qa,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),c.open(),h=!0),Rt(qa,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),c.send(t))},To:()=>c.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(c,xt.EventType.OPEN,()=>{d||(Rt(qa,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.yo())}),p(c,xt.EventType.CLOSE,()=>{d||(d=!0,Rt(qa,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.So())}),p(c,xt.EventType.ERROR,t=>{d||(d=!0,jt(qa,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.So(new Vt(Ut.UNAVAILABLE,"The operation could not be completed")))}),p(c,xt.EventType.MESSAGE,t=>{var n;if(!d){const i=t.data[0];Bt(!!i);const o=i,a=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(a){Rt(qa,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=no[e];if(void 0!==t)return oo(t)}(t),i=a.message;void 0===n&&(n=Ut.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),d=!0,f.So(new Vt(n,i)),c.close()}else Rt(qa,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.bo(i)}}),p(a,St.STAT_EVENT,t=>{t.stat===_t.PROXY?Rt(qa,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===_t.NOPROXY&&Rt(qa,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.wo()},0),f}}function Ka(){return"undefined"!=typeof document?document:null}function Xa(e){return new Co(e,!0)}class Ya{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&Rt("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Qa{constructor(e,t,n,r,i,o,a,s){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=s,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ya(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Ut.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ut.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)},t=>{e(()=>{const e=new Vt(Ut.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Rt("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Rt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $a extends Qa{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Lt()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Bt(void 0===t||"string"==typeof t),Bn.fromBase64String(t||"")):(Bt(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Bn.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,s=a&&function(e){const t=void 0===e.code?Ut.UNKNOWN:oo(e.code);return new Vt(t,e.message||"")}(a);n=new yo(r,i,o,s||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=jo(e,r.document.name),o=No(r.document.updateTime),a=r.document.createTime?No(r.document.createTime):rn.min(),s=new fr({mapValue:{fields:r.document.fields}}),u=mr.newFoundDocument(i,o,a,s),l=r.targetIds||[],c=r.removedTargetIds||[];n=new go(l,c,u.key,u)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=jo(e,r.document),o=r.readTime?No(r.readTime):rn.min(),a=mr.newNoDocument(i,o),s=r.removedTargetIds||[];n=new go([],s,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=jo(e,r.document),o=r.removedTargetIds||[];n=new go([],o,i,null)}else{if(!("filter"in t))return Lt();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new to(r,i),a=e.targetId;n=new vo(a,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return rn.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?rn.min():t.readTime?No(t.readTime):rn.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Bo(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Vr(r)?{documents:Wo(e,r)}:{query:Ho(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ao(e,t.resumeToken);const r=Io(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(rn.min())>0){n.readTime=To(e,t.snapshotVersion.toTimestamp());const r=Io(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Lt()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Bo(this.serializer),t.removeTarget=e,this.a_(t)}}class Za extends Qa{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Bt(!!e.streamToken),this.lastStreamToken=e.streamToken,Bt(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Bt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Bt(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?No(e.updateTime):No(t);return n.isEqual(rn.min())&&(n=No(t)),new ji(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=No(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Bo(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Vo(this.serializer,e))};this.a_(t)}}class Ja extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Vt(Ut.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,a]=i;return this.connection.Mo(e,Do(t,n),r,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ut.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vt(Ut.UNKNOWN,e.toString())})}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(o=>{let[a,s]=o;return this.connection.Lo(e,Do(t,n),r,a,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ut.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vt(Ut.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class es{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(Mt(t),this.D_=!1):Rt("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class ts{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(e=>{n.enqueueAndForget(async()=>{cs(this)&&(Rt("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=zt(e);t.L_.add(4),await rs(t),t.q_.set("Unknown"),t.L_.delete(4),await ns(t)}(this))})}),this.q_=new es(n,r)}}async function ns(e){if(cs(e))for(const t of e.B_)await t(!0)}async function rs(e){for(const t of e.B_)await t(!1)}function is(e,t){const n=zt(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),ls(n)?us(n):As(n).r_()&&as(n,t))}function os(e,t){const n=zt(e),r=As(n);n.N_.delete(t),r.r_()&&ss(n,t),0===n.N_.size&&(r.r_()?r.o_():cs(n)&&n.q_.set("Unknown"))}function as(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(rn.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}As(e).A_(t)}function ss(e,t){e.Q_.xe(t),As(e).R_(t)}function us(e){e.Q_=new xo({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),As(e).start(),e.q_.v_()}function ls(e){return cs(e)&&!As(e).n_()&&e.N_.size>0}function cs(e){return 0===zt(e).L_.size}function hs(e){e.Q_=void 0}async function ds(e){e.q_.set("Online")}async function fs(e){e.N_.forEach((t,n)=>{as(e,t)})}async function ps(e,t){hs(e),ls(e)?(e.q_.M_(t),us(e)):e.q_.set("Unknown")}async function ms(e,t,n){if(e.q_.set("Online"),t instanceof yo&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){Rt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await gs(e,n)}else if(t instanceof go?e.Q_.Ke(t):t instanceof vo?e.Q_.He(t):e.Q_.We(t),!n.isEqual(rn.min()))try{const t=await Oa(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Bn.EMPTY_BYTE_STRING,r.snapshotVersion)),ss(e,t);const i=new ta(r.target,t,n,r.sequenceNumber);as(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Rt("RemoteStore","Failed to raise snapshot:",t),await gs(e,t)}}async function gs(e,t,n){if(!xn(t))throw t;e.L_.add(1),await rs(e),e.q_.set("Offline"),n||(n=()=>Oa(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Rt("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await ns(e)})}function vs(e,t){return t().catch(n=>gs(e,n,t))}async function ys(e){const t=zt(e),n=Os(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;bs(t);)try{const e=await Pa(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,xs(t,e)}catch(e){await gs(t,e)}ws(t)&&Es(t)}function bs(e){return cs(e)&&e.O_.length<10}function xs(e,t){e.O_.push(t);const n=Os(e);n.r_()&&n.V_&&n.m_(t.mutations)}function ws(e){return cs(e)&&!Os(e).n_()&&e.O_.length>0}function Es(e){Os(e).start()}async function _s(e){Os(e).p_()}async function Ss(e){const t=Os(e);for(const n of e.O_)t.m_(n.mutations)}async function ks(e,t,n){const r=e.O_.shift(),i=Ji.from(r,t,n);await vs(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await ys(e)}async function Cs(e,t){t&&Os(e).V_&&await async function(e,t){if(function(e){return io(e)&&e!==Ut.ABORTED}(t.code)){const n=e.O_.shift();Os(e).s_(),await vs(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await ys(e)}}(e,t),ws(e)&&Es(e)}async function Is(e,t){const n=zt(e);n.asyncQueue.verifyOperationInProgress(),Rt("RemoteStore","RemoteStore received new credentials");const r=cs(n);n.L_.add(3),await rs(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await ns(n)}async function Ts(e,t){const n=zt(e);t?(n.L_.delete(2),await ns(n)):t||(n.L_.add(2),await rs(n),n.q_.set("Unknown"))}function As(e){return e.K_||(e.K_=function(e,t,n){const r=zt(e);return r.w_(),new $a(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:ds.bind(null,e),Ro:fs.bind(null,e),mo:ps.bind(null,e),d_:ms.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),ls(e)?us(e):e.q_.set("Unknown")):(await e.K_.stop(),hs(e))})),e.K_}function Os(e){return e.U_||(e.U_=function(e,t,n){const r=zt(e);return r.w_(),new Za(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:_s.bind(null,e),mo:Cs.bind(null,e),f_:Ss.bind(null,e),g_:ks.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await ys(e)):(await e.U_.stop(),e.O_.length>0&&(Rt("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Ns{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Wt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,a=new Ns(e,t,o,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vt(Ut.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ps(e,t){if(Mt("AsyncQueue","".concat(t,": ").concat(e)),xn(e))return new Vt(Ut.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Ds{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ln.comparator(t.key,n.key):(e,t)=>ln.comparator(e.key,t.key),this.keyedMap=ci(),this.sortedSet=new Pn(this.comparator)}static emptySet(e){return new Ds(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ds))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Ds;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Rs{constructor(){this.W_=new Pn(ln.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Lt():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Ms{constructor(e,t,n,r,i,o,a,s,u){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s,this.hasCachedResults=u}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(e=>{o.push({type:0,doc:e})}),new Ms(e,t,Ds.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class js{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Fs{constructor(){this.queries=Ls(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=zt(e),r=n.queries;n.queries=Ls(),r.forEach((e,n)=>{for(const r of n.j_)r.onError(t)})}(this,new Vt(Ut.ABORTED,"Firestore shutting down"))}}function Ls(){return new ai(e=>ei(e),Jr)}async function Bs(e,t){const n=zt(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.H_()&&t.J_()&&(r=2):(o=new js,r=t.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ps(e,"Initialization of query '".concat(ti(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,o),o.j_.push(t),t.Z_(n.onlineState),o.z_&&t.X_(o.z_)&&Ws(n)}async function zs(e,t){const n=zt(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.j_.indexOf(t);e>=0&&(o.j_.splice(e,1),0===o.j_.length?i=t.J_()?0:1:!o.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Us(e,t){const n=zt(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&Ws(n)}function Vs(e,t,n){const r=zt(e),i=r.queries.get(t);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(t)}function Ws(e){e.Y_.forEach(e=>{e.next()})}var Hs,qs;(qs=Hs||(Hs={})).ea="default",qs.Cache="cache";class Gs{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ms(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Ms.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hs.Cache}}class Ks{constructor(e){this.key=e}}class Xs{constructor(e){this.key=e}}class Ys{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=vi(),this.mutatedKeys=vi(),this.Aa=ii(e),this.Ra=new Ds(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Rs,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const s="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,u="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const l=r.get(e),c=ni(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let f=!1;l&&c?l.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ga(l,c)||(n.track({type:2,doc:c}),f=!0,(s&&this.Aa(c,s)>0||u&&this.Aa(c,u)<0)&&(a=!0)):!l&&c?(n.track({type:0,doc:c}),f=!0):l&&!c&&(n.track({type:1,doc:l}),f=!0,(s||u)&&(a=!0)),f&&(c?(o=o.add(c),i=d?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:o,fa:n,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lt()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],s=0===this.da.size&&this.current&&!r?1:0,u=s!==this.Ea;return this.Ea=s,0!==o.length||u?{snapshot:new Ms(this.query,e.Ra,i,o,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Rs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=vi(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new Xs(e))}),this.da.forEach(n=>{e.has(n)||t.push(new Ks(n))}),t}ba(e){this.Ta=e.Ts,this.da=vi();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ms.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Qs{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class $s{constructor(e){this.key=e,this.va=!1}}class Zs{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ai(e=>ei(e),Jr),this.Ma=new Map,this.xa=new Set,this.Oa=new Pn(ln.comparator),this.Na=new Map,this.La=new ma,this.Ba={},this.ka=new Map,this.qa=ua.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Js(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=xu(e);let i;const o=r.Fa.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await tu(r,t,n,!0),i}async function eu(e,t){const n=xu(e);await tu(n,t,!0,!1)}async function tu(e,t,n,r){const i=await Da(e.localStore,Yr(t)),o=i.targetId,a=e.sharedClientState.addLocalQueryTarget(o,n);let s;return r&&(s=await nu(e,t,o,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&is(e.remoteStore,i),s}async function nu(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Ma(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,i)}));const o=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,o,a);return pu(e,t.targetId,s.wa),s.snapshot}(e,t,n,r);const o=await Ma(e.localStore,t,!0),a=new Ys(t,o.Ts),s=a.ma(o.documents),u=mo.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=a.applyChanges(s,e.isPrimaryClient,u);pu(e,n,l.wa);const c=new Qs(t,n,a);return e.Fa.set(t,c),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),l.snapshot}async function ru(e,t,n){const r=zt(e),i=r.Fa.get(t),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(e=>!Jr(e,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ra(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&os(r.remoteStore,i.targetId),du(r,i.targetId)}).catch(vn)):(du(r,i.targetId),await Ra(r.localStore,i.targetId,!0))}async function iu(e,t){const n=zt(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),os(n.remoteStore,r.targetId))}async function ou(e,t){const n=zt(e);try{const e=await function(e,t){const n=zt(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];t.targetChanges.forEach((o,s)=>{const u=i.get(s);if(!u)return;a.push(n.Ur.removeMatchingKeys(e,o.removedDocuments,s).next(()=>n.Ur.addMatchingKeys(e,o.addedDocuments,s)));let l=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?l=l.withResumeToken(Bn.EMPTY_BYTE_STRING,rn.min()).withLastLimboFreeSnapshotVersion(rn.min()):o.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(o.resumeToken,r)),i=i.insert(s,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(u,l,o)&&a.push(n.Ur.updateTargetData(e,l))});let s=ui(),u=vi();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Na(e,o,t.documentUpdates).next(e=>{s=e.Ps,u=e.Is})),!r.isEqual(rn.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return yn.waitFor(a).next(()=>o.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,s,u)).next(()=>s)}).then(e=>(n.os=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Na.get(t);r&&(Bt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Bt(r.va):e.removedDocuments.size>0&&(Bt(r.va),r.va=!1))}),await vu(n,e,t)}catch(e){await vn(e)}}function au(e,t,n){const r=zt(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=zt(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)}),r&&Ws(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function su(e,t,n){const r=zt(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),o=i&&i.key;if(o){let e=new Pn(ln.comparator);e=e.insert(o,mr.newNoDocument(o,rn.min()));const n=vi().add(o),i=new po(rn.min(),new Map,new Pn(en),e,n);await ou(r,i),r.Oa=r.Oa.remove(o),r.Na.delete(t),gu(r)}else await Ra(r.localStore,t,!1).then(()=>du(r,t,n)).catch(vn)}async function uu(e,t){const n=zt(e),r=t.batch.batchId;try{const e=await function(e,t){const n=zt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let a=yn.resolve();return o.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const o=n.docVersions.get(e);Bt(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=vi();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);hu(n,r,null),cu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vu(n,e)}catch(e){await vn(e)}}async function lu(e,t,n){const r=zt(e);try{const e=await function(e,t){const n=zt(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Bt(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);hu(r,t,n),cu(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await vu(r,e)}catch(n){await vn(n)}}function cu(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function hu(e,t,n){const r=zt(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function du(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||fu(e,t)})}function fu(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(os(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),gu(e))}function pu(e,t,n){for(const r of n)r instanceof Ks?(e.La.addReference(r.key,t),mu(e,r)):r instanceof Xs?(Rt("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||fu(e,r.key)):Lt()}function mu(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(Rt("SyncEngine","New document in limbo: "+n),e.xa.add(r),gu(e))}function gu(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new ln(an.fromString(t)),r=e.qa.next();e.Na.set(r,new $s(n)),e.Oa=e.Oa.insert(n,r),is(e.remoteStore,new ta(Yr(qr(n.path)),r,"TargetPurposeLimboResolution",wn.oe))}}async function vu(e,t,n){const r=zt(e),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((e,s)=>{a.push(r.Ka(s,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(s.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(s.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Sa.Wi(s.targetId,e);o.push(t)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(e,t){const n=zt(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>yn.forEach(t,t=>yn.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>yn.forEach(t.Ui,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!xn(e))throw e;Rt("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,o))}async function yu(e,t){const n=zt(e);if(!n.currentUser.isEqual(t)){Rt("SyncEngine","User change. New user:",t.toKey());const e=await Aa(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new Vt(Ut.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await vu(n,e.hs)}}function bu(e,t){const n=zt(e),r=n.Na.get(t);if(r&&r.va)return vi().add(r.key);{let e=vi();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function xu(e){const t=zt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ou.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=bu.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=su.bind(null,t),t.Ca.d_=Us.bind(null,t.eventManager),t.Ca.$a=Vs.bind(null,t.eventManager),t}function wu(e){const t=zt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=uu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=lu.bind(null,t),t}class Eu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xa(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Ta(this.persistence,new Ca,e.initialUser,this.serializer)}Ga(e){return new wa(_a.Zr,this.serializer)}Wa(e){return new La}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Eu.provider={build:()=>new Eu};class _u{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>au(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=yu.bind(null,this.syncEngine),await Ts(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Fs}createDatastore(e){const t=Xa(e.databaseInfo.databaseId),n=function(e){return new Ga(e)}(e.databaseInfo);return function(e,t,n,r){return new Ja(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ts(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>au(this.syncEngine,e,0),za.D()?new za:new Ba)}createSyncEngine(e,t){return function(e,t,n,r,i,o,a){const s=new Zs(e,t,n,r,i,o);return a&&(s.Qa=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=zt(e);Rt("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await rs(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}_u.provider={build:()=>new _u};class Su{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class ku{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ot.UNAUTHENTICATED,this.clientId=Jt.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Rt("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Rt("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(jd){const n=Ps(jd,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Cu(e,t){e.asyncQueue.verifyOperationInProgress(),Rt("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Aa(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Iu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Tu(e);Rt("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Is(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Is(t.remoteStore,n)),e._onlineComponents=t}async function Tu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Rt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cu(e,e._uninitializedComponentsProvider._offline)}catch(jd){const n=jd;if(!function(e){return"FirebaseError"===e.name?e.code===Ut.FAILED_PRECONDITION||e.code===Ut.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;jt("Error using user provided cache. Falling back to memory cache: "+n),await Cu(e,new Eu)}}else Rt("FirestoreClient","Using default OfflineComponentProvider"),await Cu(e,new Eu);return e._offlineComponents}async function Au(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Rt("FirestoreClient","Using user provided OnlineComponentProvider"),await Iu(e,e._uninitializedComponentsProvider._online)):(Rt("FirestoreClient","Using default OnlineComponentProvider"),await Iu(e,new _u))),e._onlineComponents}function Ou(e){return Au(e).then(e=>e.syncEngine)}async function Nu(e){const t=await Au(e),n=t.eventManager;return n.onListen=Js.bind(null,t.syncEngine),n.onUnlisten=ru.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=eu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=iu.bind(null,t.syncEngine),n}function Pu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Wt;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new Su({next:n=>{o.Za(),t.enqueueAndForget(()=>zs(e,a)),n.fromCache&&"server"===r.source?i.reject(new Vt(Ut.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new Gs(n,o,{includeMetadataChanges:!0,_a:!0});return Bs(e,a)}(await Nu(e),e.asyncQueue,t,n,r)),r.promise}function Du(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Ru=new Map;function Mu(e,t,n){if(!n)throw new Vt(Ut.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function ju(e){if(!ln.isDocumentKey(e))throw new Vt(Ut.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Fu(e){if(ln.isDocumentKey(e))throw new Vt(Ut.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Lu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Lt()}function Bu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Vt(Ut.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lu(e);throw new Vt(Ut.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}class zu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Vt(Ut.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Vt(Ut.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Vt(Ut.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Du(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Vt(Ut.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Vt(Ut.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Vt(Ut.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zu({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Vt(Ut.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Vt(Ut.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zu(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new qt;switch(e.type){case"firstParty":return new Yt(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Vt(Ut.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Ru.get(e);t&&(Rt("ComponentProvider","Removing Datastore"),Ru.delete(e),t.terminate())}(this),Promise.resolve()}}class Vu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Vu(this.firestore,e,this._query)}}class Wu{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wu(this.firestore,e,this._key)}}class Hu extends Vu{constructor(e,t,n){super(e,t,qr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wu(this.firestore,null,new ln(e))}withConverter(e){return new Hu(this.firestore,e,this._path)}}function qu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=z(e),Mu("collection","path",t),e instanceof Uu){const n=an.fromString(t,...r);return Fu(n),new Hu(e,null,n)}{if(!(e instanceof Wu||e instanceof Hu))throw new Vt(Ut.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(an.fromString(t,...r));return Fu(n),new Hu(e.firestore,null,n)}}function Gu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=z(e),1===arguments.length&&(t=Jt.newId()),Mu("doc","path",t),e instanceof Uu){const n=an.fromString(t,...r);return ju(n),new Wu(e,null,new ln(n))}{if(!(e instanceof Wu||e instanceof Hu))throw new Vt(Ut.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(an.fromString(t,...r));return ju(n),new Wu(e.firestore,e instanceof Hu?e.converter:null,new ln(n))}}class Ku{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ya(this,"async_queue_retry"),this.Vu=()=>{const e=Ka();e&&Rt("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Ka();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Ka();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Wt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(Fd){if(!xn(Fd))throw Fd;Rt("AsyncQueue","Operation failed with retryable error: "+Fd)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Mt("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Ns.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(r),r}fu(){this.Eu&&Lt()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Xu(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Yu extends Uu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Ku,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ku(e),this._firestoreClient=void 0,await e}}}function Qu(e){if(e._terminated)throw new Vt(Ut.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||$u(e),e._firestoreClient}function $u(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new Kn(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Du(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new ku(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Zu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zu(Bn.fromBase64String(e))}catch(e){throw new Vt(Ut.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Zu(Bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ju{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class el{constructor(e){this._methodName=e}}class tl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Vt(Ut.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Vt(Ut.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}}class nl{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const rl=/^__.*__$/;class il{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms):new qi(e,this.data,t,this.fieldTransforms)}}function ol(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lt()}}class al{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new al(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return bl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(ol(this.Cu)&&rl.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class sl{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Xa(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new al({Cu:e,methodName:t,qu:n,path:un.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ul(e){const t=e._freezeSettings(),n=Xa(e._databaseId);return new sl(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ll(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Qu(o.merge||o.mergeFields?2:0,t,n,i);ml("Data must be an object, but it was:",a,r);const s=fl(r,a);let u,l;if(o.merge)u=new Fn(a.fieldMask),l=a.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=gl(t,r,n);if(!a.contains(i))throw new Vt(Ut.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));xl(e,i)||e.push(i)}u=new Fn(e),l=a.fieldTransforms.filter(e=>u.covers(e.field))}else u=null,l=a.fieldTransforms;return new il(new fr(s),u,l)}class cl extends el{_toFieldTransform(e){return new Mi(e.path,new Ii)}isEqual(e){return e instanceof cl}}function hl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return dl(n,e.Qu(r?4:3,t))}function dl(e,t){if(pl(e=z(e)))return ml("Unsupported field value:",t,e),fl(e,t);if(e instanceof el)return function(e,t){if(!ol(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=dl(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=z(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ei(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=nn.fromDate(e);return{timestampValue:To(t.serializer,n)}}if(e instanceof nn){const n=new nn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:To(t.serializer,n)}}if(e instanceof tl)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Zu)return{bytesValue:Ao(t.serializer,e._byteString)};if(e instanceof Wu){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Po(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof nl)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return xi(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(Lu(e)))}(e,t)}function fl(e,t){const n={};return Nn(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):On(e,(e,r)=>{const i=dl(r,t.Mu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function pl(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof nn||e instanceof tl||e instanceof Zu||e instanceof Wu||e instanceof el||e instanceof nl)}function ml(e,t,n){if(!pl(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Lu(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function gl(e,t,n){if((t=z(t))instanceof Ju)return t._internalPath;if("string"==typeof t)return yl(e,t);throw bl("Field path arguments must be of type string or ",e,!1,void 0,n)}const vl=new RegExp("[~\\*/\\[\\]]");function yl(e,t,n){if(t.search(vl)>=0)throw bl("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Ju(...t.split("."))._internalPath}catch(Bd){throw bl("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function bl(e,t,n,r,i){const o=r&&!r.isEmpty(),a=void 0!==i;let s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=" in field ".concat(r)),a&&(u+=" in document ".concat(i)),u+=")"),new Vt(Ut.INVALID_ARGUMENT,s+e+u)}function xl(e,t){return e.some(e=>e.isEqual(t))}class wl{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Wu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new El(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_l("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class El extends wl{data(){return super.data()}}function _l(e,t){return"string"==typeof t?yl(e,t):t instanceof Ju?t._internalPath:t._delegate._internalPath}function Sl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Vt(Ut.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kl{}class Cl extends kl{}function Il(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t instanceof kl&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof Ol).length,n=e.filter(e=>e instanceof Tl).length;if(t>1||t>0&&n>0)throw new Vt(Ut.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class Tl extends Cl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Tl(e,t,n)}_apply(e){const t=this._parse(e);return Ml(e._query,t),new Vu(e.firestore,e.converter,$r(e._query,t))}_parse(e){const t=ul(e.firestore),n=function(e,t,n,r,i,o,a){let s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(o,"' queries on documentId()."));if("in"===o||"not-in"===o){Rl(a,o);const t=[];for(const n of a)t.push(Dl(r,e,n));s={arrayValue:{values:t}}}else s=Dl(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Rl(a,o),s=hl(n,t,a,"in"===o||"not-in"===o);return Er.create(i,o,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Al(e,t,n){const r=t,i=_l("where",e);return Tl._create(i,r,n)}class Ol extends kl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ol(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:_r.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Ml(n,i),n=$r(n,i)}(e._query,t),new Vu(e.firestore,e.converter,$r(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Nl extends Cl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Nl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new br(t,n)}(e._query,this._field,this._direction);return new Vu(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Wr(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Pl(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=_l("orderBy",e);return Nl._create(n,t)}function Dl(e,t,n){if("string"==typeof(n=z(n))){if(""===n)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Kr(t)&&-1!==n.indexOf("/"))throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(an.fromString(n));if(!ln.isDocumentKey(r))throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return ir(e,new ln(r))}if(n instanceof Wu)return ir(e,n._key);throw new Vt(Ut.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Lu(n),"."))}function Rl(e,t){if(!Array.isArray(e)||0===e.length)throw new Vt(Ut.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Ml(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Vt(Ut.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Vt(Ut.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class jl{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Lt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return On(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>Vn(e.doubleValue));return new nl(i)}convertGeoPoint(e){return new tl(Vn(e.latitude),Vn(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=qn(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Gn(e));default:return null}}convertTimestamp(e){const t=Un(e);return new nn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=an.fromString(e);Bt(ea(n));const r=new Xn(n.get(1),n.get(3)),i=new ln(n.popFirst(5));return r.isEqual(t)||Mt("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Fl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Ll{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bl extends wl{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new zl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(_l("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class zl extends Bl{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ul{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ll(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new zl(this._firestore,this._userDataWriter,n.key,n,new Ll(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Vt(Ut.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new zl(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ll(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new zl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ll(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:Vl(t.type),doc:r,oldIndex:i,newIndex:o}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Vl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lt()}}class Wl extends jl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wu(this.firestore,null,t)}}function Hl(e){e=Bu(e,Vu);const t=Bu(e.firestore,Yu),n=Qu(t),r=new Wl(t);return Sl(e._query),Pu(n,e._query).then(n=>new Ul(t,r,e,n))}function ql(e,t){const n=Bu(e.firestore,Yu),r=Gu(e),i=Fl(e.converter,t);return Kl(n,[ll(ul(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Fi.exists(!1))]).then(()=>r)}function Gl(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o,a;e=z(e);let s={includeMetadataChanges:!1,source:"default"},u=0;"object"!=typeof n[u]||Xu(n[u])||(s=n[u],u++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Xu(n[u])){const e=n[u];n[u]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[u+1]=null===(o=e.error)||void 0===o?void 0:o.bind(e),n[u+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let c,h,d;if(e instanceof Wu)h=Bu(e.firestore,Yu),d=qr(e._key.path),c={next:t=>{n[u]&&n[u](Xl(h,e,t))},error:n[u+1],complete:n[u+2]};else{const t=Bu(e,Vu);h=Bu(t.firestore,Yu),d=t._query;const r=new Wl(h);c={next:e=>{n[u]&&n[u](new Ul(h,r,t,e))},error:n[u+1],complete:n[u+2]},Sl(e._query)}return function(e,t,n,r){const i=new Su(r),o=new Gs(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Bs(await Nu(e),o)),()=>{i.Za(),e.asyncQueue.enqueueAndForget(async()=>zs(await Nu(e),o))}}(Qu(h),d,l,c)}function Kl(e,t){return function(e,t){const n=new Wt;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=wu(e);try{const e=await function(e,t){const n=zt(e),r=nn.now(),i=t.reduce((e,t)=>e.add(t.key),vi());let o,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let s=ui(),u=vi();return n.cs.getEntries(e,i).next(e=>{s=e,s.forEach((e,t)=>{t.isValidDocument()||(u=u.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,s)).next(i=>{o=i;const a=[];for(const e of t){const t=Wi(e,o.get(e.key).overlayedDocument);null!=t&&a.push(new Gi(e.key,t,pr(t.value.mapValue),Fi.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(o,u);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:hi(o)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new Pn(en)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await vu(r,e.changes),await ys(r.remoteStore)}catch(e){const t=Ps(e,"Failed to persist write");n.reject(t)}}(await Ou(e),t,n)),n.promise}(Qu(e),t)}function Xl(e,t,n){const r=n.docs.get(t._key),i=new Wl(e);return new Bl(e,i,t._key,r,new Ll(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Nt=e}(tt),$e(new U("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const o=e.getProvider("app").getImmediate(),a=new Yu(new Kt(e.getProvider("auth-internal")),new $t(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Vt(Ut.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xn(e.options.projectId,t)}(o,r),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),it(At,"4.7.3",e),it(At,"4.7.3","esm2017")}();it("firebase","10.14.1","app");const Yl="firebasestorage.googleapis.com",Ql="storageBucket";class $l extends R{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(ec(e),"Firebase Storage: ".concat(t," (").concat(ec(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$l.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ec(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var Zl,Jl;function ec(e){return"storage/"+e}function tc(){return new $l(Zl.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function nc(){return new $l(Zl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rc(){return new $l(Zl.CANCELED,"User canceled the upload/download.")}function ic(){return new $l(Zl.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function oc(e){return new $l(Zl.INVALID_ARGUMENT,e)}function ac(){return new $l(Zl.APP_DELETED,"The Firebase app was deleted.")}function sc(e,t){return new $l(Zl.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function uc(e){throw new $l(Zl.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Zl||(Zl={}));class lc{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=lc.makeFromUrl(e,t)}catch(Fd){return new lc(e,"")}if(""===n.path)return n;throw r=e,new $l(Zl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),s=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(a,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(t===Yl?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}];for(let u=0;u<s.length;u++){const t=s[u],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new lc(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new $l(Zl.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class cc{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function hc(e){return"string"===typeof e||e instanceof String}function dc(e){return fc()&&e instanceof Blob}function fc(){return"undefined"!==typeof Blob}function pc(e,t,n,r){if(r<t)throw oc("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw oc("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function mc(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function gc(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function vc(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Jl||(Jl={}));class yc{constructor(e,t,n,r,i,o,a,s,u,l,c){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=s,this.timeout_=u,this.progressCallback_=l,this.connectionFactory_=c,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new bc(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Jl.NO_ERROR,i=n.getStatus();if(!t||vc(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Jl.ABORT;return void e(!1,new bc(!1,null,t))}const o=-1!==this.successCodes_.indexOf(i);e(!0,new bc(o,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(Fd){r(Fd)}else if(null!==i){const e=tc();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?ac():rc())}else{r(nc())}};this.canceled_?t(0,new bc(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,o=null,a=!1,s=0;function u(){return 2===s}let l=!1;function c(){if(!l){l=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout(()=>{i=null,e(f,u())},t)}function d(){o&&clearTimeout(o)}function f(e){if(l)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void c.call(null,e,...n);if(u()||a)return d(),void c.call(null,e,...n);let o;r<64&&(r*=2),1===s?(s=2,o=0):o=1e3*(r+Math.random()),h(o)}let p=!1;function m(e){p||(p=!0,d(),l||(null!==i?(e||(s=2),clearTimeout(i),h(0)):e||(s=1)))}return h(0),o=setTimeout(()=>{a=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class bc{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function xc(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function wc(){const e=xc();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(fc())return new Blob(n);throw new $l(Zl.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function Ec(e){if("undefined"===typeof atob)throw t="base-64",new $l(Zl.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const _c="raw",Sc="base64",kc="base64url",Cc="data_url";class Ic{constructor(e,t){this.data=e,this.contentType=t||null}}function Tc(e,t){switch(e){case _c:return new Ic(Ac(t));case Sc:case kc:return new Ic(Oc(e,t));case Cc:return new Ic(function(e){const t=new Nc(e);return t.base64?Oc(Sc,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(Fd){throw sc(Cc,"Malformed data URL.")}return Ac(t)}(t.rest)}(t),new Nc(t).contentType)}throw tc()}function Ac(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Oc(e,t){switch(e){case Sc:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw sc(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case kc:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw sc(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Ec(t)}catch(Fd){if(Fd.message.includes("polyfill"))throw Fd;throw sc(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Nc{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw sc(Cc,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){const n=e.length>=t.length;if(!n)return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Pc{constructor(e,t){let n=0,r="";dc(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(dc(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new Pc(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Pc(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(fc()){const e=t.map(e=>e instanceof Pc?e.data_:e);return new Pc(wc.apply(null,e))}{const e=t.map(e=>hc(e)?Tc(_c,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let i=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]}),new Pc(r,!0)}}uploadData(){return this.data_}}function Dc(e){let t;try{t=JSON.parse(e)}catch(Fd){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Rc(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Mc(e,t){return t}class jc{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Mc}}let Fc=null;function Lc(){if(Fc)return Fc;const e=[];e.push(new jc("bucket")),e.push(new jc("generation")),e.push(new jc("metageneration")),e.push(new jc("name","fullPath",!0));const t=new jc("name");t.xform=function(e,t){return function(e){return!hc(e)||e.length<2?e:Rc(e)}(t)},e.push(t);const n=new jc("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new jc("timeCreated")),e.push(new jc("updated")),e.push(new jc("md5Hash",null,!0)),e.push(new jc("cacheControl",null,!0)),e.push(new jc("contentDisposition",null,!0)),e.push(new jc("contentEncoding",null,!0)),e.push(new jc("contentLanguage",null,!0)),e.push(new jc("contentType",null,!0)),e.push(new jc("metadata","customMetadata",!0)),Fc=e,Fc}function Bc(e,t,n){const r={type:"file"},i=n.length;for(let o=0;o<i;o++){const e=n[o];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new lc(n,r);return t._makeStorageReference(i)}})}(r,e),r}function zc(e,t,n){const r=Dc(t);if(null===r)return null;return Bc(e,r,n)}function Uc(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Vc{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Wc(e){if(!e)throw tc()}function Hc(e,t){return function(n,r){const i=zc(e,r,t);return Wc(null!==i),i}}function qc(e,t){return function(n,r){const i=zc(e,r,t);return Wc(null!==i),function(e,t,n,r){const i=Dc(t);if(null===i)return null;if(!hc(i.downloadTokens))return null;const o=i.downloadTokens;if(0===o.length)return null;const a=encodeURIComponent,s=o.split(",").map(t=>{const i=e.bucket,o=e.fullPath;return mc("/b/"+a(i)+"/o/"+a(o),n,r)+gc({alt:"media",token:t})});return s[0]}(i,r,e.host,e._protocol)}}function Gc(e){return function(t,n){let r;var i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new $l(Zl.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new $l(Zl.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new $l(Zl.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):r=403===t.getStatus()?function(e){return new $l(Zl.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}(e.path):n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Kc(e){const t=Gc(e);return function(n,r){let i=t(n,r);return 404===n.getStatus()&&(i=function(e){return new $l(Zl.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}(e.path)),i.serverResponse=r.serverResponse,i}}function Xc(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Yc(e,t,n,r,i){const o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};const s=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;const u=Xc(t,r,i),l="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Uc(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",c="\r\n--"+s+"--",h=Pc.getBlob(l,r,c);if(null===h)throw ic();const d={name:u.fullPath},f=mc(o,e.host,e._protocol),p=e.maxUploadRetryTime,m=new Vc(f,"POST",Hc(e,n),p);return m.urlParams=d,m.headers=a,m.body=h.uploadData(),m.errorHandler=Gc(t),m}class Qc{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Jl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Jl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw uc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw uc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw uc("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Fd){return-1}}getResponse(){if(!this.sent_)throw uc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw uc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class $c extends Qc{initXhr(){this.xhr_.responseType="text"}}function Zc(){return new $c}class Jc{constructor(e,t){this._service=e,this._location=t instanceof lc?t:lc.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Jc(e,t)}get root(){const e=new lc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Rc(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new lc(this._location.bucket,e);return new Jc(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new $l(Zl.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function eh(e,t,n){e._throwIfRoot("uploadBytes");const r=Yc(e.storage,e._location,Lc(),new Pc(t,!0),n);return e.storage.makeRequestWithTokens(r,Zc).then(t=>({metadata:t,ref:e}))}function th(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=mc(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,o=new Vc(r,"GET",qc(e,n),i);return o.errorHandler=Kc(t),o}(e.storage,e._location,Lc());return e.storage.makeRequestWithTokens(t,Zc).then(e=>{if(null===e)throw new $l(Zl.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function nh(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new lc(e._location.bucket,n);return new Jc(e.storage,r)}function rh(e,t){if(e instanceof ah){const n=e;if(null==n._bucket)throw new $l(Zl.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ql+"' property when initializing the app?");const r=new Jc(n,n._bucket);return null!=t?rh(r,t):r}return void 0!==t?nh(e,t):e}function ih(e,t){if(t&&function(e){return/^[A-Za-z]+:\/\//.test(e)}(t)){if(e instanceof ah)return new Jc(e,t);throw oc("To use ref(service, url), the first argument must be a Storage instance.")}return rh(e,t)}function oh(e,t){const n=null===t||void 0===t?void 0:t[Ql];return null==n?null:lc.makeFromBucketSpec(n,e)}class ah{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Yl,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?lc.makeFromBucketSpec(r,this._host):oh(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=lc.makeFromBucketSpec(this._url,e):this._bucket=oh(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pc("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pc("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jc(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new cc(ac());{const o=function(e,t,n,r,i,o){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const s=gc(e.urlParams),u=e.url+s,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(l,o),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new yc(u,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const sh="@firebase/storage",uh="0.13.2",lh="storage";function ch(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new ah(r,i,o,n,tt)}$e(new U(lh,ch,"PUBLIC").setMultipleInstances(!0)),it(sh,uh,""),it(sh,uh,"esm2017");const hh="@firebase/installations",dh="0.6.9",fh=1e4,ph="w:".concat(dh),mh="FIS_v2",gh=36e5,vh=new M("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function yh(e){return e instanceof R&&e.code.includes("request-failed")}function bh(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function xh(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function wh(e,t){const n=(await t.json()).error;return vh.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Eh(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function _h(e,t){let{refreshToken:n}=t;const r=Eh(e);return r.append("Authorization",function(e){return"".concat(mh," ").concat(e)}(n)),r}async function Sh(e){const t=await e();return t.status>=500&&t.status<600?e():t}function kh(e){return new Promise(t=>{setTimeout(t,e)})}const Ch=/^[cdef][\w-]{21}$/;function Ih(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=function(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}(e);return t.substr(0,22)}(e);return Ch.test(t)?t:""}catch(by){return""}}function Th(e){return"".concat(e.appName,"!").concat(e.appId)}const Ah=new Map;function Oh(e,t){const n=Th(e);Nh(n,t),function(e,t){const n=Dh();n&&n.postMessage({key:e,fid:t});Rh()}(n,t)}function Nh(e,t){const n=Ah.get(e);if(n)for(const r of n)r(t)}let Ph=null;function Dh(){return!Ph&&"BroadcastChannel"in self&&(Ph=new BroadcastChannel("[Firebase] FID Change"),Ph.onmessage=e=>{Nh(e.data.key,e.data.fid)}),Ph}function Rh(){0===Ah.size&&Ph&&(Ph.close(),Ph=null)}const Mh="firebase-installations-store";let jh=null;function Fh(){return jh||(jh=ce("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Mh)}})),jh}async function Lh(e,t){const n=Th(e),r=(await Fh()).transaction(Mh,"readwrite"),i=r.objectStore(Mh),o=await i.get(n);return await i.put(t,n),await r.done,o&&o.fid===t.fid||Oh(e,t.fid),t}async function Bh(e){const t=Th(e),n=(await Fh()).transaction(Mh,"readwrite");await n.objectStore(Mh).delete(t),await n.done}async function zh(e,t){const n=Th(e),r=(await Fh()).transaction(Mh,"readwrite"),i=r.objectStore(Mh),o=await i.get(n),a=t(o);return void 0===a?await i.delete(n):await i.put(a,n),await r.done,!a||o&&o.fid===a.fid||Oh(e,a.fid),a}async function Uh(e){let t;const n=await zh(e.appConfig,n=>{const r=function(e){const t=e||{fid:Ih(),registrationStatus:0};return Hh(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(vh.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const o=bh(n),a=Eh(n),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const u={fid:i,authVersion:mh,appId:n.appId,sdkVersion:ph},l={method:"POST",headers:a,body:JSON.stringify(u)},c=await Sh(()=>fetch(o,l));if(c.ok){const e=await c.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:xh(e.authToken)}}throw await wh("Create Installation",c)}(e,t);return Lh(e.appConfig,n)}catch(Fd){throw yh(Fd)&&409===Fd.customData.serverCode?await Bh(e.appConfig):await Lh(e.appConfig,{fid:t.fid,registrationStatus:0}),Fd}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Vh(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Vh(e){let t=await Wh(e.appConfig);for(;1===t.registrationStatus;)await kh(100),t=await Wh(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Uh(e);return n||t}return t}function Wh(e){return zh(e,e=>{if(!e)throw vh.create("installation-not-found");return Hh(e)})}function Hh(e){return 1===(t=e).registrationStatus&&t.registrationTime+fh<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function qh(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return"".concat(bh(e),"/").concat(n,"/authTokens:generate")}(n,t),o=_h(n,t),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const s={installation:{sdkVersion:ph,appId:n.appId}},u={method:"POST",headers:o,body:JSON.stringify(s)},l=await Sh(()=>fetch(i,u));if(l.ok){return xh(await l.json())}throw await wh("Generate Auth Token",l)}async function Gh(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await zh(e.appConfig,r=>{if(!Xh(r))throw vh.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+gh}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await Kh(e.appConfig);for(;1===n.authToken.requestStatus;)await kh(100),n=await Kh(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Gh(e,t):r}(e,n),r;{if(!navigator.onLine)throw vh.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await qh(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Lh(e.appConfig,r),n}catch(Fd){if(!yh(Fd)||401!==Fd.customData.serverCode&&404!==Fd.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Lh(e.appConfig,n)}else await Bh(e.appConfig);throw Fd}}(e,n),n}});return t?await t:r.authToken}function Kh(e){return zh(e,e=>{if(!Xh(e))throw vh.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+fh<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n})}function Xh(e){return void 0!==e&&2===e.registrationStatus}async function Yh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Uh(e);t&&await t}(n);return(await Gh(n,t)).token}function Qh(e){return vh.create("missing-app-config-values",{valueName:e})}const $h="installations",Zh=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Qh("App Configuration");if(!e.name)throw Qh("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Qh(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Ze(t,"heartbeat"),_delete:()=>Promise.resolve()}},Jh=e=>{const t=Ze(e.getProvider("app").getImmediate(),$h).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Uh(t);return r?r.catch(console.error):Gh(t).catch(console.error),n.fid}(t),getToken:e=>Yh(t,e)}};$e(new U($h,Zh,"PUBLIC")),$e(new U("installations-internal",Jh,"PRIVATE")),it(hh,dh),it(hh,dh,"esm2017");const ed="analytics",td="https://www.googletagmanager.com/gtag/js",nd=new $("@firebase/analytics"),rd=new M("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function id(e){if(!e.startsWith(td)){const t=rd.create("invalid-gtag-resource",{gtagURL:e});return nd.warn(t.message),""}return e}function od(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function ad(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:id}),r=document.createElement("script"),i="".concat(td,"?l=").concat(e,"&id=").concat(t);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function sd(e,t,n,r){return async function(i){try{for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];if("event"===i){const[r,i]=a;await async function(e,t,n,r,i){try{let o=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await od(n);for(const n of e){const e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){o=[];break}o.push(i)}}0===o.length&&(o=Object.values(t)),await Promise.all(o),e("event",r,i||{})}catch(Fd){nd.error(Fd)}}(e,t,n,r,i)}else if("config"===i){const[i,o]=a;await async function(e,t,n,r,i,o){const a=r[i];try{if(a)await t[a];else{const e=(await od(n)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(Fd){nd.error(Fd)}e("config",i,o)}(e,t,n,r,i,o)}else if("consent"===i){const[t,n]=a;e("consent",t,n)}else if("get"===i){const[t,n,r]=a;e("get",t,n,r)}else if("set"===i){const[t]=a;e("set",t)}else e(i,...a)}catch(Fd){nd.error(Fd)}}}const ud=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function ld(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function cd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ud,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:o}=e.options;if(!r)throw rd.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:r};throw rd.create("no-api-key")}const a=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new dd;return setTimeout(async()=>{s.abort()},void 0!==n?n:6e4),hd({appId:r,apiKey:i,measurementId:o},a,s,t)}async function hd(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ud;var a;const{appId:s,measurementId:u}=e;try{await function(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(o),r(rd.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,r)}catch(Fd){if(u)return nd.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===Fd||void 0===Fd?void 0:Fd.message,"]")),{appId:s,measurementId:u};throw Fd}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:ld(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),a=await fetch(o,i);if(200!==a.status&&304!==a.status){let e="";try{const n=await a.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(s){}throw rd.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()}(e);return o.deleteThrottleMetadata(s),t}catch(Fd){const r=Fd;if(!function(e){if(!(e instanceof R)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(r)){if(o.deleteThrottleMetadata(s),u)return nd.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===r||void 0===r?void 0:r.message,"]")),{appId:s,measurementId:u};throw Fd}const l=503===Number(null===(a=null===r||void 0===r?void 0:r.customData)||void 0===a?void 0:a.httpStatus)?B(i,o.intervalMillis,30):B(i,o.intervalMillis),c={throttleEndTimeMillis:Date.now()+l,backoffCount:i+1};return o.setThrottleMetadata(s,c),nd.debug("Calling attemptFetch again in ".concat(l," millis")),hd(e,c,n,o)}}class dd{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let fd,pd;function md(e){pd=e}function gd(e){fd=e}async function vd(e,t,n,r,i,o,a){var s;const u=cd(e);u.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&nd.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>nd.error(e)),t.push(u);const l=async function(){if(!P())return nd.warn(rd.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await D()}catch(Fd){return nd.warn(rd.create("indexeddb-unavailable",{errorInfo:null===Fd||void 0===Fd?void 0:Fd.toString()}).message),!1}return!0}().then(e=>e?r.getId():void 0),[c,h]=await Promise.all([u,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(td)&&n.src.includes(e))return n;return null})(o)||ad(o,c.measurementId),pd&&(i("consent","default",pd),md(void 0)),i("js",new Date);const d=null!==(s=null===a||void 0===a?void 0:a.config)&&void 0!==s?s:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),i("config",c.measurementId,d),fd&&(i("set",fd),gd(void 0)),c.measurementId}class yd{constructor(e){this.app=e}_delete(){return delete bd[this.app.options.appId],Promise.resolve()}}let bd={},xd=[];const wd={};let Ed,_d,Sd="dataLayer",kd="gtag",Cd=!1;function Id(){const e=[];if(function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),n=rd.create("invalid-analytics-context",{errorInfo:t});nd.warn(n.message)}}function Td(e,t,n){Id();const r=e.options.appId;if(!r)throw rd.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw rd.create("no-api-key");nd.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=bd[r])throw rd.create("already-exists",{id:r});if(!Cd){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Sd);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(o=window[i]),window[i]=sd(o,e,t,n),{gtagCore:o,wrappedGtag:window[i]}}(bd,xd,wd,Sd,kd);_d=e,Ed=t,Cd=!0}bd[r]=vd(e,xd,wd,t,Ed,Sd,n);return new yd(e)}function Ad(e,t,n,r){e=z(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(_d,bd[e.app.options.appId],t,n,r).catch(e=>nd.error(e))}const Od="@firebase/analytics",Nd="0.10.8";$e(new U(ed,(e,t)=>{let{options:n}=t;return Td(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),$e(new U("analytics-internal",function(e){try{const t=e.getProvider(ed).getImmediate();return{logEvent:(e,n,r)=>Ad(t,e,n,r)}}catch(Fd){throw rd.create("interop-component-reg-failed",{reason:Fd})}},"PRIVATE")),it(Od,Nd),it(Od,Nd,"esm2017");const Pd=nt({apiKey:"AIzaSyBniaY78773XHdE0g52tP0rPAeab0mZGGU",authDomain:"tiewson-eceee.firebaseapp.com",projectId:"tiewson-eceee",storageBucket:"tiewson-eceee.firebasestorage.app",messagingSenderId:"475652146978",appId:"1:475652146978:web:29f605312bd482e3d8877b",measurementId:"G-6WP7J32GMS"}),Dd=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt();e=z(e);const t=Ze(e,ed);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Ze(e,ed);if(n.isInitialized()){const e=n.getImmediate();if(F(t,n.getOptions()))return e;throw rd.create("already-initialized")}const r=n.initialize({options:t})}(e)}(Pd),function(e,t){const n="string"==typeof e?e:t||"(default)",r=Ze("object"==typeof e?e:rt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=C("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const o=(e=Bu(e,Uu))._getSettings(),a="".concat(t,":").concat(n);if("firestore.googleapis.com"!==o.host&&o.host!==a&&jt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ot.MOCK_USER;else{t=A(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new Vt(Ut.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ot(o)}e._authCredentials=new Gt(new Ht(t,n))}}(r,...e)}return r}(Pd)),Rd=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt(),t=arguments.length>1?arguments[1]:void 0;e=z(e);const n=Ze(e,lh).getImmediate({identifier:t}),r=C("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:A(i,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}(Pd),Md=(qu(Dd,"advertisements"),e=>{let{language:n}=e;const[r,i]=(0,t.useState)([]),[o,a]=(0,t.useState)(0),s=(0,t.useRef)(null);(0,t.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=Il(qu(Dd,"news"),Pl("createdAt","desc")),t=(await Hl(e)).docs.map(e=>l({id:e.id},e.data()));i(t)}catch(e){console.error("Error fetching news:",e)}};(0,t.useEffect)(()=>{if(0===r.length)return;const e=setInterval(()=>{a(e=>(e+1)%r.length)},5e3);return()=>clearInterval(e)},[r.length]);const c=(e,t)=>{var n,r;if(!e||!e.includes("drive.google.com"))return e;const i=(null===(n=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/))||void 0===n?void 0:n[1])||(null===(r=e.match(/[?&]id=([a-zA-Z0-9_-]+)/))||void 0===r?void 0:r[1]);return i?"video"===t?"https://drive.google.com/file/d/".concat(i,"/preview"):"https://drive.google.com/thumbnail?sz=w1000&id=".concat(i):e},h=e=>"th"===n?e.titleTh||e.title:"en"===n?e.titleEn||e.title:"zh"===n?e.titleZh||e.titleEn||e.title:"ko"===n&&(e.titleKo||e.titleEn)||e.title,d=e=>"th"===n?e.descriptionTh||e.description:"en"===n?e.descriptionEn||e.description:"zh"===n?e.descriptionZh||e.descriptionEn||e.description:"ko"===n&&(e.descriptionKo||e.descriptionEn)||e.description;return 0===r.length?(0,v.jsx)("div",{className:"fixed inset-0 bg-slate-900 flex items-center justify-center",children:(0,v.jsx)("div",{className:"text-white text-4xl font-bold animate-pulse",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23...":"Loading News..."})}):(0,v.jsxs)("div",{className:"fixed inset-0 overflow-hidden bg-black",children:[(0,v.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-30 p-8 flex items-center gap-6",children:[(0,v.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/70 to-transparent -z-10 h-40"}),(0,v.jsxs)("div",{className:"text-white ml-32",children:[(0,v.jsx)("h2",{className:"text-4xl font-black drop-shadow-2xl tracking-tight",children:"\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32 \u0e40\u0e0a\u0e35\u0e22\u0e07\u0e43\u0e2b\u0e21\u0e48"}),(0,v.jsx)("p",{className:"text-xl text-white/80 font-medium drop-shadow-lg uppercase tracking-wider",children:"Lanna Polytechnic Chiangmai Technological College"})]})]}),(0,v.jsx)("div",{ref:s,className:"flex h-full transition-transform duration-1000 ease-in-out",style:{transform:"translateX(-".concat(100*o,"%)")},children:r.map((e,t)=>(0,v.jsxs)("div",{className:"min-w-full h-full relative flex items-center justify-center",children:[(0,v.jsxs)("div",{className:"absolute inset-0",children:["video"===e.mediaType?(0,v.jsx)("iframe",{src:c(e.mediaUrl,"video"),className:"w-full h-full object-contain",allow:"autoplay",title:h(e)}):(0,v.jsx)("img",{src:c(e.mediaUrl,"image"),alt:h(e),className:"w-full h-full object-contain"}),(0,v.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent"})]}),(0,v.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto px-12 text-white mt-40 text-left w-full",children:[(0,v.jsx)("h1",{className:"text-7xl font-black mb-8 drop-shadow-2xl leading-tight tracking-tighter",children:h(e)}),(0,v.jsx)("p",{className:"text-3xl leading-relaxed drop-shadow-lg line-clamp-3 text-white/90 font-light",children:d(e)})]})]},e.id))}),(0,v.jsx)("div",{className:"fixed bottom-16 right-16 z-50",children:(0,v.jsx)("div",{className:"relative w-28 h-28",children:(0,v.jsx)("img",{src:"/tiwson-avatar.png",className:"w-full h-full object-contain drop-shadow-2xl",alt:"Avatar",onError:e=>{e.target.src="https://via.placeholder.com/150"}})})}),(0,v.jsx)("div",{className:"absolute bottom-16 left-1/2 transform -translate-x-1/2 flex gap-4 z-20",children:r.map((e,t)=>(0,v.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(t===o?"w-24 bg-blue-500":"w-4 bg-white/30")},t))})]})});var jd=function(e,t){return(jd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Fd(e,t){function n(){this.constructor=e}jd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Ld(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function Bd(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var zd=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,t[0],t[1]),t.join("=")}),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach(function(t){var n=t.split(":"),r=n[0],i=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,i)})}},e}();function Ud(){return Vd}var Vd=null,Wd=new Map,Hd=new Map;function qd(e,t){var n=Yd(e,t);return Wd.get(n)}function Gd(e){for(var t=Wd.entries(),n=[];;){var r=t.next(),i=r.done,o=r.value;if(i)break;var a=o[0],s=o[1];a.split("_")[0]===e&&n.push(s)}return n}function Kd(e){var t=e.kernelName,n=e.backendName,r=Yd(t,n);if(Wd.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Wd.set(r,e)}function Xd(e){var t=e.kernelName;Hd.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Hd.set(t,e)}function Yd(e,t){return t+"_"+e}function Qd(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function $d(e,t,n){return Math.max(e,Math.min(t,n))}function Zd(e){return e%2==0?e:e+1}function Jd(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function ef(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function tf(e,t,n){void 0===n&&(n=""),ef(af(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function nf(e){ef(null!=e,function(){return"The input to the tensor constructor must be a non-null value."})}function rf(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||xf(e)&&!n)for(var r=0;r<e.length;++r)rf(e[r],t,n);else t.push(e);return t}function of(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function af(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function sf(e){return e%1==0}function uf(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function lf(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function cf(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function hf(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise(function(r,i){var o=0,a=function(){if(e())r();else{o++;var s=t(o);null!=n&&o>=n?i():setTimeout(a,s)}};a()})}function df(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var o=e.slice();return o[r]=t/n,o}function ff(e,t){var n=t.length;return ef((e=null==e?t.map(function(e,t){return t}):[].concat(e)).every(function(e){return e>=-n&&e<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),ef(e.every(function(e){return sf(e)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(e){return e<0?n+e:e})}function pf(e,t){for(var n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:ff(t,e).sort(),a=0,s=0;s<e.length;++s){if(null!=o){if(o[a]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==o[a]||o[a]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),o[a]<=s&&a++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function mf(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function gf(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function vf(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function yf(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function bf(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function xf(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function wf(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function Ef(e){if(null==e)return 0;var t=0;return e.forEach(function(e){return t+=e.length}),t}function _f(e){return"string"==typeof e||e instanceof String}function Sf(e){return"boolean"==typeof e}function kf(e){return"number"==typeof e}function Cf(e){return Array.isArray(e)?Cf(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":kf(e)?"float32":_f(e)?"string":Sf(e)?"bool":"float32"}function If(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Tf(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Af(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Of(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=rf(e)),n&&vf(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)0!==Math.round(e[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function Nf(e,t){if(0===e.length)return t[0];var n=e.reduce(function(e,t){return e*t});if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var i=new Array;if(1===n.length)for(var o=n[0],a=0;a<o;a++)i[a]=r[t+a];else{o=n[0];var s=n.slice(1),u=s.reduce(function(e,t){return e*t});for(a=0;a<o;a++)i[a]=e(t+a*u,s,r)}return i}(0,e,t)}function Pf(e,t){for(var n=Df(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Df(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Rf(){return Ud().platform.now()}function Mf(e){e.forEach(function(t){ef(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function jf(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",Ud().platform.encode(e,t)}function Ff(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",Ud().platform.decode(e,t)}function Lf(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function Bf(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}Object.freeze({shuffle:Qd,clamp:$d,nearestLargerEven:Zd,sum:Jd,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:ef,assertShapesMatch:tf,assertNonNull:nf,flatten:rf,sizeFromShape:of,isScalarShape:function(e){return 0===e.length},arraysEqual:af,isInt:sf,tanh:uf,sizeToSquarishShape:lf,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return Qd(t),t},rightPad:cf,repeatedTry:hf,inferFromImplicitShape:df,parseAxisParam:ff,squeezeShape:pf,getTypedArrayFromDType:mf,getArrayFromDType:gf,checkConversionForErrors:vf,isValidDtype:yf,hasEncodingLoss:bf,isTypedArray:xf,bytesPerElement:wf,bytesFromStringArray:Ef,isString:_f,isBoolean:Sf,isNumber:kf,inferDtype:Cf,isFunction:If,nearestDivisor:Tf,computeStrides:Af,toTypedArray:Of,toNestedArray:Nf,makeOnesTypedArray:Pf,makeZerosTypedArray:Df,now:Rf,assertNonNegativeIntegerDimensions:Mf,fetch:function(e,t){return Ud().platform.fetch(e,t)},encodeString:jf,decodeString:Ff,locToIndex:Lf,indexToLoc:Bf});var zf=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Uf)}return e.prototype.profileKernel=function(e,t,n){var r,i=this,o=this.backendTimer.time(function(){r=n()});return r.forEach(function(n){n.data().then(function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),o.then(function(o){var a="";null!=o.getExtraProfileInfo&&(a=o.getExtraProfileInfo()),i.logger.logKernelProfile(e,n,r,o.kernelMs,t,a)})})}),r},e}(),Uf=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,i,o){var a="number"==typeof r?cf(r+"ms",9):r.error,s=cf(e,25),u=t.rank,l=t.size,c=cf(t.shape.toString(),14),h="";for(var d in i){var f=i[d].shape||t.shape,p=f.length;h+=d+": "+p+"D "+(p>0?f:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+c+"\t%c"+l+"\t%c"+h+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function Vf(e,t,n){return cf(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":_f(e)?"'"+e+"'":"bool"===n?Wf(e):parseFloat(e.toFixed(7)).toString(),t)}function Wf(e){return 0===e?"false":"true"}function Hf(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var qf=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=of(e),null!=n){var i=n.length;ef(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."})}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||gf(t,this.size),this.strides=Af(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),ef(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"});var i=this.locToIndex(n);this.values[i]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,i=e;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Gf().makeTensor(this.values,this.shape,this.dtype)},e}(),Gf=null,Kf=null,Xf=null,Yf=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=of(e),this.strides=Af(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),ef(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),this.reshape([e,t,n,r,i])},e.prototype.asType=function(e){return this.throwIfDisposed(),Kf.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Kf.buffer(this.shape,this.dtype,e)]}})})},e.prototype.bufferSync=function(){return Kf.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Nf(this.shape,e)]}})})},e.prototype.arraySync=function(){return Nf(this.shape,this.dataSync())},e.prototype.data=function(){return Ld(this,void 0,void 0,function(){var e,t;return Bd(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=Gf().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(e){return Ff(e)})]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}case 2:return[2,e]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var e=Gf().readSync(this.dataId);if("string"===this.dtype)try{return e.map(function(e){return Ff(e)})}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,Gf().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Gf().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),Kf.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),Kf.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),Kf.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),Kf.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),Kf.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),Kf.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),Kf.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var i=Af(t),o=function(e,t,n,r){var i=of(t),o=r[r.length-1],a=new Array(o).fill(0),s=t.length,u="complex64"===n?Hf(e):e;if(s>1)for(var l=0;l<i/o;l++)for(var c=l*o,h=0;h<o;h++)a[h]=Math.max(a[h],Vf(u[c+h],0,n).length);return a}(e,t,n,i),a=t.length,s=function e(t,n,r,i,o,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[Vf(Hf(t)[0],0,r)]:"bool"===r?[Wf(t[0])]:[t[0].toString()];if(1===l){if(u>20){var c=3*s,h=Array.from(t.slice(0,c)),d=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(h=Hf(h),d=Hf(d)),["["+h.map(function(e,t){return Vf(e,o[t],r)}).join(", ")+", ..., "+d.map(function(e,t){return Vf(e,o[u-3+t],r)}).join(", ")+"]"]}return["["+("complex64"===r?Hf(t):Array.from(t)).map(function(e,t){return Vf(e,o[t],r)}).join(", ")+"]"]}var f=n.slice(1),p=i.slice(1),m=i[0]*s,g=[];if(u>20){for(var v=0;v<3;v++){var y=(b=v*m)+m;g.push.apply(g,e(t.slice(b,y),f,r,p,o,!1))}for(g.push("..."),v=u-3;v<u;v++)y=(b=v*m)+m,g.push.apply(g,e(t.slice(b,y),f,r,p,o,v===u-1))}else for(v=0;v<u;v++){var b;y=(b=v*m)+m,g.push.apply(g,e(t.slice(b,y),f,r,p,o,v===u-1))}var x=2===l?",":"";for(g[0]="["+g[0]+x,v=1;v<g.length-1;v++)g[v]=" "+g[v]+x;var w=",\n";for(v=2;v<l;v++)w+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(a?"":w),g}(e,t,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(e){return"    "+e}).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),Kf.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),Kf.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),Kf.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),Kf.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),Kf.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),Kf.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),Kf.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Kf.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),Kf.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),Kf.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),Kf.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),Kf.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,i){return void 0===n&&(n=.001),Xf("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,i,r,n)},e.prototype.batchNorm=function(e,t,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),Kf.batchNorm(this,e,t,n,r,i)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Kf.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),Kf.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),Kf.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),Kf.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),Kf.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),Kf.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),Kf.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),Kf.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),Kf.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),Kf.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),Kf.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),Kf.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),Kf.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),Kf.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),Kf.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),Kf.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),Kf.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),Kf.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),Kf.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),Kf.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),Kf.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),Kf.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),Kf.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Kf.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),Kf.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),Kf.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Kf.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),Kf.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),Kf.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),Kf.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),Kf.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),Kf.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),Kf.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),Kf.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),Kf.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),Kf.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),Kf.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Kf.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),Kf.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Kf.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),Kf.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),Kf.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),Kf.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Kf.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Kf.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Kf.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Kf.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Kf.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Kf.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Kf.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Kf.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Kf.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Kf.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Kf.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Kf.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Kf.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Kf.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Kf.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Kf.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),Kf.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Kf.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Kf.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Kf.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),Kf.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),Kf.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Kf.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Kf.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Kf.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Kf.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Kf.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Kf.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Kf.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Kf.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Kf.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Kf.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Kf.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Kf.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Kf.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Kf.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Kf.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Kf.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Kf.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Kf.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Kf.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),Kf.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),Kf.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),Kf.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),Kf.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),Kf.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),Kf.conv1d(this,e,t,n,r,i,o)},e.prototype.conv2d=function(e,t,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),Kf.conv2d(this,e,t,n,r,i,o)},e.prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),Kf.conv2dTranspose(this,e,t,n,r,i)},e.prototype.depthwiseConv2D=function(e,t,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),Kf.depthwiseConv2d(this,e,t,n,r,i,o)},e.prototype.separableConv2d=function(e,t,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),Kf.separableConv2d(this,e,t,n,r,i,o)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Kf.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Kf.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),Kf.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,i){return this.throwIfDisposed(),Kf.pool(this,e,t,n,r,i)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),Gf().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Kf.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Kf.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Kf.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),Kf.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,i,o,a,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),Kf.stridedSlice(this,e,t,n,r,i,o,a,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Kf.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),Kf.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Kf.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Kf.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Kf.spectral.irfft(this)},e}();Object.defineProperty(Yf,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var Qf,$f,Zf,Jf,ep,tp=function(e){function t(t,n,r,i){var o=e.call(this,t.shape,t.dtype,t.dataId,i)||this;return o.trainable=n,o.name=r,o}return Fd(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!af(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Gf().disposeTensor(this),this.dataId=e.dataId,Gf().incRef(this,null)},t.prototype.dispose=function(){Gf().disposeVariable(this),this.isDisposedInternal=!0},t}(Yf);Object.defineProperty(tp,Symbol.hasInstance,{value:function(e){return e instanceof Yf&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Qf||(Qf={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}($f||($f={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Zf||(Zf={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Jf||(Jf={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(ep||(ep={}));var np={float32:Jf,int32:$f,bool:Zf,complex64:ep};function rp(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return np[e][t]}function ip(e){return rp(e,"int32")}function op(e,t){if(e.dtype===t.dtype)return[e,t];var n=rp(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ap(e,t){ef(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function sp(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof Yf)n.push(t);else if(i=t,Array.isArray(i)||"object"==typeof i){var i,o=t;for(var a in o){var s=o[a];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:op,assertTypesMatch:ap,isTensorInList:function(e,t){return t.some(function(t){return t.id===e.id})},getTensorsInContainer:sp});var up,lp=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),cp=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new lp}return e.prototype.ready=function(){return Ld(this,void 0,void 0,function(){var e,t,n;return Bd(this,function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return Ld(this,void 0,void 0,function(){var t,n,r;return Bd(this,function(i){switch(i.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new zf(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var e=this;Gd(this.backendName).forEach(function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)})},e.prototype.disposeRegisteredKernels=function(e){var t=this;Gd(e).forEach(function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])})},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then(function(n){return!(i<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)}).catch(function(n){return!(i<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),i=r.success,o=r.asyncInit;if(o||i)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,i=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return r.startScope(i)},function(){return r.endScope(n)},function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],function(e){return{x:function(){return e.toFloat()}}},[]),t},e.prototype.runKernel=function(e,t,n,r,i){return this.runKernelFunc(null,t,null,e,n,r,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),i=0;n.forEach(function(e){i+="complex64"===e.dtype?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-i-o;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,i,o,a){var s,u=this;void 0===o&&(o=[]),void 0===a&&(a=[]);var l=[],c=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,d=function(e){c&&(l=e.map(function(e){return u.keep(u.clone(e))}))},f=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,g=qd(r,this.backendName);return h=null!=g?function(){var e=u.backend.numDataIds();m=g.kernelFunc({inputs:t,attrs:i,backend:u.backend});var n=Array.isArray(m)?m:[m];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map(function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)}),l=s.filter(function(e,t){return a[t]});return d((o||[]).slice().concat(l)),s}:function(){var t=u.backend.numDataIds();m=u.tidy(function(){return e(u.backend,d)});var n=Array.isArray(m)?m:[m];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n},this.scopedRun(function(){return u.state.kernelDepth++},function(){return u.state.kernelDepth--},function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,function(){return h()}):h()}),c&&this.addTapeNode(r,t,s,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(e){return t[e].shape}),outputShapes:s.map(function(e){return e.shape})}),Array.isArray(m)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=e;"string"===n&&_f(e[0])&&(i=e.map(function(e){return jf(e)}));var o=r.write(i,t,n),a=new Yf(t,n,o,this.nextTensorId());if(this.incRef(a,r),"string"===n){var s=this.state.tensorInfo.get(o),u=Ef(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return a},e.prototype.makeTensorFromDataId=function(e,t,n,r){var i=new Yf(t,n=n||"float32",e,this.nextTensorId());return this.incRef(i,r),i},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var i=new tp(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*wf(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof tp||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return Ld(this,void 0,void 0,function(){var t,n;return Bd(this,function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(e){return e.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,i){var o=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},s=function(e){return Hd.get(e)}(e);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=function(e){return e=e.map(function(e,t){if(null==e){var r=n[t],i=Df(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return e}),r(e.length>1?e:e[0],i)}),this.state.activeTape.push(a)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=sp(e),r=new Set(n.map(function(e){return e.id})),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(e){e.kept||e.scopeId!==a.id||t.track(e)})},e.prototype.gradients=function(e,t,n,r){var i=this;if(void 0===r&&(r=!1),ef(t.length>0,function(){return"gradients() received an empty list of xs."}),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});ef(o instanceof Yf,function(){return"The result y returned by f() must be a tensor."});var a=function(e,t,n){for(var r={},i={},o=0;o<t.length;o++)r[t[o].id]=!0;for(o=0;o<e.length;o++){var a=(p=e[o]).inputs;for(var s in a){for(var u=a[s],l=!1,c=0;c<t.length;c++)if(r[u.id]){p.outputs.forEach(function(e){return r[e.id]=!0}),l=!0,i[p.id]=!0;break}if(l)break}}var h={};h[n.id]=!0;var d={};for(o=e.length-1;o>=0;o--)for(a=(p=e[o]).inputs,c=0;c<p.outputs.length;c++)if(h[p.outputs[c].id]){for(var s in a)h[a[s].id]=!0,d[p.id]=!0;break}var f=[];for(o=0;o<e.length;o++){var p;if(i[(p=e[o]).id]&&d[p.id]){var m={};for(var s in p.inputs){var g=p.inputs[s];r[g.id]&&(m[s]=g)}var v=Object.assign({},p);v.inputs=m,v.outputs=p.outputs,f.push(v)}}return f}(this.state.activeTape,t,o);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var e,r,s={};s[o.id]=null==n?(r=Pf(of(e=o.shape),"float32"),hp.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var i=t[r],o=[];if(i.outputs.forEach(function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.kernelName+".");var a=i.gradient(o),s=function(t){if(!(t in a))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(a)+".");var r=n(function(){return a[t]()});if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[t];if(!af(r.shape,o.shape))throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==e[o.id])e[o.id]=r;else{var s=e[o.id];e[o.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=t.length-1;i>=0;i--)r(i)}(s,a,function(e){return i.tidy(e)});var u=t.map(function(e){return s[e.id]});return 0===i.state.gradientDepth&&(i.state.activeTape.forEach(function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()}),i.state.activeTape=null),{value:o,grads:u}})},e.prototype.customGrad=function(e){var t=this;return ef(If(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];ef(r.every(function(e){return e instanceof Yf}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return r.forEach(function(e,t){o[t]=e}),t.runKernelFunc(function(t,i){return ef((n=e.apply(void 0,r.concat([i]))).value instanceof Yf,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),ef(If(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},o,function(e,t){var i=n.gradFunc(e,t),o=Array.isArray(i)?i:[i];ef(o.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),ef(o.every(function(e){return e instanceof Yf}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var a={};return o.forEach(function(e,t){a[t]=function(){return e}}),a})}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return Ld(this,void 0,void 0,function(){var t,n;return Bd(this,function(r){switch(r.label){case 0:return t=Rf(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=Rf()-t,[2,n]}})})},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new lp,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),hp=function(){var e=function(){if(null==up){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}up=e}return up}();if(null==e._tfengine){var t=new zd(e);e._tfengine=new cp(t)}return function(e){Vd=e}(e._tfengine.ENV),Gf=function(){return e._tfengine},e._tfengine}();function dp(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var fp=Ud();fp.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),fp.registerFlag("IS_BROWSER",function(){return dp()}),fp.registerFlag("IS_NODE",function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}),fp.registerFlag("IS_CHROME",function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),fp.registerFlag("PROD",function(){return!1}),fp.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return fp.getBool("DEBUG")}),fp.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),fp.registerFlag("IS_TEST",function(){return!1});var pp,mp,gp,vp={},yp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function bp(e,t){vp[e]=t}function xp(e){e in vp||(vp[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",function(t){t.preventDefault(),delete vp[e]},!1),1===e?t.getContext("webgl",yp)||t.getContext("experimental-webgl",yp):t.getContext("webgl2",yp)}(e));var t=vp[e];return t.isContextLost()?(delete vp[e],xp(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),vp[e])}function wp(e,t){return[t,e]}function Ep(e){var t=of(e);return lf(Math.ceil(t/4))}function _p(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Sp(e,t){var n,r,i,o,a,s,u,l,c,h=e;return 2===Ud().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,o=h.RGBA32F,a=h.RED,s=4,u=1,l=h.HALF_FLOAT,c=h.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,o=h.RGBA,a=e.RGBA,s=4,u=4,l=null!=t?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function kp(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Ip(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(pp||(pp={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(mp||(mp={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(gp||(gp={}));function Cp(e){return!!(Ud().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Ip(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Tp(e,t,n){return $p(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function Ap(e,t,n){var r=$p(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(kp(e,t,function(){return e.shaderSource(r,n)}),kp(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Op(e,t,n){var r=$p(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(kp(e,t,function(){return e.shaderSource(r,n)}),kp(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=Dp.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],i=e.split("\n"),o=i.length.toString().length+2,a=i.map(function(e,t){return cf((t+1).toString(),o)+e}),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var l=a.slice(0,r-1),c=a.slice(r-1,r),h=a.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+cf(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Np,Pp,Dp=/ERROR: [0-9]+:([0-9]+):/g;function Rp(e,t){return $p(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function Mp(e,t,n){if(kp(e,t,function(){return e.linkProgram(n)}),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function jp(e,t,n){if(kp(e,t,function(){return e.validateProgram(n)}),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Fp(e,t,n){var r=$p(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return kp(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),kp(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function Lp(e,t,n){var r=$p(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return kp(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),kp(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function Bp(e,t){return $p(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function zp(e,t){var n=Ud().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function Up(e,t){return $p(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Vp(e,t,n,r,i,o,a,s){var u=e.getAttribLocation(n,r);return-1!==u&&(kp(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),kp(e,t,function(){return e.vertexAttribPointer(u,o,e.FLOAT,!1,a,s)}),kp(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function Wp(e,t,n,r){Zp(e,r),kp(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function Hp(e,t,n,r){return $p(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function qp(e,t,n){return e.getUniformLocation(t,n)}function Gp(e,t,n,r,i,o){kp(e,t,function(){return Wp(e,t,r,o)}),kp(e,t,function(){return e.uniform1i(i,o)})}function Kp(e,t,n,r){kp(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),kp(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function Xp(e,t,n){kp(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),kp(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Yp(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Qp(e,t))}function Qp(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function $p(e,t,n,r){var i=kp(e,t,function(){return n()});if(null==i)throw new Error(r);return i}function Zp(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Jp(e,t){return void 0===t&&(t=2),of(e.slice(0,e.length-t))}function em(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function tm(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Jp(e)].concat(em(e))),t}function nm(e,t){var n;void 0===t&&(t=!1);var r=Ud().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map(function(t,n){return n>=e.length-2?Zd(e[n]):e[n]})).length&&(e=[2,e[0]])),2!==e.length){var i=pf(e);e=i.newShape}var o=of(e);if(e.length<=1&&o<=r)return[1,o];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Jp(e),s=2,u=2;return e.length&&(s=(n=em(e))[0],u=n[1]),lf(o=a*(s/2)*(u/2)).map(function(e){return 2*e})}return lf(o)}function rm(e){return e%2==0}function im(e,t){if(af(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(rm(n)&&rm(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&rm(e[0])&&rm(t[0])}function om(e){if(null==Np){var t=xp(e);Np=t.getParameter(t.MAX_TEXTURE_SIZE)}return Np}function am(e){if(null==Pp){var t=xp(e);Pp=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Pp)}function sm(e){if(0===e)return 0;var t=xp(e);return um(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:um(t,"EXT_disjoint_timer_query")?1:0}function um(e,t){return null!=e.getExtension(t)}function lm(e){try{if(null!=xp(e))return!0}catch(e){return!1}return!1}function cm(e){if(0===e)return!1;var t=xp(e);if(1===e){if(!um(t,"OES_texture_float"))return!1}else if(!um(t,"EXT_color_buffer_float"))return!1;return dm(t)}function hm(e){if(0===e)return!1;var t=xp(e);if(1!==e){if(um(t,"EXT_color_buffer_float"))return dm(t);if(um(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=Sp(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),o}(t,n)}return!1}return!!um(t,"OES_texture_float")&&!!um(t,"WEBGL_color_buffer_float")&&dm(t)}function dm(e){var t=Sp(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function fm(e){return 2===e&&null!=xp(e).fenceSync}var pm=Object.freeze({callAndCheck:kp,canBeRepresented:Cp,getWebGLErrorMessage:Ip,getExtensionOrThrow:Tp,createVertexShader:Ap,createFragmentShader:Op,createProgram:Rp,linkProgram:Mp,validateProgram:jp,createStaticVertexBuffer:Fp,createStaticIndexBuffer:Lp,getNumChannels:function(){return 2===Ud().getNumber("WEBGL_VERSION")?1:4},createTexture:Bp,validateTextureSize:zp,createFramebuffer:Up,bindVertexBufferToProgramAttribute:Vp,bindTextureUnit:Wp,unbindTextureUnit:function(e,t,n){Zp(e,n),kp(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:Hp,getProgramUniformLocation:qp,bindTextureToProgramUniformSampler:Gp,bindCanvasToFramebuffer:function(e,t){kp(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),kp(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),kp(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:Kp,unbindColorTextureFromFramebuffer:Xp,validateFramebuffer:Yp,getFramebufferErrorMessage:Qp,getBatchDim:Jp,getRowsCols:em,getShapeAs3D:tm,getTextureShapeFromLogicalShape:nm,isReshapeFree:im,getWebGLMaxTextureSize:om,resetMaxTextureSize:function(){Np=null},resetMaxTexturesInShader:function(){Pp=null},getMaxTexturesInShader:am,getWebGLDisjointQueryTimerVersion:sm,hasExtension:um,isWebGLVersionEnabled:lm,isCapableOfRenderingToFloatTexture:cm,isDownloadFloatTextureEnabled:hm,isWebGLFenceEnabled:fm}),mm=Ud();function gm(e){Ud().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function vm(e,t){return hp.tidy(e,t)}function ym(e){sp(e).forEach(function(e){return e.dispose()})}function bm(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ud().getBool("IS_TEST")||console.warn.apply(console,e)}function xm(e,t){var n=e;if(xf(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||xf(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Ud().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||xf(t)){ef(n.length>0,function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"}),ef(t.length===n[0],function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"});for(var i=n.slice(1),o=0;o<t.length;++o)e(t[o],i,r.concat(o))}else ef(0===n.length,function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"})}(e,r,[]),r}function wm(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function Em(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof Yf)return wm(r,e.dtype,t,n),e;var i=Cf(e);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),wm(r,i,t,n),null==e||!xf(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var o=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+o+"'")}var a=xm(e,i);xf(e)||Array.isArray(e)||(e=[e]);var s="string"!==i?Of(e,i,Ud().getBool("DEBUG")):rf(e,[],!0);return hp.makeTensor(s,a,i)}function _m(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(e,r){return Em(e,t+"["+r+"]",n)},r)}function Sm(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function km(e,t,n){for(var r=e.length+t.length,i=[],o=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(e[o++]):i.push(t[a++]);return i}function Cm(e,t){for(var n=[],r=e.length,i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map(function(t){return e[t]})]}function Im(e,t){return km(e,t.map(function(e){return 1}),t)}function Tm(e,t,n){ef(Sm(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Am(e,t){if(Sm(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(function(e){return n.push(e)}),n}function Om(e){return e.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function Nm(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function Pm(e,t){var n=e[0].length;e.forEach(function(e,t){ef(e.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"})}),ef(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(e,i){for(var o=0;o<n;o++)ef(o===t||e[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Dm(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Rm(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];hp.startScope(n);try{var i=r.apply(void 0,e);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),hp.endScope(i),i}catch(e){throw hp.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}mm.registerFlag("HAS_WEBGL",function(){return mm.getNumber("WEBGL_VERSION")>0}),mm.registerFlag("WEBGL_VERSION",function(){return lm(2)?2:lm(1)?1:0}),mm.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===mm.get("WEBGL_VERSION")}),mm.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),mm.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),mm.registerFlag("WEBGL_PACK",function(){return mm.getBool("HAS_WEBGL")}),mm.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_CLIP",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),mm.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_PACK_REDUCE",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_LAZILY_UNPACK",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_CONV_IM2COL",function(){return mm.getBool("WEBGL_PACK")}),mm.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return om(mm.getNumber("WEBGL_VERSION"))}),mm.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return am(mm.getNumber("WEBGL_VERSION"))}),mm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=mm.getNumber("WEBGL_VERSION");return 0===e?0:sm(e)}),mm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return mm.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),mm.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return cm(mm.getNumber("WEBGL_VERSION"))}),mm.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!mm.getBool("WEBGL_FORCE_F16_TEXTURES")&&mm.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),mm.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return hm(mm.getNumber("WEBGL_VERSION"))}),mm.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return fm(mm.getNumber("WEBGL_VERSION"))}),mm.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return mm.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Xf=gm;var Mm=Rm({complex_:function(e,t){var n=Em(e,"real","complex"),r=Em(t,"imag","complex");return tf(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),hp.runKernelFunc(function(e){return e.complex(n,r)},{$real:n,$imag:r})}}),jm=Rm({real_:function(e){var t=Em(e,"input","real");return hp.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),Fm=Rm({imag_:function(e){var t=Em(e,"input","imag");return hp.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function Lm(e,t,n){return Bm(e,t,xm(e,n),n)}function Bm(e,t,n,r){if(null==r&&(r=Cf(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!xf(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Mf(t);var i=of(t),o=of(n);ef(i===o,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+o});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==of(t.slice(a));ef(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return xf(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Of(e,r,Ud().getBool("DEBUG")):rf(e,[],!0),hp.makeTensor(e,t,r)}function zm(e,t){if((xf(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&xf(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Bm(e,[],[],t)}function Um(e,t){nf(e);var n=xm(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Bm(e,null,n,t)}function Vm(e,t,n){if(nf(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=xm(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Bm(e,t,r,n)}function Wm(e,t,n){if(nf(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=xm(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)}function Hm(e,t,n){if(nf(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=xm(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)}function qm(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=qm(e,"float32"),r=Gm(e,"float32");return Mm(n,r)}var i=Pf(of(e),t);return hp.makeTensor(i,e,t)}function Gm(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=Gm(e,"float32"),r=Gm(e,"float32");return Mm(n,r)}var i=Df(of(e),t);return hp.makeTensor(i,e,t)}function Km(e,t,n){return hp.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function Xm(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Gm([0],r);var i=Df(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return Um(i,r)}var Ym=Rm({onesLike_:function(e){var t=Em(e,"x","onesLike");if("complex64"===t.dtype){var n=Ym(jm(t)),r=Qm(Fm(t));return Mm(n,r)}return hp.runKernelFunc(function(e){return e.onesLike(t)},{$x:t},function(e,t){return{$x:function(){return Qm(e)}}})}}),Qm=Rm({zerosLike_:function(e){var t=Em(e,"x","zerosLike");return hp.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,t){return{$x:function(){return Qm(e)}}})}}),$m=Rm({concat_:function(e,t){void 0===t&&(t=0),ef(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=_m(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")}),t=ff(t,n[0].shape)[0];var r=Dm(n.map(function(e){return e.shape}),t);if(0===of(r))return Lm([],r);if(1===(n=n.filter(function(e){return e.size>0})).length)return n[0];var i=n.map(function(e){return e.shape});Pm(i,t);var o=n,a={axis:t};return hp.runKernelFunc(function(e){return e.concat(n,t)},o,function(e){var n=i.map(function(e){return e[t]});return ng(e,n,t).map(function(e){return function(){return e}})},"Concat",a)}}),Zm=Rm({concat1d_:function(e){return $m(e,0)}}),Jm=Rm({concat2d_:function(e,t){return $m(e,t)}}),eg=Rm({concat3d_:function(e,t){return $m(e,t)}}),tg=Rm({concat4d_:function(e,t){return $m(e,t)}}),ng=Rm({split_:function(e,t,n){void 0===n&&(n=0);var r,i=Em(e,"x","split");return n=ff(n,i.shape)[0],"number"==typeof t?(ef(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(ef(i.shape[n]===t.reduce(function(e,t){return e+t}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),hp.runKernelFunc(function(e){return e.split(i,r,n)},{$x:i},function(e){return{$x:function(){return $m(e,n)}}})}});function rg(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var ig=rg(function(e){!function(e,t){function n(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var i=new n(e),o=t&&t.state,a=i.next;return a.int32=function(){return 4294967296*i.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.alea=i}(0,e)}),og=rg(function(e){!function(e,t){function n(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var i=new n(e),o=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,o&&("object"==typeof o&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.xor128=i}(0,e)}),ag=rg(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var i=new n(e),o=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,o&&("object"==typeof o&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.xorwow=i}(0,e)}),sg=rg(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var i=new n(e),o=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,o&&(o.x&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.xorshift7=i}(0,e)}),ug=rg(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,o=-32;o<u;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=a,e.X=s,e.i=i}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var i=new n(e),o=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,o&&(o.X&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.xor4096=i}(0,e)}),lg=rg(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var i=new n(e),o=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,o&&("object"==typeof o&&r(o,i),a.state=function(){return r(i,{})}),a}t&&t.exports?t.exports=i:this.tychei=i}(0,e)}),cg=rg(function(e){!function(t,r){var i,o=this,a=256,s="random",u=r.pow(a,6),l=r.pow(2,52),c=2*l,h=255;function d(e,n,h){var d=[],v=m(function e(t,n){var r,i=[],o=typeof t;if(n&&"object"==o)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"string"==o?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(a):(e=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,g(t)]}}():e,3),d),y=new f(d),b=function(){for(var e=y.g(6),t=u,n=0;e<l;)e=(e+n)*a,t*=a,n=y.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(g(y.S),t),(n.pass||h||function(e,t,n,i){return i&&(i.S&&p(i,y),e.state=function(){return p(y,{})}),n?(r[s]=e,t):e})(b,v,"global"in n?n.global:this==r,n.state)}function f(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=h&o+e[i%n]+(t=s[i])],s[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,s=r.S;e--;)t=s[i=h&i+1],n=n*a+s[h&(s[i]=s[o=h&o+t])+(s[o]=t)];return r.i=i,r.j=o,n})(a)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",i=0;i<r.length;)t[h&i]=h&(n^=19*t[h&i])+r.charCodeAt(i++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=d,m(r.random(),t),e.exports){e.exports=d;try{i=n(8082)}catch(e){}}}([],Math)});cg.alea=ig,cg.xor128=og,cg.xorwow=ag,cg.xorshift7=sg,cg.xor4096=ug,cg.tychei=lg;var hg=cg.alea,dg=function(){function e(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=hg(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var i=void 0,o=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*o*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),fg=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var i=r||Math.random();this.randu=hg(i.toString()),this.randn=new dg(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,i,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-o+Math.log(o)),(i=this.randu())<t||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),pg=function(){function e(e,t,n,r){var i=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=hg(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function mg(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",Mf(e),new qf(e,t,n)}var gg=Rm({batchToSpaceND_:function(e,t,n){var r=Em(e,"x","batchToSpaceND"),i=t.reduce(function(e,t){return e*t});return ef(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),ef(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),ef(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),hp.runKernelFunc(function(e){return e.batchToSpaceND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}})}}),vg=Rm({broadcastTo_:function(e,t){var n=Em(e,"broadcastTo","x"),r=n.shape;if(t.some(function(e){return!(e>0)||e%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var o=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])o[a]=1;else if(1!==n.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=o.map(function(e,t){return e>1?t:-1}).filter(function(e){return e>=0});return 0===s.length?n.clone():hp.runKernelFunc(function(e){return e.tile(n,o)},{input:n},function(e){return{input:function(){return e.sum(s,!0)}}})}}),yg=Rm({cast_:function(e,t){var n=Em(e,"x","cast");if(!yf(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return hp.runKernelFunc(function(e){return e.cast(n,t)},{x:n},function(e){return{x:function(){return e.clone()}}},"Cast",r)}}),bg=Rm({clone_:function(e){var t=Em(e,"x","clone",null);return hp.runKernelFunc(function(){return hp.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),xg=Rm({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Em(e,"x","cumsum"),o=Am([t|=0],i.rank),a=i;null!=o&&(a=i.transpose(o));var s=Nm(1,i.rank)[0],u=hp.runKernelFunc(function(e){return e.cumsum(a,s,n,r)},{permutedX:a},function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}});return null!=o&&(u=u.transpose(o)),u}}),wg=Rm({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=Em(e,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return ef(i*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+"  for depthToSpace with input shape\n      "+r.shape}),ef(o*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+" for depthToSpace with input shape\n          "+r.shape}),ef(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),hp.runKernelFunc(function(e){return e.depthToSpace(r,t,n)},{$x:r})}}),Eg=Rm({expandDims_:function(e,t){void 0===t&&(t=0);var n=Em(e,"x","expandDims",null);ef(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(ef(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Mg(n,r)}}),_g=Rm({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var i=mg([e,t],r),o=e<=t?e:t,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return Bg(Eg(s,0),[n[0],1,1]);if(2===n.length)return Bg(Eg(Eg(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Bg(Eg(Eg(Eg(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Sg=Rm({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var i=Em(e,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?i.as2D(1,-1):i,u=hp.runKernelFunc(function(e){return e.multinomial(s,r,t,n)},{logits2D:s});return 1===a?u.as1D():u}}),kg=Rm({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=Em(e,"indices","oneHot","int32"),o=i.shape.concat([t]);return i=i.flatten(),hp.runKernelFunc(function(e){return e.oneHot(i,t,n,r)},{$indices:i},function(e){return{$indices:function(){return Gm(i.shape,"float32")}}}).reshape(o)}}),Cg=Rm({pad_:function(e,t,n){void 0===n&&(n=0);var r=Em(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n};return hp.runKernelFunc(function(e){return e.pad(r,t,n)},{x:r},function(e){var n=t.map(function(e){return e[0]});return{x:function(){return e.slice(n,r.shape)}}},"PadV2",i)}}),Ig=Rm({pad1d_:function(e,t,n){return void 0===n&&(n=0),ef(2===t.length,function(){return"Invalid number of paddings. Must be length of 2."}),Cg(e,[t],n)}}),Tg=Rm({pad2d_:function(e,t,n){return void 0===n&&(n=0),ef(2===t.length&&2===t[0].length&&2===t[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cg(e,t,n)}}),Ag=Rm({pad3d_:function(e,t,n){return void 0===n&&(n=0),ef(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cg(e,t,n)}}),Og=Rm({pad4d_:function(e,t,n){return void 0===n&&(n=0),ef(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cg(e,t,n)}}),Ng=Rm({rand_:function(e,t,n){var r=of(e),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=t();return hp.makeTensor(i,e,n)}}),Pg=Rm({randomNormal_:function(e,t,n,r,i){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new dg(t,n,r,!1,i),a=mg(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Dg=Rm({randomGamma_:function(e,t,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var o=new fg(t,n,r,i),a=mg(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Rg=Rm({randomUniform_:function(e,t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=mg(e,r),a=new pg(t,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Mg=Rm({reshape_:function(e,t){var n=Em(e,"x","reshape",null);t=df(t,n.size),ef(n.size===of(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return hp.runKernelFunc(function(e){return e.reshape(n,t)},{x:n},function(e){return{x:function(){return e.reshape(n.shape)}}},"Reshape",r)}}),jg=Rm({spaceToBatchND_:function(e,t,n){var r=Em(e,"x","spaceToBatchND");return ef(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),ef(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),ef(r.shape.reduce(function(e,r,i){return i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]==0:e},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),hp.runKernelFunc(function(e){return e.spaceToBatchND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}})}}),Fg=Rm({squeeze_:function(e,t){var n=Em(e,"x","squeeze");return Mg(n,pf(n.shape,t).newShape)}}),Lg=Rm({stack_:function(e,t){void 0===t&&(t=0);var n=_m(e,"tensors","stack");if(ef(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===n.length)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,o=n[0].dtype;ef(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(e){tf(i,e.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(e){ef(o===e.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(e){return e.expandDims(t)});return $m(a,t)}}),Bg=Rm({tile_:function(e,t){var n=Em(e,"x","tile",null);ef(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={reps:t};return hp.runKernelFunc(function(e,r){var i=e.tile(n,t);return r([n]),i},{x:n},function(e,n){var r=n[0];return{x:function(){var n=Qm(r);if(1===r.rank)for(var i=0;i<t[0];++i)n=n.add(e.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<t[0];++i)for(var o=0;o<t[1];++o)n=n.add(e.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<t[0];++i)for(o=0;o<t[1];++o)for(var a=0;a<t[2];++a)n=n.add(e.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<t[0];++i)for(o=0;o<t[1];++o)for(a=0;a<t[2];++a)for(var s=0;s<t[3];++s)n=n.add(e.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}},"Tile",i,r)}}),zg=Rm({truncatedNormal_:function(e,t,n,r,i){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new dg(t,n,r,!0,i),a=mg(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Ug=Rm({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=Em(e,"x","unstack");ef(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return hp.runKernelFunc(function(e){return e.unstack(n,t)},{x:n},function(e){return{x:function(){return Lg(e,t)}}},"Unpack",r)}});function Vg(e,t,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var o=t.length,a=0;a<o;++a)i=i.concat([e[a+1]/t[a],t[a]]);i=i.concat(e.slice(o+1))}return i}function Wg(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function Hg(e,t,n,r){void 0===r&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var o=1;o<e.length;++o)o<=t.length?r?i.push(t[o-1]*e[o]):i.push(e[o]/t[o-1]):i.push(e[o]);return i}function qg(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Gg(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}function Kg(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=e.shape,s=n.slice();s.pop();var u=1;for(o=r;o<e.rank;++o)u*=a[o],s.push(a[o]);var l=Af(e.shape).map(function(e){return e/u}).concat([1]).slice(0,r);return[s,i,u,l]}Object.freeze({prepareAndValidate:Kg});function Xg(e){return e<=30?e:Tf(e,Math.floor(Math.sqrt(e)))}function Yg(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(o+" update.rank != "+(i+e.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==t.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==e[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+e[a+i]+")")}function Qg(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}Yg(n,t,e)}function $g(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,o=n.length,a=1,s=i;s<o;++s)a*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:of(t.shape)/u,sliceSize:a,strides:Af(n.slice(0,i)).concat([1]),outputSize:of(n)}}Object.freeze({validateUpdateShape:Yg,validateInput:Qg,calculateShapes:$g});function Zg(e,t,n){ef(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),ef(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(r){ef(t[r]+n[r]<=e.shape[r],function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"})},i=0;i<e.rank;++i)r(i)}function Jg(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function ev(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function tv(e,t,n,r,i){var o=t[i],a=n[i]||1;(e&1<<i||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),$d(0,o,s-1)}function nv(e,t,n,r,i){var o=t[i],a=n[i]||1;(e&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),a>0?$d(0,o,s):$d(-1,o,s-1)}function rv(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function iv(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:Zg,maskToAxes:Jg,computeOutShape:ev,startForAxis:tv,stopForAxis:nv,isSliceContinous:rv,computeFlatOffset:iv});function ov(e){return hp.customGrad(e)}var av=Rm({softmax_:function(e,t){void 0===t&&(t=-1);var n=Em(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return hp.runKernelFunc(function(e,r){var i=e.softmax(n,t);return r([i]),i},{logits:n},function(e,n){var r=n[0],i=e.mul(r);return{logits:function(){return i.sub(i.sum([t],!0).mul(r))}}},"Softmax",{dim:t},[],[!0])}}),sv=Rm({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=Em(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return ov(function(e,n){var r=e.max(t,!0),i=e.sub(r),o=i.toFloat().sub(i.exp().sum(t,!0).log());return n([o]),{value:o,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}})(n)}}),uv=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),lv=function(){function e(){}return e.prototype.time=function(e){return cv("time")},e.prototype.read=function(e){return cv("read")},e.prototype.readSync=function(e){return cv("readSync")},e.prototype.numDataIds=function(){return cv("numDataIds")},e.prototype.disposeData=function(e){return cv("disposeData")},e.prototype.write=function(e,t,n){return cv("write")},e.prototype.move=function(e,t,n,r){return cv("move")},e.prototype.memory=function(){return cv("memory")},e.prototype.floatPrecision=function(){return cv("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return cv("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,cv("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return cv("slice")},e.prototype.stridedSlice=function(e,t,n,r){return cv("stridedSlice")},e.prototype.unstack=function(e,t){return cv("unstack")},e.prototype.reverse=function(e,t){return cv("reverse")},e.prototype.concat=function(e,t){return cv("concat")},e.prototype.neg=function(e){return cv("neg")},e.prototype.add=function(e,t){return cv("add")},e.prototype.addN=function(e){return cv("addN")},e.prototype.subtract=function(e,t){return cv("subtract")},e.prototype.multiply=function(e,t){return cv("multiply")},e.prototype.realDivide=function(e,t){return cv("realDivide")},e.prototype.floorDiv=function(e,t){return cv("floorDiv")},e.prototype.sum=function(e,t){return cv("sum")},e.prototype.prod=function(e,t){return cv("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return cv("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return cv("argMin")},e.prototype.argMax=function(e,t){return cv("argMax")},e.prototype.equal=function(e,t){return cv("equal")},e.prototype.notEqual=function(e,t){return cv("notEqual")},e.prototype.less=function(e,t){return cv("less")},e.prototype.lessEqual=function(e,t){return cv("lessEqual")},e.prototype.greater=function(e,t){return cv("greater")},e.prototype.greaterEqual=function(e,t){return cv("greaterEqual")},e.prototype.logicalNot=function(e){return cv("logicalNot")},e.prototype.logicalAnd=function(e,t){return cv("logicalAnd")},e.prototype.logicalOr=function(e,t){return cv("logicalOr")},e.prototype.where=function(e){return cv("where")},e.prototype.select=function(e,t,n){return cv("select")},e.prototype.topk=function(e,t,n){return cv("topk")},e.prototype.min=function(e,t){return cv("min")},e.prototype.minimum=function(e,t){return cv("minimum")},e.prototype.mod=function(e,t){return cv("mod")},e.prototype.max=function(e,t){return cv("max")},e.prototype.maximum=function(e,t){return cv("maximum")},e.prototype.all=function(e,t){return cv("all")},e.prototype.any=function(e,t){return cv("any")},e.prototype.squaredDifference=function(e,t){return cv("squaredDifference")},e.prototype.ceil=function(e){return cv("ceil")},e.prototype.floor=function(e){return cv("floor")},e.prototype.round=function(e){return cv("round")},e.prototype.sign=function(e){return cv("sign")},e.prototype.isNaN=function(e){return cv("isNaN")},e.prototype.isInf=function(e){return cv("isInf")},e.prototype.isFinite=function(e){return cv("isFinite")},e.prototype.pow=function(e,t){return cv("pow")},e.prototype.exp=function(e){return cv("exp")},e.prototype.expm1=function(e){return cv("expm1")},e.prototype.softmax=function(e,t){return cv("softmax")},e.prototype.log=function(e){return cv("log")},e.prototype.log1p=function(e){return cv("log1p")},e.prototype.sqrt=function(e){return cv("sqrt")},e.prototype.rsqrt=function(e){return cv("rsqrt")},e.prototype.square=function(e){return cv("square")},e.prototype.reciprocal=function(e){return cv("reciprocal")},e.prototype.relu=function(e){return cv("relu")},e.prototype.relu6=function(e){return cv("relu6")},e.prototype.prelu=function(e,t){return cv("prelu")},e.prototype.elu=function(e){return cv("elu")},e.prototype.eluDer=function(e,t){return cv("eluDer")},e.prototype.selu=function(e){return cv("selu")},e.prototype.int=function(e){return cv("int")},e.prototype.clip=function(e,t,n){return cv("clip")},e.prototype.abs=function(e){return cv("abs")},e.prototype.complexAbs=function(e){return cv("complexAbs")},e.prototype.sigmoid=function(e){return cv("sigmoid")},e.prototype.softplus=function(e){return cv("softplus")},e.prototype.sin=function(e){return cv("sin")},e.prototype.cos=function(e){return cv("cos")},e.prototype.tan=function(e){return cv("tan")},e.prototype.asin=function(e){return cv("asin")},e.prototype.acos=function(e){return cv("acos")},e.prototype.atan=function(e){return cv("atan")},e.prototype.atan2=function(e,t){return cv("atan2")},e.prototype.sinh=function(e){return cv("sinh")},e.prototype.cosh=function(e){return cv("cosh")},e.prototype.tanh=function(e){return cv("tanh")},e.prototype.asinh=function(e){return cv("asinh")},e.prototype.acosh=function(e){return cv("acosh")},e.prototype.atanh=function(e){return cv("atanh")},e.prototype.erf=function(e){return cv("erf")},e.prototype.step=function(e,t){return cv("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,cv("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return cv("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return cv("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return cv("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,cv("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return cv("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return cv("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return cv("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return cv("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return cv("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return cv("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return cv("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return cv("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return cv("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return cv("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return cv("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return cv("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return cv("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return cv("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return cv("reshape")},e.prototype.cast=function(e,t){return cv("cast")},e.prototype.tile=function(e,t){return cv("tile")},e.prototype.pad=function(e,t,n){return cv("pad")},e.prototype.transpose=function(e,t){return cv("transpose")},e.prototype.gather=function(e,t,n){return cv("gather")},e.prototype.gatherND=function(e,t){return cv("gatherND")},e.prototype.scatterND=function(e,t,n){return cv("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return cv("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return cv("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return cv("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return cv("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return cv("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return cv("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,i,o){return cv("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,i){return cv("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,i,o,a){return cv("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return cv("multinomial")},e.prototype.oneHot=function(e,t,n,r){return cv("oneHot")},e.prototype.cumsum=function(e,t,n,r){return cv("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,i){return cv("nonMaxSuppression")},e.prototype.fft=function(e){return cv("fft")},e.prototype.ifft=function(e){return cv("ifft")},e.prototype.complex=function(e,t){return cv("complex")},e.prototype.real=function(e){return cv("real")},e.prototype.imag=function(e){return cv("imag")},e.prototype.cropAndResize=function(e,t,n,r,i,o){return cv("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return cv("depthToSpace")},e.prototype.split=function(e,t,n){return cv("split")},e.prototype.sparseToDense=function(e,t,n,r){return cv("sparseToDense")},e.prototype.diag=function(e){return cv("diag")},e.prototype.fill=function(e,t,n){return cv("fill")},e.prototype.onesLike=function(e){return cv("onesLike")},e.prototype.zerosLike=function(e){return cv("zerosLike")},e.prototype.linspace=function(e,t,n){return cv("linspace")},e.prototype.dispose=function(){return cv("dispose")},e}();function cv(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function hv(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r}function dv(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],o=t.length-r-1,a=t[o];(null==i||1===i&&a>1)&&n.unshift(o)}return n}function fv(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var o=e[e.length-i-1];null==o&&(o=1);var a=t[t.length-i-1];if(null==a&&(a=1),1===o)n.unshift(a);else if(1===a)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(o)}}return n}function pv(e,t,n,r,i,o,a){void 0===a&&(a="channelsLast");var s,u=bv(t),l=u[0],c=u[1];if("channelsLast"===a)s=[l,c,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return gv(e,s,n,r,i,o,!1,a)}function mv(e,t,n,r,i,o,a){void 0===a&&(a="NDHWC");var s,u,l=xv(t),c=l[0],h=l[1],d=l[2];if("NDHWC"===a)u="channelsLast",s=[c,h,d,e[4],e[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,h,d,e[1],e[1]]}return vv(e,s,n,r,i,!1,u,o)}function gv(e,t,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3];if("channelsLast"===s)l=e[0],c=e[1],h=e[2],d=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],h=e[3]}var f,p=t[0],m=t[1],g=t[3],v=bv(n),y=v[0],b=v[1],x=bv(r),w=x[0],E=x[1],_=wv(p,w),S=wv(m,E),k=function(e,t,n,r,i,o,a,s){var u,l,c;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,i){null==r&&(r=yv(e,t,n));var o=e[1],a=Ev((e[0]-t+2*r)/n+1,i);ef(sf(a),function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"});var s=Ev((o-t+2*r)/n+1,i);return ef(sf(s),function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"}),[a,s]}([t,n],o,r,e,s);l=h[0],c=h[1]}else if("same"===e){l=Math.ceil(t/r),c=Math.ceil(n/i);var d=Math.max(0,(l-1)*r+o-t),f=Math.max(0,(c-1)*i+a-n),p=Math.floor(d/2),m=d-p,g=Math.floor(f/2);u={top:p,bottom:m,left:g,right:f-g,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-o+1)/r),c=Math.ceil((n-a+1)/i)}return{padInfo:u,outHeight:l,outWidth:c}}(i,c,h,y,b,_,S,o),C=k.padInfo,I=k.outHeight,T=k.outWidth,A=a?g*d:g;return"channelsFirst"===s?f=[l,A,I,T]:"channelsLast"===s&&(f=[l,I,T,A]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:h,inChannels:d,outHeight:I,outWidth:T,outChannels:A,padInfo:C,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:_,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:E,inShape:e,outShape:f,filterShape:t}}function vv(e,t,n,r,i,o,a,s){void 0===o&&(o=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3],f=u[4];if("channelsLast"===a)l=e[0],c=e[1],h=e[2],d=e[3],f=e[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);l=e[0],f=e[1],c=e[2],h=e[3],d=e[4]}var p,m=t[0],g=t[1],v=t[2],y=t[4],b=xv(n),x=b[0],w=b[1],E=b[2],_=xv(r),S=_[0],k=_[1],C=_[2],I=wv(m,S),T=wv(g,k),A=wv(v,C),O=function(e,t,n,r,i,o,a,s,u,l,c){var h,d,f,p;if("number"==typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,i,o){null==i&&(i=yv(e,t,r));var a=e[1],s=e[2],u=Ev((e[0]-t+2*i)/r+1,o);ef(sf(u),function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"});var l=Ev((a-t+2*i)/r+1,o);ef(sf(l),function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"});var c=Ev((s-t+2*i)/r+1,o);return ef(sf(c),function(){return"The output # of columns ("+c+") must be an integer. Change the stride and/or zero pad parameters"}),[u,l,c,1]}([t,n,r,1],s,0,i,e,c);d=m[0],f=m[1],p=m[2]}else if("same"===e){var g=((d=Math.ceil(t/i))-1)*i+s-t,v=((f=Math.ceil(n/o))-1)*o+u-n,y=((p=Math.ceil(r/a))-1)*a+l-r,b=Math.floor(g/2),x=g-b,w=Math.floor(v/2),E=v-w,_=Math.floor(y/2);h={top:w,bottom:E,left:_,right:y-_,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((t-s+1)/i),f=Math.ceil((n-u+1)/o),p=Math.ceil((r-l+1)/a)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(i,c,h,d,x,w,E,I,T,A,s),N=O.padInfo,P=O.outDepth,D=O.outHeight,R=O.outWidth,M=o?y*f:y;return"channelsFirst"===a?p=[l,M,P,D,R]:"channelsLast"===a&&(p=[l,P,D,R,M]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:d,inChannels:f,outDepth:P,outHeight:D,outWidth:R,outChannels:M,padInfo:N,strideDepth:x,strideHeight:w,strideWidth:E,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:I,effectiveFilterHeight:T,effectiveFilterWidth:A,dilationDepth:S,dilationHeight:k,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function yv(e,t,n,r){void 0===r&&(r=1);var i=wv(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function bv(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function xv(e){return"number"==typeof e?[e,e,e]:e}function wv(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ev(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function _v(e){var t=bv(e),n=t[0],r=t[1],i=t[2];return 1===n&&1===r&&1===i}function Sv(e,t){return _v(e)||_v(t)}function kv(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function Cv(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Gm(e.shape),i=e.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!bf(e.dtype,t))return hp.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var a=n.real(e);return o=a.cast(t),a.dispose(),o}if("int32"===t)return n.int(e);if("bool"===t){var s=zm(0,e.dtype);return o=n.notEqual(e,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Iv(e,t){return hp.makeTensorFromDataId(e.dataId,t,e.dtype)}function Tv(e,t,n){var r=(t-e)/(n-1),i=Df(n,"float32");i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Um(i,"float32")}Object.freeze({castTensor:Cv,reshapeTensor:Iv,linspaceImpl:Tv,upcastType:rp,axesAreInnerMostDims:Sm,combineLocations:km,computeOutAndReduceShapes:Cm,expandShapeToKeepDim:Im,assertAxesAreInnerMostDims:Tm,getAxesPermutation:Am,getUndoAxesPermutation:Om,getInnerMostAxes:Nm,getBroadcastDims:hv,getReductionAxes:dv,assertAndGetBroadcastShape:fv,assertParamsConsistent:Pm,computeOutShape:Dm,computePool2DInfo:pv,computePool3DInfo:mv,computeConv2DInfo:gv,computeConv3DInfo:vv,computeDefaultPad:yv,tupleValuesAreOne:_v,eitherStridesOrDilationsAreOne:Sv,convertConv2DDataFormat:kv,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Xg});function Av(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ov(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Nv(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Pv(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Dv(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,i=e.length,o=0,a=!1;r<i;){var s=n(t,e[o=r+(i-r>>>1)]);s>0?r=o+1:(i=o,a=!s)}return a?r:-r-1}(e,t,n||Rv)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function Rv(e,t){return e>t?1:e<t?-1:0}function Mv(e,t,n,r,i){return Fv(e,t,n,r,i,0).selectedIndices}function jv(e,t,n,r,i,o){var a=Fv(e,t,n,r,i,o,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function Fv(e,t,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map(function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}}).filter(function(e){return e.score>i}).sort(zv),l=o>0?-.5/o:0,c=[],h=[];c.length<n&&u.length>0;){var d=u.pop(),f=d.score,p=d.boxIndex,m=d.suppressBeginIndex;if(f<i)break;for(var g=!1,v=c.length-1;v>=m;--v){var y=Lv(e,p,c[v]);if(y>=r){g=!0;break}if(d.score=d.score*Bv(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,g||(d.score===f?(c.push(p),h.push(d.score)):d.score>i&&Dv(u,d,zv))}var b=c.length;return s&&(c.fill(0,b),h.fill(0,b)),{selectedIndices:Um(c,"int32"),selectedScores:Um(h,"float32"),numValidOutputs:zm(b,"int32")}}function Lv(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(s-o)*(u-a),p=(h-l)*(d-c);if(f<=0||p<=0)return 0;var m=Math.max(o,l),g=Math.max(a,c),v=Math.min(s,h),y=Math.min(u,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+p-b)}function Bv(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function zv(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Uv(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(t){i[n]=t;var o=e.slice(r,i);return r[n]+=t,o})}function Vv(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=mg(n,e.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=o[s]%e.shape[s];var u=e.locToIndex(a);i.values[r]=e.values[u]}return i.toTensor()}function Wv(e,t,n,r,i){for(var o=t[t.length-1],a=[e.length/o,o],s=a[0],u=a[1],l=mf(n,s*r),c=mf("int32",s*r),h=0;h<s;h++){for(var d=h*u,f=e.subarray(d,d+u),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort(function(e,t){return t.value-e.value});var g=h*r,v=l.subarray(g,g+r),y=c.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=t.slice();return b[b.length-1]=r,[Lm(l,b,n),Lm(c,b,"int32")]}function Hv(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=mg(e,"int32"),o=mg([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]),s=r*e.length;o.values.set(a,s)}return o.toTensor()}var qv=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Gv=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Kv=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,o=e.inSize,a=Math.ceil(o/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Xv(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(t){return e+"."+t})}function Yv(e,t){return 1===t?[e]:Xv(e,t)}function Qv(){var e,t,n,r,i,o,a,s,u,l;return 2===Ud().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function $v(e,t,n){void 0===n&&(n="index");var r=Af(t);return r.map(function(t,i){return"int "+e[i]+" = "+n+" / "+t+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+t:"index -= "+e[i]+" * "+t)+";"}).join("")}function Zv(e){var t=Af(e).map(function(e){return e.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var Jv="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function ey(e,t,n,r){var i=[];e.forEach(function(e){var t=of(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?i.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(i.push("uniform sampler2D "+e.name+";"),i.push("uniform int offset"+e.name+";"))});var o,a,s=i.join("\n"),u=e.map(function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?ny(e):ty(e);var i=e.shapeInfo.logicalShape,o=t.logicalShape;return i.length<=o.length&&(r+=n?function(e,t){var n,r=e.name,i=r.charAt(0).toUpperCase()+r.slice(1),o="get"+i+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=hv(e.shapeInfo.logicalShape,t.logicalShape),l=ly(s),c=s-a,h=["x","y","z","w","u","v"];n=0===a?"":s<2&&u.length>=1?"coords = 0;":u.map(function(e){return"coords."+h[e+c]+" = 0;"}).join("\n");var d;d=s<2&&a>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+h[t+c]}).join(", ");var f="return outputValue;",p=1===of(e.shapeInfo.logicalShape),m=1===of(t.logicalShape);if(1!==a||p||m){if(p&&!m)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=a-2,v=a-1;u.indexOf(g)>-1&&u.indexOf(v)>-1?f="return vec4(outputValue.x);":u.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+o+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+i+"("+d+");\n      "+f+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.texShape,a=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&af(a,o))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var l,c=ly(u),h=hv(e.shapeInfo.logicalShape,t.logicalShape),d=u-s,f=["x","y","z","w","u","v"];l=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map(function(e){return"coords."+f[e+d]+" = 0;"}).join("\n");var p;return p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+f[t+d]}).join(", "),"\n    float "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+l+"\n      return get"+r+"("+p+");\n    }\n  "}(e,t)),r}(e,t,r)}).join("\n"),l=t.texShape,c=Qv(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(c),d=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+ry+"\n    "+iy+"\n    "+oy+"\n  "}(c);return t.isPacked?(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(af(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2),o=i,a="",s="b, r, c",u=2;u<e.length-1;u++)a="\n      int b"+u+" = index / "+(o*=e[e.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,i,o,a}(t.logicalShape,l),a=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(c)):(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return af(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=$v(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=$v(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=$v(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=$v(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,l),a=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(c)),r&&(d+=ay),[d,h,a,s,o,u,n].join("\n")}function ty(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,i=r[0],o=r[1];if(1===i&&1===o)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+a[0]+", "+a[1]+", "+sy(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+uy(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=sy(t);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+i+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+a+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape;if(null!=i&&af(t,i)){var o=i[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+i[1]+".0, "+o+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var a=pf(t),s=a.newShape,u=a.keptDims,l=s;if(l.length<t.length)return"\n      "+ty(cy(e,l))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+hy(["row","col"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+uy(e)+"\n      }\n    ";var c=i[0],h=i[1],d=sy(n);return 1===h?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+c+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===c?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+c+", "+h+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[1]*t[2],o=t[2],a=pf(t),s=a.newShape,u=a.keptDims,l=s;if(l.length<t.length)return"\n        "+ty(cy(e,l))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+hy(["row","col","depth"],u)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+i+", "+o+", 1)));\n        "+uy(e)+"\n      }\n    ";var c=e.shapeInfo.texShape,h=c[0],d=c[1],f=e.shapeInfo.flatOffset;return d===i&&null==f?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+o+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+h+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":d===o&&null==f?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+h+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+i+" + col * "+o+" + depth + "+sy(n)+";\n        vec2 uv = uvFromFlat("+h+", "+d+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[3],o=t[2]*i,a=t[1]*o,s=pf(t),u=s.newShape,l=s.keptDims;if(u.length<t.length)return"\n      "+ty(cy(e,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+hy(["row","col","depth","depth2"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+o+", "+i+", 1)));\n        "+uy(e)+"\n      }\n    ";var c=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1];return f===a&&null==c?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+o+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":f===i&&null==c?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+o+" +\n          depth * "+i+" + depth2;\n      vec2 uv = uvFromFlat("+d+", "+f+", index + "+sy(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],o=t[3]*i,a=t[2]*o,s=t[1]*a,u=pf(t),l=u.newShape,c=u.keptDims;if(l.length<t.length)return"\n      "+ty(cy(e,l))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+hy(["row","col","depth","depth2","depth3"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+a+", "+o+", "+i+")) +\n          depth3;\n        "+uy(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1];return p===s&&null==h?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+o+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===i&&null==h?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" + depth * "+o+" +\n          depth2 * "+i+" + depth3 + "+sy(n)+";\n      vec2 uv = uvFromFlat("+f+", "+p+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=pf(t),o=i.newShape,a=i.keptDims;if(o.length<t.length)return"\n      "+ty(cy(e,o))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+hy(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    ";var s=t[5],u=t[4]*s,l=t[3]*u,c=t[2]*l,h=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+h+", "+c+", "+l+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+uy(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];return m===h&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+c+", "+l+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":m===s&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+h+" + col * "+c+" + depth * "+l+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+sy(n)+";\n      vec2 uv = uvFromFlat("+p+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function ny(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+Qv().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=Qv();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=i[0],a=i[1],s=Qv();if(null!=i&&af(t,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===t[0])return"\n        "+ny(cy(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+hy(["b","row","col"],[1,2])+");\n        }\n      ";var a=o[0],s=o[1],u=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+a+", "+s+", "+u*Math.ceil(t[1]/2)+", "+u+", b, row, col);\n      return "+Qv().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],s=a[0],u=a[1],l=Math.ceil(t[n-1]/2),c=l*Math.ceil(t[n-2]/2),h="int b, int row, int col",d="b * "+c+" + (row / 2) * "+l+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,d="b"+f+" * "+(c*=t[n-f-1])+" + "+d;return"\n    vec4 "+i+"("+h+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+Qv().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var ry="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",iy="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",oy="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ay="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function sy(e){return"offset"+e}function uy(e){var t=e.name,n=of(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function ly(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function cy(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function hy(e,t){return t.map(function(t){return e[t]}).join(", ")}var dy=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ef(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=ly(l),h=Yv("coords",l);if(1===o){var d=ly(s=l+1);a="\n        "+d+" sourceLocR = "+d+"("+h.join()+", 0);\n        ++"+h[l-1]+";\n        "+d+" sourceLocG = "+d+"("+h.join()+", 0);\n        ++"+h[l-2]+";\n        "+d+" sourceLocA = "+d+"("+h.join()+", 0);\n        --"+h[l-1]+";\n        "+d+" sourceLocB = "+d+"("+h.join()+", 0);\n        --"+h[l-2]+";"}else s=l,a="\n        "+c+" sourceLocR = coords;\n        ++"+h[l-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+h[l-2]+";\n        "+c+" sourceLocA = coords;\n        --"+h[l-1]+";\n        "+c+" sourceLocB = coords;\n        --"+h[l-2]+";";var f=["x","y","z","w","u","v"].slice(0,s),p="."+f[s-1],m=f.map(function(e){return"int "+e}),g=Yv("sourceLocR",s-1).concat("inIdx.r"),v=Yv("sourceLocG",s-1).concat("inIdx.g"),y=Yv("sourceLocB",s-1).concat("inIdx.b"),b=Yv("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",E="vec4(\n            getAChannel("+g.join()+"),\n            hasNextCol ? getAChannel("+v.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",_=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+_+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+h[l-1]+" < "+(u[l-1]-1)+";\n        bool hasNextRow = "+h[l-2]+" < "+(u[l-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+E+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+E+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},fy=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,h=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+l+", "+c+");\n      const float avgMultiplier = float("+h+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+o+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+a+") {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},py=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=c-1-e.padInfo.front,p=h-1-e.padInfo.top,m=d-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float avgMultiplier = float("+g+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+i+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+h+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+o+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+d+";\n                wC += "+l+") {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},my=function(e,t,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],fv(e,t),fv(e,n);var a="0.0";null!=r&&(fv(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=i&&(fv(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},gy=function(e,t,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],fv(e,t),fv(e,n);var a="vec4(0.0)";null!=r&&(fv(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(fv(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},vy=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=fv(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},yy="return a + b;",by="return a - b;",xy="return a * b;",wy="return (a < 0.) ? b * a : a;",Ey=function(e,t,n){this.variableNames=["A","B"],this.outputShape=fv(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},_y="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Sy=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=fv(t,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===of(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+ly(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Yv("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+a[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+a[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},ky=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Cy=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Iy=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Ty=function(e){this.outputShape=[],this.outputShape=Dm(e,1),this.variableNames=e.map(function(e,t){return"T"+t});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var o=t.length,a=t[t.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+a+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Ay=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Dm(e,t);var n=this.outputShape,r=n.length,i=ly(r),o=Yv("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(e,t){return"T"+t});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),h=a.join(),d="if ("+l+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+c.join()+"));\n        }";for(u=1;u<s.length;u++){var f=s[u-1];d+="\n        if ("+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Oy(a,l,f)+"),\n            vec2("+Oy(c,l,f)+"));\n        }"}var p=s.length,m=s[s.length-1];d+="\n        return getChannel(\n          getT"+p+"("+Oy(a,l,m)+"),\n          vec2("+Oy(c,l,m)+"));",this.userCode="\n      float getValue("+a.map(function(e){return"int "+e})+") {\n        "+d+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n\n        "+o[r-1]+" = "+o[r-1]+" + 1;\n        if ("+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n\n        "+o[r-2]+" = "+o[r-2]+" + 1;\n        if ("+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n\n        "+o[r-1]+" = "+o[r-1]+" - 1;\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            "+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "};function Oy(e,t,n){var r=e.indexOf(t);return e.map(function(e,t){return t===r?e+" - "+n:e}).join()}var Ny=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+o+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Py=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=o?1:2,l=o?2:3,c=o?3:1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+c+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+l+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+o+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Dy=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+i+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+o+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+a+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ry=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+l+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+i+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+o+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},My=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+o+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},jy=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Fy=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,o=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),f=e.inChannels%4,p="channelsLast"===e.dataFormat,m=p?1:2,g=p?2:3,v=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+v+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+l+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},Ly=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,h=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+l+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},By=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,o=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=e.outChannels/e.inChannels,m="",g="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+c+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+o+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+v+"\n        "+g+"\n        setOutput(result);\n      }\n    "},zy=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,o=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=f,m="int xR; int xC; int xCOffset;",g=0;g<d;g++)for(var v=0;v<f;v++)m+="\n          vec4 xTexelR"+g+"C"+2*v+" = vec4(0.);\n          vec4 wR"+g+"C"+v+" = vec4(0.);\n          vec4 xR"+g+"C"+v+" = vec4(0.);";for(g=0;g<d;g++)for(var y=0;y<p;y++){if(m+="\n          xR = xRCorner + "+g*c+";\n          xC = xCCorner + "+(v=2*y)*h+";\n        ",1===l){if(v<f&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+o+") {\n                    xTexelR"+g+"C"+v+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+o+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+".xy);\n                } else {\n                  xR"+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+o+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = xTexelR"+g+"C"+v+";\n              ",v+1<f)){var b=s%2==0?Zd(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+o+") {\n                      xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+g+"C"+v+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+g+"C"+(v+1)+" = vec4(\n                    xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+";\n                "}}else v<f&&(m+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+l+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+o+") {\n                  xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+g+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = vec4(\n                  xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".zw);\n              ",v+1<f&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+l+";\n                  if(xCOffset >= 0 && xCOffset < "+o+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+o+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+l+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = vec4(\n                  xTexelR"+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+".xy);\n              ",v+1<f&&(m+="\n                  xR"+g+"C"+(v+1)+" = vec4(\n                    xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".zw);\n                ")),m+="}");v<f&&(m+="\n            vec4 wTexelR"+g+"C"+v+" = getW("+g+", "+v+", d1, q);\n            wR"+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+".xz);\n          ",v+1<f&&(m+="\n              vec4 wTexelR"+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+", d1, q);\n              wR"+g+"C"+(v+1)+" =\n                vec4(wTexelR"+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<d;g++)for(v=0;v<f;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+E+"\n        "+w+"\n        setOutput(result);\n      }\n    "},Uy=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],h=n[1];this.outputShape=[l,c,h,u];var d="bilinear"===r?1:0,f=[a-1+".0",s-1+".0"],p=f[0],m=f[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=g[0],y=g[1],b=g[2],x=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=x[0],E=x[1],_=x[2];this.userCode="\n      const float height_ratio = float("+v+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+E+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+_+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+d+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Vy=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+ly(r)+" coords = getOutputCoords();\n        int end = "+Wy(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+Wy(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Wy(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Hy=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=pp.DENSE;var t=Ep(e),n=Qv();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+$v(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},qy=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=pp.DENSE;var t=Ep(e),n=Qv();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+$v(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},Gy=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Ky=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Xy=function(e){this.variableNames=["A"],this.outTexUsage=mp.DOWNLOAD;var t=Qv();this.outputShape=e,this.userCode="\n      "+Jv+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},Yy=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=mp.DOWNLOAD;var t=Qv();this.outputShape=e,this.userCode="\n      "+Jv+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},Qy=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Qv(),i=t[0],o=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Zv(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},$y=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Qv(),i=t[0],o=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+l+" < "+e[2]+") {\n            localCoords[2] += "+l+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Zv(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},Zy=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+o+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Jy=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),eb=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=ly(this.rank),o=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<e.length;o++)o===t?i.push("int(getIndices("+r[o]+"))"):i.push(""+r[o]);return i.join()}(e,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},tb=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=ly(t.length),i=ly(n.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+o+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function nb(e,t){var n=Qv();return Ap(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function rb(e,t){return Fp(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ib(e,t){return Lp(e,t,new Uint16Array([0,1,2,2,1,3]))}function ob(e,t,n,r,i,o,a){zp(n,r);var s=Bp(e,t),u=e.TEXTURE_2D;return kp(e,t,function(){return e.bindTexture(u,s)}),kp(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),kp(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),kp(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),kp(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),kp(e,t,function(){return e.texImage2D(u,0,i,n,r,0,o,a,null)}),kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function ab(e,t,n,r,i){var o=wp(n,r);return ob(e,t,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function sb(e,t,n,r,i){var o=wp(n,r);return ob(e,t,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function ub(e,t,n,r,i){var o=wp(n,r);return ob(e,t,o[0],o[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function lb(e,t,n,r,i){var o=_p(n,r);return ob(e,t,o[0],o[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function cb(e,t,n,r,i){var o=_p(n,r);return ob(e,t,o[0],o[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function hb(e,t,n,r){return kp(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Vp(e,t,n,"clipSpacePos",r,3,20,0)&&Vp(e,t,n,"uv",r,2,20,12)}function db(e,t,n,r,i,o,a){var s,u,l;kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(o),kp(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function fb(e,t,n,r){kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?kp(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):kp(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),kp(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function pb(e,t,n,r,i){var o=e.createBuffer();kp(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,o)});var a=16*n*r;return kp(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),kp(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),kp(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),o}function mb(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function gb(e,t,n,r,i){var o=wp(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return kp(e,t,function(){return e.readPixels(0,0,a,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function vb(e,t,n,r,i,o,a,s){var u=e,l=new Float32Array(function(e,t){var n=_p(e,t);return n[0]*n[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function yb(e,t,n,r){var i=new Float32Array(n*r*4);return kp(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var bb=Object.freeze({createVertexShader:nb,createVertexBuffer:rb,createIndexBuffer:ib,createFloat32MatrixTexture:ab,createFloat16MatrixTexture:sb,createUnsignedBytesMatrixTexture:ub,createPackedMatrixTexture:lb,createFloat16PackedMatrixTexture:cb,bindVertexProgramAttributeStreams:hb,uploadDenseMatrixToTexture:db,uploadPixelDataToTexture:fb,createBufferFromOutputTexture:pb,downloadFloat32MatrixFromBuffer:mb,downloadByteEncodedFloatMatrixFromOutputTexture:gb,downloadPackedMatrixFromBuffer:vb,downloadMatrixFromPackedOutputTexture:yb}),xb=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=Ud().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,bp(t,e)):this.gl=xp(t);var n="WEBGL_color_buffer_float";if(1===Ud().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=Tp(this.gl,this.debug,"OES_texture_float"),um(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Tp(this.gl,this.debug,"OES_texture_half_float");else if(Ud().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),um(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Tp(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Ud().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",um(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!um(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=rb(this.gl,this.debug),this.indexBuffer=ib(this.gl,this.debug),this.framebuffer=Up(this.gl,this.debug),this.textureConfig=Sp(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return Ud().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;kp(t,this.debug,function(){return t.finish()}),kp(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),kp(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),kp(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),kp(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),kp(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),ab(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),sb(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),ub(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),fb(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),db(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),cb(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),lb(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Xp(this.gl,this.debug,this.framebuffer),this.outputTexture=null),kp(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return gb(r.gl,r.debug,t,n,r.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,i,o){return vb(this.gl,e,0,0,0,i,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return mb(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=pb(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(Ud().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=i.clientWaitSync(o,0,0);return e===i.ALREADY_SIGNALED||e===i.CONDITION_SATISFIED},t=o}else Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return yb(r.gl,r.debug,t,n)})},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=Op(t,this.debug,e),r=nb(t,this.debug),i=Rp(t,this.debug);return kp(t,this.debug,function(){return t.attachShader(i,r)}),kp(t,this.debug,function(){return t.attachShader(i,n)}),Mp(t,this.debug,i),this.debug&&jp(t,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=hb(t,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&kp(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&jp(this.gl,this.debug,this.program),kp(this.gl,this.debug,function(){return t.gl.useProgram(e)})},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?Hp(this.gl,this.debug,e,t):qp(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),kp(this.gl,this.debug,function(){return n.gl.getAttribLocation(e,t)})},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Gp(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=_p(t,n),i=r[0],o=r[1];this.setOutputMatrixTextureDriver(e,i,o)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&jp(this.gl,this.debug,this.program),Yp(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),kp(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),kp(this.gl,this.debug,function(){return e.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Tp(this.gl,this.debug,2===Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(2!==Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return Ld(this,void 0,void 0,function(){var t=this;return Bd(this,function(n){switch(n.label){case 0:return[4,hf(function(){return t.disposed||t.isQueryAvailable(e,Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(e,Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise(function(n){t.addItemToPoll(function(){return e.isFencePassed()},function(){return n()})})},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(function(e){return e.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||hf(function(){return n.pollItems(),0===n.itemsToPoll.length})},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Kp(this.gl,this.debug,e,this.framebuffer),this.debug&&Yp(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Kp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Yp(this.gl)):Xp(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;Kp(r,this.debug,e,this.framebuffer),this.debug&&Yp(r),this.outputTexture=e,kp(r,this.debug,function(){return r.viewport(0,0,t,n)}),kp(r,this.debug,function(){return r.scissor(0,0,t,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var i=this;this.throwIfDisposed(),kp(this.gl,this.debug,function(){return i.gl.scissor(e,t,n,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function wb(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(e,n){var r=e.logicalShape,i=t[n],o=i.shape;if(!af(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!e.isUniform||!i.isUniform){var a=e.texShape,s=i.isUniform?null:i.texData.texShape;if(!af(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}})}var Eb=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,o=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,h=n.dataFormat,d=s.left,f=s.top,p=i*r,m=Qv(),g="channelsLast"===h,v=g?0:1,y=g?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+f+";\n            d0 = offsetY + "+c+" * (pos / "+p+");\n\n            if(d0 < "+t[v]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+o+". - "+d+".);\n              d1 = offsetX + "+l+" * (int(mod(float(pos), "+p+".) / "+i+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+i+".));\n\n                if ("+g+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "},_b=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var o,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";o=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+o+";\n        setOutput(val);\n      }\n    "},Sb=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},kb=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";o=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+o+";\n        setOutput(result);\n      }\n    "},Cb=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,s=o-1-e.padInfo.left,u=i*o-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+i+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+o+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+o+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ib=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,h=u-1-e.padInfo.top,d=l-1-e.padInfo.left,f=s*u*l-1;this.userCode="\n      const ivec3 pads = ivec3("+c+", "+h+", "+d+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+i+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+o+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+a+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+f+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+l+" +\n                  wR * "+l+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Tb=function(e,t,n,r,i,o,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",p="";o&&(f=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+o+"\n        }":"vec4 activation(vec4 x) {\n          "+o+"\n        }",p="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+f+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+l+");\n          vec4 b = getMatrixB(rc.x, "+c+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+h[0]+" * "+d[0]+");\n          result += ("+h[1]+" * "+d[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},Ab=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),Ob=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Nb=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Yv("rc",t),r=ly(t),i=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",i=e-2;i<e;i++)r+=n[i]+" >= "+t[i],i<e-1&&(r+="||");return r}(t,e,n),o=function(e,t,n,r){if(1===e)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),a=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),a=2;a<e;a++)o=t[t.length-1-a]+","+o;n.push(o)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},Pb=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});var r=e.length,i=ly(r),o=t.map(function(e){return e[0]}).join(","),a=t.map(function(t,n){return t[0]+e[n]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Db=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});for(var r=e.length,i=ly(r),o=t.map(function(e){return e[0]}).join(","),a=t.map(function(t,n){return t[0]+e[n]}).join(","),s=Yv("rc",r),u=Yv("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+l+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+l+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,m=1===r?2:4;p<m;p++)f+="\n        "+h[p]+"\n        if ("+d+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+c+");\n        }\n      ";f+=1===r?"} ":"}}",this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+f+"\n        setOutput(result);\n      }\n    "},Rb=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,f="0.0";if(d||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+c+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+c+", "+h+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},Mb=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g="avg"===t,v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+o+", "+a+");\n        const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+c+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+l+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w="\n      if ("+g+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float initializationValue = "+v+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+v+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+l+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+l+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},jb=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",s="min"):"max"===t&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,h="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===t?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},Fb=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+$v(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Zv(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Lb=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],o=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?i-1:i,n&&u>1?o-1:o],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Bb=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},zb=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+",\n          "+u[1]/l[1]+");\n      const vec3 inputShapeRC = vec3("+o+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Ub=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],o=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?i-1:i,n&&u>1?o-1:o],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Vb=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+c+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Wb=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map(function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)}).join(","),i=ly(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},Hb=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Yv("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=ly(n);function s(n){var r=e.map(function(r,i){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)});return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},qb=function(e,t,n,r,i,o,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=ly(i.length),u=ly(o.length),l="";1===n?l="i":2===n&&(l="i, j");var c="getIndices("+l+")",h="";1===r?h="i":2===r&&(h="i, coords[1]");var d="getUpdates("+h+")",f=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+c+");\n              flattenedIndex += index * "+f+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+d+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Gb=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ",c="";i%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},Kb=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+o[u]),u<e&&a.push(""+o[u]);r=a.join(),i=s.join()}var l=ly(n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},Xb=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=ly(this.rank),r="uniform int start["+this.rank+"];",i=function(e){if(1===e)return"sourceLoc";if(e<=6)return Yb.slice(0,e).map(function(e){return"sourceLoc."+e}).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map(function(e,t){return"sourceLoc."+Yb[t]+" = start["+t+"] + coords."+Yb[t]+";"}).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+i+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Yb=["x","y","z","w","u","v"],Qb=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=ly(this.rank),n=Yv("coords",this.rank),r=Yv("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",a="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map(function(e,t){return"start["+t+"]"}).join()+");":e.map(function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),$b=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=ly(n.length),o=ly(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map(function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"}).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+e+");\n      "+i+" strides = "+i+"("+t+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},Zb=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,i=Jb(t,n),o=ex(e,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),i===gp.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===gp.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===gp.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===gp.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===gp.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var i=ex(t,Jb(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],a=o.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function Jb(e,t){if(e===mp.UPLOAD)return gp.PACKED_2X2_FLOAT32;if(e===mp.RENDER||null==e)return function(e){return Ud().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?gp.PACKED_2X2_FLOAT32:gp.UNPACKED_FLOAT32:e?gp.PACKED_2X2_FLOAT16:gp.UNPACKED_FLOAT16}(t);if(e===mp.DOWNLOAD||e===mp.PIXELS)return gp.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function ex(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var tx=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=ly(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<e.length;i++)r.push("imod("+n[i]+", "+e[i]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},nx=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=ly(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}(t);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},rx=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=ly(this.rank),o=Xv("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+l+";\n      if("+u+") {\n        result[1] = "+l+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+l+";\n        if("+u+") {\n          result[3] = "+l+";\n        }\n      }\n      setOutput(result);\n    }\n    "},ix=1.7580993408473768,ox=1.0507009873554805,ax=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},sx="if (isnan(x)) return x;",ux="return abs(x);",lx=sx+"\n  return (x < 0.0) ? 0.0 : x;\n",cx=sx+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",hx="return (x >= 0.0) ? x : (exp(x) - 1.0);",dx="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+ix+";\n  float scale = "+ox+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",fx="return -x;",px="return ceil(x);",mx="return floor(x);",gx="return exp(x);",vx="return exp(x) - 1.0;",yx=sx+"\n  return sin(x);\n",bx=sx+"\n  return cos(x);\n",xx=sx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",wx=sx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",Ex=sx+"\n  return atan(x);\n",_x=sx+"return log(x + sqrt(x * x + 1.0));",Sx=sx+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",kx=sx+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Cx="return x;",Ix="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Tx="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ax="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Ox=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Nx=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Yv("rc",t),r=ly(t),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),o=n.slice(-2),a=t<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},Px={};function Dx(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?Ix:lx;if("elu"===e)return t?Ax:hx;if("relu6"===e)return t?Tx:cx;if("prelu"===e)return t?_y:wy;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var Rx=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Ud().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var i=xp(Ud().getNumber("WEBGL_VERSION"));r.binaryCache=((n=Ud().getNumber("WEBGL_VERSION"))in Px||(Px[n]={}),Px[n]),r.gpgpu=new xb(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new Zb(r.gpgpu),r.numMBBeforeWarning=null==Ud().global.screen?1024:Ud().global.screen.height*Ud().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new uv(r,hp),r}return Fd(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(Ud().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:mp.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(Ud().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:mp.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,i=t.complexTensors,o=t.slice,a=t.shape,s=t.isPacked;if(null!=o){var u;u=s?new Ox(a,Cx):new ax(a,Cx);var l=this.runWebGLProgram(u,[{dataId:e,shape:a,dtype:r}],r),c=this.readSync(l.dataId);return this.disposeData(l.dataId),c}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,d,f=null!=this.activeTimers;return f&&(h=Rf()),d="complex64"===r?Av(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(e),f&&(this.downloadWaitMs+=Rf()-h),this.convertAndCacheOnCPU(e,d)},t.prototype.read=function(e){return Ld(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,l,c,h,d,f,p,m,g,v,y,b,x,w,E;return Bd(this,function(_){switch(_.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise(function(e){return t.push(e)})];if(n=this.texData.get(e),r=n.values,i=n.shape,o=n.slice,a=n.dtype,s=n.complexTensors,u=n.isPacked,null!=o)return void 0,l=u?new Ox(i,Cx):new ax(i,Cx),c=this.runWebGLProgram(l,[{dataId:e,shape:i,dtype:a}],a),h=this.read(c.dataId),this.disposeData(c.dataId),[2,h];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!Ud().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Ud().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==a&&Ud().get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(e),p=this.texData.get(f.dataId),d=(E=this.gpgpu).createBufferFromTexture.apply(E,[p.texture].concat(Ep(i)))),this.pendingRead.set(e,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_.sent(),_.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return g=_.sent(),v=g[0],y=g[1],m=Av(v,y),[3,5];case 4:null==d?m=this.getValuesFromTexture(e):(b=of(i),m=this.gpgpu.downloadFloat32MatrixFromBuffer(d,b)),_.label=5;case 5:return null!=f&&this.disposeData(f.dataId),x=this.convertAndCacheOnCPU(e,m),w=this.pendingRead.get(e),this.pendingRead.delete(e),w.forEach(function(e){return e(x)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,x]}})})},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Cp(n)){if(Ud().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,i=n.dtype,o=n.isPacked,a=of(r);if(Ud().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),l=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(Ep(r))).subarray(0,a);return this.disposeData(s.dataId),l}var c=Ud().getBool("WEBGL_PACK")&&!0===o,h=c?tm(r):r,d=c?new Yy(h):new Xy(h),f=this.runWebGLProgram(d,[{shape:h,dtype:i,dataId:e}],"float32"),p=this.texData.get(f.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,a);return this.disposeData(f.dataId),m},t.prototype.time=function(e){return Ld(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return Bd(this,function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),i=rf(this.activeTimers.map(function(e){return e.query})).filter(function(e){return null!=e}),o=rf(this.activeTimers.map(function(e){return e.name})).filter(function(e){return null!=e}),this.activeTimers=t,r&&(this.programTimersStack=null),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return s=u.sent(),a.kernelMs=Jd(s),a.getExtraProfileInfo=function(){return s.map(function(e,t){return{name:o[t],ms:e}}).map(function(e){return e.name+": "+e.ms}).join(", ")},[3,3];case 2:a.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Rf(),endMs:null}},t.prototype.endTimer=function(e){return Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Rf(),e)},t.prototype.getQueryTime=function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){return Ud().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,i=t.texShape,o=t.usage,a=t.isPacked,s=t.slice,u=s&&s.origDataId||e,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,a)));var c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return Ud().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=hp.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every(function(e){return null==n.texData.get(e.dataId).texture&&e.size<t})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:hp.keep(e.clone()),imag:hp.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===of(n))return Lm([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,i=rv(e.shape,t,n);if(r||!i){var o=Ud().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Qb(n):new Xb(n),a=o.getCustomSetupFunc(t);return this.compileAndRun(o,[e],null,a)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),i=this.makeOutput(n,e.dtype),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=e.dtype;var a=iv(t,e.strides);r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,s+1),i},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var i=ev(t,n,r);if(i.some(function(e){return 0===e}))return Lm([],i);var o=new $b(t,r,i);return this.compileAndRun(o,[e])},t.prototype.reverse=function(e,t){var n=Ud().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hb(e.shape,t):new Wb(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map(function(e){return jm(e)}),r=e.map(function(e){return Fm(e)});return Mm(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>Ud().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(e.length/2),o=this.concat(e.slice(0,i),t),a=this.concat(e.slice(i),t);return this.concat([o,a],t)}if(Ud().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new Ay(e.map(function(e){return e.shape}),t);return this.compileAndRun(s,e)}var u=Dm(e.map(function(e){return e.shape}),t),l=e.map(function(e){return e.as2D(-1,of(e.shape.slice(t)))}),c=new Ty(l.map(function(e){return e.shape}));return this.compileAndRun(c,l).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,fx,e.dtype);var t=new ax(e.shape,fx);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],a=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===i||1===o)&&a>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===o?e:e.as3D(s,a,1),l=1===o?2:1,c=1===o?t.as3D(s,1,a):t;return this.multiply(u,c).sum(l,!0)}var h=rp(e.dtype,t.dtype),d=new Tb(e.shape,[s,i,o],n,r);return this.compileAndRun(d,[e,t],h)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,i=e.transposeB,o=e.bias,a=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],l=i?n.shape[1]:n.shape[2],c=t.shape[0],h=rp(t.dtype,n.dtype),d=null!=o,f=null!=s,p=a?Dx(a,!0):null,m=new Tb(t.shape,[c,u,l],r,i,d,p,f),g=[t,n];return o&&g.push(o),s&&g.push(s),this.compileAndRun(m,g,h)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),i=new vy("return areal * breal - aimag * bimag;",e.shape,t.shape),o=new vy("return areal * bimag + aimag * breal;",e.shape,t.shape),a=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(i,a),u=this.compileAndRun(o,a),l=this.complex(s,u);return s.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,xy,e.dtype);var c=new Ey(xy,e.shape,t.shape);return this.compileAndRun(c,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,i,o){var a=[e,t,n],s=null;null!=o&&(s=o.shape,a.push(o));var u=null;if(null!=i&&(u=i.shape,a.push(i)),Ud().getBool("WEBGL_PACK_NORMALIZATION")){var l=new gy(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,a)}var c=new my(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,a)},t.prototype.localResponseNormalization4D=function(e,t,n,r,i){var o=Ud().getBool("WEBGL_PACK_NORMALIZATION")?new kb(e.shape,t,n,r,i):new _b(e.shape,t,n,r,i);return this.compileAndRun(o,[e])},t.prototype.LRNGrad=function(e,t,n,r,i,o,a){var s=new Sb(t.shape,r,i,o,a);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map(function(e){return Ff(e)});return Vv(mg(e.shape,e.dtype,n),t)}var r=new tx(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=Ud().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Db(e.shape,t,n):new Pb(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=Ud().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rx(e.shape,t):new nx(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new eb(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){ef(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),i=Vg(e.shape,t,r),o=Wg(i.length,t.length),a=Hg(e.shape,t,r),s=qg(n,t.length),u=Gg(a,n,t.length);return e.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){ef(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),i=[[0,0]];i.push.apply(i,n);for(var o=1+t.length;o<e.shape.length;++o)i.push([0,0]);var a=e.pad(i),s=Vg(a.shape,t,r,!1),u=Wg(s.length,t.length,!1),l=Hg(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],i=e.shape[1],o=Xg(i),a=new jb({windowSize:o,inSize:i,batchSize:r},t),s=this.compileAndRun(a,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],i=e.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=Xg(i),a=new Kv({windowSize:o,inSize:i,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(a,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,i=Xg(r[r.length-1]),o=new dy(r,i,t,null==n),a=null==n?[e]:[e,n],s=this.compileAndRun(o,a,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){Tm("sum",t,e.rank);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i),a=ip(e.dtype);return this.reduce(o,"sum",a).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i),a=ip(e.dtype);return this.reduce(o,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,i=Am([r],e.rank),o=e;null!=i&&(o=e.transpose(i),r=Nm(1,e.rank)[0]);var a=function(e,t,n){for(var r=[],i=e.length,o=0;o<i;o++)o!==t?r.push(e[o]):r.push(n);return r}(o.shape,r,n),s=of([o.shape[r]]),u=o.as2D(-1,s),l=ip(e.dtype),c=this.segOpCompute(u,"unsortedSegmentSum",t,l,n).reshape(a);return null!=i&&(c=c.transpose(Om(i))),c},t.prototype.segOpCompute=function(e,t,n,r,i){var o=e.shape[0],a=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=Tf(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Tf(e,n+1);return n}(a,i),u=new Gb({windowSize:s,inSize:a,batchSize:o,numSegments:i},t),l=this.compileAndRun(u,[e,n],r);return l.shape[1]===i?l:(n=Xm(0,i).tile([a/s]),this.segOpCompute(l,t,n,r,i))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(Tm("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!Ud().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var i=Cm(e.shape,r),o=i[0],a=of(i[1]),s=e.as2D(-1,a);return this.argReduce(s,n).reshape(o)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var i=new Vy(e.shape,n,r);return this.compileAndRun(i,[e])},t.prototype.equal=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new Ey("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Ey("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Ey("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Ey("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Ey("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Ey("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new ax(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Ey("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Ey("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new Kb(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],rp(t.dtype,n.dtype))},t.prototype.where=function(e){bm("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Hv(e.shape,t)},t.prototype.topk=function(e,t,n){return Wv(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Tm("min",t,e.rank);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Ey("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Ey("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);Tm("max",t,e.rank);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Ey("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){Tm("all",t,e.rank);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(e,t){Tm("any",t,e.rank);var n=Cm(e.shape,t),r=n[0],i=of(n[1]),o=e.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new Ey("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Ey("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,yy);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=rp(e.dtype,t.dtype);if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,yy,n);var r=new Ey(yy,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new Ox(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,i){void 0===i&&(i=!1);var o=new Sy(n,e.shape,t.shape,i);return this.compileAndRun(o,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,i=this.texData.get(e.dataId),o=this.texData.get(t.dataId),a=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map(function(i){var o=i[0],a=i[1],s=r.makeComplexComponentTensorInfo(e,o),u=r.makeComplexComponentTensorInfo(t,a),l=new Ey(n,e.shape,t.shape);return r.compileAndRun(l,[s,u],rp(o.dtype,a.dtype))}),s=a[0],u=a[1],l=this.complex(s,u);return s.dispose(),u.dispose(),l},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>Ud().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var i=e.map(function(e){return e.dtype}).reduce(function(e,t){return rp(e,t)}),o=e.map(function(e){return e.shape}),a=Ud().getBool("WEBGL_PACK")?new Gv(e[0].shape,o):new qv(e[0].shape,o);return this.compileAndRun(a,e,i)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,by);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=rp(e.dtype,t.dtype);if(Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,by,e.dtype);var r=new Ey(by,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Ey("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=rp(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,px,e.dtype);var t=new ax(e.shape,px);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,mx,e.dtype);var t=new ax(e.shape,mx);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new ax(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new ax(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new ax(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new ax(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new ax(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,gx,e.dtype);var t=new ax(e.shape,gx);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,vx,e.dtype);var t=new ax(e.shape,vx);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=ff([t],e.shape),r=this.max(e,n),i=Im(r.shape,n),o=this.subtract(e,r.reshape(i)),a=this.exp(o),s=this.sum(a,n).reshape(i);return this.realDivide(a,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new ax(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new ax(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new ax(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new ax(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new ax(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=Ud().getBool("WEBGL_PACK")?new Ox(e.shape,Ix):new ax(e.shape,lx),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=Ud().getBool("WEBGL_PACK")?new Ox(e.shape,Tx):new ax(e.shape,cx),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy(_y,e.shape,t.shape):new Ey(wy,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ax,e.dtype);var t=new ax(e.shape,hx);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new Ey("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new ax(e.shape,dx);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new ax(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,i=(r=Ud().getBool("WEBGL_PACK_CLIP")?new Cy(e.shape):new ky(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,i)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(Ud().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ux,e.dtype);var t=new ax(e.shape,ux);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new Iy(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new ax(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new ax(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new ax(e.shape,yx);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new ax(e.shape,bx);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new ax(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new ax(e.shape,xx);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new ax(e.shape,wx);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new ax(e.shape,Ex);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Ey("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new ax(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new ax(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new ax(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new ax(e.shape,_x);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new ax(e.shape,Sx);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new ax(e.shape,kx);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new ax(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new ax(e.shape,function(e){return void 0===e&&(e=0),sx+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,i,o){var a=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,l=a[0]*a[1]*a[2],c=n.outChannels,h="channelsLast"===n.dataFormat,d=(1===l||1===c)&&u>1e3,f=a[2]%2!=0&&!!s.isPacked;if(d||!Ud().getBool("WEBGL_LAZILY_UNPACK")||!Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!f){var p=h?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],m=this.reshape(e,[1,p,n.inChannels]),g=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:g,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),n.outShape)}var v=h?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),y={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,ef(im(s.shape,y.shape),function(){return"packed reshape "+s.shape+" to "+y.shape+" isn't free"});var x=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:y,b:x,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),E=this.texData.get(w.dataId);return ef(E.isPacked,function(){return"batchMatMul result is expected to be packed"}),s.shape=b,E.shape=n.outShape,hp.makeTensorFromDataId(w.dataId,n.outShape,w.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,i,o){var a=n.filterWidth,s=n.filterHeight,u=n.inChannels,l=n.outWidth,c=n.outHeight,h="channelsLast"===n.dataFormat,d=a*s*u,f=c*l,p=[d,f],m=e.squeeze([0]),g=t.reshape([1,d,-1]),v=new Eb(p,m.shape,n),y=this.compileAndRun(v,[m]).reshape([1,p[0],p[1]]),b=null!=r,x=null!=o,w=i?Dx(i,!0):null,E=new Tb(y.shape,[1,f,n.outChannels],!0,!1,b,w,x),_=[y,g];r&&_.push(r),x&&_.push(o);var S=this.compileAndRun(E,_);return h?S.reshape([1,c,l,n.outChannels]):S.reshape([1,n.outChannels,c,l])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,o=e.activation,a=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,i,o,a);if(Ud().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,i,o,a);var s=null!=i,u=null!=a,l=o?Dx(o,!1):null,c=new Fy(r,s,l,u),h=[t,n];return i&&h.push(i),a&&h.push(a),this.compileAndRun(c,h)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(Ud().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Fy(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new Py(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new Ny(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,i=e.convInfo,o=e.bias,a=e.activation,s=e.preluActivationWeights,u=Ud().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,l=a?Dx(a,u):null,c=[n,r],h=null!=o,d=null!=s;return h&&c.push(o),d&&c.push(s),u?(t=new zy(i,h,l,d),this.compileAndRun(t,c)):(t=new By(i,h,l,d),this.compileAndRun(t,c))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return Ud().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new zy(n),this.compileAndRun(r,[e,t])):(r=new By(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new jy(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new My(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new Ly(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new Ry(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new Dy(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new Rb(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new Rb(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var i=new Rb(r,"max",!0),o=this.compileAndRun(i,[t]),a=new Cb(r),s=this.compileAndRun(a,[e,o],t.dtype);return o.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new fy(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return Cv(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),i=0,o=0;o<e.rank;o++)o!==t&&(r[i++]=e.shape[o]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[t]=o,u[o]=this.slice(e,a,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new Mb(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new py(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new Mb(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var i=new Mb(r,"max",!0),o=this.compileAndRun(i,[t]),a=new Ib(r),s=this.compileAndRun(a,[e,o],t.dtype);return o.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!im(e.shape,t)&&(null===n.texture||!im(n.shape,t))){var r=this.packedReshape(e,t);return hp.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Iv(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var i=Ud().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zb(e.shape,t,n,r):new Bb(e.shape,t,n,r);return this.compileAndRun(i,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new Lb(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var i=new Vb(e.shape,t,n,r);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new Ub(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var i=t?e:av(e),o=i.shape[0],a=i.shape[1],s=new Ab(o,a,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[i],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var i=new Ob(e.size,t,n,r);return this.compileAndRun(i,[e])},t.prototype.diag=function(e){var t=new Ky(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,i){return bm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Mv(e.dataSync(),t.dataSync(),n,r,i)},t.prototype.cropAndResize=function(e,t,n,r,i,o){var a=new Uy(e.shape,t.shape,r,i,o);return this.compileAndRun(a,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){ef(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});var r=e.shape[0],i="NHWC"===n?e.shape[1]:e.shape[2],o="NHWC"===n?e.shape[2]:e.shape[3],a="NHWC"===n?e.shape[3]:e.shape[1],s=i*t,u=o*t,l=a/(t*t),c=new Gy("NHWC"===n?[r,s,u,l]:[r,l,s,u],t,n);return this.compileAndRun(c,[e])},t.prototype.split=function(e,t,n){return Uv(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=$g(0,e,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=[u/a,a],c=e.reshape([o,i]),h=t.reshape([o,a]);if(0===u)return Iv(Lm([]),n);var d=zm(0),f=new qb(o,i,c.rank,h.rank,s,l);return this.compileAndRun(f,[h,c,d]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var i=$g(0,e,n),o=i.sliceRank,a=i.numUpdates,s=i.strides,u=i.outputSize,l=new qb(a,o,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(l,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Zy("return real * expR - imag * expI;",e.shape,t),i=new Zy("return real * expI + imag * expR;",e.shape,t),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],a=this.compileAndRun(r,o),s=this.compileAndRun(i,o),u=this.complex(a,s).as2D(e.shape[0],e.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],i=Kg(e,t),o=i[0],a=i[1],s=i[2],u=i[3],l=t.reshape([a,r]),c=e.reshape([e.size/s,s]),h=new tb(r,u,[a,s]);return this.compileAndRun(h,[c,l]).reshape(o)},t.prototype.fill=function(e,t,n){if("string"===(n=n||Cf(t))){var r=gf(n,of(e));return r.fill(t),hp.makeTensor(r,e,n,this)}var i=new Jy(e,t),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[],n,o)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return Tv(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return hp.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new Nx(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new Nb(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[Jp(e.shape)].concat(em(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},i=[Jp(t)].concat(em(t)),o=new Fb(i,n),a=this.runWebGLProgram(o,[r],e.dtype,null,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,i=n.shape,o=n.dtype,a=tm(i);return t=r?new qy(a):new Hy(a),{dtype:o,shape:i,dataId:this.runWebGLProgram(t,[{shape:a,dtype:o,dataId:e}],o,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,i){var o=this;void 0===i&&(i=!1);var a=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(a.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===pp.DENSE){var u=Ep(e.outputShape);s.texShape=u.map(function(e){return 2*e})}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===of(a.shape))return s.values=mf(a.dtype,0),a;var l=[],c=t.map(function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&of(t.shape)<=Ud().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?o.unpackTensor(t):o.packTensor(t),l.push(t),n=o.texData.get(t.dataId);else if(n.isPacked&&!im(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=o.packedReshape(t,i),l.push(t),n=o.texData.get(t.dataId),r.shape=i}return o.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(a.dataId);var h,d={shape:a.shape,texData:s,isUniform:!1},f=function(e,t,n){var r="";t.concat(n).forEach(function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t});var i=e.userCode;return e.constructor.name+"_"+r+"_"+i}(e,c,d),p=this.getAndSaveBinary(f,function(){return function(e,t,n,r){var i=t.userCode,o=n.map(function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),a=o.map(function(e){return e.shapeInfo}),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=ey(o,s,i,t.packedInputs),l=e.createProgram(u),c=null,h=e.getUniformLocation(l,"NAN",!1);1===Ud().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(l,"INFINITY",!1));for(var d={},f=0;f<t.variableNames.length;f++){var p=t.variableNames[f];d[p]=e.getUniformLocation(l,p,!1),d["offset"+p]=e.getUniformLocation(l,"offset"+p,!1)}return{program:t,source:u,webGLProgram:l,uniformLocations:d,inShapeInfos:a,outShapeInfo:s,infLoc:c,nanLoc:h}}(o.gpgpu,e,c,d)}),m=null!=this.activeTimers;if(m&&(h=this.startTimer()),function(e,t,n,r,i){wb(t.inShapeInfos,n),wb([t.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o,a[0],a[1]):e.setOutputMatrixTexture(o,a[0],a[1]),e.setProgram(t.webGLProgram),1===Ud().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach(function(n,r){var i=t.program.variableNames[r],o=t.uniformLocations[i],a=t.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(of(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(o,s)}else null!=n.texData.slice&&null!=a&&e.gl.uniform1i(a,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,o,r)}),null!=i&&i(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,p,c,d,r),l.forEach(function(e){return o.disposeData(e.dataId)}),m&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!Ud().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var g=this.unpackTensor(a);return this.disposeData(a.dataId),g}return a},t.prototype.compileAndRun=function(e,t,n,r,i){void 0===i&&(i=!1),n=n||t[0].dtype;var o=this.runWebGLProgram(e,t,n,r,i);return hp.makeTensorFromDataId(o.dataId,o.shape,o.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(Ud().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=vm(function(){if(!Ud().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Ud().getBool("DEBUG");Ud().set("DEBUG",!1);var n=e.abs(zm(1e-8)).dataSync()[0];if(Ud().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,i=n.dtype,o=n.values,a=n.texture,s=n.usage,u=n.isPacked;if(null==a){var l,c=null!=this.activeTimers;c&&(l=Rf());var h=n.texShape;if(null==h&&(h=nm(r,u),n.texShape=h),null!=o){var d=tm(r),f=void 0,p=h[1],m=h[0],g=o instanceof Uint8Array;u?(p=(t=_p(h[0],h[1]))[0],m=t[1],f=new $y(d,[m,p],g)):f=new Qy(d,[m,p],g);var v=this.makeTensorInfo([m,p],i);this.texData.get(v.dataId).usage=g?mp.PIXELS:mp.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,o);var y=this.runWebGLProgram(f,[v],i,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(v.dataId),this.texData.delete(y.dataId),n.values=null,c&&(this.uploadWaitMs+=Rf()-l)}else{var x=this.acquireTexture(h,s,i,u);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*wf(t)},t}(lv);dp()&&hp.registerBackend("webgl",function(){return new Rx},2);var Mx=Rm({square_:function(e){var t=Em(e,"x","square"),n=[t];return hp.runKernelFunc(function(e,n){return n([t]),e.square(t)},{x:t},null,"Square",{},n,[])}}),jx="SquaredDifference",Fx=Rm({squaredDifference_:function(e,t){var n,r=Em(e,"a","squaredDifference"),i=Em(t,"b","squaredDifference");n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape);var o={a:r,b:i},a=[r,i];return hp.runKernelFunc(function(e,t){var n=e.squaredDifference(r,i);return t([r,i]),n},o,function(e,t){var n=t[0],r=t[1],i=zm(2);return{a:function(){return e.mul(n.sub(r).mul(i))},b:function(){return e.mul(r.sub(n).mul(i))}}},jx,{},a,[])}}),Lx=Rm({abs_:function(e){var t=Em(e,"x","abs");return"complex64"===t.dtype?hp.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):hp.runKernelFunc(function(e,n){var r=e.abs(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}},"Abs")}}),Bx=Rm({acos_:function(e){var t=Em(e,"x","acos");return hp.runKernelFunc(function(e,n){var r=e.acos(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(zm(1).sub(n.toFloat().square()).sqrt()).neg()}}})}}),zx=Rm({acosh_:function(e){var t=Em(e,"x","acosh");return hp.runKernelFunc(function(e,n){var r=e.acosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}})}}),Ux=Rm({asin_:function(e){var t=Em(e,"x","asin");return hp.runKernelFunc(function(e,n){var r=e.asin(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(zm(1).sub(n.toFloat().square()).sqrt())}}})}}),Vx=Rm({asinh_:function(e){var t=Em(e,"x","asinh");return hp.runKernelFunc(function(e,n){var r=e.asinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(zm(1).add(n.toFloat().square()).sqrt())}}})}}),Wx=Rm({atan_:function(e){var t=Em(e,"x","atan");return hp.runKernelFunc(function(e,n){var r=e.atan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}})}}),Hx=Rm({atanh_:function(e){var t=Em(e,"x","atanh");return hp.runKernelFunc(function(e,n){var r=e.atanh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(zm(1).sub(n.toFloat().square()))}}})}}),qx=Rm({ceil_:function(e){var t=Em(e,"x","ceil");return hp.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),Gx=Rm({clipByValue_:function(e,t,n){var r=Em(e,"x","clipByValue");ef(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],o={min:t,max:n};return hp.runKernelFunc(function(e,i){var o=e.clip(r,t,n);return i([r]),o},{x:r},function(e,r){var i=r[0];return{x:function(){return e.where(i.greaterEqual(t).logicalAnd(i.lessEqual(n)),Qm(e))}}},"ClipByValue",o,i)}}),Kx=Rm({cos_:function(e){var t=Em(e,"x","cos"),n=[t];return hp.runKernelFunc(function(e,n){var r=e.cos(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}},"Cos",{},n)}}),Xx=Rm({cosh_:function(e){var t=Em(e,"x","cosh");return hp.runKernelFunc(function(e,n){var r=e.cosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}})}}),Yx=Rm({erf_:function(e){var t=Em(e,"x","erf");return ef("int32"===t.dtype||"float32"===t.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===t.dtype&&(t=t.toFloat()),hp.runKernelFunc(function(e,n){var r=e.erf(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Qx=Rm({exp_:function(e){var t=Em(e,"x","exp");return hp.runKernelFunc(function(e,n){var r=e.exp(t);return n([r]),r},{x:t},function(e,t){return{x:function(){return e.mulStrict(t[0])}}},"Exp",{},[],[!0])}}),$x=Rm({expm1_:function(e){var t=Em(e,"x","expm1");return hp.runKernelFunc(function(e,n){var r=e.expm1(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}})}}),Zx=Rm({floor_:function(e){var t=Em(e,"x","floor");return hp.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),Jx=Rm({log_:function(e){var t=Em(e,"x","log"),n=[t];return hp.runKernelFunc(function(e,n){var r=e.log(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}},"Log",{},n)}}),ew=Rm({log1p_:function(e){var t=Em(e,"x","log1p");return hp.runKernelFunc(function(e,n){var r=e.log1p(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}})}}),tw=Rm({logSigmoid_:function(e){var t=Em(e,"x","logSigmoid");return hp.runKernelFunc(function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}})}}),nw=Rm({neg_:function(e){var t=Em(e,"x","neg"),n=[t];return hp.runKernelFunc(function(e){return e.neg(t)},{x:t},function(e){return{x:function(){return e.neg()}}},"Neg",{},n)}}),rw=Rm({reciprocal_:function(e){var t=Em(e,"x","reciprocal");return hp.runKernelFunc(function(e,n){var r=e.reciprocal(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}})}}),iw=Rm({round_:function(e){var t=Em(e,"x","round");return hp.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),ow=Rm({rsqrt_:function(e){var t=Em(e,"x","rsqrt"),n=[t];return hp.runKernelFunc(function(e,n){var r=e.rsqrt(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),aw=Rm({sigmoid_:function(e){var t=Em(e,"x","sigmoid");return hp.runKernelFunc(function(e,n){var r=e.sigmoid(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(zm(1).sub(n)))}}},"Sigmoid")}}),sw=Rm({sign_:function(e){var t=Em(e,"x","sign");return hp.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),uw=Rm({isNaN_:function(e){var t=Em(e,"x","isNaN");return hp.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),lw=Rm({isInf_:function(e){var t=Em(e,"x","isInf");return hp.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),cw=Rm({isFinite_:function(e){var t=Em(e,"x","isFinite");return hp.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return Qm(e)}}})}}),hw=Rm({sin_:function(e){var t=Em(e,"x","sin"),n=[t];return hp.runKernelFunc(function(e,n){var r=e.sin(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}},"Sin",{},n)}}),dw=Rm({sinh_:function(e){var t=Em(e,"x","sinh");return hp.runKernelFunc(function(e,n){var r=e.sinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}})}}),fw=Rm({softplus_:function(e){var t=Em(e,"x","softplus");return hp.runKernelFunc(function(e,n){var r=e.softplus(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}})}}),pw=Rm({sqrt_:function(e){var t=Em(e,"x","sqrt");return hp.runKernelFunc(function(e,n){var r=e.sqrt(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}})}}),mw=Rm({step_:function(e,t){void 0===t&&(t=0);var n=Em(e,"x","step");return hp.runKernelFunc(function(e){return e.step(n,t)},{$x:n},function(e){return{$x:function(){return Qm(e)}}})}}),gw=Rm({tan_:function(e){var t=Em(e,"x","tan");return hp.runKernelFunc(function(e,n){var r=e.tan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}})}}),vw=Rm({tanh_:function(e){var t=Em(e,"x","tanh");return hp.runKernelFunc(function(e,n){var r=e.tanh(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return zm(1).sub(n.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function yw(e,t,n,r,i,o){var a,s,u=Em(e,"x","batchNorm"),l=Em(t,"mean","batchNorm"),c=Em(n,"variance","batchNorm");return null!=i&&(a=Em(i,"scale","batchNorm")),null!=r&&(s=Em(r,"offset","batchNorm")),ef(2===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),ef(2===l.rank||1===l.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),ef(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),null!=a&&ef(2===a.rank||1===a.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),null!=s&&ef(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),ww(u,l,c,s,a,o)}function bw(e,t,n,r,i,o){var a,s,u=Em(e,"x","batchNorm"),l=Em(t,"mean","batchNorm"),c=Em(n,"variance","batchNorm");return null!=i&&(a=Em(i,"scale","batchNorm")),null!=r&&(s=Em(r,"offset","batchNorm")),ef(3===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),ef(3===l.rank||1===l.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),ef(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),null!=a&&ef(3===a.rank||1===a.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),null!=s&&ef(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),ww(u,l,c,s,a,o)}function xw(e,t,n,r,i,o){var a,s,u=Em(e,"x","batchNorm"),l=Em(t,"mean","batchNorm"),c=Em(n,"variance","batchNorm");return null!=i&&(a=Em(i,"scale","batchNorm")),null!=r&&(s=Em(r,"offset","batchNorm")),ef(4===u.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),ef(4===l.rank||1===l.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),ef(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),null!=a&&ef(4===a.rank||1===a.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),null!=s&&ef(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),ww(u,l,c,s,a,o)}function ww(e,t,n,r,i,o){null==o&&(o=.001);var a,s,u,l=Em(e,"x","batchNorm"),c=Em(t,"mean","batchNorm"),h=Em(n,"variance","batchNorm");null!=i&&(a=Em(i,"scale","batchNorm")),null!=r&&(s=Em(r,"offset","batchNorm")),ef(c.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),ef(null==s||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),ef(null==a||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var d=[l,c,h,a];return hp.runKernelFunc(function(e,t){var n=e.batchNormalization(u,Ew(c),Ew(h),o,Ew(a),Ew(s));return t([l,c,h,a]),n},{x:l,mean:c,variance:h,scale:a,offset:s},function(e,t){var n=t,r=n[0],i=n[1],a=n[2],s=n[3],l=null==s?zm(1):s,c=dv(i.shape,u.shape),h=[];if(1===i.rank){for(var d=0;d<u.shape.length-1;++d)h.push(u.shape[d]);h.push(1)}var f=r.sub(i),p=e.mul(l),m=ow(a.add(zm(o))),g=m.mul(m).mul(m).mul(zm(-.5));return{x:function(){return 1===i.rank?e.mul(Bg(m.as4D(1,1,1,i.shape[0]),h)).mul(l).reshape(r.shape):e.mul(m).mul(l).reshape(r.shape)},mean:function(){var e=m.mul(zm(-1)).mul(p);return 1===i.rank&&(e=e.sum(c)),e.reshape(i.shape)},variance:function(){var e=g.mul(f).mul(p);return 1===i.rank&&(e=e.sum(c)),e.reshape(i.shape)},scale:function(){var t=f.mul(m),n=e.mul(t);return 1===i.rank&&(n=n.sum(c)),n.reshape(i.shape)},offset:function(){var t=e;return 1===i.rank&&(t=t.sum(c)),t.reshape(i.shape)}}},"BatchNormalization",{varianceEpsilon:o},d).reshape(l.shape)}function Ew(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function _w(){gm("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Sw=Rm({batchNormalization2d_:function(e,t,n,r,i,o){return void 0===r&&(r=.001),_w(),yw(e,t,n,o,i,r)}}),kw=Rm({batchNormalization3d_:function(e,t,n,r,i,o){return void 0===r&&(r=.001),_w(),bw(e,t,n,o,i,r)}}),Cw=Rm({batchNormalization4d_:function(e,t,n,r,i,o){return void 0===r&&(r=.001),_w(),xw(e,t,n,o,i,r)}}),Iw=Rm({batchNormalization_:function(e,t,n,r,i,o){return void 0===r&&(r=.001),_w(),ww(e,t,n,o,i,r)}}),Tw=Rm({batchNorm_:ww}),Aw=Rm({batchNorm2d_:yw}),Ow=Rm({batchNorm3d_:bw}),Nw=Rm({batchNorm4d_:xw}),Pw=Rm({logicalAnd_:function(e,t){var n=Em(e,"a","logicalAnd","bool"),r=Em(t,"b","logicalAnd","bool");return fv(n.shape,r.shape),hp.runKernelFunc(function(e){return e.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),Dw=Rm({logicalNot_:function(e){var t=Em(e,"x","logicalNot","bool");return hp.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),Rw=Rm({logicalOr_:function(e,t){var n=Em(e,"a","logicalOr","bool"),r=Em(t,"b","logicalOr","bool");return fv(n.shape,r.shape),hp.runKernelFunc(function(e){return e.logicalOr(n,r)},{$a:n,$b:r})}}),Mw=Rm({logicalXor_:function(e,t){var n=Em(e,"a","logicalXor","bool"),r=Em(t,"b","logicalXor","bool");return fv(n.shape,r.shape),Rw(e,t).logicalAnd(Pw(e,t).logicalNot())}}),jw=Rm({where_:function(e,t,n){var r=Em(t,"a","where"),i=Em(n,"b","where"),o=Em(e,"condition","where","bool");return tf(r.shape,i.shape,"Error in where: "),1===o.rank?ef(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):tf(o.shape,i.shape,"Error in where: "),hp.runKernelFunc(function(e,t){var n=e.select(o,r,i);return t([o]),n},{$condition:o,$a:r,$b:i},function(e,t){var n=t[0];return{$condition:function(){return Qm(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}})}}),Fw=function(e){return Ld(this,void 0,void 0,function(){var t,n,r;return Bd(this,function(i){switch(i.label){case 0:return[4,(t=Em(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=Hv(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Lw=Rm({add_:function(e,t){var n,r=Em(e,"a","add"),i=Em(t,"b","add");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e){return e.add(r,i)},{a:r,b:i},function(e){return{a:function(){var t=e,n=dv(r.shape,o);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=dv(i.shape,o);return n.length>0&&(t=t.sum(n)),t.reshape(i.shape)}}},"Add")}}),Bw=Rm({addN_:function(e){ef(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),ef(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(e,t){return Em(e,"tensors"+t,"addN")}),n=t[0];t.forEach(function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(e){if(!af(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return hp.runKernelFunc(function(e){return e.addN(t)},r,function(e){var n={};return t.forEach(function(t,r){n[r]=function(){return e.clone()}}),n},"AddN")}}),zw=Rm({addStrict_:function(e,t){var n=Em(e,"a","addStrict"),r=Em(t,"b","addStrict");return tf(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Uw=Rm({atan2_:function(e,t){var n,r=Em(e,"a","atan2"),i=Em(t,"b","atan2");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e,t){var n=e.atan2(r,i);return t([r,i]),n},{$a:r,$b:i},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Lw(n.square(),r.square()),i=e.mul(r.div(t)),a=dv(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var t=Lw(n.square(),r.square()),i=nw(e.mul(n.div(t))),a=dv(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}})}}),Vw=Rm({div_:function(e,t){var n,r=Em(e,"a","div"),i=Em(t,"b","div");if(n=op(r,i),r=n[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return qw(r,i);var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e,t){var n=e.realDivide(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),i=dv(n.shape,o);return i.length>0?t.sum(i).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),i=dv(r.shape,o);i.length>0&&(t=t.sum(i).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}},"Div")}}),Ww=Rm({divNoNan_:function(e,t){var n,r=Em(e,"a","div"),i=Em(t,"b","div");r=(n=op(r,i))[0],i=n[1];var o=Vw(r,i),a=Qm(o),s=i.equal(a);return jw(s,a,o)}}),Hw=Rm({divStrict_:function(e,t){var n=Em(e,"a","div"),r=Em(t,"b","div");return tf(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),qw=Rm({floorDiv_:function(e,t){var n,r=Em(e,"a","floorDiv"),i=Em(t,"b","floorDiv");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e,t){var n=e.floorDiv(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),i=dv(n.shape,o);return i.length>0?t.sum(i).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),i=dv(r.shape,o);i.length>0&&(t=t.sum(i).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}},"FloorDiv")}}),Gw=Rm({maximum_:function(e,t){var n,r=Em(e,"a","maximum"),i=Em(t,"b","maximum");return n=op(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),fv(r.shape,i.shape),hp.runKernelFunc(function(e,t){var n=e.maximum(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}},"Maximum")}}),Kw=Rm({maximumStrict_:function(e,t){var n=Em(e,"a","maximumStrict"),r=Em(t,"b","maximumStrict");return tf(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Xw=Rm({minimum_:function(e,t){var n,r=Em(e,"a","minimum"),i=Em(t,"b","minimum");return n=op(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),fv(r.shape,i.shape),hp.runKernelFunc(function(e,t){var n=e.minimum(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}},"Minimum")}}),Yw=Rm({minimumStrict_:function(e,t){var n=Em(e,"a","minimumStrict"),r=Em(t,"b","minimumStrict");return tf(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Qw=Rm({mod_:function(e,t){var n,r=Em(e,"a","mod"),i=Em(t,"b","mod");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e,t){var n=e.mod(r,i);return t([r,i]),n},{$a:r,$b:i},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=dv(n.shape,o);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),i=dv(r.shape,o);return i.length>0?t.sum(i).reshape(r.shape):t}}})}}),$w=Rm({modStrict_:function(e,t){var n=Em(e,"a","modStrict"),r=Em(t,"b","modStrict");return tf(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Zw=Rm({mul_:function(e,t){var n,r=Em(e,"a","mul"),i=Em(t,"b","mul");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e,t){var n=e.multiply(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),i=dv(n.shape,o);return i.length>0?t.sum(i).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),i=dv(r.shape,o);return i.length>0?t.sum(i).reshape(r.shape):t}}},"Mul")}}),Jw=Rm({mulStrict_:function(e,t){var n=Em(e,"a","mul"),r=Em(t,"b","mul");return tf(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),eE=Rm({pow_:function(e,t){var n,r=Em(e,"base","pow"),i=Em(t,"exp","pow");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape),a=[r,i];return hp.runKernelFunc(function(e,t){var n=e.pow(r,i);return t([r,i,n]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1],i=t[2];return{a:function(){var t=r.toFloat(),i=e.mul(t.mul(n.pow(t.sub(zm(1))))),a=dv(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},b:function(){var t=n.greater(0),a=n.log().where(t,Qm(n)),s=e.mul(i.mul(a)),u=dv(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}},"Pow",{},a,[!0])}}),tE=Rm({powStrict_:function(e,t){return tf(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),nE=Rm({squaredDifferenceStrict_:function(e,t){var n=Em(e,"a","squaredDifferenceStrict"),r=Em(t,"b","squaredDifferenceStrict");return tf(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),rE=Rm({sub_:function(e,t){var n,r=Em(e,"a","sub"),i=Em(t,"b","sub");n=op(r,i),r=n[0],i=n[1];var o=fv(r.shape,i.shape);return hp.runKernelFunc(function(e){return e.subtract(r,i)},{a:r,b:i},function(e){return{a:function(){var t=e,n=dv(r.shape,o);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=dv(i.shape,o);return n.length>0&&(t=t.sum(n)),t.neg().reshape(i.shape)}}},"Sub")}}),iE=Rm({subStrict_:function(e,t){var n=Em(e,"a","subStrict"),r=Em(t,"b","subStrict");return tf(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),oE=Rm({equal_:function(e,t){var n,r=Em(e,"a","equal"),i=Em(t,"b","equal");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e){return e.equal(r,i)},{$a:r,$b:i})}}),aE=Rm({equalStrict_:function(e,t){var n=Em(e,"a","equalStrict"),r=Em(t,"b","equalStrict");return tf(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),sE=Rm({greater_:function(e,t){var n,r=Em(e,"a","greater"),i=Em(t,"b","greater");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e){return e.greater(r,i)},{a:r,b:i},null,"Greater")}}),uE=Rm({greaterEqual_:function(e,t){var n,r=Em(e,"a","greaterEqual"),i=Em(t,"b","greaterEqual");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e,t){var n=e.greaterEqual(r,i);return t([r,i]),n},{a:r,b:i},function(e,t){var n=t[0],r=t[1];return{a:function(){return Qm(n)},b:function(){return Qm(r)}}},"GreaterEqual")}}),lE=Rm({greaterEqualStrict_:function(e,t){var n=Em(e,"a","greaterEqualStrict"),r=Em(t,"b","greaterEqualStrict");return tf(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),cE=Rm({greaterStrict_:function(e,t){var n=Em(e,"a","greaterStrict"),r=Em(t,"b","greaterStrict");return tf(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),hE=Rm({less_:function(e,t){var n,r=Em(e,"a","less"),i=Em(t,"b","less");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e){return e.less(r,i)},{a:r,b:i},null,"Less")}}),dE=Rm({lessEqual_:function(e,t){var n,r=Em(e,"a","lessEqual"),i=Em(t,"b","lessEqual");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e,t){var n=e.lessEqual(r,i);return t([r,i]),n},{a:r,b:i},null,"LessEqual")}}),fE=Rm({lessEqualStrict_:function(e,t){var n=Em(e,"a","lessEqualStrict"),r=Em(t,"b","lessEqualStrict");return tf(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),pE=Rm({lessStrict_:function(e,t){var n=Em(e,"a","lessStrict"),r=Em(t,"b","lessStrict");return tf(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),mE=Rm({notEqual_:function(e,t){var n,r=Em(e,"a","notEqual"),i=Em(t,"b","notEqual");return n=op(r,i),r=n[0],i=n[1],fv(r.shape,i.shape),hp.runKernelFunc(function(e){return e.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),gE=Rm({notEqualStrict_:function(e,t){var n=Em(e,"a","notEqualStrict"),r=Em(t,"b","notEqualStrict");return tf(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function vE(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function yE(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var bE=Rm({gather_:function(e,t,n){void 0===n&&(n=0);var r=Em(e,"x","gather"),i=Em(t,"indices","gather","int32");n=ff(n,r.shape)[0];var o=function(e,t,n){for(var r=e.shape[n],i=[],o=1,a=1,s=0;s<n;s++)i.push(e.shape[s]),o*=e.shape[s];for(s=0;s<t.rank;s++)i.push(t.shape[s]);for(s=n+1;s<e.rank;s++)i.push(e.shape[s]),a*=e.shape[s];return{batchSize:o,sliceSize:a,dimSize:r,outputShape:i}}(r,i,n);return hp.runKernelFunc(function(e,t){var o=e.gather(r,i.flatten(),n);return t([i]),o},{x:r,indices:i},function(e,t){var i=t[0];return{x:function(){var t=r.shape,o=i.size,a=t.slice(0,n),s=a.length,u=t.slice(n,t.length).slice(1),l=u.length,c=vE(0,s),h=vE(s+1,s+1+l),d=yE([a,[o],u]),f=e.reshape(d),p=i.reshape([o]),m=yE([[s],c,h]),g=f.transpose(m),v=xE(g,p,r.shape[n]),y=Om(m);return v.transpose(y)},indices:function(){return i}}},"Gather",{axis:n}).reshape(o.outputShape)}}),xE=Rm({unsortedSegmentSum_:function(e,t,n){var r=Em(e,"x","unsortedSegmentSum"),i=Em(t,"segmentIds","unsortedSegmentSum","int32");return ef(sf(n),function(){return"numSegments must be of dtype int"}),hp.runKernelFunc(function(e,t){var o=e.unsortedSegmentSum(r,i,n);return t([i]),o},{$x:r},function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=Gw(t,Qm(t)),r=bE(e,n),i=uE(t,zm(0,"int32")),o=r.rank-i.rank,a=0;a<o;++a)i=Eg(i,a+1);i=Pw(i,qm(r.shape,"bool"));var s=Qm(r);return jw(i,r,s)}(e,n)}}})}});function wE(e,t,n,r,i,o,a){void 0===o&&(o="NHWC"),ef(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;3===t.rank&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),ef(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),ef(4===u.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),ef(4===n.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c="NHWC"===o?s[3]:s[1],h="NHWC"===o?u.shape[3]:u.shape[1];ef(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),ef(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),null!=a&&ef(sf(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var d=kv(o),f=gv(s,n.shape,r,1,i,a,!1,d),p=hp.runKernelFunc(function(e,t){var r=e.conv2dDerInput(u,n,f);return t([n,u]),r},{dy4D:u,filter:n},function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return kE(e,n,r,i,o,1,a)},filter:function(){return IE(e,s,n.shape,r,i,o,a)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function EE(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],i=t[2];return 1===n&&1===r&&1===i}function _E(e,t,n,r,i){ef(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var o=e,a=t,s=!1;4===t.rank&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),o=[1,e[0],e[1],e[2],e[3]]);var u=o[4],l=a.shape[4];ef(5===o.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),ef(5===a.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),ef(5===n.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),ef(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),ef(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=vv(o,n.shape,r,1,i),h=hp.runKernelFunc(function(e){return e.conv3dDerInput(a,n,c)},{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var SE=Rm({conv1d_:function(e,t,n,r,i,o,a){void 0===i&&(i="NWC"),void 0===o&&(o=1);var s=Em(e,"x","conv1d"),u=Em(t,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),ef(3===l.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),ef(3===u.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),null!=a&&ef(sf(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),ef(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),ef(Sv(n,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"}),ef("NWC"===i,function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),f=kE(d,h,[1,n],r,"NHWC",[1,o],a);return c?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),kE=Rm({conv2d_:function(e,t,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=Em(e,"x","conv2d"),u=Em(t,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),ef(4===l.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),ef(4===u.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),null!=a&&ef(sf(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h="NHWC"===i?l.shape[3]:l.shape[1];ef(h===u.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."}),ef(Sv(n,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"});var d=kv(i),f=gv(l.shape,u.shape,n,o,r,a,!1,d),p=[u,l],m=hp.runKernelFunc(function(e,t){var n=e.conv2d(l,u,f);return t([u,l]),n},{x:l,filter:u},function(e,t){var a=t,s=a[0],u=a[1];return ef(_v(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return TE(u.shape,e,s,n,r,i)},filter:function(){return IE(u,e,s.shape,n,r,i)}}},"Conv2D",f,p);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),CE=Rm({conv3d_:function(e,t,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var a=Em(e,"x","conv3d"),s=Em(t,"filter","conv3d"),u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),ef(5===u.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),ef(5===s.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),ef(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),ef(function(e,t){return EE(e)||EE(t)}(n,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),ef("NDHWC"===i,function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=vv(u.shape,s.shape,n,o,r),h=hp.runKernelFunc(function(e,t){var n=e.conv3d(u,s,c);return t([u,s]),n},{x:u,$filter:s},function(e,t){ef(EE(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var i=t[0],a=t[1];return{x:function(){return _E(i.shape,e,a,n,r)},$filter:function(){return function(e,t,n,r,i){var o=e;4===e.rank&&(o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var a=t;4===a.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),ef(5===o.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."}),ef(5===a.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."}),ef(5===n.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."}),ef(o.shape[4]===n[3],function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."}),ef(a.shape[4]===n[4],function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."});var s=vv(o.shape,n,r,1,i);return hp.runKernelFunc(function(e){return e.conv3dDerFilter(o,a,s)},{x5D:o,dy5D:a})}(i,e,a.shape,n,r)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),IE=Rm({conv2dDerFilter_:function(e,t,n,r,i,o,a){void 0===o&&(o="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),ef(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),ef(4===u.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),ef(4===n.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l="NHWC"===o?s.shape[3]:s.shape[1],c="NHWC"===o?u.shape[3]:u.shape[1];ef(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),ef(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),null!=a&&ef(sf(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var h=kv(o),d=gv(s.shape,n,r,1,i,a,!1,h);return hp.runKernelFunc(function(e){return e.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),TE=Rm({conv2dDerInput_:wE}),AE=Rm({depthwiseConv2d_:function(e,t,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=Em(e,"x","depthwiseConv2d"),u=Em(t,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),ef(4===l.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),ef(4===u.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),ef(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),null==o&&(o=[1,1]),ef(Sv(n,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=a&&ef(sf(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=gv(l.shape,u.shape,n,o,r,a,!0),d=[l,u],f=hp.runKernelFunc(function(e,t){var n=e.depthwiseConv2D(l,u,h);return t([l,u]),n},{x:l,filter:u},function(e,t){ef(_v(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var n=t[0],r=t[1];return{x:function(){return OE(n.shape,e,r,h)},filter:function(){return NE(n,e,r.shape,h)}}},"DepthwiseConv2dNative",h,d);return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),OE=Rm({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,o=!1;3===t.rank&&(o=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=hp.runKernelFunc(function(e){return e.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),NE=Rm({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;3===e.rank&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=t;return 3===o.rank&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),hp.runKernelFunc(function(e){return e.depthwiseConv2DDerFilter(i,o,r)},{x4D:i,dy4D:o})}}),PE=Rm({separableConv2d_:function(e,t,n,r,i,o,a){void 0===o&&(o=[1,1]),void 0===a&&(a="NHWC");var s=Em(e,"x","separableConv2d"),u=Em(t,"depthwiseFilter","separableConv2d"),l=Em(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ef(4===c.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),ef(4===u.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),ef(4===l.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),ef(1===l.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),ef(1===l.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],f=u.shape[3];ef(l.shape[2]===d*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+l.shape[2]+"."});var p=AE(c,u,r,i,a,o),m=kE(p,l,1,"valid",a);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),DE=Rm({conv2dTranspose_:function(e,t,n,r,i,o){return wE(n,Em(e,"x","conv2dTranspose"),Em(t,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),RE=Rm({conv3dTranspose_:function(e,t,n,r,i){return _E(n,Em(e,"x","conv3dTranspose"),Em(t,"filter","conv3dTranspose"),r,i)}}),ME=Rm({matMul_:function(e,t,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=Em(e,"a","matMul"),a=Em(t,"b","matMul");i=op(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),d=a.shape.slice(0,-2),f=of(h),p=of(d);ef(o.rank>=2&&a.rank>=2&&o.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."}),ef(af(h,d),function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."}),ef(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=o.shape.slice(0,-2).concat([l,c]),g=n?o.as3D(f,s,l):o.as3D(f,l,s),v=r?a.as3D(p,c,u):a.as3D(p,u,c),y={transposeA:n,transposeB:r};return hp.runKernelFunc(function(e,t){var i=e.batchMatMul(g,v,n,r);return t([g,v]),i},{a:g,b:v},function(e,t){var i=t,o=i[0],a=i[1];return n||r?!n&&r?{a:function(){return e.matMul(a,!1,!1)},b:function(){return e.matMul(o,!0,!1)}}:n&&!r?{a:function(){return a.matMul(e,!1,!0)},b:function(){return o.matMul(e,!1,!1)}}:{a:function(){return a.matMul(e,!0,!0)},b:function(){return e.matMul(o,!0,!0)}}:{a:function(){return e.matMul(a,!1,!0)},b:function(){return o.matMul(e,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),jE=Rm({dot_:function(e,t){var n=Em(e,"t1","dot"),r=Em(t,"t2","dot");ef(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return ef(i===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."}),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),FE=Rm({outerProduct_:function(e,t){var n=Em(e,"v1","outerProduct"),r=Em(t,"v2","outerProduct");return ef(1===n.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),LE=Rm({reverse_:function(e,t){var n=Em(e,"x","reverse");if(0===n.rank)return n.clone();var r=ff(t,n.shape);return hp.runKernelFunc(function(e){return e.reverse(n,r)},{$x:n},function(e){return{$x:function(){return e.reverse(r)}}}).reshapeAs(n)}}),BE=Rm({reverse1d_:function(e){var t=Em(e,"x","reverse");return ef(1===t.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),LE(t,0)}}),zE=Rm({reverse2d_:function(e,t){var n=Em(e,"x","reverse");return ef(2===n.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),LE(n,t)}}),UE=Rm({reverse3d_:function(e,t){var n=Em(e,"x","reverse");return ef(3===n.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),LE(n,t)}}),VE=Rm({reverse4d_:function(e,t){var n=Em(e,"x","reverse");return ef(4===n.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),LE(n,t)}});function WE(e,t,n,r,i,o){var a=Em(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),ef(4===s.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),ef(Sv(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),null!=o&&ef(sf(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=pv(s.shape,t,n,r,i,o);if(1===l.filterWidth&&1===l.filterHeight&&af(l.inShape,l.outShape))return a.clone();var c=[s],h=hp.runKernelFunc(function(e,t){var n=e.maxPool(s,l);return t([s,n]),n},{x:s},function(e,o){var a=o[0],s=o[1];return{x:function(){return function(e,t,n,r,i,o,a,s){var u=Em(e,"dy","maxPoolBackprop"),l=Em(t,"input","maxPoolBackprop"),c=Em(n,"output","maxPoolBackprop");ef(l.rank===u.rank,function(){return"Rank of input ("+l.rank+") does not match rank of dy ("+u.rank+")"}),null==o&&(o=[1,1]),ef(Sv(i,o),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}),ef(4===u.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."}),ef(4===l.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+"."});var h=pv(l.shape,r,i,o,a,s);return hp.runKernelFunc(function(e){return e.maxPoolBackprop(u,l,c,h)},{$dy:u,$input:l})}(e,a,s,t,n,r,i)}}},"MaxPool",l,c);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function HE(e,t,n,r,i,o){var a=Em(e,"x","avgPool","float32");null==r&&(r=[1,1]),ef(Sv(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),ef(4===s.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),null!=o&&ef(sf(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=pv(s.shape,t,n,r,i,o);if(1===l.filterWidth&&1===l.filterHeight&&af(l.inShape,l.outShape))return a.clone();var c=hp.runKernelFunc(function(e){return e.avgPool(s,l)},{x:s},function(e){return{x:function(){return function(e,t,n,r,i,o){var a=Em(e,"dy","avgPoolBackprop"),s=Em(t,"input","avgPoolBackprop");ef(s.rank===a.rank,function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"}),null==i&&(i=[1,1]),ef(Sv(r,i),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"});var u=s,l=a,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),ef(4===l.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."}),ef(4===u.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."});var h=pv(u.shape,n,r,i,o),d=hp.runKernelFunc(function(e){return e.avgPoolBackprop(l,u,h)},{dy4D:l,input4D:u});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(e,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var qE=Rm({maxPool_:function(e,t,n,r,i){return WE(e,t,n,1,r,i)}}),GE=Rm({avgPool_:function(e,t,n,r,i){return HE(e,t,n,1,r,i)}}),KE=Rm({pool_:function(e,t,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var a=Em(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),ef(Sv(o,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"});var l,c=pv(s.shape,t,o,i,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(e,t){var n=e.map(function(e,n){return e+(e-1)*(t[n]-1)}).map(function(e){return e-1}),r=n.map(function(e){return Math.floor(e/2)}),i=n.map(function(e,t){return e-r[t]});return n.map(function(e,t){return[r[t],i[t]]})}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],f=function(e,t,n){var r=n.map(function(e){return e[0]}),i=n.map(function(e){return e[1]}),o=e.concat(r,i),a=t.map(function(e,t){return(e-o[t]%e)%e}),s=i.map(function(e,t){return e+a[t]});return[t.map(function(e,t){return[r[t],s[t]]}),t.map(function(e,t){return[0,a[t]]})]}([c.inHeight,c.inWidth],h,l),p=f[0],m=f[1],g=d?r:"valid",v=d?s:jg(s,h,p),y=("avg"===n?function(){return HE(v,t,o,1,g)}:function(){return WE(v,t,o,1,g)})(),b=d?y:gg(y,h,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),XE=Rm({maxPool3d_:function(e,t,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=Em(e,"x","maxPool3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),ef(5===u.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),ef("NDHWC"===o,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),ef(Sv(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),null!=i&&ef(sf(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=mv(u.shape,t,n,a,r,i,o),h=hp.runKernelFunc(function(e,t){var n=e.maxPool3d(u,c);return t([u,n]),n},{x:u},function(e,o){var s=o[0],u=o[1];return{x:function(){return function(e,t,n,r,i,o,a,s){var u=Em(e,"dy","maxPool3dBackprop"),l=Em(t,"input","maxPool3dBackprop"),c=Em(n,"output","maxPool3dBackprop"),h=u,d=l,f=c,p=!1;4===l.rank&&(p=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),ef(5===h.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."}),ef(5===d.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."}),ef(5===f.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."}),null==o&&(o=[1,1,1]),ef(Sv(i,o),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}),null!=s&&ef(sf(a),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var m=mv(d.shape,r,i,o,a,s),g=hp.runKernelFunc(function(e){return e.maxPool3dBackprop(h,d,f,m)},{dy5D:h,input5D:d});return p?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(e,s,u,t,n,a,r,i)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),YE=Rm({avgPool3d_:function(e,t,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=Em(e,"x","avgPool3d","float32"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),ef(5===u.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),ef("NDHWC"===o,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),ef(Sv(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),null!=i&&ef(sf(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=mv(u.shape,t,n,a,r,i,o),h=hp.runKernelFunc(function(e){return e.avgPool3d(u,c)},{x:u},function(e){return{x:function(){return function(e,t,n,r,i,o,a){var s=Em(e,"dy","avgPool3dBackprop"),u=Em(t,"input","avgPool3dBackprop"),l=s,c=u,h=!1;4===u.rank&&(h=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),ef(5===l.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+l.rank+"."}),ef(5===c.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+c.rank+"."}),null==i&&(i=[1,1,1]),ef(Sv(r,i),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}),null!=a&&ef(sf(o),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=mv(c.shape,n,r,i,o,a),f=hp.runKernelFunc(function(e){return e.avgPool3dBackprop(l,c,d)},{dy5D:l,input5D:c});return h?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(e,u,t,n,a,r,i)}}});return h=h.cast(u.dtype),l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),QE=Rm({slice_:function(e,t,n){var r,i,o=Em(e,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(o.rank-1).fill(0)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(0)):t.slice()).forEach(function(e){ef(-1!==e,function(){return"slice() does not support negative begin indexing."})}),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map(function(e,t){return e>=0?e:(ef(-1===e,function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."}),o.shape[t]-r[t])}),Zg(o,r,i);var a=o.shape,s={begin:r,size:i};return hp.runKernelFunc(function(e){return e.slice(o,r,i)},{x:o},function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],a[n]-r[n]-i[n]]);return{x:function(){return e.pad(t)}}},"Slice",s)}}),$E=Rm({slice1d_:function(e,t,n){var r=Em(e,"x","slice1d");return ef(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),QE(r,[t],[n])}}),ZE=Rm({slice2d_:function(e,t,n){var r=Em(e,"x","slice2d");return ef(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),QE(r,t,n)}}),JE=Rm({slice3d_:function(e,t,n){var r=Em(e,"x","slice3d");return ef(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),QE(r,t,n)}}),e_=Rm({slice4d_:function(e,t,n){var r=Em(e,"x","slice4d");return ef(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),QE(r,t,n)}});function t_(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(Im(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Im(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==i?r:r.transpose(i)}}}var n_=Rm({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","all","bool"),i=ff(t,r.shape),o=i,a=Am(o,r.rank);null!=a&&(r=r.transpose(a),o=Nm(o.length,r.rank));var s=hp.runKernelFunc(function(e){return e.all(r,o)},{$x:r});if(n){var u=Im(s.shape,i);return s.reshape(u)}return s}}),r_=Rm({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","any","bool"),i=ff(t,r.shape),o=i,a=Am(o,r.rank);null!=a&&(r=r.transpose(a),o=Nm(o.length,r.rank));var s=hp.runKernelFunc(function(e){return e.any(r,o)},{$x:r});if(n){var u=Im(s.shape,i);return s.reshape(u)}return s}}),i_=Rm({argMax_:function(e,t){void 0===t&&(t=0);var n=Em(e,"x","argMax");null==t&&(t=0);var r=ff(t,n.shape),i=Am(r,n.rank);null!=i&&(n=n.transpose(i),r=Nm(r.length,n.rank));var o={axis:r[0]},a=[n];return hp.runKernelFunc(function(e,t){var i=e.argMax(n,r[0]);return t([n]),i},{x:n},function(e,t){var n=t[0];return{x:function(){return Qm(n)}}},"ArgMax",o,a)}}),o_=Rm({argMin_:function(e,t){void 0===t&&(t=0);var n=Em(e,"x","argMin");null==t&&(t=0);var r=ff(t,n.shape),i=Am(r,n.rank);return null!=i&&(n=n.transpose(i),r=Nm(r.length,n.rank)),hp.runKernelFunc(function(e,t){var i=e.argMin(n,r[0]);return t([n]),i},{$x:n},function(e,t){var n=t[0];return{$x:function(){return Qm(n)}}})}}),a_=Rm({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","logSumExp"),i=ff(t,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=Im(s.shape,i);return s.reshape(u)}return s}}),s_=Rm({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","max"),i=r,o=ff(t,r.shape),a=o,s=Am(a,r.rank);null!=s&&(r=r.transpose(s),a=Nm(a.length,r.rank));var u=[r],l=hp.runKernelFunc(function(e,t){var n=e.max(r,a);return t([i,n]),n},{x:r},function(e,t){return t_(e,t[1],t[0],o,s)},"Max",{axes:a},u,[!0]);if(n){var c=Im(l.shape,o);l=l.reshape(c)}return l}}),u_=Rm({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","mean"),i=ff(t,r.shape),o=of(Cm(r.shape,i)[1]);return ov(function(e){var r=zm(o);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return i.forEach(function(e){n[e]=1}),t.reshape(n).mul(qm(e.shape,"float32")).div(o)}}})(r)}}),l_=Rm({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","min"),i=r,o=ff(t,r.shape),a=o,s=Am(a,r.rank);null!=s&&(r=r.transpose(s),a=Nm(a.length,r.rank));var u=[r],l=hp.runKernelFunc(function(e,t){var n=e.min(r,a);return t([i,n]),n},{x:r},function(e,t){return t_(e,t[1],t[0],o,s)},"Min",{axes:a},u,[!0]);if(n){var c=Im(l.shape,o);l=l.reshape(c)}return l}}),c_=Rm({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=ff(t,(e=Em(e,"x","moments")).shape),i=e.mean(r,n),o=i.shape;n||(o=Im(i.shape,r));var a=e.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),h_=Rm({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=ff(t,r.shape);return ov(function(e){var t=Am(i,e.rank),r=i,o=e;null!=t&&(o=e.transpose(t),r=Nm(r.length,e.rank));var a=function(t){var n=e.shape.slice();return i.forEach(function(e){n[e]=1}),t.reshape(n).mul(qm(e.shape,"float32"))},s={axes:r},u=hp.runKernelFunc(function(e){return e.sum(o,r)},{x:o},function(e){return{x:function(){return a(e)}}},"Sum",s);if(n){var l=Im(u.shape,i);u=u.reshape(l)}return{value:u,gradFunc:a}})(r)}}),d_=Rm({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Em(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=ff(t,r.shape),o=Am(i,r.rank),a=i,s=r;null!=o&&(s=r.transpose(o),a=Nm(a.length,r.rank));var u=hp.runKernelFunc(function(e){return e.prod(s,a)},{permutedX:s});if(n){var l=Im(u.shape,i);u=u.reshape(l)}return u}}),f_=Rm({elu_:function(e){var t=Em(e,"x","elu");return hp.runKernelFunc(function(e,n){var r=e.elu(t);return n([r]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return hp.runKernelFunc(function(t){return t.eluDer(e,n)},{dy:e,y:n})}}})}}),p_=Rm({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=Em(e,"x","leakyRelu");return Gw(zm(t).mul(n),n)}}),m_=Rm({prelu_:function(e,t){var n=Em(e,"x","prelu"),r=Em(t,"alpha","prelu");return hp.runKernelFunc(function(e,t){var i=e.prelu(n,r);return t([n,r]),i},{x:n,alpha:r},function(e,t){var n=t[0],r=t[1],i=n.greater(0);return{x:function(){return jw(i,e,e.mul(r))},alpha:function(){var t=jw(i,Qm(e),e.mul(n)),o=dv(r.shape,e.shape);return o.length>0&&(t=t.sum(o)),t.reshape(r.shape)}}},"Prelu")}}),g_=Rm({relu_:function(e){var t=Em(e,"x","relu");return"bool"===t.dtype?t.toInt():hp.runKernelFunc(function(e,n){var r=e.relu(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}},"Relu")}}),v_=Rm({relu6_:function(e){var t=Em(e,"x","relu6");return"bool"===t.dtype?t.toInt():hp.runKernelFunc(function(e,n){var r=e.relu6(t);return n([t]),r},{x:t},function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}},"Relu6")}}),y_=Rm({selu_:function(e){var t=Em(e,"x","selu");return hp.runKernelFunc(function(e,n){var r=e.selu(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){var t=n.greater(zm(0)),r=zm(ix),i=zm(ox),o=e.mul(i),a=e.mul(r).mul(n.toFloat().exp());return jw(t,o,a)}}})}}),b_=Rm({transpose_:function(e,t){var n=Em(e,"x","transpose");if(null==t&&(t=n.shape.map(function(e,t){return t}).reverse()),ef(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(e){ef(e>=0&&e<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return hp.runKernelFunc(function(e){return e.transpose(n,t)},{x:n},function(e){var n=Om(t);return{x:function(){return e.transpose(n)}}},"Transpose",r)}}),x_=Rm({localResponseNormalization_:function(e,t,n,r,i){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=Em(e,"x","localResponseNormalization");ef(4===o.rank||3===o.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."}),ef(sf(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=o,s=!1;3===o.rank&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=hp.runKernelFunc(function(e,o){var s=e.localResponseNormalization4D(a,t,n,r,i);return o([a,s]),s},{x4D:a},function(e,o){var a=o[0],s=o[1];return{x4D:function(){return hp.runKernelFunc(function(o){return o.LRNGrad(e,a,s,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),w_=Rm({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(zm(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Em(e,"x","norm"),t,n),o=i.shape;if(r){var a=ff(n,e.shape);o=Im(i.shape,a)}return i.reshape(o)}}),E_=Rm({basicLSTMCell_:function(e,t,n,r,i,o){var a=Em(e,"forgetBias","basicLSTMCell"),s=Em(t,"lstmKernel","basicLSTMCell"),u=Em(n,"lstmBias","basicLSTMCell"),l=Em(r,"data","basicLSTMCell"),c=Em(i,"c","basicLSTMCell"),h=Em(o,"h","basicLSTMCell"),d=l.concat(h,1).matMul(s).add(u),f=d.shape[0],p=d.shape[1]/4,m=[f,p],g=d.slice([0,0],m),v=d.slice([0,p],m),y=d.slice([0,2*p],m),b=d.slice([0,3*p],m),x=g.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),__=Rm({multiRNNCell_:function(e,t,n,r){for(var i=Em(t,"data","multiRNNCell"),o=_m(n,"c","multiRNNCell"),a=_m(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,o[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var h=[],d=[];for(l=0;l<u.length;l+=2)h.push(u[l]),d.push(u[l+1]);return[h,d]}}),S_=Rm({movingAverage_:function(e,t,n,r,i){void 0===i&&(i=!0);var o=Em(e,"v","movingAverage"),a=Em(t,"x","movingAverage"),s=Em(n,"decay","movingAverage");ap(o,a),ef(af(o.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=zm(1),l=u.sub(s),c=a.sub(o).mul(l);if(i){ef(null!=r,function(){return"When using zeroDebias: true, step is required."});var h=Em(r,"step","movingAverage");c=c.div(u.sub(eE(s,h)))}return o.add(c)}}),k_=Rm({stridedSlice_:function(e,t,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var l=Em(e,"x","stridedSlice"),c=Jg(s),h=l.shape.slice();c.forEach(function(e){t[e]=0,n[e]=1,h.splice(e,0,1)}),l=l.reshape(h);for(var d=0;d<l.rank;d++)t[d]=tv(i,t,r,l.shape,d),n[d]=nv(o,n,r,l.shape,d),r[d]=r[d]||1;var f=Jg(u);f.forEach(function(e){n[e]=t[e]+1,r[e]=1});var p=ev(t,n,r),m=p.filter(function(e,t){return-1===f.indexOf(t)});return r.every(function(e){return 1===e})?QE(l,t,p).reshape(m):hp.runKernelFunc(function(e){return e.stridedSlice(l,t,n,r)},{$x:l}).reshape(m)}}),C_=Rm({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=Em(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var o=hp.runKernelFunc(function(e){return e.topk(r,t,n)},{$x:r});return{values:o[0],indices:o[1]}}}),I_=Rm({scatterND_:function(e,t,n){var r=Em(e,"indices","scatterND","int32"),i=Em(t,"updates","scatterND");return Qg(i,r,n),hp.runKernelFunc(function(e){return e.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),T_=Rm({fft_:function(e){ef("complex64"===e.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return hp.runKernelFunc(function(e){return e.fft(r)},{input:e}).reshape(e.shape)}}),A_=Rm({ifft_:function(e){ef("complex64"===e.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return hp.runKernelFunc(function(e){return e.ifft(r)},{input:e}).reshape(e.shape)}}),O_=Rm({rfft_:function(e,t){ef("float32"===e.dtype,function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(null!=t&&t<r){var o=e.shape.map(function(e){return 0}),a=e.shape.map(function(e){return e});a[e.shape.length-1]=t,n=e.slice(o,a),r=t}else if(null!=t&&t>r){var s=e.shape.map(function(e){return e});s[e.shape.length-1]=t-r,n=e.concat(Gm(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Mm(n,u).as2D(i,r),c=T_(l),h=Math.floor(r/2)+1,d=jm(c),f=Fm(c),p=d.split([h,r-h],d.shape.length-1),m=f.split([h,r-h],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,Mm(p[0],m[0]).reshape(g)}}),N_=Rm({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=A_(r);return jm(i)}var o=[n,2*(t-1)],a=jm(e).as2D(n,t),s=Fm(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(zm(-1)),c=a.concat(u,1),h=s.concat(l,1);return r=Mm(c,h).as2D(o[0],o[1]),i=A_(r),jm(i)}}),P_=Object.freeze({fft:T_,ifft:A_,rfft:O_,irfft:N_}),D_=Rm({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var i=Em(e,"sparseIndices","sparseToDense","int32"),o=Em(t,"sparseValues","sparseToDense"),a=Em(r,"defaultValue","sparseToDense",o.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var i=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");var a=t.size;if(0!==t.rank&&(1!==t.rank||a!==i))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+i+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),hp.runKernelFunc(function(e){return e.sparseToDense(i,o,n,a)},{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),R_=Rm({gatherND_:function(e,t){var n=Em(t,"indices","gatherND","int32"),r=Em(e,"x","gatherND");return hp.runKernelFunc(function(e){return e.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),M_=Rm({diag_:function(e){var t=Em(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return hp.runKernelFunc(function(e){return e.diag(t)},{$x:t}).reshape(n)}}),j_=Rm({dropout_:function(e,t,n,r){var i=Em(e,"x","dropout");if(ef("float32"===i.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),ef(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),0===t)return e instanceof Yf?i.clone():i;var o=function(e,t){if(null==t)return e.shape.slice();if(af(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(i,n),a=1-t,s=Rg(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function F_(e,t,n){for(var r=1-e%2,i=new Float32Array(e),o=0;o<e;++o){var a=2*Math.PI*o/(e+r-1);i[o]=t-n*Math.cos(a)}return Um(i,"float32")}var L_,B_=Rm({hannWindow_:function(e){return F_(e,.5,.5)}}),z_=Rm({hammingWindow_:function(e){return F_(e,.54,.46)}}),U_=Rm({frame_:function(e,t,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,a=[];o+t<=e.size;)a.push(QE(e,o,t)),o+=n;if(r)for(;o<e.size;){var s=o+t-e.size,u=$m([QE(e,o,t-s),Km([s],i)]);a.push(u),o+=n}return 0===a.length?Vm([],[0,t]):$m(a).as2D(a.length,t)}}),V_=Rm({stft_:function(e,t,n,r,i){var o;void 0===i&&(i=B_),null==r&&(o=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var a=U_(e,t,n),s=Zw(a,i(t)),u=[],l=0;l<a.shape[0];l++)u.push(O_(s.slice([l,0],[1,t]),r));return $m(u)}}),W_=Object.freeze({hannWindow:B_,hammingWindow:z_,frame:U_,stft:V_});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(L_||(L_={}));var H_=Rm({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=L_.SUM_BY_NONZERO_WEIGHTS);var i=Em(e,"labels","absoluteDifference"),o=Em(t,"predictions","absoluteDifference"),a=null;null!=n&&(a=Em(n,"weights","absoluteDifference")),tf(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return q_(s,a,r)}}),q_=Rm({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=L_.SUM_BY_NONZERO_WEIGHTS);var r=Em(e,"losses","computeWeightedLoss"),i=null;null!=t&&(i=Em(t,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===L_.NONE)return o;if(n===L_.SUM)return o.sum();if(n===L_.MEAN){if(null==i)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(zm(a)):s}if(n===L_.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(zm(r.size));var u=i.mul(qm(r.shape)).notEqual(zm(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),G_=Rm({cosineDistance_:function(e,t,n,r,i){void 0===i&&(i=L_.SUM_BY_NONZERO_WEIGHTS);var o=Em(e,"labels","cosineDistance"),a=Em(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Em(r,"weights","cosineDistance")),tf(o.shape,a.shape,"Error in cosineDistance: ");var u=zm(1).sub(o.mul(a).sum(n,!0));return q_(u,s,i)}}),K_=Rm({hingeLoss_:function(e,t,n,r){void 0===r&&(r=L_.SUM_BY_NONZERO_WEIGHTS);var i=Em(e,"labels","hingeLoss"),o=Em(t,"predictions","hingeLoss"),a=null;null!=n&&(a=Em(n,"weights","hingeLoss")),tf(i.shape,o.shape,"Error in hingeLoss: ");var s=zm(1);i=zm(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return q_(u,a,r)}}),X_=Rm({huberLoss_:function(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=L_.SUM_BY_NONZERO_WEIGHTS);var o=Em(e,"labels","huberLoss"),a=Em(t,"predictions","huberLoss"),s=null;null!=n&&(s=Em(n,"weights","huberLoss")),tf(o.shape,a.shape,"Error in huberLoss: ");var u=zm(r),l=a.sub(o).abs(),c=Xw(l,u),h=l.sub(c),d=zm(.5).mul(c.square()).add(u.mul(h));return q_(d,s,i)}}),Y_=Rm({logLoss_:function(e,t,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=L_.SUM_BY_NONZERO_WEIGHTS);var o=Em(e,"labels","logLoss"),a=Em(t,"predictions","logLoss"),s=null;null!=n&&(s=Em(n,"weights","logLoss")),tf(o.shape,a.shape,"Error in logLoss: ");var u=zm(1),l=zm(r),c=o.mul(a.add(l).log()).neg().sub(u.sub(o).mul(u.sub(a).add(l).log()));return q_(c,s,i)}}),Q_=Rm({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=L_.SUM_BY_NONZERO_WEIGHTS);var i=Em(e,"labels","meanSquaredError"),o=Em(t,"predictions","meanSquaredError"),a=null;null!=n&&(a=Em(n,"weights","meanSquaredError")),tf(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return q_(s,a,r)}}),$_=Rm({sigmoidCrossEntropy_:function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=L_.SUM_BY_NONZERO_WEIGHTS);var o=Em(e,"multiClassLabels","sigmoidCrossEntropy"),a=Em(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Em(n,"weights","sigmoidCrossEntropy")),tf(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=zm(r),l=zm(1),c=zm(.5);o=o.mul(l.sub(u)).add(c.mul(u))}var h=function(e,t){var n=Em(e,"labels","sigmoidCrossEntropyWithLogits"),r=Em(t,"logits","sigmoidCrossEntropyWithLogits");tf(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),a=r.abs().neg().exp().log1p();return i.sub(o).add(a)}(o,a);return q_(h,s,i)}}),Z_=Rm({softmaxCrossEntropy_:function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=L_.SUM_BY_NONZERO_WEIGHTS);var o=Em(e,"onehotLabels","softmaxCrossEntropy"),a=Em(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Em(n,"weights","softmaxCrossEntropy")),tf(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=zm(r),l=zm(1),c=zm(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(c))}var h=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return ov(function(e,t,r){var i=t.logSumExp([n],!0),o=t.toFloat().sub(i);return r([e,o]),{value:o.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],i=t[1],o=Im(e.shape,[n]);return[e.reshape(o).mul(r.toFloat().sub(i.exp())),e.reshape(o).mul(i.exp().sub(r.toFloat()))]}}})(e,t)}(o,a);return q_(h,s,i)}}),J_=Object.freeze({get Reduction(){return L_},absoluteDifference:H_,computeWeightedLoss:q_,cosineDistance:G_,hingeLoss:K_,huberLoss:X_,logLoss:Y_,meanSquaredError:Q_,sigmoidCrossEntropy:$_,softmaxCrossEntropy:Z_});function eS(e,t){return void 0===t&&(t=!1),hp.tidy(function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=_g(n),o=e.clone(),a=Vm([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(e){var t,u=o,l=s,c=i;t=hp.tidy(function(){var t=o.slice([e,e],[n-e,1]),u=t.norm(),l=o.slice([e,e],[1,1]),c=Vm([[-1]]).where(l.greater(0),Vm([[1]])),h=l.sub(c.mul(u)),d=t.div(h);s=1===d.shape[0]?a.clone():a.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var f=c.matMul(h).div(u).neg(),p=o.slice([e,0],[n-e,r]),m=f.mul(s);if(0===e)o=p.sub(m.matMul(s.transpose().matMul(p)));else{var g=p.sub(m.matMul(s.transpose().matMul(p)));o=o.slice([0,0],[e,r]).concat(g,0)}var v=i.slice([0,e],[n,i.shape[1]-e]);if(0===e)i=v.sub(v.matMul(s).matMul(m.transpose()));else{var y=v.sub(v.matMul(s).matMul(m.transpose()));i=i.slice([0,0],[n,e]).concat(y,1)}return[s,o,i]}),s=t[0],o=t[1],i=t[2],ym([u,l,c])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]})}var tS=Rm({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Em(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),a=o[0],s=o[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=Xm(0,a,1,"int32").reshape([-1,1]),l=Xm(0,s,1,"int32"),c=rE(u,l),h=Pw(c.lessEqual(zm(+t,"int32")),c.greaterEqual(zm(-n,"int32"))),d=Gm([a,s],r.dtype);return Lg(Ug(r.reshape([-1,a,s])).map(function(e){return jw(h,e,d)})).reshape(i)}}),nS=Rm({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,ef(null!=e&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(t){ef(e[t].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=ng(e,e.shape[0],0).map(function(e){return Fg(e,[0])});ef(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var o=[],a=e,s=function(e){o.push(hp.tidy(function(){var t=a[e];if(e>0)for(var n=0;n<e;++n){var r=h_(o[n].mulStrict(t)).mul(o[n]);t=t.sub(r)}return t.div(w_(t,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?Lg(o,0):o}}),rS=Rm({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return eS(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(e,t){return e*t}),r=Ug(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],o=[];return r.forEach(function(e){var n=eS(e,t),r=n[0],a=n[1];i.push(r),o.push(a)}),[Lg(i,0).reshape(e.shape),Lg(o,0).reshape(e.shape)]}}),iS=Object.freeze({bandPart:tS,gramSchmidt:nS,qr:rS});function oS(e,t,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);var a=e.shape[0];return n=Math.min(n,a),ef(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),ef(2===e.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),ef(4===e.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),ef(1===t.rank,function(){return"scores must be a 1D tensor"}),ef(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),ef(0<=o&&o<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var aS=Rm({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=Em(e,"images","resizeBilinear");ef(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),ef(2===t.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=hp.runKernelFunc(function(e,t){return t([i]),e.resizeBilinear(i,a,s,n)},{x:i},function(e,t){return{x:function(){return hp.runKernelFunc(function(r){return r.resizeBilinearBackprop(e,t[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),sS=Rm({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=Em(e,"images","resizeNearestNeighbor");ef(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),ef(2===t.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),ef("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=hp.runKernelFunc(function(e,t){return t([i]),e.resizeNearestNeighbor(i,a,s,n)},{batchImages:i},function(e,t){return{batchImages:function(){return hp.runKernelFunc(function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),uS=Rm({nonMaxSuppression_:function(e,t,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=Em(e,"boxes","nonMaxSuppression"),a=Em(t,"scores","nonMaxSuppression"),s=oS(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return hp.runKernelFunc(function(e){return e.nonMaxSuppression(o,a,n,r,i)},{boxes:o,scores:a},null,"NonMaxSuppressionV3",u)}}),lS=Rm({nonMaxSuppressionWithScore_:function(e,t,n,r,i,o){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===o&&(o=0);var a=Em(e,"boxes","nonMaxSuppression"),s=Em(t,"scores","nonMaxSuppression"),u=oS(a,s,n,r,i,o),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},c=hp.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),cS=Rm({cropAndResize_:function(e,t,n,r,i,o){var a=Em(e,"image","cropAndResize"),s=Em(t,"boxes","cropAndResize","float32"),u=Em(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=s.shape[0];return ef(4===a.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),ef(2===s.rank&&4===s.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),ef(1===u.rank&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),ef(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),ef(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),ef("bilinear"===i||"nearest"===i,function(){return"method must be bilinear or nearest, but was "+i}),hp.runKernelFunc(function(e,t){return e.cropAndResize(a,s,u,r,i,o)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),hS=Object.freeze({resizeBilinear:aS,resizeNearestNeighbor:sS,nonMaxSuppression:uS,nonMaxSuppressionAsync:function(e,t,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),Ld(this,void 0,void 0,function(){var o,a,s,u,l,c,h;return Bd(this,function(d){switch(d.label){case 0:return o=Em(e,"boxes","nonMaxSuppressionAsync"),a=Em(t,"scores","nonMaxSuppressionAsync"),s=oS(o,a,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],h=Mv(l,c,n,r,i),o!==e&&o.dispose(),a!==t&&a.dispose(),[2,h]}})})},nonMaxSuppressionWithScore:lS,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,i,o){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===o&&(o=0),Ld(this,void 0,void 0,function(){var a,s,u,l,c,h,d;return Bd(this,function(f){switch(f.label){case 0:return a=Em(e,"boxes","nonMaxSuppressionAsync"),s=Em(t,"scores","nonMaxSuppressionAsync"),u=oS(a,s,n,r,i,o),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=f.sent(),c=l[0],h=l[1],d=jv(c,h,n,r,i,o),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,d]}})})},cropAndResize:cS}),dS=function(e,t){return!(e>0)||"linear"===t},fS=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},pS=function(e,t){var n=t,r=dv(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},mS=function(e,t,n){if("linear"===t)return e;if("relu"===t)return g_(e);if("elu"===t)return f_(e);if("relu6"===t)return v_(e);if("prelu"===t)return m_(e,n);throw new Error("Unknown fused activation "+t+".")},gS=Rm({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,o=void 0!==i&&i,a=e.transposeB,s=void 0!==a&&a,u=e.bias,l=e.activation,c=void 0===l?"linear":l,h=e.preluActivationWeights;if(!1===dS(hp.state.gradientDepth,c)){var d=ME(n,r,o,s);return null!=u&&(d=Lw(d,u)),mS(d,c,h)}var f=Em(n,"a","fused matMul"),p=Em(r,"b","fused matMul");t=op(f,p),f=t[0],p=t[1];var m=o?f.shape[f.rank-2]:f.shape[f.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=o?f.shape[f.rank-1]:f.shape[f.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=f.shape.slice(0,-2),x=p.shape.slice(0,-2),w=of(b),E=of(x);ef(f.rank>=2&&p.rank>=2&&f.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+p.rank+"."}),ef(af(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+f.shape+" and "+p.shape+" must match."}),ef(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+f.shape+" and "+p.shape+" and transposeA="+o+" and transposeB="+s+" must match."});var _,S,k=f.shape.slice(0,-2).concat([v,y]),C=o?f.as3D(w,m,v):f.as3D(w,v,m),I=s?p.as3D(E,y,g):p.as3D(E,g,y);null!=u&&fv(k,(_=op(_=Em(u,"bias","fused matMul"),f)[0]).shape),null!=h&&(S=Em(h,"prelu weights","fused matMul"));var T={a:C,b:I};null!=u&&(T.bias=_),null!=h&&(T.preluActivationWeights=S);var A=[C,I];return hp.runKernelFunc(function(e,t){var n=e.fusedBatchMatMul({a:C,b:I,transposeA:o,transposeB:s,bias:_,activation:c,preluActivationWeights:S});return t([C,I,n]),n},T,function(e,t){var n=t[0],r=t[1],i=t[2],a=fS(e,i,c),l={};return null!=u&&(l={bias:function(){return pS(_,a)}}),o||s?!o&&s?Object.assign({a:function(){return a.matMul(r,!1,!1)},b:function(){return a.matMul(n,!0,!1)}},l):o&&!s?Object.assign({a:function(){return r.matMul(a,!1,!0)},b:function(){return n.matMul(a,!1,!1)}},l):Object.assign({a:function(){return r.matMul(a,!0,!0)},b:function(){return a.matMul(n,!0,!0)}},l):Object.assign({a:function(){return a.matMul(r,!1,!0)},b:function(){return n.matMul(a,!0,!1)}},l)},"_FusedMatMul",{transposeA:o,transposeB:s,activation:c},A,[!0]).reshape(k)}}),vS=Rm({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,a=void 0===o?"NHWC":o,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights;if(d=d||"linear",!1===dS(hp.state.gradientDepth,d)){var p=kE(t,n,r,i,a,u,l);return null!=c&&(p=Lw(p,c)),mS(p,d,f)}var m=Em(t,"x","conv2d"),g=Em(n,"filter","conv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),ef(4===v.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),ef(4===g.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),null!=l&&ef(sf(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),ef(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),ef(Sv(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),ef("NHWC"===a,function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,x,w=gv(v.shape,g.shape,r,u,i,l);null!=c&&(b=op(b=Em(c,"bias","fused conv2d"),m)[0],fv(w.outShape,b.shape)),null!=f&&(x=Em(f,"prelu weights","fused conv2d"));var E={x:v,filter:g};null!=c&&(E.bias=b),null!=f&&(E.preluActivationWeights=x);var _=[g,v],S=hp.runKernelFunc(function(e,t){var n=e.fusedConv2d({input:v,filter:g,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([g,v,n]),n},E,function(e,t){var n=t,o=n[0],a=n[1],s=n[2],l=fS(e,s,d);ef(_v(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var h={};return null!=c&&(h={bias:function(){return pS(b,l)}}),Object.assign({x:function(){return TE(a.shape,l,o,r,i)},filter:function(){return IE(a,l,o.shape,r,i)}},h)},"FusedConv2D",{convInfo:w,activation:d},_,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),yS=Rm({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,a=void 0===o?"NHWC":o,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights;if(!1===dS(hp.state.gradientDepth,d)){var p=AE(t,n,r,i,a,u,l);return null!=c&&(p=Lw(p,c)),mS(p,d,f)}var m=Em(t,"x","depthwiseConv2d"),g=Em(n,"filter","depthwiseConv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),ef(4===v.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),ef(4===g.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),ef(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),null==u&&(u=[1,1]),ef(Sv(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),null!=l&&ef(sf(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=gv(v.shape,g.shape,r,u,i,l,!0);null!=c&&(b=op(b=Em(c,"bias","fused conv2d"),m)[0],fv(w.outShape,b.shape)),null!=f&&(x=Em(f,"prelu weights","fused depthwiseConv2d"));var E={x:v,filter:g};null!=c&&(E.bias=b),null!=f&&(E.preluActivationWeights=x);var _=[g,v],S=hp.runKernelFunc(function(e,t){var n=e.fusedDepthwiseConv2D({input:v,filter:g,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([g,v,n]),n},E,function(e,t){ef(_v(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var n=t[0],r=t[1],i=t[2],o=fS(e,i,d),a={};return null!=c&&(a={bias:function(){return pS(b,o)}}),Object.assign({x:function(){return OE(r.shape,o,n,w)},filter:function(){return NE(r,o,n.shape,w)}},a)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},_,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),bS=Object.freeze({matMul:gS,conv2d:vS,depthwiseConv2d:yS}),xS=Object.freeze({image:hS,linalg:iS,losses:J_,spectral:P_,fused:bS,signal:W_,square:Mx,squaredDifference:Fx,conv1d:SE,conv2d:kE,conv3d:CE,depthwiseConv2d:AE,separableConv2d:PE,conv2dTranspose:DE,conv3dTranspose:RE,op:Rm,batchNormalization2d:Sw,batchNormalization3d:kw,batchNormalization4d:Cw,batchNormalization:Iw,batchNorm:Tw,batchNorm2d:Aw,batchNorm3d:Ow,batchNorm4d:Nw,booleanMaskAsync:function(e,t,n){return Ld(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,p,m;return Bd(this,function(g){switch(g.label){case 0:for(r=Em(e,"tensor","boolMask"),i=Em(t,"mask","boolMask","bool"),o=null==n?0:n,a=i.rank,s=r.shape,ef(a>0,function(){return"mask cannot be scalar"}),tf(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+a;l++)u*=s[l];return c=s.slice(0,o).concat([u],s.slice(o+a)),h=r.reshape(c),d=i.reshape([-1]),[4,Fw(d)];case 1:return f=g.sent(),p=f.squeeze([1]),m=bE(h,p,o),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),h.dispose(),d.dispose(),f.dispose(),[2,m]}})})},complex:Mm,real:jm,imag:Fm,concat:$m,concat1d:Zm,concat2d:Jm,concat3d:eg,concat4d:tg,split:ng,matMul:ME,dot:jE,outerProduct:FE,reverse:LE,reverse1d:BE,reverse2d:zE,reverse3d:UE,reverse4d:VE,maxPool:qE,avgPool:GE,pool:KE,maxPool3d:XE,avgPool3d:YE,slice:QE,slice1d:$E,slice2d:ZE,slice3d:JE,slice4d:e_,abs:Lx,acos:Bx,acosh:zx,asin:Ux,asinh:Vx,atan:Wx,atanh:Hx,ceil:qx,clipByValue:Gx,cos:Kx,cosh:Xx,erf:Yx,exp:Qx,expm1:$x,floor:Zx,log:Jx,log1p:ew,logSigmoid:tw,neg:nw,reciprocal:rw,round:iw,rsqrt:ow,sigmoid:aw,sign:sw,isNaN:uw,isInf:lw,isFinite:cw,sin:hw,sinh:dw,softplus:fw,sqrt:pw,step:mw,tan:gw,tanh:vw,all:n_,any:r_,argMax:i_,argMin:o_,logSumExp:a_,max:s_,mean:u_,min:l_,moments:c_,sum:h_,prod:d_,equal:oE,equalStrict:aE,greater:sE,greaterEqual:uE,greaterEqualStrict:lE,greaterStrict:cE,less:hE,lessEqual:dE,lessEqualStrict:fE,lessStrict:pE,notEqual:mE,notEqualStrict:gE,add:Lw,addN:Bw,addStrict:zw,atan2:Uw,div:Vw,divNoNan:Ww,divStrict:Hw,floorDiv:qw,maximum:Gw,maximumStrict:Kw,minimum:Xw,minimumStrict:Yw,mod:Qw,modStrict:$w,mul:Zw,mulStrict:Jw,pow:eE,powStrict:tE,squaredDifferenceStrict:nE,sub:rE,subStrict:iE,elu:f_,leakyRelu:p_,prelu:m_,relu:g_,relu6:v_,selu:y_,logicalAnd:Pw,logicalNot:Dw,logicalOr:Rw,logicalXor:Mw,where:jw,whereAsync:Fw,buffer:mg,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:gg,broadcastTo:vg,cast:yg,clone:bg,cumsum:xg,depthToSpace:wg,expandDims:Eg,eye:_g,multinomial:Sg,oneHot:kg,pad:Cg,pad1d:Ig,pad2d:Tg,pad3d:Ag,pad4d:Og,rand:Ng,randomNormal:Pg,randomGamma:Dg,randomUniform:Rg,reshape:Mg,spaceToBatchND:jg,squeeze:Fg,stack:Lg,tile:Bg,truncatedNormal:zg,unstack:Ug,setdiff1dAsync:function(e,t){return Ld(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c,h;return Bd(this,function(d){switch(d.label){case 0:return n=Em(e,"x","setdiff1d"),r=Em(t,"y","setdiff1d"),ef(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),ef(1===n.rank,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),ef(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(o=d.sent(),a=new Set(o),s=0,c=0;c<i.length;c++)a.has(i[c])||s++;for(u=new qf([s],n.dtype),l=new qf([s],"int32"),c=0,h=0;c<i.length;c++)a.has(i[c])||(u.values[h]=i[c],l.values[h]=c,h++);return[2,[u.toTensor(),l.toTensor()]]}})})},fill:Km,linspace:function(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return hp.runKernelFunc(function(r){return r.linspace(e,t,n)},{})},ones:qm,range:Xm,scalar:zm,tensor:Lm,tensor1d:Um,tensor2d:Vm,tensor3d:Wm,tensor4d:Hm,tensor5d:function(e,t,n){if(nf(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=xm(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)},tensor6d:function(e,t,n){if(nf(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=xm(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Bm(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),hp.makeVariable(e,t,n,r)},zeros:Gm,onesLike:Ym,zerosLike:Qm,transpose:b_,softmax:av,logSoftmax:sv,localResponseNormalization:x_,norm:w_,gather:bE,unsortedSegmentSum:xE,basicLSTMCell:E_,multiRNNCell:__,movingAverage:S_,stridedSlice:k_,topk:C_,scatterND:I_,fft:T_,ifft:A_,rfft:O_,irfft:N_,sparseToDense:D_,gatherND:R_,diag:M_,dropout:j_,hannWindow:B_,hammingWindow:z_,frame:U_,stft:V_,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),Ld(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,p,m,g;return Bd(this,function(v){switch(v.label){case 0:return r=Em(e,"predictions","inTopK"),i=Em(t,"targets","inTopK"),ef(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),ef(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),tf(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],ef(n>0&&n<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[a.length/o,o],c=u[1],h=mf("bool",l=u[0]),d=0;d<l;d++){for(f=d*c,p=a.subarray(f,f+c),m=[],g=0;g<p.length;g++)m.push({value:p[g],index:g});for(m.sort(function(e,t){return t.value-e.value}),h[d]=0,g=0;g<n;g++)if(m[g].index===s[d]){h[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Lm(h,i.shape,"bool")]}})})}});function wS(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){null!=e&&ef("complex64"!==e.dtype,function(){return t+" does not support complex64 tensors."})})}function ES(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var _S=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new uv(t,hp),t}return Fd(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,Ud().get("IS_NODE")&&bm("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?Av(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map(function(e){return Ff(e)})}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return mg(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return hp.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){return t=Rf(),e(),[2,{kernelMs:Rf()-t}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:hp.keep(e.clone()),imag:hp.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(wS(e,"slice"),rv(e.shape,t,n)){var r=iv(t,e.strides),i=of(n);return Lm(this.readSync(e.dataId).subarray(r,r+i),n,e.dtype)}for(var o=mg(n,e.dtype),a=this.bufferSync(e),s=0;s<o.size;++s){var u=o.indexToLoc(s).map(function(e,n){return e+t[n]});o.values[s]=a.get.apply(a,u)}return o.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){wS(e,"stridedSlice");var i=ev(t,n,r);if(i.some(function(e){return 0===e}))return Lm([],i);for(var o=mg(i,e.dtype),a=this.bufferSync(e),s=0;s<o.size;s++){for(var u=o.indexToLoc(s),l=new Array(u.length),c=0;c<l.length;c++)l[c]=u[c]*r[c]+t[c];o.set.apply(o,[a.get.apply(a,l)].concat(u))}return o.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=mg([e.size,e.size],e.dtype),r=n.values,i=0;i<t.length;i++)r[i*e.size+i]=t[i];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),i=0,o=0;o<e.rank;o++)o!==t&&(r[i++]=e.shape[o]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[t]=o,u[o]=this.slice(e,a,s).reshape(r);return u},t.prototype.reverse=function(e,t){wS(e,"reverse");for(var n=mg(e.shape,e.dtype),r=this.bufferSync(e),i=function(i){var o=n.indexToLoc(i),a=o.slice();t.forEach(function(t){return a[t]=e.shape[t]-1-a[t]}),n.set.apply(n,[r.get.apply(r,a)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map(function(e){return jm(e)}),i=e.map(function(e){return Fm(e)});return Mm(this.concat(r,t),this.concat(i,t))}var o=e.map(function(e){var n=of(e.shape.slice(t));return e.as2D(-1,n)}),a=Dm(o.map(function(e){return e.shape}),1),s=mg(a,e[0].dtype).values;if(1===o[0].shape[0]){var u=0;o.forEach(function(e){s.set(n.readSync(e.dataId),u),u+=e.size})}else{var l=0;o.forEach(function(e){for(var t=n.readSync(e.dataId),r=0,i=0;i<e.shape[0];++i)for(var o=i*a[1]+l,u=0;u<e.shape[1];++u)s[o+u]=t[r++];l+=e.shape[1]})}var c=Dm(e.map(function(e){return e.shape}),t);return Lm(s,c,e[0].dtype)},t.prototype.neg=function(e){return wS(e,"neg"),this.multiply(zm(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e+n,imag:t+r}}):this.broadcastedBinaryOp(e,t,rp(e.dtype,t.dtype),function(e,t){return e+t})},t.prototype.addN=function(e){var t=this;wS(e,"addN");for(var n=e.map(function(e){return t.readSync(e.dataId)}),r=mg(e[0].shape,e[0].dtype),i=r.values,o=0;o<e.length;o++)for(var a=n[o],s=0;s<i.length;s++)i[s]+=a[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=ff([t],e.shape),r=this.max(e,n),i=Im(r.shape,n),o=this.subtract(e,r.reshape(i)),a=this.exp(o),s=this.sum(a,n).reshape(i);return this.realDivide(a,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e-n,imag:t-r}}):this.broadcastedBinaryOp(e,t,rp(e.dtype,t.dtype),function(e,t){return e-t})},t.prototype.pow=function(e,t){return wS([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.pow(e,t)})},t.prototype.batchMatMul=function(e,t,n,r){wS([e,t],"matMul");for(var i=n?e.shape[1]:e.shape[2],o=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),l=this.readSync(t.dataId),c=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],h=c[0],d=c[1],f=c[2],p=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],m=p[0],g=p[1],v=p[2],y=o*a,b=mg([s,o,a],e.dtype),x=b.values,w=this.blockSize,E=0;E<s;E++)for(var _=0;_<o;_+=w)for(var S=0;S<a;S+=w)for(var k=0;k<i;k+=w)for(var C=Math.min(_+w,o),I=Math.min(S+w,a),T=Math.min(k+w,i),A=_;A<C;A++)for(var O=S;O<I;O++){for(var N=0,P=k;P<T;P++)N+=u[E*h+A*d+P*f]*l[P*m+O*g+E*v];x[E*y+(A*a+O)]+=N}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,i=e.transposeB,o=e.bias,a=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,i);return o&&(u=this.add(u,o)),a&&(u=ES(this,u,a,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}}):this.broadcastedBinaryOp(e,t,rp(e.dtype,t.dtype),function(e,t){return e*t})},t.prototype.realDivide=function(e,t){return wS([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",function(e,t){return e/t})},t.prototype.floorDiv=function(e,t){return wS([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",function(e,t){return Math.floor(e/t)})},t.prototype.sum=function(e,t){wS(e,"sum"),Tm("sum",t,e.rank);for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,rp(e.dtype,"int32")),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=0,d=0;d<a;++d)h+=u[c+d];s[l]=h}return o},t.prototype.prod=function(e,t){wS(e,"sum");for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,rp(e.dtype,"int32")),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=1,d=0;d<a;++d)h*=u[c+d];s[l]=h}return o},t.prototype.unsortedSegmentSum=function(e,t,n){wS(e,"unsortedSegmentSum");for(var r=[],i=e.rank-t.rank,o=0;o<i;++o)t=t.expandDims(o+1);for(o=0;o<n;++o){var a=zm(o,"int32"),s=oE(a,t).asType("float32").mul(e).sum(0);r.push(s)}return Lg(r)},t.prototype.argMin=function(e,t){wS(e,"argMin");var n=[t];Tm("argMin",n,e.rank);for(var r=Cm(e.shape,n),i=r[0],o=r[1],a=Gm(i,"int32"),s=of(o),u=this.readSync(a.dataId),l=this.readSync(e.dataId),c=0;c<u.length;++c){for(var h=c*s,d=l[h],f=0,p=0;p<s;++p){var m=l[h+p];m<d&&(d=m,f=p)}u[c]=f}return a},t.prototype.argMax=function(e,t){wS(e,"argMax");var n=[t];Tm("argMax",n,e.rank);for(var r=Cm(e.shape,n),i=r[0],o=r[1],a=Gm(i,"int32"),s=of(o),u=this.readSync(a.dataId),l=this.readSync(e.dataId),c=0;c<u.length;++c){for(var h=c*s,d=l[h],f=0,p=0;p<s;++p){var m=l[h+p];m>d&&(d=m,f=p)}u[c]=f}return a},t.prototype.cumsum=function(e,t,n,r){if(wS(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var i=rp(e.dtype,"int32"),o=Gm(e.shape,i),a=this.readSync(o.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],l=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},c=0;c<s.length;c+=u)for(var h=0;h<u;h++){var d=l(c,h);if(0===h)a[d]=n?0:s[d];else{var f=l(c,h-1);a[d]=n?s[f]+a[f]:s[d]+a[f]}}return o},t.prototype.equal=function(e,t){return wS([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e===t?1:0})},t.prototype.notEqual=function(e,t){return wS([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e!==t?1:0})},t.prototype.less=function(e,t){return wS([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<t?1:0})},t.prototype.lessEqual=function(e,t){return wS([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<=t?1:0})},t.prototype.greater=function(e,t){return wS([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>t?1:0})},t.prototype.greaterEqual=function(e,t){return wS([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>=t?1:0})},t.prototype.logicalNot=function(e){wS(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return wS([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e&&t})},t.prototype.logicalOr=function(e,t){return wS([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e||t})},t.prototype.select=function(e,t,n){wS([e,t,n],"select");for(var r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=this.readSync(n.dataId),a=Gm(t.shape,rp(t.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,l=0===e.rank||e.rank>1||1===t.rank?1:of(t.shape.slice(1)),c=0;c<r.length;c++)for(var h=0;h<l;h++)1===r[c]?s[u++]=i[c]:s[u++]=o[c];return a},t.prototype.where=function(e){wS([e],"where");var t=this.readSync(e.dataId);return Hv(e.shape,t)},t.prototype.topk=function(e,t,n){return wS(e,"topk"),Wv(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){wS(e,"min"),Tm("min",t,e.rank);for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,e.dtype),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0;d<a;++d){var f=u[c+d];f<h&&(h=f)}s[l]=h}return o},t.prototype.minimum=function(e,t){return wS([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.min(e,t)})},t.prototype.mod=function(e,t){return wS([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})},t.prototype.max=function(e,t){wS(e,"max"),Tm("max",t,e.rank);for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,e.dtype),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0;d<a;++d){var f=u[c+d];f>h&&(h=f)}s[l]=h}return o},t.prototype.maximum=function(e,t){return wS([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.max(e,t)})},t.prototype.all=function(e,t){wS(e,"all"),Tm("all",t,e.rank);for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,e.dtype),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0;d<a;++d){var f=u[c+d];h=h&&f}s[l]=h}return o},t.prototype.any=function(e,t){wS(e,"any"),Tm("any",t,e.rank);for(var n=Cm(e.shape,t),r=n[0],i=n[1],o=Gm(r,e.dtype),a=of(i),s=this.readSync(o.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0;d<a;++d){var f=u[c+d];h=h||f}s[l]=h}return o},t.prototype.squaredDifference=function(e,t){return wS([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e-t;return n*n})},t.prototype.ceil=function(e){wS(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){wS(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){wS(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){wS(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){wS(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){wS(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){wS(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=Math.floor(t[r]);t[r]-i<.5?n[r]=Math.floor(t[r]):t[r]-i>.5?n[r]=Math.ceil(t[r]):n[r]=i%2==0?i:i+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){wS(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){wS(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){wS(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.log(i)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){wS(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.log1p(i)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){wS(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.sqrt(i)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){wS(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=1/Math.sqrt(i)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){wS(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){wS(e,"relu");for(var t=Gm(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return t},t.prototype.relu6=function(e){wS(e,"relu");for(var t=Gm(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return t},t.prototype.prelu=function(e,t){return wS([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return e<0?t*e:e})},t.prototype.elu=function(e){wS(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var i=n[r];t[r]=i>=0?i:Math.exp(i)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){wS([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=0;o<r.length;++o){var a=r[o];n[o]=a>=1?i[o]:i[o]*(a+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){wS(e,"selu");for(var t=ix,n=ox,r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>=0?n*a:t*(Math.exp(a)-1)}return this.makeOutput(r,e.shape,"float32")},t.prototype.clip=function(e,t,n){wS(e,"clip");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>n?n:a<t?t:a}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var i=n[2*r],o=n[2*r+1];t[r]=Math.hypot(i,o)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){wS(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){wS(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){wS(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),i=0;i<r.length;++i){var o,a=r[i]>-t,s=r[i]<t,u=Math.exp(r[i]);o=s?u:a?r[i]:Math.log(1+u),n[i]=o}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){wS(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){wS(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){wS(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){wS(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){wS(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){wS(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return wS([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.atan2(e,t)})},t.prototype.sinh=function(e){wS(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){wS(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){wS(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=uf(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){wS(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){wS(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){wS(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){wS(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),o=Math.abs(n[r]),a=1/(1+.3275911*o);t[r]=i*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-o*o))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),wS(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];isNaN(o)?n[i]=NaN:n[i]=o>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,o=e.activation,a=e.preluActivationWeights,s=this.conv2d(t,n,r);return i&&(s=this.add(s,i)),o&&(s=ES(this,s,o,a)),s},t.prototype.conv2d=function(e,t,n){wS([e,t],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l="channelsLast"===n.dataFormat,c=mg(n.outShape,e.dtype),h=e.strides[0],d=l?e.strides[1]:e.strides[2],f=l?e.strides[2]:1,p=l?1:e.strides[1],m=c.strides[0],g=l?c.strides[1]:c.strides[2],v=l?c.strides[2]:1,y=l?1:c.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=c.values,E=0;E<n.batchSize;++E)for(var _=E*h,S=E*m,k=0;k<n.outHeight;++k)for(var C=S+k*g,I=k*n.strideHeight-u,T=0;T<r;T++){var A=I+T*o;if(!(A<0||A>=n.inHeight))for(var O=T*t.strides[0],N=_+A*d,P=0;P<n.outWidth;++P)for(var D=C+P*v,R=P*n.strideWidth-s,M=0;M<i;M++){var j=R+M*a;if(!(j<0||j>=n.inWidth))for(var F=N+j*f,L=O+M*t.strides[1],B=0;B<n.inChannels;++B){for(var z=b[F+B*p],U=0;U<n.outChannels;++U)w[D+U*y]+=z*x[L+U];L+=n.outChannels}}}return c.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,l=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,d=mg(n.outShape,e.dtype),f=this.readSync(e.dataId),p=this.readSync(t.dataId),m=d.values,g=0;g<n.batchSize;++g)for(var v=g*e.strides[0],y=g*d.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*d.strides[1],w=b*n.strideDepth-l,E=0;E<r;E++){var _=w+E*a;if(!(_<0||_>=n.inDepth))for(var S=E*t.strides[0],k=v+_*e.strides[1],C=0;C<n.outHeight;++C)for(var I=x+C*d.strides[2],T=C*n.strideHeight-h,A=0;A<i;A++){var O=T+A*s;if(!(O<0||O>=n.inHeight))for(var N=S+A*t.strides[1],P=k+O*e.strides[2],D=0;D<n.outWidth;++D)for(var R=I+D*n.outChannels,M=D*n.strideWidth-c,j=0;j<o;j++){var F=M+j*u;if(!(F<0||F>=n.inWidth))for(var L=N+j*t.strides[2],B=P+F*n.inChannels,z=L,U=0;U<n.inChannels;++U){for(var V=f[B+U],W=0;W<n.outChannels;++W)m[R+W]+=V*p[z+W];z+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){wS([e,t],"conv2dDerInput");for(var r=mg(n.inShape,"float32"),i=r.values,o=this.readSync(e.dataId),a=this.readSync(t.dataId),s=t.strides,u=s[0],l=s[1],c=s[2],h=n.batchSize,d=n.filterHeight,f=n.filterWidth,p=n.inChannels,m=n.inHeight,g=n.inWidth,v=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,E=n.dataFormat,_=d-1-n.padInfo.top,S=f-1-n.padInfo.left,k="channelsLast"===E,C=r.strides[0],I=k?r.strides[1]:r.strides[2],T=k?r.strides[2]:1,A=k?1:r.strides[1],O=e.strides[0],N=k?e.strides[1]:e.strides[2],P=k?e.strides[2]:1,D=k?1:e.strides[1],R=0;R<h;++R)for(var M=0;M<p;++M)for(var j=0;j<m;++j)for(var F=j-_,L=Math.max(0,Math.ceil(F/x)),B=Math.min(y,(d+F)/x),z=0;z<g;++z){for(var U=z-S,V=Math.max(0,Math.ceil(U/w)),W=Math.min(b,(f+U)/w),H=0,q=L;q<B;++q)for(var G=q*x-F,K=V;K<W;++K)for(var X=O*R+N*q+P*K,Y=u*(d-1-G)+l*(f-1-(K*w-U))+c*M,Q=0;Q<v;++Q)H+=o[X+D*Q]*a[Y+Q];i[C*R+I*j+T*z+A*M]=H}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=mg(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],l=o[3],c=this.readSync(e.dataId),h=e.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(t.dataId),v=t.strides,y=v[0],b=v[1],x=v[2],w=v[3],E=n.batchSize,_=n.filterDepth,S=n.filterHeight,k=n.filterWidth,C=n.inChannels,I=n.inDepth,T=n.inHeight,A=n.inWidth,O=n.outChannels,N=n.outDepth,P=n.outHeight,D=n.outWidth,R=n.strideDepth,M=n.strideHeight,j=n.strideWidth,F=_-1-n.padInfo.front,L=S-1-n.padInfo.top,B=k-1-n.padInfo.left,z=0;z<E;++z)for(var U=0;U<C;++U)for(var V=0;V<I;++V)for(var W=V-F,H=Math.max(0,Math.ceil(W/R)),q=Math.min(N,(_+W)/R),G=0;G<T;++G)for(var K=G-L,X=Math.max(0,Math.ceil(K/M)),Y=Math.min(P,(S+K)/M),Q=0;Q<A;++Q){for(var $=Q-B,Z=Math.max(0,Math.ceil($/j)),J=Math.min(D,(k+$)/j),ee=0,te=H;te<q;++te)for(var ne=te*R-W,re=X;re<Y;++re)for(var ie=re*M-K,oe=Z;oe<J;++oe)for(var ae=d*z+f*te+p*re+m*oe,se=y*(_-1-ne)+b*(S-1-ie)+x*(k-1-(oe*j-$))+w*U,ue=0;ue<O;++ue)ee+=c[ae+ue]*g[se+ue];i[a*z+s*V+u*G+l*Q+U]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){wS([e,t],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=mg(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,h=this.bufferSync(e),d=this.bufferSync(t),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),g=0;g<a;++g)for(var v=Math.max(0,Math.ceil((l-g)/i)),y=Math.min(n.outWidth,(n.inWidth+l-g)/i),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,E=0;E<n.batchSize;++E)for(var _=p;_<m;++_)for(var S=f+_*r-c,k=v;k<y;++k){var C=g+k*i-l;w+=s?h.get(E,S,C,b)*d.get(E,_,k,x):h.get(E,b,S,C)*d.get(E,x,_,k)}u.set(w,f,g,b,x)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=mg(n.filterShape,"float32"),c=l.values,h=l.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(t.dataId),v=t.strides,y=v[0],b=v[1],x=v[2],w=v[3],E=this.readSync(e.dataId),_=e.strides,S=_[0],k=_[1],C=_[2],I=_[3],T=n.padInfo.front,A=n.padInfo.left,O=n.padInfo.top,N=0;N<a;++N)for(var P=Math.max(0,Math.ceil((T-N)/r)),D=Math.min(n.outDepth,(n.inDepth+T-N)/r),R=N*d,M=0;M<s;++M)for(var j=Math.max(0,Math.ceil((O-M)/i)),F=Math.min(n.outHeight,(n.inHeight+O-M)/i),L=M*f+R,B=0;B<u;++B)for(var z=Math.max(0,Math.ceil((A-B)/o)),U=Math.min(n.outWidth,(n.inWidth+A-B)/o),V=B*p+L,W=0;W<n.inChannels;++W)for(var H=W*m+V,q=0;q<n.outChannels;++q){for(var G=0,K=0;K<n.batchSize;++K)for(var X=K*S,Y=K*y,Q=P;Q<D;++Q)for(var $=(N+Q*r-T)*k+X,Z=Q*b+Y,J=j;J<F;++J)for(var ee=(M+J*i-O)*C+$,te=J*x+Z,ne=z;ne<U;++ne){var re=ne*w+te;G+=E[(B+ne*o-A)*I+ee+W]*g[re+q]}c[H+q]=G}return l.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,o=e.activation,a=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return i&&(s=this.add(s,i)),o&&(s=ES(this,s,o,a)),s},t.prototype.depthwiseConv2D=function(e,t,n){wS([e,t],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=mg(n.outShape,e.dtype),h=this.readSync(e.dataId),d=this.readSync(t.dataId),f=c.values,p=0;p<n.batchSize;++p)for(var m=p*e.strides[0],g=p*c.strides[0],v=0;v<n.outHeight;++v)for(var y=g+v*c.strides[1],b=v*n.strideHeight-s,x=0;x<r;++x){var w=b+x*o;if(!(w<0||w>=n.inHeight))for(var E=x*t.strides[0],_=m+w*e.strides[1],S=0;S<n.outWidth;++S)for(var k=y+S*c.strides[2],C=S*n.strideWidth-u,I=0;I<i;++I){var T=C+I*a;if(!(T<0||T>=n.inWidth))for(var A=E+I*t.strides[1],O=_+T*n.inChannels,N=k,P=A,D=0;D<n.inChannels;++D){for(var R=h[O+D],M=0;M<l;++M)f[N+M]+=R*d[P+M];N+=l,P+=l}}}return c.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){wS([e,t],"depthwiseConv2DDerInput");for(var r=mg(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],l=this.readSync(e.dataId),c=e.strides,h=c[0],d=c[1],f=c[2],p=this.readSync(t.dataId),m=t.strides,g=m[0],v=m[1],y=m[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,E=n.inChannels,_=n.inHeight,S=n.inWidth,k=n.outChannels,C=n.outHeight,I=n.outWidth,T=n.strideHeight,A=n.strideWidth,O=x-1-n.padInfo.top,N=w-1-n.padInfo.left,P=k/E,D=0;D<b;++D)for(var R=0;R<E;++R)for(var M=0;M<_;++M)for(var j=M-O,F=Math.max(0,Math.ceil(j/T)),L=Math.min(C,(x+j)/T),B=0;B<S;++B){for(var z=B-N,U=Math.max(0,Math.ceil(z/A)),V=Math.min(I,(w+z)/A),W=0,H=F;H<L;++H)for(var q=H*T-j,G=U;G<V;++G)for(var K=h*D+d*H+f*G,X=g*(x-1-q)+v*(w-1-(G*A-z))+y*R,Y=0;Y<P;++Y)W+=l[K+(R*P+Y)]*p[X+Y];i[a*D+s*M+u*B+R]=W}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){wS([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=mg(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(e),d=this.bufferSync(t),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((l-f)/r)),m=Math.min(n.outHeight,(n.inHeight+l-f)/r),g=0;g<a;++g)for(var v=Math.max(0,Math.ceil((u-g)/i)),y=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/c),w=b%c,E=0,_=0;_<n.batchSize;++_)for(var S=p;S<m;++S)for(var k=f+S*r-l,C=v;C<y;++C){var I=g+C*i-u;E+=h.get(_,k,I,x)*d.get(_,S,C,b)}s.set(E,f,g,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return wS(e,"tile"),Vv(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){wS(e,"pad");var r=t.map(function(t,n){return t[0]+e.shape[n]+t[1]}),i=t.map(function(e){return e[0]}),o=this.bufferSync(e),a=mg(r,e.dtype);0!==n&&a.values.fill(n);for(var s=0;s<e.size;s++){var u=o.indexToLoc(s),l=u.map(function(e,t){return e+i[t]});a.set.apply(a,[o.get.apply(o,u)].concat(l))}return a.toTensor()},t.prototype.transpose=function(e,t){wS(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var i=this.readSync(e.dataId),o=mg(n,e.dtype),a=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),l=0;l<u.length;l++)u[l]=s[t[l]];var c=o.locToIndex(u);o.values[c]=i[r]}return o.toTensor()},t.prototype.gather=function(e,t,n){wS([e,t],"gather");var r=e.shape.slice(),i=this.readSync(t.dataId);r[n]=i.length;for(var o=mg(r,e.dtype),a=this.bufferSync(e),s=0;s<o.size;++s){var u=o.indexToLoc(s),l=u.slice();l[n]=i[u[n]];var c=a.locToIndex(l);o.values[s]=a.values[c]}return o.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){wS([e],"batchToSpaceND");var r=t.reduce(function(e,t){return e*t}),i=Vg(e.shape,t,r),o=Wg(i.length,t.length),a=Hg(e.shape,t,r),s=qg(n,t.length),u=Gg(a,n,t.length);return e.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){wS([e],"spaceToBatchND");var r=t.reduce(function(e,t){return e*t}),i=[[0,0]];i.push.apply(i,n);for(var o=1+t.length;o<e.shape.length;++o)i.push([0,0]);var a=e.pad(i),s=Vg(a.shape,t,r,!1),u=Wg(s.length,t.length,!1),l=Hg(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.pool=function(e,t,n){wS(e,"pool");for(var r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(e.dataId),f=mg(t.outShape,e.dtype),p=f.values,m=t.outShape[1]*t.outShape[2]*t.outShape[3],g=t.outShape[2]*t.outShape[3],v=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*m,x=y*e.strides[0],w=0;w<t.inChannels;++w)for(var E=0;E<t.outHeight;++E)for(var _=E*r-l,S=Math.max(0,_),k=Math.min(t.inHeight,s+_),C=b+E*g,I=0;I<t.outWidth;++I){for(var T=I*i-c,A=Math.max(0,T),O=Math.min(t.inWidth,u+T),N=h,P=0,D=0,R=S;R<k;R+=o){for(var M=x+R*e.strides[1],j=A;j<O;j+=a){var F=d[M+j*e.strides[2]+w];"max"===n&&F>N?N=F:"avg"===n&&(P+=F,D++)}if(isNaN(N))break}p[C+I*v+w]="avg"===n?P/D:N}return f.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=mg(t.outShape,"int32"),r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,h=this.bufferSync(e),d=0;d<t.batchSize;++d)for(var f=0;f<t.inChannels;++f)for(var p=0;p<t.outHeight;++p){for(var m=p*r-l,g=m;g<0;)g+=o;for(var v=Math.min(t.inHeight,s+m),y=0;y<t.outWidth;++y){for(var b=y*i-c,x=b;x<0;)x+=a;for(var w=Math.min(t.inWidth,u+b),E=Number.NEGATIVE_INFINITY,_=-1,S=g;S<v;S+=o)for(var k=S-m,C=x;C<w;C+=a){var I=C-b,T=h.get(d,S,C,f);T>E&&(E=T,_=k*u+I)}n.set(_,d,p,y,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){wS([t,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(t,r),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=c-1-r.padInfo.left,d=l-1-r.padInfo.top,f=mg(t.shape,"float32"),p=this.bufferSync(i),m=this.bufferSync(e),g=0;g<r.batchSize;++g)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-d,w=b-h,E=0,_=0;_<l;_+=s){var S=(x+_)/o;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var k=0;k<c;k+=u){var C=(w+k)/a;if(!(C<0||C>=r.outWidth||Math.floor(C)!==C)){var I=l*c-1-p.get(g,S,C,v)===_*c+k?1:0;0!==I&&(E+=m.get(g,S,C,v)*I)}}}f.set(E,g,y,b,v)}return f.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){wS([e,t],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,d=l-1-n.padInfo.top,f=mg(t.shape,"float32"),p=1/(o*a),m=this.bufferSync(e),g=0;g<n.batchSize;++g)for(var v=0;v<n.inChannels;++v)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-d,w=b-h,E=0,_=0;_<l;_+=s){var S=(x+_)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var k=0;k<c;k+=u){var C=(w+k)/i;C<0||C>=n.outWidth||Math.floor(C)!==C||(E+=m.get(g,S,C,v))}}f.set(E*p,g,y,b,v)}return f.toTensor()},t.prototype.pool3d=function(e,t,n){wS(e,"pool3d");for(var r=t.strideDepth,i=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(e.dataId),v=mg(t.outShape,e.dtype),y=v.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],E=t.outShape[4],_=0;_<t.batchSize;++_)for(var S=_*b,k=_*e.strides[0],C=0;C<t.inChannels;++C)for(var I=0;I<t.outDepth;++I){for(var T=I*r-d,A=T;A<0;)A+=a;for(var O=Math.min(t.inDepth,l+T),N=S+I*x,P=0;P<t.outHeight;++P){for(var D=P*i-f,R=D;R<0;)R+=s;for(var M=Math.min(t.inHeight,c+D),j=N+P*w,F=0;F<t.outWidth;++F){for(var L=F*o-p,B=L;B<0;)B+=u;for(var z=Math.min(t.inWidth,h+L),U=j+F*E,V=m,W=0,H=0,q=A;q<O;q+=a){for(var G=k+q*e.strides[1],K=R;K<M;K+=s){for(var X=G+K*e.strides[2],Y=B;Y<z;Y+=u){var Q=g[X+Y*e.strides[3]+C];if("max"===n&&Q>V?V=Q:"avg"===n&&(W+=Q,H++),isNaN(V))break}if(isNaN(V))break}if(isNaN(V))break}y[U+C]="avg"===n?W/H:V}}}return v.toTensor()},t.prototype.avgPool3d=function(e,t){return wS(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){wS([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=n.dilationDepth,c=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=d-1-n.padInfo.front,g=p-1-n.padInfo.left,v=f-1-n.padInfo.top,y=mg(t.shape,"float32"),b=1/(a*s*u),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var E=0;E<n.inChannels;++E)for(var _=0;_<n.inDepth;++_)for(var S=0;S<n.inHeight;++S)for(var k=0;k<n.inWidth;++k){for(var C=_-m,I=S-v,T=k-g,A=0,O=0;O<d;O+=l){var N=(C+O)/r;if(!(N<0||N>=n.outDepth||Math.floor(N)!==N))for(var P=0;P<f;P+=c){var D=(I+P)/i;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var R=0;R<p;R+=h){var M=(T+R)/o;M<0||M>=n.outWidth||Math.floor(M)!==M||(A+=x.get(w,N,D,M,E))}}}y.set(A*b,w,_,S,k,E)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return wS(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=mg(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,m=this.bufferSync(e),g=0;g<t.batchSize;++g)for(var v=0;v<t.inChannels;++v)for(var y=0;y<t.outDepth;++y){for(var b=y*r-d,x=b;x<0;)x+=a;for(var w=Math.min(t.inDepth,l+b),E=0;E<t.outHeight;++E){for(var _=E*i-f,S=_;S<0;)S+=s;for(var k=Math.min(t.inHeight,c+_),C=0;C<t.outWidth;++C){for(var I=C*o-p,T=I;T<0;)T+=u;for(var A=Math.min(t.inWidth,h+I),O=Number.NEGATIVE_INFINITY,N=-1,P=x;P<w;P+=a)for(var D=P-b,R=S;R<k;R+=s)for(var M=R-_,j=T;j<A;j+=u){var F=j-I,L=m.get(g,P,R,j,v);L>=O&&(O=L,N=D*c*h+M*c+F)}n.set(N,g,y,E,C,v)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){wS([t,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(t,r),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=h-1-r.padInfo.front,m=f-1-r.padInfo.left,g=d-1-r.padInfo.top,v=mg(t.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var E=0;E<r.inDepth;++E)for(var _=0;_<r.inHeight;++_)for(var S=0;S<r.inWidth;++S){for(var k=E-p,C=_-g,I=S-m,T=0,A=0;A<h;A+=u){var O=(k+A)/o;if(!(O<0||O>=r.outDepth||Math.floor(O)!==O))for(var N=0;N<d;N+=l){var P=(C+N)/a;if(!(P<0||P>=r.outHeight||Math.floor(P)!==P))for(var D=0;D<f;D+=c){var R=(I+D)/s;if(!(R<0||R>=r.outWidth||Math.floor(R)!==R)){var M=h*d*f-1-y.get(x,O,P,R,w)===A*d*f+N*f+D?1:0;0!==M&&(T+=b.get(x,O,P,R,w)*M)}}}}v.set(T,x,E,_,S,w)}return v.toTensor()},t.prototype.cast=function(e,t){return Cv(e,t,this)},t.prototype.reshape=function(e,t){return Iv(e,t)},t.prototype.avgPool=function(e,t){return wS(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){wS(e,"resizeBilinear");for(var i=e.shape,o=i[0],a=i[1],s=i[2],u=i[3],l=this.readSync(e.dataId),c=new Float32Array(of([o,t,n,u])),h=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=0,p=h[0]/d[0],m=h[1]/d[1],g=0;g<o;g++)for(var v=0;v<t;v++)for(var y=p*v,b=Math.floor(y),x=y-b,w=Math.min(a-1,Math.ceil(y)),E=g*e.strides[0]+b*e.strides[1],_=g*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var k=m*S,C=Math.floor(k),I=k-C,T=Math.min(s-1,Math.ceil(k)),A=E+C*e.strides[2],O=_+C*e.strides[2],N=E+T*e.strides[2],P=_+T*e.strides[2],D=0;D<u;D++){var R=l[A+D],M=l[O+D],j=R+(l[N+D]-R)*I,F=j+(M+(l[P+D]-M)*I-j)*x;c[f++]=F}return Lm(c,[o,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){wS([e,t],"resizeBilinearBackprop");for(var r=t.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],h=new Float32Array(i*o*a*s),d=[n&&l>1?o-1:o,n&&c>1?a-1:a],f=[n&&l>1?l-1:l,n&&c>1?c-1:c],p=d[0]/f[0],m=d[1]/f[1],g=this.readSync(e.dataId),v=0,y=0;y<i;y++)for(var b=y*t.strides[0],x=0;x<l;x++)for(var w=x*p,E=Math.floor(w),_=Math.min(Math.ceil(w),o-1),S=b+E*t.strides[1],k=b+_*t.strides[1],C=w-E,I=1-C,T=0;T<c;T++)for(var A=T*m,O=Math.floor(A),N=Math.min(Math.ceil(A),a-1),P=A-O,D=1-P,R=S+O*t.strides[2],M=S+N*t.strides[2],j=k+O*t.strides[2],F=k+N*t.strides[2],L=I*D,B=I*P,z=C*D,U=C*P,V=0;V<s;V++){var W=g[v++];h[R+V]+=W*L,h[M+V]+=W*B,h[j+V]+=W*z,h[F+V]+=W*U}return Hm(h,[i,a,o,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){wS(e,"resizeNearestNeighbor");for(var i=e.shape,o=i[0],a=i[1],s=i[2],u=i[3],l=this.readSync(e.dataId),c=new Float32Array(o*t*n*u),h=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=h[0]/d[0],p=h[1]/d[1],m=0,g=0;g<o;g++)for(var v=g*e.strides[0],y=0;y<t;y++)for(var b=f*y,x=v+Math.min(a-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var E=p*w,_=x+Math.min(s-1,r?Math.round(E):Math.floor(E))*e.strides[2],S=0;S<u;S++){var k=l[_+S];c[m++]=k}return Lm(c,[o,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){wS([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],h=new Float32Array(i*o*a*s),d=this.readSync(e.dataId),f=[n&&l>1?o-1:o,n&&c>1?a-1:a],p=[n&&l>1?l-1:l,n&&c>1?c-1:c],m=f[0]/p[0],g=f[1]/p[1],v=1/m,y=1/g,b=2*Math.ceil(v)+2,x=2*Math.ceil(y)+2,w=0;w<i;w++)for(var E=w*t.strides[0],_=0;_<o;_++)for(var S=E+_*t.strides[1],k=Math.floor(_*v),C=Math.floor(k-b/2),I=0;I<a;I++)for(var T=S+I*t.strides[2],A=Math.floor(I*y),O=Math.floor(A-x/2),N=0;N<s;N++){for(var P=0,D=0;D<b;D++){var R=D+C;if(!(R<0||R>=l)){var M=E+R*e.strides[1],j=R*m;if(_===Math.min(o-1,n?Math.round(j):Math.floor(j)))for(var F=0;F<x;F++){var L=F+O;if(!(L<0||L>=c)){var B=M+L*e.strides[2],z=L*g;I===Math.min(a-1,n?Math.round(z):Math.floor(z))&&(P+=d[B+N])}}}}h[T+N]=P}return Hm(h,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,i,o){wS([e,t,n,i,o],"batchNorm");for(var a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),l=i?this.readSync(i.dataId):new Float32Array([1]),c=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(a.length),d=c.length,f=l.length,p=u.length,m=s.length,g=0,v=0,y=0,b=0,x=0;x<a.length;++x)h[x]=c[g++]+(a[x]-s[v++])*l[y++]/Math.sqrt(u[b++]+r),g>=d&&(g=0),v>=m&&(v=0),y>=f&&(y=0),b>=p&&(b=0);return Hm(h,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,i){wS(e,"localResponseNormalization4D");var o=e.shape[3],a=o-1,s=this.readSync(e.dataId),u=e.size,l=new Float32Array(u);function c(e){for(var n=e%o,r=e-n+Math.max(0,n-t),i=e-n+Math.min(n+t,a),u=0;r<=i;r++){var l=s[r];u+=l*l}return u}for(var h=0;h<u;h++){var d=c(h),f=s[h]*Math.pow(n+r*d,-i);l[h]=f}return Hm(l,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,i,o,a){wS(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),l=this.readSync(t.dataId),c=this.readSync(n.dataId),h=new Float32Array(e.size),d=e.size,f=0;f<d;f++){for(var p=f%s,m=f-p+Math.max(0,p-r),g=f-p+Math.min(s,p+r+1),v=0,y=m;y<g;y++)v+=Math.pow(l[y],2);for(v=o*v+i,y=m;y<g;y++){var b=-2*o*a*l[y]*c[f]/v;f===y&&(b+=Math.pow(v,-a)),b*=u[f],h[y]+=b}}return Hm(h,e.shape)},t.prototype.multinomial=function(e,t,n,r){wS(e,"multinomial");for(var i=t?e:av(e),o=i.shape[0],a=i.shape[1],s=Gm([o,n],"int32"),u=this.readSync(s.dataId),l=this.readSync(i.dataId),c=0;c<o;++c){var h=c*a,d=new Float32Array(a-1);d[0]=l[h];for(var f=1;f<d.length;++f)d[f]=d[f-1]+l[h+f];for(var p=hg(r.toString()),m=c*n,g=0;g<n;++g){var v=p();u[m+g]=d.length;for(var y=0;y<d.length;y++)if(v<d[y]){u[m+g]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){wS(e,"oneHot");var i=new Float32Array(e.size*t);i.fill(r);for(var o=this.readSync(e.dataId),a=0;a<e.size;++a)o[a]>=0&&o[a]<t&&(i[a*t+o[a]]=n);return Vm(i,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,i){return wS(e,"nonMaxSuppression"),Mv(this.readSync(e.dataId),this.readSync(t.dataId),n,r,i)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],i=mg(e.shape,"float32"),o=mg(e.shape,"float32"),a=jm(e).as2D(n,r),s=Fm(e).as2D(n,r),u=0;u<n;u++)for(var l=a.slice([u,0],[1,r]),c=s.slice([u,0],[1,r]),h=Mm(l,c),d=this.readSync(this.fftImpl(h,t).dataId),f=0;f<r;f++){var p=Ov(d,f);i.values[u*r+f]=p.real,o.values[u*r+f]=p.imag}return Mm(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(i=Mm(jm(i).div(zm(r)),Fm(i).div(zm(r)))),i}var o=this.readSync(e.dataId),a=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(o,r,t));return Mm(a.real,a.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),i=t/2,o=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}(r),a=Mm(o.real,o.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}(r),u=Mm(s.real,s.imag).as1D();a=this.fftRadix2(a,i,n),u=this.fftRadix2(u,i,n);var l=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),i=0;i<Math.ceil(e/2);i++){var o=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(t,n),c=Mm(l.real,l.imag).mul(u),h=a.add(c),d=a.sub(c),f=jm(h).concat(jm(d)),p=Fm(h).concat(Fm(d));return Mm(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),i=0;i<t;i++){for(var o=0,a=0,s=0;s<t;s++){var u=Pv(i*s,t,n),l=Ov(e,s);o+=l.real*u.real-l.imag*u.imag,a+=l.real*u.imag+l.imag*u.real}n&&(o/=t,a/=t),Nv(r,o,a,i)}return r},t.prototype.depthToSpace=function(e,t,n){ef("NHWC"===n,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n}),ef(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});for(var r=e.shape[0],i=e.shape[1],o=e.shape[2],a=e.shape[3],s=i*t,u=o*t,l=a/(t*t),c=this.readSync(e.dataId),h=new Float32Array(r*s*u*l),d=0,f=0;f<r;++f)for(var p=0;p<s;++p)for(var m=Math.floor(p/t),g=p%t,v=0;v<u;++v)for(var y=Math.floor(v/t),b=(g*t+v%t)*l,x=0;x<l;++x){var w=x+b+a*(y+o*(m+i*f));h[d++]=c[w]}return Hm(h,[r,s,u,l])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var i=fv(e.shape,t.shape),o=mg(i,n),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=hv(e.shape,i),l=hv(t.shape,i),c=o.values;if(u.length+l.length===0)for(var h=0;h<c.length;++h)c[h]=r(a[h%a.length],s[h%s.length]);else{var d=this.bufferSync(e),f=this.bufferSync(t),p=function(n){var i=o.indexToLoc(n),h=i.slice(-e.rank);u.forEach(function(e){return h[e]=0});var p=d.locToIndex(h),m=i.slice(-t.rank);l.forEach(function(e){return m[e]=0});var g=f.locToIndex(m);c[n]=r(a[p],s[g])};for(h=0;h<c.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=fv(e.shape,t.shape),i=mg(r,"float32"),o=mg(r,"float32"),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=hv(e.shape,r),l=hv(t.shape,r),c=i.values,h=o.values;if(u.length+l.length===0)for(var d=0;d<c.length;d++){var f=d%a.length,p=d%s.length,m=n(a[2*f],a[2*f+1],s[2*p],s[2*p+1]);c[d]=m.real,h[d]=m.imag}else{var g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),d=o.slice(-e.rank);u.forEach(function(e){return d[e]=0});var f=g.locToIndex(d),p=o.slice(-t.rank);l.forEach(function(e){return p[e]=0});var m=v.locToIndex(p),y=n(a[2*f],a[2*f+1],s[2*m],s[2*m+1]);c[r]=y.real,h[r]=y.imag};for(d=0;d<c.length;d++)y(d)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(e,t,n){return Uv(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,i,o){for(var a=e.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=t.shape[0],d=r[0],f=r[1],p=mg([h,d,f,c],"float32"),m=this.readSync(t.dataId),g=this.readSync(n.dataId),v=this.readSync(e.dataId),y=e.strides,b=p.strides,x=0;x<h;x++){var w=4*x,E=m[w],_=m[w+1],S=m[w+2],k=m[w+3],C=g[x];if(!(C>=s))for(var I=d>1?(S-E)*(u-1)/(d-1):0,T=f>1?(k-_)*(l-1)/(f-1):0,A=0;A<d;A++){var O=d>1?E*(u-1)+A*I:.5*(E+S)*(u-1);if(O<0||O>u-1)for(var N=0;N<f;N++)for(var P=0;P<c;P++){var D=P+N*b[2]+A*b[1]+x*b[0];p.values[D]=o}else if("bilinear"===i){var R=Math.floor(O),M=Math.ceil(O),j=O-R;for(N=0;N<f;N++)if((q=f>1?_*(l-1)+N*T:.5*(_+k)*(l-1))<0||q>l-1)for(P=0;P<c;P++)D=P+N*b[2]+A*b[1]+x*b[0],p.values[D]=o;else{var F=Math.floor(q),L=Math.ceil(q),B=q-F;for(P=0;P<c;P++){var z=v[D=P+F*y[2]+R*y[1]+C*y[0]],U=v[D=P+L*y[2]+R*y[1]+C*y[0]],V=v[D=P+F*y[2]+M*y[1]+C*y[0]],W=z+(U-z)*B,H=V+(v[D=P+L*y[2]+M*y[1]+C*y[0]]-V)*B;D=P+N*b[2]+A*b[1]+x*b[0],p.values[D]=W+(H-W)*j}}}else for(N=0;N<f;++N){var q;if((q=f>1?_*(l-1)+N*T:.5*(_+k)*(l-1))<0||q>l-1)for(P=0;P<c;P++)D=P+N*b[2]+A*b[1]+x*b[0],p.values[D]=o;else{var G=Math.round(q),K=Math.round(O);for(P=0;P<c;P++){var X=P+G*y[2]+K*y[1]+C*y[0],Y=P+N*b[2]+A*b[1]+x*b[0];p.values[Y]=v[X]}}}}}return p.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var i=$g(0,e,n),o=i.sliceRank,a=i.numUpdates,s=i.sliceSize,u=i.strides,l=i.outputSize;return this.scatter(e,t,n,l,s,a,o,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],i=Kg(e,t),o=i[0],a=i[1],s=i[2],u=i[3];if(0===a)return Lm([],o,e.dtype);for(var l=new qf([a,s],e.dtype),c=this.readSync(t.dataId),h=this.readSync(e.dataId),d=0;d<a;d++){for(var f=[],p=0,m=0;m<r;m++){var g=c[d*r+m];p+=g*u[m],f.push(g)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: "+f+" does not index into "+e.shape);for(var v=0;v<s;v++)l.values[d*s+v]=h[p*s+v]}return l.toTensor().reshape(o)},t.prototype.scatterND=function(e,t,n){var r=$g(0,e,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=zm(0);return this.scatter(e,t,n,u,a,o,i,s,l,!0)},t.prototype.fill=function(e,t,n){var r=gf(n=n||Cf(t),of(e));return r.fill(t),hp.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=gf(e.dtype,of(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return Tv(e,t,n)},t.prototype.scatter=function(e,t,n,r,i,o,a,s,u,l){var c=[r/i,i],h=this.readSync(e.dataId),d=this.readSync(t.dataId);if(0===r)return Lm([],n,t.dtype);var f=new qf(c,t.dtype);f.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var m=[],g=0,v=0;v<a;v++){var y=h[p*a+v];m.push(y),g+=y*s[v]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)l?f.values[g*i+b]+=d[p*i+b]:f.values[g*i+b]=0===t.rank?d[0]:d[p*i+b]}return f.toTensor().reshape(n)},t}(lv);hp.registerBackend("cpu",function(){return new _S},1);for(var SS=0,kS=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,h=s.softNmsSigma,d=n;wS(o,"NonMaxSuppressionWithScore");var f=jv(d.data.get(o.dataId).values,d.data.get(a.dataId).values,u,l,c,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;wS(r,"square");for(var o=i.data.get(r.dataId).values,a=new Float32Array(o.length),s=0;s<o.length;++s){var u=o[s];a[s]=u*u}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:jx,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,o=r.b,a=n;wS([i,o],jx);var s=a.data.get(i.dataId).values,u=a.data.get(o.dataId).values,l=function(e,t,n,r,i,o){var a=fv(e,t),s=a.length,u=Af(a),l=mf(i,of(a)),c=e.length,h=t.length,d=Af(e),f=Af(t),p=hv(e,a),m=hv(t,a);if(p.length+m.length===0)for(var g=0;g<l.length;++g)l[g]=o(n[g%n.length],r[g%r.length]);else{var v=function(e){var t=Bf(e,s,u),i=t.slice(-c);p.forEach(function(e){return i[e]=0});var a=Lf(i,c,d),g=t.slice(-h);m.forEach(function(e){return g[e]=0});var v=Lf(g,h,f);l[e]=o(n[a],r[v])};for(g=0;g<l.length;++g)v(g)}return[l,a]}(i.shape,o.shape,s,u,i.dtype,function(e,t){var n=e-t;return n*n}),c=l[0],h=l[1];return{dataId:a.write(c,h,i.dtype),shape:h,dtype:i.dtype}}}];SS<kS.length;SS++)Kd(kS[SS]);for(var CS,IS=function(e){this.variableNames=["A"];var t=Qv(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},TS=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Qv(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},AS=0,OS=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,o=r.numChannels,a="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,u=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],h=[c,l],d=[c,l,o];(s||a)&&(null==CS&&(CS=document.createElement("canvas").getContext("2d")),CS.canvas.width=l,CS.canvas.height=c,CS.drawImage(i,0,0,l,c),i=CS.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=mp.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),i);var p=Ud().getBool("WEBGL_PACK")?new TS(d):new IS(d),m=n.runWebGLProgram(p,[f],"int32");return n.disposeData(f.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;bm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,h=s.softNmsSigma,d=n,f=jv(d.readSync(o.dataId),d.readSync(a.dataId),u,l,c,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,o=new ax(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:jx,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,o=r.b,a=n,s=Ud().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Sy("return (a - b) * (a - b);",i.shape,o.shape):new Ey("return (a - b) * (a - b);",i.shape,o.shape);return a.compileAndRun(s,[i,o])}}];AS<OS.length;AS++)Kd(OS[AS]);for(var NS=0,PS=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:jx,gradFunc:function(e,t){var n=t[0],r=t[1],i=zm(2);return{a:function(){return Zw(e,Zw(i,rE(n,r)))},b:function(){return Zw(e,Zw(i,rE(r,n)))}}}}];NS<PS.length;NS++)Xd(PS[NS]);var DS=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();Ud().get("IS_BROWSER")&&Ud().setPlatform("browser",new DS);var RS,MS=function(){function e(){this.util=n(745),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=Ud().global.fetch?Ud().global.fetch(e,t):(null==RS&&(RS=n(7318)),RS(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();Ud().get("IS_NODE")&&Ud().setPlatform("node",new MS);var jS={float32:4,int32:4,uint16:2,uint8:1,bool:1};function FS(e,t){for(var n={},r=0,i=function(t){var i=t.name,o=t.dtype,a=t.shape,s=of(a),u=void 0;if("quantization"in t){var l=t.quantization;if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+l.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=jS[l.dtype],h=e.slice(r,r+s*c),d="uint8"===l.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(d,function(e){return e*l.scale+l.min});else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(d,function(e){return Math.round(e*l.scale+l.min)})}r+=s*c}else if("string"===o){var f=of(t.shape);u=[];for(var p=0;p<f;p++){var m=new Uint32Array(e.slice(r,r+4))[0];r+=4;var g=new Uint8Array(e.slice(r,r+m));u.push(g),r+=m}}else{var v=jS[o];if(h=e.slice(r,r+s*v),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=s*v}n[i]=Lm(u,a,o)},o=0,a=t;o<a.length;o++)i(a[o]);return n}function LS(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(e){r.set(new Uint8Array(e.buffer),i),i+=e.byteLength}),r.buffer}var BS="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function zS(e){return BS?Buffer.byteLength(e):new Blob([e]).size}function US(e){var t=0;e.forEach(function(e){t+=e.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(new Uint8Array(e),r),r+=e.byteLength}),n.buffer}function VS(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function WS(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:zS(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:zS(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var HS=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(e){var n=e(t,r);null!==n&&i.push(n)}),i},e}(),qS="://",GS=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){ef(null!=t,function(){return"scheme must not be undefined or null."}),t.endsWith(qS)&&(t=t.slice(0,t.indexOf(qS))),ef(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();ef(null==r.managers[t],function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function KS(e){if(-1===e.indexOf(qS))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+GS.getSchemes().join(","));return{scheme:e.split(qS)[0],path:e.split(qS)[1]}}function XS(e,t,n){return void 0===n&&(n=!1),Ld(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h;return Bd(this,function(d){switch(d.label){case 0:return ef(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),ef((r=HS.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),ef(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],ef((o=HS.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),ef(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=o[0],s=KS(e).scheme,u=KS(e).path,l=s===KS(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,GS.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,a.save(c)];case 4:return h=d.sent(),!n||l?[3,6]:[4,GS.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var YS="models_store",QS="model_info_store";function $S(){if(!Ud().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ZS(e){var t=e.result;t.createObjectStore(YS,{keyPath:"modelPath"}),t.createObjectStore(QS,{keyPath:"modelPath"})}var JS=function(){function e(e){if(this.indexedDB=$S(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},e.prototype.load=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(e,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return ZS(i)},i.onsuccess=function(){var o=i.result;if(null==t){var a=o.transaction(YS,"readonly"),s=a.objectStore(YS).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return o.close(),r(s.error)},a.oncomplete=function(){return o.close()}}else{var u,l=WS(t),c=o.transaction(QS,"readwrite"),h=c.objectStore(QS),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});d.onsuccess=function(){var i=(u=o.transaction(YS,"readwrite")).objectStore(YS).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l});i.onsuccess=function(){return e({modelArtifactsInfo:l})},i.onerror=function(e){var t=(h=c.objectStore(QS)).delete(n.modelPath);t.onsuccess=function(){return o.close(),r(i.error)},t.onerror=function(e){return o.close(),r(i.error)}}},d.onerror=function(e){return o.close(),r(d.error)},c.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(e){return r(i.error)}})},e.URL_SCHEME="indexeddb://",e}(),ek=function(e){return Ud().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(JS.URL_SCHEME)?(t=e.slice(JS.URL_SCHEME.length),new JS(t)):null;var t};HS.registerSaveRouter(ek),HS.registerLoadRouter(ek);var tk=function(){function e(){this.indexedDB=$S()}return e.prototype.listModels=function(){return Ld(this,void 0,void 0,function(){var e=this;return Bd(this,function(t){return[2,new Promise(function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return ZS(r)},r.onsuccess=function(){var e=r.result,i=e.transaction(QS,"readonly"),o=i.objectStore(QS).getAll();o.onsuccess=function(){for(var e={},n=0,r=o.result;n<r.length;n++){var i=r[n];e[i.modelPath]=i.modelArtifactsInfo}t(e)},o.onerror=function(t){return e.close(),n(o.error)},i.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}})]})})},e.prototype.removeModel=function(e){return Ld(this,void 0,void 0,function(){var t=this;return Bd(this,function(n){var r;return e=(r=e).startsWith(JS.URL_SCHEME)?r.slice(JS.URL_SCHEME.length):r,[2,new Promise(function(n,r){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return ZS(i)},i.onsuccess=function(){var t,o=i.result,a=o.transaction(QS,"readwrite"),s=a.objectStore(QS),u=s.get(e);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var i=s.delete(e),a=function(){var i=(t=o.transaction(YS,"readwrite")).objectStore(YS).delete(e);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(e){return r(u.error)}};i.onsuccess=a,i.onerror=function(e){return a(),o.close(),r(u.error)}},u.onerror=function(e){return o.close(),r(u.error)},a.oncomplete=function(){null==t?o.close():t.oncomplete=function(){return o.close()}}},i.onerror=function(e){return r(i.error)}})]})})},e}();if(Ud().getBool("IS_BROWSER"))try{GS.registerManager(JS.URL_SCHEME,new tk)}catch(jd){}var nk="/",rk="tensorflowjs_models",ik="info",ok="model_topology",ak="weight_specs",sk="weight_data",uk="model_metadata";function lk(e){return{info:[rk,e,ik].join(nk),topology:[rk,e,ok].join(nk),weightSpecs:[rk,e,ak].join(nk),weightData:[rk,e,sk].join(nk),modelMetadata:[rk,e,uk].join(nk)}}function ck(e){var t=e.split(nk);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(nk)}var hk=function(){function e(e){if(!Ud().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=lk(this.modelPath)}return e.prototype.save=function(e){return Ld(this,void 0,void 0,function(){var t,n,r;return Bd(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=WS(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(BS)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}})})},e.prototype.load=function(){return Ld(this,void 0,void 0,function(){var e,t,n,r,i,o,a;return Bd(this,function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,t.userDefinedMetadata=o.userDefinedMetadata),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(BS){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(a),[2,t]})})},e.URL_SCHEME="localstorage://",e}(),dk=function(e){return Ud().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(hk.URL_SCHEME)?(t=e.slice(hk.URL_SCHEME.length),new hk(t)):null;var t};HS.registerSaveRouter(dk),HS.registerLoadRouter(dk);var fk=function(){function e(){ef(Ud().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),ef("undefined"==typeof window||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return Ld(this,void 0,void 0,function(){var e,t,n,r,i,o;return Bd(this,function(a){for(e={},t=rk+nk,n=nk+ik,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(t)&&i.endsWith(n)&&(o=ck(i),e[o]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},e.prototype.removeModel=function(e){return Ld(this,void 0,void 0,function(){var t,n;return Bd(this,function(r){var i;if(e=(i=e).startsWith(hk.URL_SCHEME)?i.slice(hk.URL_SCHEME.length):i,t=lk(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]})})},e}();if(Ud().getBool("IS_BROWSER"))try{GS.registerManager(hk.URL_SCHEME,new fk)}catch(jd){}function pk(e){return new Promise(function(e){return setTimeout(e)}).then(e)}var mk=function(){function e(t){if(!Ud().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return Ld(this,void 0,void 0,function(){var t,n,r,i,o,a;return Bd(this,function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,[4,pk(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return s.sent(),null==e.weightData?[3,4]:((a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,pk(function(){return a.dispatchEvent(new MouseEvent("click"))})]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:WS(e)}]}})})},e.URL_SCHEME="downloads://",e}(),gk=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return Ld(this,void 0,void 0,function(){var e,t,n=this;return Bd(this,function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(r,i){var o=new FileReader;o.onload=function(o){var a=JSON.parse(o.target.result),s=a.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var l;try{l=n.checkManifestAndWeightFiles(u,t)}catch(e){return void i(e)}var c=[],h=[],d=[];u.forEach(function(e){e.paths.forEach(function(e){h.push(e),d.push(null)}),c.push.apply(c,e.weights)}),u.forEach(function(e){e.paths.forEach(function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,i=h.indexOf(e);d[i]=n,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:US(d),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},t.onerror=function(t){return i("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(l[e])})})}else i(new Error("weightManifest field is missing from file "+e.name))}else i(new Error("modelTopology field is missing from file "+e.name))},o.onerror=function(t){return i("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(e)})]})})},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map(function(e){return VS(e.name)}),i={},o=0,a=e;o<a.length;o++)a[o].paths.forEach(function(e){var o=VS(e);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[e]=t[r.indexOf(o)]});if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return i},e}();function vk(e,t,n,r){!function(e){ef(null!=e&&Array.isArray(e)&&e.length>0,function(){return"promises must be a none empty array"})}(e),function(e,t){ef(e>=0&&e<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e}),ef(t>=0&&t<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t}),ef(t>=e,function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t})}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(e.map(function(o){return o.then(function(o){var a=n+ ++i/e.length*(r-n);return t(a),o}),o}))}function yk(e,t){return Ld(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c;return Bd(this,function(h){switch(h.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?Ud().platform.fetch:t.fetchFunc,r=e.map(function(e){return n(e,t.requestInit,{isBinary:!0})}),i=0,o=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=h.sent(),[3,4];case 2:return[4,vk(r,t.onProgress,i,o)];case 3:a=h.sent(),h.label=4;case 4:return s=a.map(function(e){return e.arrayBuffer()}),u=.5,l=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return c=h.sent(),[3,8];case 6:return[4,vk(s,t.onProgress,u,l)];case 7:c=h.sent(),h.label=8;case 8:return[2,c]}})})}function bk(e){var t=this;return function(n,r,i){return void 0===r&&(r=""),Ld(t,void 0,void 0,function(){var t,o,a,s,u,l,c,h,d,f;return Bd(this,function(p){switch(p.label){case 0:if(t=n.map(function(){return!1}),o={},a=null!=i?i.map(function(){return!1}):[],s=[],n.forEach(function(e,n){var r=0;e.weights.forEach(function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,l=jS[u]*of(e.shape),c=function(){t[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:e,groupOffset:r,sizeBytes:l})};null!=i?i.forEach(function(t,n){t===e.name&&(c(),a[n]=!0)}):c(),s.push(e.name),r+=l})}),!a.every(function(e){return e}))throw u=i.filter(function(e,t){return!a[t]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=t.reduce(function(e,t,n){return t&&e.push(n),e},[]),c=[],l.forEach(function(e){n[e].paths.forEach(function(e){var t=r+(r.endsWith("/")?"":"/")+e;c.push(t)})}),[4,e(c)];case 1:return h=p.sent(),d={},f=0,l.forEach(function(e){for(var t=n[e].paths.length,r=0,i=0;i<t;i++)r+=h[f+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,l=0;l<t;l++){var c=new Uint8Array(h[f+l]);s.set(c,u),u+=c.byteLength}o[e].forEach(function(e){var t=FS(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]}),f+=t}),[2,d]}})})}}HS.registerSaveRouter(function(e){return Ud().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(mk.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new mk(e)}(e.slice(mk.URL_SCHEME.length)):null});var xk=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(ef("function"==typeof t.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=Ud().platform.fetch,ef(null!=e&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&ef(2===e.length,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return Ld(this,void 0,void 0,function(){var t,n,r,i;return Bd(this,function(o){switch(o.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((i=o.sent()).ok)return[2,{modelArtifactsInfo:WS(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return Ld(this,void 0,void 0,function(){var e,t,n,r,i,o,a,s,u,l,c,h;return Bd(this,function(d){switch(d.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=d.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");d.label=2;case 2:return d.trys.push([2,4,,5]),[4,e.json()];case 3:return t=d.sent(),[3,5];case 4:throw d.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,i=t.weightsManifest,o=t.generatedBy,a=t.convertedBy,s=t.format,u=t.userDefinedMetadata,null==r&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:h=d.sent(),l=h[0],c=h[1],d.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:c,userDefinedMetadata:u,generatedBy:o,convertedBy:a,format:s}]}})})},e.prototype.loadWeights=function(e){return Ld(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,l,c,h;return Bd(this,function(d){switch(d.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],i=n[1],o=this.weightPathPrefix||r,a=[],s=0,u=e;s<u.length;s++)l=u[s],a.push.apply(a,l.weights);return c=[],e.forEach(function(e){e.paths.forEach(function(e){c.push(o+e+i)})}),[4,yk(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=d.sent(),[2,[a,US(h)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function wk(e){return null!=e.match(xk.URL_SCHEME_REGEX)}var Ek=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every(function(e){return wk(e)}):wk(e))?_k(e,{onProgress:t}):null};function _k(e,t){return new xk(e,t)}HS.registerSaveRouter(Ek),HS.registerLoadRouter(Ek);var Sk,kk=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){return[2,this.modelArtifacts]})})},e}(),Ck=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){return[2,this.saveHandler(e)]})})},e}(),Ik=Object.freeze({browserFiles:function(e){return new gk(e)},browserHTTPRequest:function(e,t){return _k(e,t)},concatenateArrayBuffers:US,decodeWeights:FS,encodeWeights:function(e,t){return Ld(this,void 0,void 0,function(){var n,r,i,o,a,s=this;return Bd(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e),o=function(o){var a=i[o],u=Array.isArray(e)?e[o].tensor:e[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+u.dtype);var l={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var c=new Promise(function(e){return Ld(s,void 0,void 0,function(){var t,n,r,i,o,a,s;return Bd(this,function(l){switch(l.label){case 0:return[4,u.bytes()];case 1:for(t=l.sent(),n=t.reduce(function(e,t){return e+t.length},0)+4*t.length,r=new Uint8Array(n),i=0,o=0;o<t.length;o++)a=t[o],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,i),i+=4,r.set(a,i),i+=a.length;return e(r),[2]}})})});r.push(c)}else r.push(u.data());null!=t&&(l.group=t),n.push(l)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:LS(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new kk(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kk({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kk({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return HS.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:WS,getSaveHandlers:function(e){return HS.getSaveHandlers(e)},http:_k,isHTTPScheme:wk,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),Ld(this,void 0,void 0,function(){return Bd(this,function(i){return[2,bk(function(e){return yk(e,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return HS.registerLoadRouter(e)},registerSaveRouter:function(e){return HS.registerSaveRouter(e)},weightsLoaderFactory:bk,withSaveHandler:function(e){return new Ck(e)},copyModel:function(e,t){return Ld(this,void 0,void 0,function(){return Bd(this,function(n){return[2,XS(e,t,!1)]})})},listModels:function(){return Ld(this,void 0,void 0,function(){var e,t,n,r,i,o,a;return Bd(this,function(s){switch(s.label){case 0:e=GS.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,GS.getManager(i).listModels()]):[3,4];case 2:for(a in o=s.sent())t[i+qS+a]=o[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return Ld(this,void 0,void 0,function(){return Bd(this,function(n){return[2,XS(e,t,!0)]})})},removeModel:function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){return t=KS(e),[2,GS.getManager(t.scheme).removeModel(t.path)]})})}}),Tk=Rm({confusionMatrix_:function(e,t,n){var r=Em(e,"labels","confusionMatrix"),i=Em(t,"predictions","confusionMatrix");ef(null==n||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),ef(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),ef(1===i.rank,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),ef(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),ef(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var o=kg(r.asType("int32"),n),a=kg(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}}),Ak=(Object.freeze({confusionMatrix:Tk}),Rm({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,o=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)o=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=qd("FromPixels",hp.backendName))return hp.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],h=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,h).data:r||n?s=e.data:(o||i)&&(null==Sk&&(Sk=document.createElement("canvas").getContext("2d")),Sk.canvas.width=c,Sk.canvas.height=h,Sk.drawImage(e,0,0,c,h),s=Sk.getImageData(0,0,c,h).data),4===t)u=new Int32Array(s);else{var d=c*h;u=new Int32Array(d*t);for(var f=0;f<d;f++)for(var p=0;p<t;++p)u[f*t+p]=s[4*f+p]}return Wm(u,[h,c,t],"int32")}})),Ok=Object.freeze({toPixels:function(e,t){return Ld(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c,h,d,f,p,m,g,v,y,b,x,w,E,_,S;return Bd(this,function(k){switch(k.label){case 0:if(n=Em(e,"img","toPixels"),e instanceof Yf||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=k.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),h=c[0],d=c[1],f=h[0],p=d[0],u.dispose(),l.dispose(),"float32"===n.dtype){if(f<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+p+"].")}for(m="float32"===n.dtype?255:1,g=new Uint8ClampedArray(o*i*4),v=0;v<i*o;++v)y=void 0,b=void 0,x=void 0,w=void 0,1===a?(y=s[v]*m,b=s[v]*m,x=s[v]*m,w=255):3===a?(y=s[3*v]*m,b=s[3*v+1]*m,x=s[3*v+2]*m,w=255):4===a&&(y=s[4*v]*m,b=s[4*v+1]*m,x=s[4*v+2]*m,w=s[4*v+3]*m),g[0+(E=4*v)]=Math.round(y),g[E+1]=Math.round(b),g[E+2]=Math.round(x),g[E+3]=Math.round(w);return null!=t&&(t.width=o,t.height=i,_=t.getContext("2d"),S=new ImageData(g,o,i),_.putImageData(S,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:Ak}),Nk=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),Pk=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Dk(e){ef(null!=e.className,function(){return"Class being registered does not have the static className property defined."}),ef("string"==typeof e.className,function(){return"className is required to be a string, but got type "+typeof e.className}),ef(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Pk.register(e)}Object.freeze({Serializable:Nk,SerializationMap:Pk,registerClass:Dk});function Rk(){return 32===hp.backend.floatPrecision()?.001:.1}function Mk(e,t,n){var r=!0;if((xf(e)||xf(t))&&(r=!1),xf(e)&&xf(t)&&(r=!0),r){var i=e.constructor.name,o=t.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(e)&&Array.isArray(t)){var a=xm(e),s=xm(t);if(!af(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=xf(e)?e:rf(e),l=xf(t)?t:rf(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+".\nActual:   "+u+".\nExpected: "+l+".");for(var c=0;c<l.length;++c){var h=u[c],d=l[c];if(!n(h,d))throw new Error("Arrays differ: actual["+c+"] = "+h+", expected["+c+"] = "+d+".\nActual:   "+u+".\nExpected: "+l+".")}}function jk(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=Rk()),Mk(e,t,function(e,t){return jk(e,t,n)})},testEpsilon:Rk,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return _f(e)||_f(e[0])||_f(t)||_f(t[0])?Mk(e,n,function(e,t){return e==t}):Mk(e,t,function(e,t){return jk(e,t,0)})},expectNumbersClose:function(e,t,n){if(null==n&&(n=Rk()),!jk(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:bb,webgl_util:pm,forceHalfFloat:function(){Ud().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Rx,setWebGLContext:bp,GPGPUContext:xb});var Fk=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fd(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),i=r.value,o=r.grads;if(null!=n){var a=n.map(function(e){return{name:e.name,tensor:o[e.name]}});this.applyGradients(a)}else this.applyGradients(o);return ym(o),t?i:(i.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){ef(If(e),function(){return"The f passed in variableGrads(f) must be a function"}),ef(null==t||Array.isArray(t)&&t.every(function(e){return e instanceof tp}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=null!=t;if(!n)for(var r in t=[],hp.registeredVariables)t.push(hp.registeredVariables[r]);var i=n?t.filter(function(e){return!e.trainable}):null,o=t.length;ef((t=t.filter(function(e){return e.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var a=hp.gradients(e,t,null,!0),s=a.value,u=a.grads;ef(u.some(function(e){return null!=e}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),ef(0===s.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(e,t){null!=u[t]&&(l[e.name]=u[t])}),null!=i&&i.forEach(function(e){return l[e.name]=null}),{value:s,grads:l}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&ym(this.iterations_)},t.prototype.saveIterations=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:zm(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}})})},t}(Nk);Object.defineProperty(Fk,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Lk=function(e){function t(t,n,r){void 0===r&&(r=null);var i=e.call(this)||this;return i.learningRate=t,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=hp.backend.epsilon()),i}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var i=hp.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:vm(function(){return Qm(i).variable(!1)})}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:vm(function(){return Qm(i).variable(!1)})});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var a=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;vm(function(){var e=a.mul(t.rho).add(o.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(a.add(t.epsilon).sqrt()).mul(o),r=s.mul(t.rho).add(n.square().mul(1-t.rho));a.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(i);i.assign(u)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(ym(this.accumulatedGrads.map(function(e){return e.variable})),ym(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(Fk);Dk(Lk);var Bk=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var i=hp.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:vm(function(){return Km(i.shape,t.initialAccumulatorValue).variable(!1)})});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var a=t.accumulatedGrads[r].variable;vm(function(){var e=a.add(o.square());a.assign(e);var n=o.div(e.add(hp.backend.epsilon()).sqrt()).mul(-t.learningRate).add(i);i.assign(n)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&ym(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(Fk);Dk(Bk);var zk=function(e){function t(t,n,r,i){void 0===i&&(i=null);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],vm(function(){o.accBeta1=zm(n).variable(),o.accBeta2=zm(r).variable()}),null==i&&(o.epsilon=hp.backend.epsilon()),o}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);vm(function(){var r=rE(1,t.accBeta1),i=rE(1,t.accBeta2);n.forEach(function(n,o){var a=hp.registeredVariables[n];null==t.accumulatedFirstMoment[o]&&(t.accumulatedFirstMoment[o]={originalName:n+"/m",variable:vm(function(){return Qm(a).variable(!1)})}),null==t.accumulatedSecondMoment[o]&&(t.accumulatedSecondMoment[o]={originalName:n+"/v",variable:vm(function(){return Qm(a).variable(!1)})});var s=Array.isArray(e)?e[o].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[o].variable,l=t.accumulatedSecondMoment[o].variable,c=u.mul(t.beta1).add(s.mul(1-t.beta1)),h=l.mul(t.beta2).add(s.square().mul(1-t.beta2)),d=c.div(r),f=h.div(i);u.assign(c),l.assign(h);var p=d.div(f.sqrt().add(t.epsilon)).mul(-t.learningRate).add(a);a.assign(p)}}),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&ym(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&ym(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){var t,n=this;return Bd(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),vm(function(){n.accBeta1.assign(eE(n.beta1,n.iterations_+1)),n.accBeta2.assign(eE(n.beta2,n.iterations_+1))}),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(Fk);Dk(zk);var Uk=function(e){function t(t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=i,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],vm(function(){a.iteration=zm(0).variable(),a.accBeta1=zm(n).variable()}),null==i&&(a.epsilon=hp.backend.epsilon()),a}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);vm(function(){var r=rE(1,t.accBeta1),i=Vw(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach(function(n,o){var a=hp.registeredVariables[n];null==t.accumulatedFirstMoment[o]&&(t.accumulatedFirstMoment[o]={originalName:n+"/m",variable:Qm(a).variable(!1)}),null==t.accumulatedWeightedInfNorm[o]&&(t.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:Qm(a).variable(!1)});var s=Array.isArray(e)?e[o].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[o].variable,l=t.accumulatedWeightedInfNorm[o].variable,c=u.mul(t.beta1).add(s.mul(1-t.beta1)),h=l.mul(t.beta2),d=s.abs(),f=h.maximum(d);u.assign(c),l.assign(f);var p=i.div(r).mul(c.div(f.add(t.epsilon))).add(a);a.assign(p)}}),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&ym(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&ym(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(Fk);Dk(Uk);var Vk=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=hp.registeredVariables[n];vm(function(){var e=t.c.mul(i).add(o);o.assign(e)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return hp.keep(e)}(zm(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(Fk);Dk(Vk);var Wk=function(e){function t(t,n,r){void 0===r&&(r=!1);var i=e.call(this,t)||this;return i.learningRate=t,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=zm(i.momentum),i}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var i=hp.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:vm(function(){return Qm(i).variable(!1)})});var o=t.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[n];null!=a&&vm(function(){var e,n=t.m.mul(o).add(a);e=t.useNesterov?t.c.mul(a.add(n.mul(t.m))).add(i):t.c.mul(n).add(i),o.assign(n),i.assign(e)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&ym(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){return Bd(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){return Bd(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(Vk);Dk(Wk);var Hk=function(e){function t(t,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var a=e.call(this)||this;if(a.learningRate=t,a.decay=n,a.momentum=r,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,null==i&&(a.epsilon=hp.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return Fd(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var i=hp.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:vm(function(){return Qm(i).variable(!1)})}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:vm(function(){return Qm(i).variable(!1)})}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:vm(function(){return Qm(i).variable(!1)})});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var a=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;vm(function(){var e=a.mul(t.decay).add(o.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(o.mul(1-t.decay)),l=s.mul(t.momentum).add(o.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));a.assign(e),n.assign(u),s.assign(l);var c=i.sub(l);i.assign(c)}else{var h=a.mul(t.decay).add(o.square().mul(1-t.decay));l=s.mul(t.momentum).add(o.mul(t.learningRate).div(h.add(t.epsilon).sqrt())),a.assign(h),s.assign(l),c=i.sub(l),i.assign(c)}})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&ym(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&ym(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&ym(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ld(this,void 0,void 0,function(){var e;return Bd(this,function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return Ld(this,void 0,void 0,function(){var t;return Bd(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(Fk);Dk(Hk);var qk=function(){function e(){}return e.sgd=function(e){return new Vk(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new Wk(e,t,n)},e.rmsprop=function(e,t,n,r,i){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new Hk(e,t,n,r,i)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new zk(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new Lk(e,t,n)},e.adamax=function(e,t,n,r,i){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new Uk(e,t,n,r,i)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new Bk(e,t)},e}();qk.sgd,qk.momentum,qk.adadelta,qk.adagrad,qk.rmsprop,qk.adamax,qk.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;function Gk(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach(function(n,r){var i=n.x,o=n.y,a=t[r];e.moveTo(a.x,a.y),e.lineTo(i,o)}),n){var r=t[t.length-1],i=t[0];if(!r||!i)return;e.moveTo(r.x,r.y),e.lineTo(i.x,i.y)}e.stroke()}Yf.prototype.squaredDifference=function(e){return Fx(this,e)},Kf=xS;var Kk=function(e,t){return Kk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},Kk(e,t)};function Xk(e,t){function n(){this.constructor=e}Kk(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Yk=function(){return Yk=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Yk.apply(this,arguments)};function Qk(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(Fd){o(Fd)}}function s(e){try{u(r.throw(e))}catch(Fd){o(Fd)}}function u(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())})}function $k(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(Fd){o=[6,Fd],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Zk(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var Jk=function(){function e(e,t){if(!uC(e)||!uC(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function eC(e,t){return e instanceof Yf&&e.shape.length===t}function tC(e){return eC(e,3)}function nC(e){return eC(e,4)}function rC(e){return e%2===0}function iC(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function oC(e){return e&&e.width&&e.height}function aC(e){return e.reduce(function(e,t){return e.add(t)},new cC(0,0)).div(new cC(e.length,e.length))}function sC(e,t,n){return Array(e).fill(0).map(function(e,r){return t+r*n})}function uC(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function lC(e){return uC(e)&&0<=e&&e<=1}var cC=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),hC=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},i=[r.left,r.top,r.right,r.bottom].every(uC),o=[r.x,r.y,r.width,r.height].every(uC);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(uC)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new cC(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new cC(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new cC(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new cC(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.round(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.floor(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,i=t.width,o=t.height,a=Math.abs(i-o);return i<o&&(n-=a/2,i+=a),o<i&&(r-=a/2,o+=a),new e({x:n,y:r,width:i,height:o})},e.prototype.rescale=function(t){var n=oC(t)?t.width:t,r=oC(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(t,n){var r=this,i=r.x,o=r.y,a=r.right,s=r.bottom,u=Math.max(i,0),l=Math.max(o,0),c=a-u,h=s-l;return new e({x:u,y:l,width:Math.min(c,t-u),height:Math.min(h,n-l)}).floor()},e.prototype.shift=function(t,n){var r=this.width,i=this.height;return new e({x:this.x+t,y:this.y+n,width:r,height:i})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,i=n,o=r,a=this.left,s=this.top,u=this.right,l=this.bottom;return u>t&&(i=-u+t+n,u=t),l>e&&(o=-l+e+r,l=e),a<1&&(o=2-a,a=1),s<1&&(o=2-s,s=1),{dy:1,edy:o,dx:1,edx:i,y:s,ey:l,x:a,ex:u,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),dC=function(e){function t(t,n,r,i,o){return void 0===o&&(o=!1),e.call(this,{left:t,top:n,right:r,bottom:i},o)||this}return Xk(t,e),t}(hC),fC=function(){function e(e,t,n,r,i){this._imageDims=new Jk(i.width,i.height),this._score=e,this._classScore=t,this._className=n,this._box=new hC(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new hC(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),pC=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return Xk(t,e),t.prototype.forSize=function(n,r){var i=e.prototype.forSize.call(this,n,r);return new t(i.score,i.relativeBox,i.imageDims)},t}(fC);function mC(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function gC(e,t,n,r){void 0===r&&(r=!0);for(var i=t.map(function(e,t){return{score:e,boxIndex:t}}).sort(function(e,t){return e.score-t.score}).map(function(e){return e.boxIndex}),o=[],a=function(){var t=i.pop();o.push(t);for(var a=i,s=[],u=0;u<a.length;u++){var l=a[u],c=e[t],h=e[l];s.push(mC(c,h,r))}i=i.filter(function(e,t){return s[t]<=n})};i.length>0;)a();return o}function vC(e,t){return vm(function(){var n=t[0],r=t[1],i=t[2],o=Km(Zk(e.shape.slice(0,3),[1]),n),a=Km(Zk(e.shape.slice(0,3),[1]),r),s=Km(Zk(e.shape.slice(0,3),[1]),i),u=$m([o,a,s],3);return rE(e,u)})}function yC(e){return 1/(1+Math.exp(-e))}var bC,xC=function(e){function t(t,n,r,i,o){return void 0===o&&(o=!1),e.call(this,{x:t,y:n,width:r,height:i},o)||this}return Xk(t,e),t}(hC),wC=function(){function e(e,t,n){void 0===n&&(n=new cC(0,0));var r=t.width,i=t.height;this._imgDims=new Jk(r,i),this._shift=n,this._positions=e.map(function(e){return e.mul(new cC(r,i)).add(n)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new cC(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new cC(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new cC(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof pC?e.box.floor():new hC(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),i=r.useDlibAlignment,o=r.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(o)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],i=function(e){return r.sub(e).magnitude()},o=(i(t)+i(n))/2,a=Math.floor(o/.45),s=aC(e),u=Math.floor(Math.max(0,s.x-.5*a)),l=Math.floor(Math.max(0,s.y-.43*a));return new xC(u,l,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+l))},e.prototype.alignMinBbox=function(e){var t=function(e){var t=e.map(function(e){return e.x}),n=e.map(function(e){return e.y}),r=t.reduce(function(e,t){return t<e?t:e},1/0),i=n.reduce(function(e,t){return t<e?t:e},1/0),o=t.reduce(function(e,t){return e<t?t:e},0),a=n.reduce(function(e,t){return e<t?t:e},0);return new dC(r,i,o,a)}(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),EC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],aC([e[3],e[4]])]},t}(wC),_C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(aC)},t}(wC),SC=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+iC(this.distance)+")":"")},e}(),kC=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return Xk(t,e),t.assertIsValidLabeledBox=function(e,t){if(hC.assertIsValidBox(e,t),!uC(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(hC),CC=function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(e){return!(e instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(e){return new Float32Array(e)});return new e(t.label,n)},e}();!function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o._score=r,o._classScore=i,o}Xk(t,e),t.assertIsValidPredictedBox=function(e,t){if(kC.assertIsValidLabeledBox(e,t),!lC(e.score)||!lC(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(kC);function IC(e){return e.detection instanceof pC}function TC(e,t){var n={detection:t};return Object.assign({},e,n)}function AC(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function OC(e){var t="";if(!e)try{e=n(1591)}catch(r){t=r.toString()}return{readFile:e?function(t){return new Promise(function(n,r){e.readFile(t,function(e,t){return e?r(e):n(t)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function NC(){var e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=OC();return Yk({Canvas:e||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},i)}function PC(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function DC(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function RC(e){bC=e}function MC(){PC()&&RC(AC()),DC()&&RC(NC())}var jC,FC={getEnv:function(){if(!bC)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return bC},setEnv:RC,initialize:MC,createBrowserEnv:AC,createFileSystem:OC,createNodejsEnv:NC,monkeyPatch:function(e){if(bC||MC(),!bC)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?bC.Canvas:t,r=e.Image,i=void 0===r?bC.Image:r;bC.Canvas=n,bC.Image=i,bC.createCanvasElement=e.createCanvasElement||function(){return new n},bC.createImageElement=e.createImageElement||function(){return new i},bC.ImageData=e.ImageData||bC.ImageData,bC.Video=e.Video||bC.Video,bC.fetch=e.fetch||bC.fetch,bC.readFile=e.readFile||bC.readFile},isBrowser:PC,isNodejs:DC};function LC(e){return FC.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function BC(e){var t=FC.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var r=LC(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=r.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}MC(),function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(jC||(jC={}));var zC=function(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,i=e.fontSize,o=e.fontStyle,a=e.padding;this.anchorPosition=t||jC.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=o||"Georgia",this.padding=a||4},UC=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new zC(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map(function(t){return e.measureText(t).width}).reduce(function(e,t){return e<t?t:e},0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===jC.BOTTOM_RIGHT||n===jC.TOP_RIGHT,i=n===jC.BOTTOM_LEFT||n===jC.BOTTOM_RIGHT,o=this.measureWidth(e),a=this.measureHeight(),s=r?this.anchor.x-o:this.anchor.x,u=i?this.anchor.y-a:this.anchor.y;if(t){var l=t.width,c=t.height;return{x:Math.max(Math.min(s,l-o),0),y:Math.max(Math.min(u,c-a),0)}}return{x:s,y:u}},e.prototype.draw=function(e){var t=LC(e),n=BC(t),r=this.options,i=r.backgroundColor,o=r.fontColor,a=r.fontSize,s=r.fontStyle,u=r.padding;n.font=a+"px "+s;var l=this.measureWidth(n),c=this.measureHeight();n.fillStyle=i;var h=this.getUpperLeft(n,t);n.fillRect(h.x,h.y,l,c),n.fillStyle=o,this.text.forEach(function(e,t){var r=u+h.x,i=u+h.y+(t+1)*a;n.fillText(e,r,i)})},e}(),VC=function(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,i=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var o={anchorPosition:jC.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new zC(Object.assign({},o,i))},WC=function(){function e(e,t){void 0===t&&(t={}),this.box=new hC(e),this.options=new VC(t)}return e.prototype.draw=function(e){var t=BC(e),n=this.options,r=n.boxColor,i=n.lineWidth,o=this.box,a=o.x,s=o.y,u=o.width,l=o.height;t.strokeStyle=r,t.lineWidth=i,t.strokeRect(a,s,u,l);var c=this.options.label;c&&new UC([c],{x:a-i/2,y:s},this.options.drawLabelOptions).draw(e)},e}();function HC(e){var t=FC.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function qC(e){var t=FC.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Jk(e.naturalWidth,e.naturalHeight):e instanceof r?new Jk(e.videoWidth,e.videoHeight):new Jk(e.width,e.height)}function GC(e){var t=e.width,n=e.height,r=(0,FC.getEnv().createCanvasElement)();return r.width=t,r.height=n,r}function KC(e,t){var n=FC.getEnv().ImageData;if(!(e instanceof n)&&!HC(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||qC(e),i=r.width,o=r.height,a=GC({width:i,height:o});return e instanceof n?BC(a).putImageData(e,0,0):BC(a).drawImage(e,0,0,i,o),a}function XC(e,t){return Qk(this,void 0,void 0,function(){var n,r,i,o,a,s;return $k(this,function(u){switch(u.label){case 0:return n=t||FC.getEnv().createCanvasElement(),r=e.shape.slice(nC(e)?1:0),i=r[0],o=r[1],a=r[2],s=vm(function(){return e.as3D(i,o,a).toInt()}),[4,Ok.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function YC(e){var t=FC.getEnv(),n=t.Image,r=t.Canvas,i=t.Video;return e instanceof n||e instanceof r||e instanceof i}var QC=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(e,t){if(tC(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(nC(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var i=e instanceof FC.getEnv().Canvas?e:KC(e);n._canvases[t]=i,n._inputDimensions[t]=[i.height,i.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return sC(this.batchSize,0,1).map(function(t,n){return e.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(e,t){var n=e.width,r=e.height,i=t/Math.max(r,n);return new Jk(Math.round(n*i),Math.round(r*i))}({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,vm(function(){var r=sC(n.batchSize,0,1).map(function(r){var i=n.getInput(r);if(i instanceof Yf){var o=nC(i)?i:i.expandDims();return o=function(e,t){return void 0===t&&(t=!1),vm(function(){var n=e.shape.slice(1),r=n[0],i=n[1];if(r===i)return e;var o=Math.abs(r-i),a=Math.round(o*(t?.5:1)),s=r>i?2:1,u=function(t){var n=e.shape.slice();return n[s]=t,Km(n,0)},l=u(a),c=o-l.shape[s],h=[t&&c?u(c):null,e,l].filter(function(e){return!!e}).map(function(e){return e.toFloat()});return $m(h,s)})}(o,t),o.shape[1]===e&&o.shape[2]===e||(o=hS.resizeBilinear(o,[e,e])),o.as3D(e,e,3)}if(i instanceof FC.getEnv().Canvas)return Ok.fromPixels(function(e,t,n){void 0===n&&(n=!1);var r=FC.getEnv(),i=r.Image,o=r.Canvas;if(!(e instanceof i||e instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=qC(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=GC({width:t,height:t}),h=e instanceof o?e:KC(e),d=Math.abs(u-l)/2,f=n&&u<l?d:0,p=n&&l<u?d:0;return BC(c).drawImage(h,f,p,u,l),c}(i,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+i)}),i=Lg(r.map(function(e){return e.toFloat()})).as4D(n.batchSize,e,e,3);return i})},e}();function $C(e){return Qk(this,void 0,void 0,function(){var t,n,r;return $k(this,function(i){switch(i.label){case 0:if(e instanceof QC)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},(r=t.map(LC)).forEach(function(e,r){if(!YC(e)&&!tC(e)&&!nC(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(nC(e)){var i=e.shape[0];if(1!==i)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+i+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(e){return YC(e)&&(t=e,new Promise(function(e,n){if(t instanceof FC.getEnv().Canvas||HC(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",i),e(t))}function i(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",i),n(e))}t.addEventListener("load",r),t.addEventListener("error",i)}));var t}))];case 1:return i.sent(),[2,new QC(r,Array.isArray(e))]}})})}function ZC(e,t){return Qk(this,void 0,void 0,function(){var n,r,i,o,a,s;return $k(this,function(u){switch(u.label){case 0:return n=FC.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,$C(e)];case 1:if((i=u.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(o=i.getInput(0))instanceof n?(a=o,[3,4]):[3,2];case 2:return[4,XC(o)];case 3:a=u.sent(),u.label=4;case 4:r=a,u.label=5;case 5:return s=BC(r),[2,t.map(function(e){return e instanceof pC?e.forSize(r.width,r.height).box.floor():e}).map(function(e){return e.clipAtImageBorders(r.width,r.height)}).map(function(e){var t=e.x,n=e.y,r=e.width,i=e.height,o=GC({width:r,height:i});return BC(o).putImageData(s.getImageData(t,n,r,i),0,0),o})]}})})}function JC(e,t){return Qk(this,void 0,void 0,function(){return $k(this,function(n){if(!tC(e)&&!nC(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(nC(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,vm(function(){var n=e.shape.slice(nC(e)?1:0),r=n[0],i=n[1],o=n[2],a=t.map(function(e){return e instanceof pC?e.forSize(i,r).box:e}).map(function(e){return e.clipAtImageBorders(i,r)}).map(function(t){var n=t.x,a=t.y,s=t.width,u=t.height;return JE(e.as3D(r,i,o),[a,n,0],[u,s,o])});return a})]})})}function eI(e,t){return Qk(this,void 0,void 0,function(){var n;return $k(this,function(r){switch(r.label){case 0:return[4,(0,FC.getEnv().fetch)(e,t)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function tI(e){return Qk(this,void 0,void 0,function(){return $k(this,function(t){switch(t.label){case 0:return[4,eI(e)];case 1:return[2,t.sent().json()]}})})}function nI(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",i=(e=e.replace(r,"")).split("/").filter(function(e){return e}),o=e.endsWith(".json")?i[i.length-1]:n,a=r+(e.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return{modelBaseUri:a=e.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+o:a+"/"+o}}function rI(e,t){return Qk(this,void 0,void 0,function(){var n,r,i,o;return $k(this,function(a){switch(a.label){case 0:return n=nI(e,t),r=n.manifestUri,i=n.modelBaseUri,[4,tI(r)];case 1:return o=a.sent(),[2,Ik.loadWeights(o,i)]}})})}var iI=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,i=n.objProp;r[i].dispose(),r[i]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof tp})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof tp)})},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())})},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var n=t.path,r=t.tensor,i=Lm(r.dataSync());r.dispose(),e.reassignParamFromPath(n,i)})},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},e.prototype.load=function(e){return Qk(this,void 0,void 0,function(){return $k(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},e.prototype.loadFromUri=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,rI(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}})})},e.prototype.loadFromDisk=function(e){return Qk(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,l,c;return $k(this,function(h){switch(h.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=FC.getEnv().readFile,n=nI(e,this.getDefaultModelName()),r=n.manifestUri,i=n.modelBaseUri,o=function(e){return Promise.all(e.map(function(e){return t(e).then(function(e){return e.buffer})}))},a=Ik.weightsLoaderFactory(o),l=(u=JSON).parse,[4,t(r)];case 1:return s=l.apply(u,[h.sent().toString()]),[4,a(s,i)];case 2:return c=h.sent(),this.loadFromWeightMap(c),[2]}})})},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}},{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof Yf))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function oI(e,t,n){return vm(function(){var r=PE(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Lw(r,t.bias)})}function aI(e,t,n){return void 0===n&&(n=!1),vm(function(){var r=g_(n?Lw(kE(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):oI(e,t.conv0,[2,2])),i=oI(r,t.conv1,[1,1]),o=oI(g_(Lw(r,i)),t.conv2,[1,1]);return g_(Lw(r,Lw(i,o)))})}function sI(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),vm(function(){var i=g_(n?Lw(kE(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):oI(e,t.conv0,r?[2,2]:[1,1])),o=oI(i,t.conv1,[1,1]),a=oI(g_(Lw(i,o)),t.conv2,[1,1]),s=oI(g_(Lw(i,Lw(o,a))),t.conv3,[1,1]);return g_(Lw(i,Lw(o,Lw(a,s))))})}function uI(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),vm(function(){var i=Lw(kE(e,t.filters,[1,1],n),t.bias);return r?g_(i):i})}function lI(e,t){Object.keys(e).forEach(function(n){t.some(function(e){return e.originalPath===n})||e[n].dispose()})}function cI(e,t){return function(n,r,i,o){var a=Hm(e(n*r*i*i),[i,i,n,r]),s=Um(e(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:a,bias:s}}}function hI(e,t){return function(n,r,i){var o=Vm(e(n*r),[n,r]),a=Um(e(r));return t.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:a}}}var dI=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function fI(e,t){return function(n,r,i){var o=Hm(e(9*n),[3,3,n,1]),a=Hm(e(n*r),[1,1,n,r]),s=Um(e(r));return t.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new dI(o,a,s)}}function pI(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),i=e(t+"/bias",1);return new dI(n,r,i)}}function mI(e,t){return function(n,r,i){var o=e[n];if(!eC(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return t.push({originalPath:n,paramPath:i||n}),o}}function gI(e){var t=e;return{extractWeights:function(e){var n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function vI(e,t){var n=cI(e,t),r=fI(e,t);function i(e,t,i,o){return void 0===o&&(o=!1),{conv0:o?n(e,t,3,i+"/conv0"):r(e,t,i+"/conv0"),conv1:r(t,t,i+"/conv1"),conv2:r(t,t,i+"/conv2")}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:function(e,t,n,o){void 0===o&&(o=!1);var a=i(e,t,n,o);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(t,t,n+"/conv3")}}}}function yI(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function bI(e,t){var n=mI(e,t),r=yI(n),i=pI(n);return{extractDenseBlock3Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):i(e+"/conv0"),conv1:i(e+"/conv1"),conv2:i(e+"/conv2")}},extractDenseBlock4Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):i(e+"/conv0"),conv1:i(e+"/conv1"),conv2:i(e+"/conv2"),conv3:i(e+"/conv3")}}}}var xI=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return vm(function(){var n=sI(vC(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(zm(255)),t.dense0,!0);return n=sI(n,t.dense1),n=sI(n,t.dense2),n=sI(n,t.dense3),n=GE(n,[7,7],[2,2],"valid")})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=bI(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return lI(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=gI(e),r=n.extractWeights,i=n.getRemainingWeights,o=vI(r,t).extractDenseBlock4Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2"),l=o(128,256,"dense3");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}(e)},t}(iI);function wI(e,t){return vm(function(){return Lw(ME(e,t.weights),t.bias)})}function EI(e){var t={},n={};return Object.keys(e).forEach(function(r){(r.startsWith("fc")?n:t)[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var _I=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return Xk(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return vm(function(){var r=e instanceof QC?t.faceFeatureExtractor.forwardInput(e):e;return wI(r.as2D(r.shape[0],-1),n.fc)})},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e,t,n){var r=[],i=gI(e),o=i.extractWeights,a=i.getRemainingWeights,s=hI(o,r)(t,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=EI(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=mI(e,t),r={fc:function(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}("fc")};return lI(e,t),{params:r,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,i=e.slice(0,e.length-r),o=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},t}(iI),SI=["neutral","happy","sad","angry","fearful","disgusted","surprised"],kI=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);SI.forEach(function(n,r){t[n]=e[r]})}return e.prototype.asSortedArray=function(){var e=this;return SI.map(function(t){return{expression:t,probability:e[t]}}).sort(function(e,t){return t.probability-e.probability})},e}(),CI=function(e){function t(t){return void 0===t&&(t=new xI),e.call(this,"FaceExpressionNet",t)||this}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this;return vm(function(){return av(t.runNet(e))})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictExpressions=function(e){return Qk(this,void 0,void 0,function(){var t,n,r,i,o=this;return $k(this,function(a){switch(a.label){case 0:return[4,$C(e)];case 1:return t=a.sent(),[4,this.forwardInput(t)];case 2:return n=a.sent(),[4,Promise.all(Ug(n).map(function(e){return Qk(o,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}})})}))];case 3:return r=a.sent(),n.dispose(),i=r.map(function(e){return new kI(e)}),[2,t.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(_I);function II(e,t){var n={expressions:t};return Object.assign({},e,n)}function TI(e){return IC(e)&&e.landmarks instanceof wC&&e.unshiftedLandmarks instanceof wC&&e.alignedRect instanceof pC}function AI(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),i=r.align(),o=e.detection.imageDims,a={landmarks:r,unshiftedLandmarks:t,alignedRect:new pC(e.detection.score,i.rescale(o.reverse()),o)};return Object.assign({},e,a)}var OI=function(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,i=void 0===r||r,o=e.lineWidth,a=e.lineColor,s=e.pointSize,u=e.pointColor;this.drawLines=n,this.drawPoints=i,this.lineWidth=o||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=u||"rgba(255, 0, 255, 1)"},NI=function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new OI(t)}return e.prototype.draw=function(e){var t=BC(e),n=this.options,r=n.drawLines,i=n.drawPoints,o=n.lineWidth,a=n.lineColor,s=n.pointSize,u=n.pointColor;if(r&&this.faceLandmarks instanceof _C&&(t.strokeStyle=a,t.lineWidth=o,Gk(t,this.faceLandmarks.getJawOutline()),Gk(t,this.faceLandmarks.getLeftEyeBrow()),Gk(t,this.faceLandmarks.getRightEyeBrow()),Gk(t,this.faceLandmarks.getNose()),Gk(t,this.faceLandmarks.getLeftEye(),!0),Gk(t,this.faceLandmarks.getRightEye(),!0),Gk(t,this.faceLandmarks.getMouth(),!0)),i){t.strokeStyle=u,t.fillStyle=u;this.faceLandmarks.positions.forEach(function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()})}},e}();function PI(e,t){var n=[],r=gI(e),i=r.extractWeights,o=r.getRemainingWeights,a=function(e,t){var n=cI(e,t),r=fI(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,i){return{separable_conv0:r(e,t,i+"/separable_conv0"),separable_conv1:r(t,t,i+"/separable_conv1"),expansion_conv:n(e,t,1,i+"/expansion_conv")}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,t+"/separable_conv0"),separable_conv1:r(e,e,t+"/separable_conv1"),separable_conv2:r(e,e,t+"/separable_conv2")}}}}(i,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,h={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:l(32,64,"entry_flow/reduction_block_0"),reduction_block_1:l(64,128,"entry_flow/reduction_block_1")},d={};sC(t,0,1).forEach(function(e){d["main_block_"+e]=c(128,"middle_flow/main_block_"+e)});var f={reduction_block:l(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:h,middle_flow:d,exit_flow:f}}}function DI(e,t){var n=[],r=function(e,t){var n=mI(e,t),r=yI(n),i=pI(n);return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:function(e){return{separable_conv0:i(e+"/separable_conv0"),separable_conv1:i(e+"/separable_conv1"),expansion_conv:r(e+"/expansion_conv")}},extractMainBlockParams:function(e){return{separable_conv0:i(e+"/separable_conv0"),separable_conv1:i(e+"/separable_conv1"),separable_conv2:i(e+"/separable_conv2")}}}}(e,n),i=r.extractConvParams,o=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u={conv_in:i("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},l={};sC(t,0,1).forEach(function(e){l["main_block_"+e]=s("middle_flow/main_block_"+e)});var c={reduction_block:a("exit_flow/reduction_block"),separable_conv:o("exit_flow/separable_conv")};return lI(e,n),{params:{entry_flow:u,middle_flow:l,exit_flow:c},paramMappings:n}}function RI(e,t,n){return Lw(kE(e,t.filters,n,"same"),t.bias)}function MI(e,t,n){void 0===n&&(n=!0);var r=n?g_(e):e;return r=oI(r,t.separable_conv0,[1,1]),r=oI(g_(r),t.separable_conv1,[1,1]),r=qE(r,[3,3],[2,2],"same"),r=Lw(r,RI(e,t.expansion_conv,[2,2]))}var jI,FI=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return vm(function(){var r=vC(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(zm(256)),i=g_(RI(r,n.entry_flow.conv_in,[2,2]));return i=MI(i,n.entry_flow.reduction_block_0,!1),i=MI(i,n.entry_flow.reduction_block_1),sC(t._numMainBlocks,0,1).forEach(function(e){i=function(e,t){var n=oI(g_(e),t.separable_conv0,[1,1]);return n=oI(g_(n),t.separable_conv1,[1,1]),n=oI(g_(n),t.separable_conv2,[1,1]),Lw(n,e)}(i,n.middle_flow["main_block_"+e])}),i=MI(i,n.exit_flow.reduction_block),i=g_(oI(i,n.exit_flow.separable_conv,[1,1]))})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return DI(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return PI(e,this._numMainBlocks)},t}(iI);!function(e){e.FEMALE="female",e.MALE="male"}(jI||(jI={}));var LI=function(e){function t(t){void 0===t&&(t=new FI(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return Xk(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return vm(function(){var r=e instanceof QC?t.faceFeatureExtractor.forwardInput(e):e,i=GE(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:wI(i,n.fc.age).as1D(),gender:wI(i,n.fc.gender)}})},t.prototype.forwardInput=function(e){var t=this;return vm(function(){var n=t.runNet(e),r=n.age,i=n.gender;return{age:r,gender:av(i)}})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return Qk(this,void 0,void 0,function(){var t,n,r,i,o,a,s=this;return $k(this,function(u){switch(u.label){case 0:return[4,$C(e)];case 1:return t=u.sent(),[4,this.forwardInput(t)];case 2:return n=u.sent(),r=Ug(n.age),i=Ug(n.gender),o=r.map(function(e,t){return{ageTensor:e,genderTensor:i[t]}}),[4,Promise.all(o.map(function(e){var t=e.ageTensor,n=e.genderTensor;return Qk(s,void 0,void 0,function(){var e,r,i,o,a;return $k(this,function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],o=(i=r>.5)?jI.MALE:jI.FEMALE,a=i?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:o,genderProbability:a}]}})})}))];case 3:return a=u.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e){var t=[],n=gI(e),r=n.extractWeights,i=n.getRemainingWeights,o=hI(r,t),a=o(512,1,"fc/age"),s=o(512,2,"fc/gender");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=EI(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=mI(e,t);function r(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return lI(e,t),{params:i,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},t}(iI),BI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map(function(e){var n=e.width,r=e.height,i=t/Math.max(r,n);return{width:n*i,height:r*i}}),i=r.length;return vm(function(){var n=function(e,t){return Lg([Km([68],e),Km([68],t)],1).as2D(1,136).as1D()},o=function(e,t){var n=r[e],i=n.width,o=n.height;return t(i,o)?Math.abs(i-o)/2:0},a=e.mul(Km([i,136],t)).sub(Lg(Array.from(Array(i),function(e,t){return n(function(e){return o(e,function(e,t){return e<t})}(t),function(e){return o(e,function(e,t){return t<e})}(t))}))).div(Lg(Array.from(Array(i),function(e,t){return n(r[t].width,r[t].height)})));return a})},t.prototype.forwardInput=function(e){var t=this;return vm(function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map(function(e){return{height:e[0],width:e[1]}}))})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.detectLandmarks=function(e){return Qk(this,void 0,void 0,function(){var t,n,r,i=this;return $k(this,function(o){switch(o.label){case 0:return[4,$C(e)];case 1:return t=o.sent(),n=vm(function(){return Ug(i.forwardInput(t))}),[4,Promise.all(n.map(function(e,n){return Qk(i,void 0,void 0,function(){var r,i,o,a,s;return $k(this,function(u){switch(u.label){case 0:return o=(i=Array).from,[4,e.data()];case 1:return r=o.apply(i,[u.sent()]),a=r.filter(function(e,t){return rC(t)}),s=r.filter(function(e,t){return!rC(t)}),[2,new _C(Array(68).fill(0).map(function(e,t){return new cC(a[t],s[t])}),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}})})}))];case 2:return r=o.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(_I),zI=function(e){function t(t){return void 0===t&&(t=new xI),e.call(this,"FaceLandmark68Net",t)||this}return Xk(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(BI);var UI=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return vm(function(){var n=aI(vC(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(zm(255)),t.dense0,!0);return n=aI(n,t.dense1),n=aI(n,t.dense2),n=GE(n,[14,14],[2,2],"valid")})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=bI(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return lI(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=gI(e),r=n.extractWeights,i=n.getRemainingWeights,o=vI(r,t).extractDenseBlock3Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}(e)},t}(iI),VI=function(e){function t(t){return void 0===t&&(t=new UI),e.call(this,"FaceLandmark68TinyNet",t)||this}return Xk(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(BI);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xk(t,e)}(zI);function WI(e,t,n,r,i){void 0===i&&(i="same");var o=t.conv,a=o.filters,s=o.bias,u=kE(e,a,n,i);return u=function(e,t){return Lw(Zw(e,t.weights),t.biases)}(u=Lw(u,s),t.scale),r?g_(u):u}function HI(e,t){return WI(e,t,[1,1],!1)}function qI(e,t){return WI(e,t,[2,2],!0,"valid")}function GI(e,t){function n(n,r,i,o){var a=function(t,n,r){var i=e(t),o=i.length/(n*r*r);if(o%1!==0)throw new Error("depth has to be an integer: "+o+", weights.length: "+i.length+", numFilters: "+n+", filterSize: "+r);return vm(function(){return b_(Hm(i,[n,o,r,r]),[2,3,1,0])})}(n,r,i),s=Um(e(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:a,bias:s}}function r(r,i,o,a){var s=n(r,i,o,a+"/conv"),u=function(n,r){var i=Um(e(n)),o=Um(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:i,biases:o}}(i,a+"/scale");return{conv:s,scale:u}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,i,o){return void 0===o&&(o=!1),{conv1:r((o?.5:1)*e,t,n,i+"/conv1"),conv2:r(e,t,n,i+"/conv2")}}}}function KI(e,t){var n=mI(e,t);function r(e){var t=n(e+"/conv/filters",4),r=n(e+"/conv/bias",1),i=function(e){return{weights:n(e+"/scale/weights",1),biases:n(e+"/scale/biases",1)}}(e);return{conv:{filters:t,bias:r},scale:i}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(e+"/conv1"),conv2:r(e+"/conv2")}}}}function XI(e){var t=[],n=KI(e,t),r=n.extractConvLayerParams,i=n.extractResidualLayerParams,o=r("conv32_down"),a=i("conv32_1"),s=i("conv32_2"),u=i("conv32_3"),l=i("conv64_down"),c=i("conv64_1"),h=i("conv64_2"),d=i("conv64_3"),f=i("conv128_down"),p=i("conv128_1"),m=i("conv128_2"),g=i("conv256_down"),v=i("conv256_1"),y=i("conv256_2"),b=i("conv256_down_out"),x=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!eC(x,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var w={conv32_down:o,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:h,conv64_3:d,conv128_down:f,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:x};return lI(e,t),{params:w,paramMappings:t}}function YI(e,t){var n=function(e,t){return WI(e,t,[1,1],!0)}(e,t.conv1);return n=HI(n,t.conv2),n=Lw(n,e),n=g_(n)}function QI(e,t){var n=qI(e,t.conv1);n=HI(n,t.conv2);var r=GE(e,2,2,"valid"),i=Gm(r.shape),o=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=Zk(n.shape);a[1]=1;var s=Gm(a),u=Zk((n=$m([n,s],1)).shape);u[2]=1;var l=Gm(u);n=$m([n,l],2)}return r=o?$m([r,i],3):r,n=Lw(r,n),n=g_(n)}var $I=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return vm(function(){var n=qI(vC(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(zm(256)),t.conv32_down);n=YI(n=qE(n,3,2,"valid"),t.conv32_1),n=YI(n,t.conv32_2),n=YI(n,t.conv32_3),n=YI(n=QI(n,t.conv64_down),t.conv64_1),n=YI(n,t.conv64_2),n=YI(n,t.conv64_3),n=YI(n=QI(n,t.conv128_down),t.conv128_1),n=YI(n,t.conv128_2),n=YI(n=QI(n,t.conv256_down),t.conv256_1);var r=(n=QI(n=YI(n,t.conv256_2),t.conv256_down_out)).mean([1,2]);return ME(r,t.fc)})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return Qk(this,void 0,void 0,function(){var t,n,r,i=this;return $k(this,function(o){switch(o.label){case 0:return[4,$C(e)];case 1:return t=o.sent(),n=vm(function(){return Ug(i.forwardInput(t))}),[4,Promise.all(n.map(function(e){return e.data()}))];case 2:return r=o.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return XI(e)},t.prototype.extractParams=function(e){return function(e){var t=gI(e),n=t.extractWeights,r=t.getRemainingWeights,i=[],o=GI(n,i),a=o.extractConvLayerParams,s=o.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),f=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),E=s(589824,256,3,"conv256_down_out"),_=vm(function(){return b_(Vm(n(32768),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:h,conv64_down:d,conv64_1:f,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:x,conv256_2:w,conv256_down_out:E,fc:_},paramMappings:i}}(e)},t}(iI);function ZI(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var JI=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,i=t.maxNumScales,o=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(e){return"number"!==typeof e}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function eT(e,t){function n(n,r,i,o,a){var s=Hm(e(n*r*i*i),[i,i,n,r]),u=Um(e(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:u}}function r(e,t,r,i){var o=n(e,t,r,i,!0);return{filters:o.filters,batch_norm_offset:o.bias}}function i(n,i,o){var a=function(n,r){var i=Hm(e(9*n),[3,3,n,1]),o=Um(e(n)),a=Um(e(n)),s=Um(e(n)),u=Um(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:i,batch_norm_scale:o,batch_norm_offset:a,batch_norm_mean:s,batch_norm_variance:u}}(n,o+"/depthwise_conv");return{depthwise_conv:a,pointwise_conv:r(n,i,1,o+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function tT(e){var t=[],n=function(e,t){var n=mI(e,t);function r(e,t,r){return{filters:n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function i(e){var t="mobilenetv1/conv_"+e,i="MobilenetV1/Conv2d_"+e+"_depthwise",o=t+"/depthwise_conv",a=t+"/pointwise_conv";return{depthwise_conv:{filters:n(i+"/depthwise_weights",4,o+"/filters"),batch_norm_scale:n(i+"/BatchNorm/gamma",1,o+"/batch_norm_scale"),batch_norm_offset:n(i+"/BatchNorm/beta",1,o+"/batch_norm_offset"),batch_norm_mean:n(i+"/BatchNorm/moving_mean",1,o+"/batch_norm_mean"),batch_norm_variance:n(i+"/BatchNorm/moving_variance",1,o+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",e,a)}}function o(e,t){return{filters:n(e+"/weights",4,t+"/filters"),bias:n(e+"/biases",1,t+"/bias")}}function a(e){return{box_encoding_predictor:o("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),class_predictor:o("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(e,t),r=n.extractMobilenetV1Params,i=n.extractPredictionLayerParams,o=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!tC(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var a={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return lI(e,t),{params:a,paramMappings:t}}function nT(e,t,n){return vm(function(){var r=kE(e,t.filters,n,"same");return r=Lw(r,t.batch_norm_offset),Gx(r,0,6)})}function rT(e,t){return vm(function(){var n=null,r=nT(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(function(e,t){var i=t+1,o=function(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}(i);r=function(e,t,n){return vm(function(){var r=AE(e,t.filters,n,"same");return r=Tw(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),Gx(r,0,6)})}(r,e.depthwise_conv,o),r=nT(r,e.pointwise_conv,[1,1]),11===i&&(n=r)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function iT(e,t,n){var r=e.arraySync(),i=Math.min(r[t][0],r[t][2]),o=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),d=(a-i)*(s-o),f=(c-u)*(h-l);if(d<=0||f<=0)return 0;var p=Math.max(i,u),m=Math.max(o,l),g=Math.min(a,c),v=Math.min(s,h),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(d+f-y)}function oT(e,t){var n=function(e){var t=Ug(b_(e,[1,0])),n=[rE(t[2],t[0]),rE(t[3],t[1])];return{sizes:n,centers:[Lw(t[0],Vw(n[0],zm(2))),Lw(t[1],Vw(n[1],zm(2)))]}}(e),r=n.sizes,i=n.centers,o=Ug(b_(t,[1,0])),a=Vw(Zw(Qx(Vw(o[2],zm(5))),r[0]),zm(2)),s=Lw(Zw(Vw(o[0],zm(10)),r[0]),i[0]),u=Vw(Zw(Qx(Vw(o[3],zm(5))),r[1]),zm(2)),l=Lw(Zw(Vw(o[1],zm(10)),r[1]),i[1]);return b_(Lg([rE(s,a),rE(l,u),Lw(s,a),Lw(l,u)]),[1,0])}function aT(e,t){return vm(function(){var n=e.shape[0];return{boxPredictionEncoding:Mg(uI(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:Mg(uI(e,t.class_predictor),[n,-1,3])}})}var sT=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),uT=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return Xk(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return vm(function(){var n=e.toBatchTensor(512,!1).toFloat(),r=rT(rE(Zw(n,zm(.007843137718737125)),zm(1)),t.mobilenetv1),i=function(e,t,n){return vm(function(){var r=nT(e,n.conv_0,[1,1]),i=nT(r,n.conv_1,[2,2]),o=nT(i,n.conv_2,[1,1]),a=nT(o,n.conv_3,[2,2]),s=nT(a,n.conv_4,[1,1]),u=nT(s,n.conv_5,[2,2]),l=nT(u,n.conv_6,[1,1]),c=nT(l,n.conv_7,[2,2]),h=aT(t,n.box_predictor_0),d=aT(e,n.box_predictor_1),f=aT(i,n.box_predictor_2),p=aT(a,n.box_predictor_3),m=aT(u,n.box_predictor_4),g=aT(c,n.box_predictor_5);return{boxPredictions:$m([h.boxPredictionEncoding,d.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:$m([h.classPrediction,d.classPrediction,f.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1)}})}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return vm(function(){var r=e.shape[0],i=oT(Mg(Bg(n.extra_dim,[r,1,1]),[-1,4]),Mg(e,[-1,4]));i=Mg(i,[r,i.shape[0]/r,4]);var o=aw(QE(t,[0,0,1],[-1,-1,-1])),a=QE(o,[0,0,0],[-1,-1,1]);return a=Mg(a,[r,a.shape[1]]),{boxes:Ug(i),scores:Ug(a)}})}(i.boxPredictions,i.classPredictions,t.output_layer)})},t.prototype.forward=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$C(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),Qk(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c,h,d,f,p,m,g,v,y,b,x,w;return $k(this,function(E){switch(E.label){case 0:return n=new sT(t),r=n.maxResults,i=n.minConfidence,[4,$C(e)];case 1:for(o=E.sent(),a=this.forwardInput(o),s=a.boxes,u=a.scores,l=s[0],c=u[0],h=1;h<s.length;h++)s[h].dispose(),u[h].dispose();return p=(f=Array).from,[4,c.data()];case 2:return d=p.apply(f,[E.sent()]),m=function(e,t,n,r,i){var o=e.shape[0],a=Math.min(n,o),s=t.map(function(e,t){return{score:e,boxIndex:t}}).filter(function(e){return e.score>i}).sort(function(e,t){return t.score-e.score}),u=function(e){return e<=r?1:0},l=[];return s.forEach(function(t){if(!(l.length>=a)){for(var n=t.score,r=l.length-1;r>=0;--r){var o=iT(e,t.boxIndex,l[r]);if(0!==o&&(t.score*=u(o),t.score<=i))break}n===t.score&&l.push(t.boxIndex)}}),l}(l,d,r,.5,i),g=o.getReshapedInputDimensions(0),v=o.inputSize,y=v/g.width,b=v/g.height,x=l.arraySync(),w=m.map(function(e){var t=[Math.max(0,x[e][0]),Math.min(1,x[e][2])].map(function(e){return e*b}),n=t[0],r=t[1],i=[Math.max(0,x[e][1]),Math.min(1,x[e][3])].map(function(e){return e*y}),a=i[0],s=i[1];return new pC(d[e],new xC(a,n,s-a,r-n),{height:o.getInputHeight(0),width:o.getInputWidth(0)})}),l.dispose(),c.dispose(),[2,w]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return tT(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=gI(e),r=n.extractWeights,i=n.getRemainingWeights,o=eT(r,t),a=o.extractMobilenetV1Params,s=o.extractPredictionLayerParams,u=a(),l=s(),c={extra_dim:Wm(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:c},paramMappings:t}}(e)},t}(iI);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xk(t,e)}(uT);var lT,cT=[new cC(.738768,.874946),new cC(2.42204,2.65704),new cC(4.30971,7.04493),new cC(10.246,4.59428),new cC(12.6868,11.8741)],hT=[new cC(1.603231,2.094468),new cC(6.041143,7.080126),new cC(2.882459,3.518061),new cC(4.266906,5.178857),new cC(9.041765,10.66308)],dT=[117.001,114.697,97.404],fT=function(e){return"number"===typeof e};function pT(e){return vm(function(){var t=Zw(e,zm(.10000000149011612));return Lw(g_(rE(e,t)),t)})}function mT(e,t){return vm(function(){var n=Cg(e,[[0,0],[1,1],[1,1],[0,0]]);return n=kE(n,t.conv.filters,[1,1],"valid"),n=rE(n,t.bn.sub),n=Zw(n,t.bn.truediv),pT(n=Lw(n,t.conv.bias))})}function gT(e,t){return vm(function(){var n=Cg(e,[[0,0],[1,1],[1,1],[0,0]]);return n=PE(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),pT(n=Lw(n,t.bias))})}function vT(e,t){var n=cI(e,t);var r=fI(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,i,o){var a=n(r,i,3,o+"/conv"),s=function(n,r){var i=Um(e(n)),o=Um(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:i,truediv:o}}(i,o+"/bn");return{conv:a,bn:s}},extractSeparableConvParams:r}}function yT(e,t){var n=mI(e,t);function r(e){return{filters:n(e+"/filters",4),bias:n(e+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){var t=r(e+"/conv"),i=function(e){return{sub:n(e+"/sub",1),truediv:n(e+"/truediv",1)}}(e+"/bn");return{conv:t,bn:i}},extractSeparableConvParams:pI(n)}}!function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"}(lT||(lT={}));var bT=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),xT=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return function(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!fT(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(e){return"string"===typeof e}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(e){return e||{}}).every(function(e){return fT(e.x)&&fT(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(fT)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),n._config=t,n}return Xk(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=mT(e,t.conv0);return n=mT(n=qE(n,[2,2],[2,2],"same"),t.conv1),n=mT(n=qE(n,[2,2],[2,2],"same"),t.conv2),n=mT(n=qE(n,[2,2],[2,2],"same"),t.conv3),n=mT(n=qE(n,[2,2],[2,2],"same"),t.conv4),n=mT(n=qE(n,[2,2],[2,2],"same"),t.conv5),n=mT(n=qE(n,[2,2],[1,1],"same"),t.conv6),uI(n=mT(n,t.conv7),t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?pT(uI(e,t.conv0,"valid",!1)):gT(e,t.conv0);return n=gT(n=qE(n,[2,2],[2,2],"same"),t.conv1),n=gT(n=qE(n,[2,2],[2,2],"same"),t.conv2),n=gT(n=qE(n,[2,2],[2,2],"same"),t.conv3),n=gT(n=qE(n,[2,2],[2,2],"same"),t.conv4),n=gT(n=qE(n,[2,2],[2,2],"same"),t.conv5),n=qE(n,[2,2],[1,1],"same"),n=t.conv6?gT(n,t.conv6):n,uI(n=t.conv7?gT(n,t.conv7):n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return vm(function(){var i=e.toBatchTensor(t,!1).toFloat();return i=(i=n.config.meanRgb?vC(i,n.config.meanRgb):i).div(zm(256)),n.config.withSeparableConvs?n.runMobilenet(i,r):n.runTinyYolov2(i,r)})},t.prototype.forward=function(e,t){return Qk(this,void 0,void 0,function(){var n;return $k(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$C(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}})})},t.prototype.detect=function(e,t){return void 0===t&&(t={}),Qk(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c,h,d,f,p,m=this;return $k(this,function(g){switch(g.label){case 0:return n=new bT(t),r=n.inputSize,i=n.scoreThreshold,[4,$C(e)];case 1:return o=g.sent(),[4,this.forwardInput(o,r)];case 2:return a=g.sent(),s=vm(function(){return Ug(a)[0].expandDims()}),u={width:o.getInputWidth(0),height:o.getInputHeight(0)},[4,this.extractBoxes(s,o.getReshapedInputDimensions(0),i)];case 3:return l=g.sent(),a.dispose(),s.dispose(),c=l.map(function(e){return e.box}),h=l.map(function(e){return e.score}),d=l.map(function(e){return e.classScore}),f=l.map(function(e){return m.config.classes[e.label]}),p=gC(c.map(function(e){return e.rescale(r)}),h,this.config.iouThreshold,!0),[2,p.map(function(e){return new fC(h[e],d[e],f[e],c[e],u)})]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function(e,t){var n,r=[],i=yT(e,r),o=i.extractConvParams,a=i.extractConvWithBatchNormParams,s=i.extractSeparableConvParams;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?o("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:o("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:o("conv8")};return lI(e,r),{params:n,paramMappings:r}}(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(e,t,n,r){var i,o=gI(e),a=o.extractWeights,s=o.getRemainingWeights,u=[],l=vT(a,u),c=l.extractConvParams,h=l.extractConvWithBatchNormParams,d=l.extractSeparableConvParams;if(t.withSeparableConvs){var f=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8];i={conv0:t.isFirstLayerConv2d?c(f,p,3,"conv0"):d(f,p,"conv0"),conv1:d(p,m,"conv1"),conv2:d(m,g,"conv2"),conv3:d(g,v,"conv3"),conv4:d(v,y,"conv4"),conv5:d(y,b,"conv5"),conv6:x?d(b,x,"conv6"):void 0,conv7:w?d(x,w,"conv7"):void 0,conv8:c(w||x||b,5*n,1,"conv8")}}else f=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8],i={conv0:h(f,p,"conv0"),conv1:h(p,m,"conv1"),conv2:h(m,g,"conv2"),conv3:h(g,v,"conv3"),conv4:h(v,y,"conv4"),conv5:h(y,b,"conv5"),conv6:h(b,x,"conv6"),conv7:h(x,w,"conv7"),conv8:c(w,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:i,paramMappings:u}}(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return Qk(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,p,m,g,v,y,b,x,w,E,_,S,k,C,I,T,A,O,N,P=this;return $k(this,function(D){switch(D.label){case 0:return r=t.width,i=t.height,o=Math.max(r,i),a=o/r,s=o/i,u=e.shape[1],l=this.config.anchors.length,c=vm(function(){var t=e.reshape([u,u,l,P.boxEncodingSize]);return[t.slice([0,0,0,0],[u,u,l,4]),t.slice([0,0,0,4],[u,u,l,1]),P.withClassScores?av(t.slice([0,0,0,5],[u,u,l,P.config.classes.length]),3):zm(0)]}),h=c[0],d=c[1],f=c[2],p=[],[4,d.array()];case 1:return m=D.sent(),[4,h.array()];case 2:g=D.sent(),v=0,D.label=3;case 3:if(!(v<u))return[3,12];y=0,D.label=4;case 4:if(!(y<u))return[3,11];b=0,D.label=5;case 5:return b<l?(x=yC(m[v][y][b][0]),!n||x>n?(w=(y+yC(g[v][y][b][0]))/u*a,E=(v+yC(g[v][y][b][1]))/u*s,_=Math.exp(g[v][y][b][2])*this.config.anchors[b].x/u*a,S=Math.exp(g[v][y][b][3])*this.config.anchors[b].y/u*s,k=w-_/2,C=E-S/2,I={row:v,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(f,I)]:[3,7]):[3,9]):[3,10];case 6:return N=D.sent(),[3,8];case 7:N={classScore:1,label:0},D.label=8;case 8:A=(T=N).classScore,O=T.label,p.push(Yk({box:new dC(k,C,k+_,C+S),score:x,classScore:x*A,label:O},I)),D.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return v++,[3,3];case 12:return h.dispose(),d.dispose(),f.dispose(),[2,p]}})})},t.prototype.extractPredictedClass=function(e,t){return Qk(this,void 0,void 0,function(){var n,r,i,o;return $k(this,function(a){switch(a.label){case 0:return n=t.row,r=t.col,i=t.anchor,[4,e.array()];case 1:return o=a.sent(),[2,Array(this.config.classes.length).fill(0).map(function(e,t){return o[n][r][i][t]}).map(function(e,t){return{classScore:e,label:t}}).reduce(function(e,t){return e.classScore>t.classScore?e:t})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(iI),wT=function(e){function t(t){void 0===t&&(t=!0);var n=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:hT,meanRgb:dT}:{anchors:cT,withClassScores:!0});return e.call(this,n)||this}return Xk(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return Qk(this,void 0,void 0,function(){return $k(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new pC(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(xT);var ET=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return Xk(t,e),t}(bT),_T=function(){function e(){}return e.prototype.then=function(e){return Qk(this,void 0,void 0,function(){var t;return $k(this,function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}})})},e.prototype.run=function(){return Qk(this,void 0,void 0,function(){return $k(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},e}();function ST(e,t){var n={descriptor:t};return Object.assign({},e,n)}function kT(e,t,n,r,i){return void 0===i&&(i=function(e){return e.alignedRect}),Qk(this,void 0,void 0,function(){var o,a,s,u,l;return $k(this,function(c){switch(c.label){case 0:return o=e.map(function(e){return TI(e)?i(e):e.detection}),(s=r)?[3,5]:t instanceof Yf?[4,JC(t,o)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,ZC(t,o)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return[4,n(a=s)];case 6:return l=c.sent(),a.forEach(function(e){return e instanceof Yf&&e.dispose()}),[2,l]}})})}function CT(e,t,n,r,i){return Qk(this,void 0,void 0,function(){var o=this;return $k(this,function(a){return[2,kT([e],t,function(e){return Qk(o,void 0,void 0,function(){return $k(this,function(t){return[2,n(e[0])]})})},r,i)]})})}function IT(e){var t=gI(e),n=t.extractWeights,r=t.getRemainingWeights,i=[],o=function(e,t){var n=cI(e,t),r=hI(e,t);function i(n,r){var i=Um(e(n));return t.push({paramPath:r}),i}function o(e,t,r){return void 0===r&&(r=!1),{conv1:n(e[0],e[1],3,t+"/conv1"),prelu1_alpha:i(e[1],t+"/prelu1_alpha"),conv2:n(e[1],e[2],3,t+"/conv2"),prelu2_alpha:i(e[2],t+"/prelu2_alpha"),conv3:n(e[2],e[3],r?2:3,t+"/conv3"),prelu3_alpha:i(e[3],t+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=o([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return Yk(Yk({},e),{conv4_1:t,conv4_2:r})},extractRNetParams:function(){var e=o([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=i(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return Yk(Yk({},e),{fc1:t,prelu4_alpha:n,fc2_1:a,fc2_2:s})},extractONetParams:function(){var e=o([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),a=i(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),u=i(256,"onet/prelu5_alpha"),l=r(256,2,"onet/fc2_1"),c=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return Yk(Yk({},e),{conv4:t,prelu4_alpha:a,fc1:s,prelu5_alpha:u,fc2_1:l,fc2_2:c,fc2_3:h})}}}(n,i),a=o.extractPNetParams,s=o.extractRNetParams,u=o.extractONetParams,l=a(),c=s(),h=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:h},paramMappings:i}}function TT(e){var t=[],n=function(e,t){var n=mI(e,t);function r(e){return{filters:n(e+"/weights",4,e+"/filters"),bias:n(e+"/bias",1)}}function i(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}function o(e){return n(e,1)}function a(e){return{conv1:r(e+"/conv1"),prelu1_alpha:o(e+"/prelu1_alpha"),conv2:r(e+"/conv2"),prelu2_alpha:o(e+"/prelu2_alpha"),conv3:r(e+"/conv3"),prelu3_alpha:o(e+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=a("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return Yk(Yk({},e),{conv4_1:t,conv4_2:n})},extractRNetParams:function(){var e=a("rnet"),t=i("rnet/fc1"),n=o("rnet/prelu4_alpha"),r=i("rnet/fc2_1"),s=i("rnet/fc2_2");return Yk(Yk({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})},extractONetParams:function(){var e=a("onet"),t=r("onet/conv4"),n=o("onet/prelu4_alpha"),s=i("onet/fc1"),u=o("onet/prelu5_alpha"),l=i("onet/fc2_1"),c=i("onet/fc2_2"),h=i("onet/fc2_3");return Yk(Yk({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:u,fc2_1:l,fc2_2:c,fc2_3:h})}}}(e,t),r=n.extractPNetParams,i=n.extractRNetParams,o=n.extractONetParams,a=r(),s=i(),u=o();return lI(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function AT(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}var OT=function(e){function t(t,n,r,i){return e.call(this,{left:t,top:n,right:r,bottom:i},!0)||this}return Xk(t,e),t}(hC);function NT(e){return vm(function(){return Zw(rE(e,zm(127.5)),zm(.0078125))})}function PT(e,t){return vm(function(){return Lw(g_(e),Zw(t,nw(g_(nw(e)))))})}function DT(e,t,n){return void 0===n&&(n=!1),vm(function(){var r=uI(e,t.conv1,"valid");return r=PT(r,t.prelu1_alpha),r=PT(r=uI(r=qE(r,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),r=PT(r=uI(r=n?r:qE(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)})}function RT(e,t,n,r,i){i.stage1=[];var o=t.map(function(t){return vm(function(){var n={scale:t},i=function(e,t){return vm(function(){var n=AT(t,e.shape.slice(1)),r=n.height,i=n.width,o=NT(hS.resizeBilinear(e,[r,i]));return b_(o,[0,2,1,3])})}(e,t),o=Date.now(),a=function(e,t){return vm(function(){var n=DT(e,t,!0),r=uI(n,t.conv4_1,"valid"),i=Eg(s_(r,3),3);return{prob:av(rE(r,i),3),regions:uI(n,t.conv4_2,"valid")}})}(i,r),s=a.prob,u=a.regions;return n.pnet=Date.now()-o,{scoresTensor:Ug(Ug(s,3)[1])[0],regionsTensor:Ug(u)[0],scale:t,statsForScale:n}})}),a=o.map(function(e){var t=e.scoresTensor,r=e.regionsTensor,o=e.scale,a=e.statsForScale,s=function(e,t,n,r){for(var i=[],o=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)o[a][s]>=r&&i.push(new cC(s,a));return i.map(function(e){var r=new dC(Math.round((2*e.y+1)/n),Math.round((2*e.x+1)/n),Math.round((2*e.y+12)/n),Math.round((2*e.x+12)/n)),i=o[e.y][e.x],a=t.arraySync();return{cell:r,score:i,region:new OT(a[e.y][e.x][0],a[e.y][e.x][1],a[e.y][e.x][2],a[e.y][e.x][3])}})}(t,r,o,n);if(t.dispose(),r.dispose(),!s.length)return i.stage1.push(a),[];var u=Date.now(),l=gC(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.5);return a.nms=Date.now()-u,a.numBoxes=l.length,i.stage1.push(a),l.map(function(e){return s[e]})}),s=a.reduce(function(e,t){return e.concat(t)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),h=gC(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.7);i.stage1_nms=Date.now()-c,l=h.map(function(e){return s[e].score}),u=h.map(function(e){return s[e]}).map(function(e){var t=e.cell,n=e.region;return new dC(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()})}return{boxes:u,scores:l}}function MT(e,t,n){var r=n.width,i=n.height;return Qk(this,void 0,void 0,function(){var n,o,a,s=this;return $k(this,function(u){switch(u.label){case 0:return n=BC(e),[4,Promise.all(t.map(function(t){return Qk(s,void 0,void 0,function(){var r,i,o,a,s,u,l,c;return $k(this,function(h){return r=t.padAtBorders(e.height,e.width),i=r.y,o=r.ey,a=r.x,s=r.ex,u=a-1,l=i-1,c=n.getImageData(u,l,s-u,o-l),[2,FC.isNodejs()?KC(c):createImageBitmap(c)]})})}))];case 1:return o=u.sent(),a=[],o.forEach(function(e){var t=BC(GC({width:r,height:i}));t.drawImage(e,0,0,r,i);for(var n=t.getImageData(0,0,r,i).data,o=[],s=0;s<n.length;s+=4)o.push(n[s+2]),o.push(n[s+1]),o.push(n[s]);a.push(o)}),[2,a.map(function(e){return vm(function(){return NT(b_(Hm(e,[1,r,i,3]),[0,2,1,3]).toFloat())})})]}})})}function jT(e,t,n,r,i){return Qk(this,void 0,void 0,function(){var o,a,s,u,l,c,h,d,f,p,m,g,v,y;return $k(this,function(b){switch(b.label){case 0:return o=Date.now(),[4,MT(e,t,{width:24,height:24})];case 1:return a=b.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),s=a.map(function(e){var t=function(e,t){return vm(function(){var n=DT(e,t),r=PT(wI(Mg(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),i=wI(r,t.fc2_1),o=Eg(s_(i,1),1),a=av(rE(i,o),1),s=wI(r,t.fc2_2);return{scores:Ug(a,1)[1],regions:s}})}(e,r);return e.dispose(),t}),i.stage2_rnet=Date.now()-o,u=s.length>1?$m(s.map(function(e){return e.scores})):s[0].scores,h=(c=Array).from,[4,u.data()];case 2:return l=h.apply(c,[b.sent()]),u.dispose(),d=l.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=d.map(function(e){return t[e]}),p=d.map(function(e){return l[e]}),m=[],g=[],f.length>0&&(o=Date.now(),v=gC(f,p,.7),i.stage2_nms=Date.now()-o,y=v.map(function(e){var t=s[d[e]].regions.arraySync();return new OT(t[0][0],t[0][1],t[0][2],t[0][3])}),g=v.map(function(e){return p[e]}),m=v.map(function(e,t){return f[e].calibrate(y[t])})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function FT(e,t,n,r,i){return Qk(this,void 0,void 0,function(){var o,a,s,u,l,c,h,d,f,p,m,g,v,y,b;return $k(this,function(x){switch(x.label){case 0:return o=Date.now(),[4,MT(e,t,{width:48,height:48})];case 1:return a=x.sent(),i.stage3_extractImagePatches=Date.now()-o,o=Date.now(),s=a.map(function(e){var t=function(e,t){return vm(function(){var n=DT(e,t);n=PT(n=uI(n=qE(n,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var r=PT(wI(Mg(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),i=wI(r,t.fc2_1),o=Eg(s_(i,1),1),a=av(rE(i,o),1),s=wI(r,t.fc2_2),u=wI(r,t.fc2_3);return{scores:Ug(a,1)[1],regions:s,points:u}})}(e,r);return e.dispose(),t}),i.stage3_onet=Date.now()-o,u=s.length>1?$m(s.map(function(e){return e.scores})):s[0].scores,h=(c=Array).from,[4,u.data()];case 2:return l=h.apply(c,[x.sent()]),u.dispose(),d=l.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=d.map(function(e){var t=s[e].regions.arraySync();return new OT(t[0][0],t[0][1],t[0][2],t[0][3])}),p=d.map(function(e,n){return t[e].calibrate(f[n])}),m=d.map(function(e){return l[e]}),g=[],v=[],y=[],p.length>0&&(o=Date.now(),b=gC(p,m,.7,!1),i.stage3_nms=Date.now()-o,g=b.map(function(e){return p[e]}),v=b.map(function(e){return m[e]}),y=b.map(function(e,t){return Array(5).fill(0).map(function(n,r){var i=s[e].points.arraySync();return new cC(i[0][r]*(g[t].width+1)+g[t].left,i[0][r+5]*(g[t].height+1)+g[t].top)})})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var LT=function(e){function t(){return e.call(this,"Mtcnn")||this}return Xk(t,e),t.prototype.load=function(t){return Qk(this,void 0,void 0,function(){return $k(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]})})},t.prototype.loadFromDisk=function(t){return Qk(this,void 0,void 0,function(){return $k(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]})})},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),Qk(this,void 0,void 0,function(){var n,r,i,o,a,s,u,l,c,h,d,f,p,m,g,v,y,b,x,w,E;return $k(this,function(_){switch(_.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return i={},o=Date.now(),a=vm(function(){return e=Eg(Ok.fromPixels(r)).toFloat(),vm(function(){return Lg(Ug(e,3).reverse(),3)});var e}),s=function(e){return a.dispose(),i.total=Date.now()-o,e},u=a.shape.slice(1),l=u[0],c=u[1],h=new JI(t),d=h.minFaceSize,f=h.scaleFactor,p=h.maxNumScales,m=h.scoreThresholds,g=h.scaleSteps,v=(g||function(e,t,n){for(var r=n[0],i=n[1],o=12/e,a=[],s=Math.min(r,i)*o,u=0;s>=12;)a.push(o*Math.pow(t,u)),s*=t,u+=1;return a}(d,f,[l,c])).filter(function(e){var t=AT(e,[l,c]);return Math.min(t.width,t.height)>12}).slice(0,p),i.scales=v,i.pyramid=v.map(function(e){return AT(e,[l,c])}),y=Date.now(),[4,RT(a,v,m[0],n.pnet,i)];case 1:return b=_.sent(),i.total_stage1=Date.now()-y,b.boxes.length?(i.stage2_numInputBoxes=b.boxes.length,y=Date.now(),[4,jT(r,b.boxes,m[1],n.rnet,i)]):[2,s({results:[],stats:i})];case 2:return x=_.sent(),i.total_stage2=Date.now()-y,x.boxes.length?(i.stage3_numInputBoxes=x.boxes.length,y=Date.now(),[4,FT(r,x.boxes,m[2],n.onet,i)]):[2,s({results:[],stats:i})];case 3:return w=_.sent(),i.total_stage3=Date.now()-y,E=w.boxes.map(function(e,t){return AI(TC({},new pC(w.scores[t],new xC(e.left/c,e.top/l,e.width/c,e.height/l),{height:l,width:c})),new EC(w.points[t].map(function(t){return t.sub(new cC(e.left,e.top)).div(new cC(e.width,e.height))}),{width:e.width,height:e.height}))}),[2,s({results:E,stats:i})]}})})},t.prototype.forward=function(e,t){return void 0===t&&(t={}),Qk(this,void 0,void 0,function(){var n;return $k(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$C(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}})})},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),Qk(this,void 0,void 0,function(){var n;return $k(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$C(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return TT(e)},t.prototype.extractParams=function(e){return IT(e)},t}(iI),BT=[new cC(1.603231,2.094468),new cC(6.041143,7.080126),new cC(2.882459,3.518061),new cC(4.266906,5.178857),new cC(9.041765,10.66308)],zT=[117.001,114.697,97.404],UT=function(e){function t(){var t={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:BT,meanRgb:zT,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e.call(this,t)||this}return Xk(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return Qk(this,void 0,void 0,function(){return $k(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new pC(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(xT),VT={ssdMobilenetv1:new uT,tinyFaceDetector:new UT,tinyYolov2:new wT,mtcnn:new LT,faceLandmark68Net:new zI,faceLandmark68TinyNet:new VI,faceRecognitionNet:new $I,faceExpressionNet:new CI,ageGenderNet:new LI};function WT(e,t){var n={age:t};return Object.assign({},e,n)}var HT=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parentTask=t,i.input=n,i.extractedFaces=r,i}return Xk(t,e),t}(_T),qT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n=this;return $k(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,kT(e=r.sent(),this.input,function(e){return Qk(n,void 0,void 0,function(){return $k(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return VT.faceExpressionNet.predictExpressions(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){return II(e,t[n])})]}})})},t.prototype.withAgeAndGender=function(){return new QT(this,this.input)},t}(HT),GT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t;return $k(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,CT(e,this.input,function(e){return VT.faceExpressionNet.predictExpressions(e)},this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,II(e,t)]}})})},t.prototype.withAgeAndGender=function(){return new $T(this,this.input)},t}(HT),KT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.withAgeAndGender=function(){return new ZT(this,this.input)},t.prototype.withFaceDescriptors=function(){return new tA(this,this.input)},t}(qT),XT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.withAgeAndGender=function(){return new JT(this,this.input)},t.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},t}(GT),YT=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parentTask=t,i.input=n,i.extractedFaces=r,i}return Xk(t,e),t}(_T),QT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n=this;return $k(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,kT(e=r.sent(),this.input,function(e){return Qk(n,void 0,void 0,function(){return $k(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return VT.ageGenderNet.predictAgeAndGender(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){var r=t[n],i=r.age;return WT(ZI(e,r.gender,r.genderProbability),i)})]}})})},t.prototype.withFaceExpressions=function(){return new qT(this,this.input)},t}(YT),$T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n,r,i;return $k(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?[4,CT(e,this.input,function(e){return VT.ageGenderNet.predictAgeAndGender(e)},this.extractedFaces)]:[2];case 2:return t=o.sent(),n=t.age,r=t.gender,i=t.genderProbability,[2,WT(ZI(e,r,i),n)]}})})},t.prototype.withFaceExpressions=function(){return new GT(this,this.input)},t}(YT),ZT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.withFaceExpressions=function(){return new KT(this,this.input)},t.prototype.withFaceDescriptors=function(){return new tA(this,this.input)},t}(QT),JT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.withFaceExpressions=function(){return new XT(this,this.input)},t.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},t}($T),eA=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return Xk(t,e),t}(_T),tA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e;return $k(this,function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,kT(e=t.sent(),this.input,function(e){return Promise.all(e.map(function(e){return VT.faceRecognitionNet.computeFaceDescriptor(e)}))},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,t.sent().map(function(t,n){return ST(e[n],t)})]}})})},t.prototype.withFaceExpressions=function(){return new KT(this,this.input)},t.prototype.withAgeAndGender=function(){return new ZT(this,this.input)},t}(eA),nA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t;return $k(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,CT(e,this.input,function(e){return VT.faceRecognitionNet.computeFaceDescriptor(e)},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return t=n.sent(),[2,ST(e,t)]}})})},t.prototype.withFaceExpressions=function(){return new XT(this,this.input)},t.prototype.withAgeAndGender=function(){return new JT(this,this.input)},t}(eA),rA=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parentTask=t,i.input=n,i.useTinyLandmarkNet=r,i}return Xk(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?VT.faceLandmark68TinyNet:VT.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(_T),iA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n,r,i,o=this;return $k(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),t=e.map(function(e){return e.detection}),this.input instanceof Yf?[4,JC(this.input,t)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,ZC(this.input,t)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map(function(e){return o.landmarkNet.detectLandmarks(e)}))];case 6:return i=a.sent(),n.forEach(function(e){return e instanceof Yf&&e.dispose()}),[2,e.map(function(e,t){return AI(e,i[t])})]}})})},t.prototype.withFaceExpressions=function(){return new KT(this,this.input)},t.prototype.withAgeAndGender=function(){return new ZT(this,this.input)},t.prototype.withFaceDescriptors=function(){return new tA(this,this.input)},t}(rA),oA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n,r,i;return $k(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?(t=e.detection,this.input instanceof Yf?[4,JC(this.input,[t])]:[3,3]):[2];case 2:return r=o.sent(),[3,5];case 3:return[4,ZC(this.input,[t])];case 4:r=o.sent(),o.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return i=o.sent(),n.forEach(function(e){return e instanceof Yf&&e.dispose()}),[2,AI(e,i)]}})})},t.prototype.withFaceExpressions=function(){return new XT(this,this.input)},t.prototype.withAgeAndGender=function(){return new JT(this,this.input)},t.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},t}(rA),aA=function(e){function t(t,n){void 0===n&&(n=new sT);var r=e.call(this)||this;return r.input=t,r.options=n,r}return Xk(t,e),t}(_T),sA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t,n,r;return $k(this,function(i){switch(i.label){case 0:return t=(e=this).input,(n=e.options)instanceof JI?[4,VT.mtcnn.forward(t,n)]:[3,2];case 1:return[2,i.sent().map(function(e){return e.detection})];case 2:if(r=n instanceof ET?function(e){return VT.tinyFaceDetector.locateFaces(e,n)}:n instanceof sT?function(e){return VT.ssdMobilenetv1.locateFaces(e,n)}:n instanceof bT?function(e){return VT.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(t){return Qk(e,void 0,void 0,function(){var e;return $k(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map(function(e){return TC({},e)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new iA(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new qT(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new QT(this.runAndExtendWithFaceDetections(),this.input)},t}(aA);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xk(t,e),t.prototype.run=function(){return Qk(this,void 0,void 0,function(){var e,t;return $k(this,function(n){switch(n.label){case 0:return[4,new sA(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach(function(e){e.score>t.score&&(t=e)}),[2,t]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(t){return Qk(e,void 0,void 0,function(){var e;return $k(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?TC({},e):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new oA(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new GT(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new $T(this.runAndExtendWithFaceDetection(),this.input)}}(aA);!function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,i=function(){return"person "+r++};this._labeledDescriptors=n.map(function(e){if(e instanceof CC)return e;if(e instanceof Float32Array)return new CC(i(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new CC(i(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map(function(t){return function(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(e,t){return e-r[t]}).reduce(function(e,t){return e+Math.pow(t,2)},0))}(t,e)}).reduce(function(e,t){return e+t},0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(n){var r=n.descriptors,i=n.label;return new SC(i,t.computeMeanDistance(e,r))}).reduce(function(e,t){return e.distance<t.distance?e:t})},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new SC("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(e){return CC.fromJSON(e)});return new e(n,t.distanceThreshold)}}();function uA(e,t){var n=new Jk(t.width,t.height),r=n.width,i=n.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(e))return e.map(function(e){return uA(e,{width:r,height:i})});if(TI(e)){var o=e.detection.forSize(r,i),a=e.unshiftedLandmarks.forSize(o.box.width,o.box.height);return AI(TC(e,o),a)}return IC(e)?TC(e,e.detection.forSize(r,i)):e instanceof wC||e instanceof pC?e.forSize(r,i):e}const lA=p("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),cA=()=>(new Date).toISOString().split("T")[0],hA=e=>{const t=cA();console.log("\ud83d\udd22 Calculating stats..."),console.log("\ud83d\udcc5 Today:",t),console.log("\ud83d\udcca Total sessions:",e.length);const n=new Set,r=new Map;e.forEach(e=>{e.userId&&(n.add(e.userId),r.has(e.userId)||r.set(e.userId,e))});const i=new Set;e.filter(e=>e.date===t).forEach(e=>{e.userId&&i.add(e.userId)});const o=n.size,a=i.size;console.log("\ud83d\udc65 Total unique users:",o),console.log("\ud83d\udd25 Today unique users:",a);const s={};r.forEach(e=>{const t=e.gender||"unknown";s[t]=(s[t]||0)+1});const u={};r.forEach(e=>{if(e.age){const t="".concat(10*Math.floor(e.age/10),"-").concat(10*Math.floor(e.age/10)+9);u[t]=(u[t]||0)+1}});const l={};e.filter(e=>e.date===t).forEach(e=>{if(e.sessionStart){const t=e.sessionStart.getHours();l[t]=(l[t]||0)+1}});const c={};return r.forEach(e=>{c[e.deviceType]=(c[e.deviceType]||0)+1}),{totalUsers:o,todayUsers:a,genderDistribution:s,ageDistribution:u,hourlyActivity:l,deviceTypes:c}},dA=e=>{let{onClose:n,onAnalysisComplete:r,language:i}=e;const o=(0,t.useRef)(null),a=(0,t.useRef)(null),[s,u]=(0,t.useState)(!0),[l,c]=(0,t.useState)(!1),[h,d]=(0,t.useState)(!0),f=(0,t.useRef)(null),p=(0,t.useRef)(!1);(0,t.useEffect)(()=>{(async()=>{try{const e="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model";await Promise.all([VT.tinyFaceDetector.loadFromUri(e),VT.ageGenderNet.loadFromUri(e),VT.faceLandmark68Net.loadFromUri(e)]),c(!0),console.log("\u2705 Face-API models loaded")}catch(e){console.error("Error loading models:",e)}})()},[]),(0,t.useEffect)(()=>{if(!l)return;return(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:"user"}});o.current&&(o.current.srcObject=e,o.current.onloadedmetadata=()=>{u(!1)})}catch(e){console.error("Error accessing webcam:",e),u(!1)}})(),()=>{var e;null!==(e=o.current)&&void 0!==e&&e.srcObject&&o.current.srcObject.getTracks().forEach(e=>e.stop())}},[l]),(0,t.useEffect)(()=>{if(!l||s)return;const e=setInterval(async()=>{var e,t,n,i;if(!p.current&&(o.current&&4===o.current.readyState)){const l=o.current,c=a.current;if(c){!function(e,t,n){void 0===n&&(n=!1);var r=n?qC(t):t,i=r.width,o=r.height;e.width=i,e.height=o}(c,{width:l.videoWidth,height:l.videoHeight})}try{const o=await(n=l,i=new ET,void 0===i&&(i=new sT),new sA(n,i)).withFaceLandmarks().withAgeAndGender();if(c){c.getContext("2d").clearRect(0,0,c.width,c.height);const n=uA(o,{width:l.videoWidth,height:l.videoHeight});!function(e,t){(Array.isArray(t)?t:[t]).forEach(function(t){var n=t instanceof pC?t.score:IC(t)?t.detection.score:void 0,r=t instanceof pC?t.box:IC(t)?t.detection.box:new hC(t),i=n?""+iC(n):void 0;new WC(r,{label:i}).draw(e)})}(c,n),e=c,t=n,(Array.isArray(t)?t:[t]).forEach(function(t){var n=t instanceof wC?t:TI(t)?t.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new NI(n).draw(e)})}if(o&&o.length>0&&h&&!p.current){const e=o[0],{age:t,gender:n,genderProbability:i}=e;if(i>.7){p.current=!0,d(!1);const e={gender:n,age:Math.round(t),confidence:i};console.log("\ud83d\udc64 Face detected:",e);try{await(async e=>{try{var t;const n="user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),r=cA();console.log("\ud83d\udcbe Saving new session:",{userId:n,date:r});const i={userId:n,gender:e.gender||null,age:e.age?parseInt(e.age):null,sessionStart:nn.now(),date:r,deviceType:/Mobile|Android|iPhone/i.test(navigator.userAgent)?"mobile":"desktop",browser:navigator.userAgent};await ql(qu(Dd,"user_sessions"),i),localStorage.setItem("userId",n),localStorage.setItem("userGender",e.gender||"unknown"),localStorage.setItem("userAge",(null===(t=e.age)||void 0===t?void 0:t.toString())||"0"),localStorage.setItem("lastSessionDate",r),console.log("\u2705 Session tracked:",i)}catch(n){console.error("\u274c Error tracking session:",n)}})({gender:n,age:Math.round(t)}),console.log("\u2705 Face data saved to Analytics")}catch(s){console.error("\u274c Error saving face data:",s)}setTimeout(()=>{r(e)},1e3)}}}catch(u){console.error("Detection error:",u)}}},500);return f.current=setTimeout(()=>{h&&n()},1e4),()=>{clearInterval(e),f.current&&clearTimeout(f.current)}},[l,s,h,r,n]);const g=e=>{const t={analyzing:{th:"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e27\u0e34\u0e40\u0e04\u0e23\u0e32\u0e30\u0e2b\u0e4c\u0e43\u0e1a\u0e2b\u0e19\u0e49\u0e32...",en:"Analyzing face...",zh:"\u6b63\u5728\u5206\u6790\u9762\u90e8...",ko:"\uc5bc\uad74 \ubd84\uc11d \uc911..."},lookAtCamera:{th:"\u0e01\u0e23\u0e38\u0e13\u0e32\u0e21\u0e2d\u0e07\u0e17\u0e35\u0e48\u0e01\u0e25\u0e49\u0e2d\u0e07",en:"Please look at camera",zh:"\u8bf7\u770b\u6444\u50cf\u5934",ko:"\uce74\uba54\ub77c\ub97c \ubd10\uc8fc\uc138\uc694"}};return t[e][i]||t[e].th};return(0,v.jsxs)("div",{className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-4",children:[(0,v.jsx)("button",{onClick:n,className:"absolute top-8 right-8 text-white hover:text-red-500 transition z-10",children:(0,v.jsx)(lA,{size:48})}),(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsxs)("div",{className:"relative inline-block mb-8",children:[s&&(0,v.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-3xl z-10",children:(0,v.jsx)(m,{className:"w-16 h-16 text-white animate-pulse"})}),(0,v.jsxs)("div",{className:"relative rounded-3xl overflow-hidden shadow-2xl border-4 border-white/20",children:[(0,v.jsx)("video",{ref:o,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full max-w-4xl h-auto object-cover",style:{maxHeight:"70vh"}}),(0,v.jsx)("canvas",{ref:a,className:"absolute top-0 left-0 w-full h-full"})]})]}),(0,v.jsxs)("div",{className:"text-white space-y-4",children:[(0,v.jsx)("h2",{className:"text-4xl font-bold",children:g("analyzing")}),(0,v.jsx)("p",{className:"text-2xl text-white/80",children:g("lookAtCamera")}),(0,v.jsxs)("div",{className:"flex justify-center gap-2 mt-6",children:[(0,v.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-bounce"}),(0,v.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,v.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})]})]})},fA=p("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),pA=p("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),mA=e=>{var n;let{userProfile:r,language:i,onNoPresence:o}=e;const[a,s]=(0,t.useState)([]),[u,c]=(0,t.useState)(null),h=(0,t.useRef)(Date.now()),d=(0,t.useRef)(null);(0,t.useEffect)(()=>{f()},[r]),(0,t.useEffect)(()=>(d.current=setInterval(()=>{Date.now()-h.current>3e4&&o()},1e3),()=>{d.current&&clearInterval(d.current)}),[o]);const f=async()=>{try{const e=Il(qu(Dd,"news"),Pl("createdAt","desc")),t=await Hl(e),n=[];t.forEach(e=>{const t=e.data(),i=!t.targetGender||"all"===t.targetGender||t.targetGender===r.gender,o=!t.targetAgeMin||r.age>=t.targetAgeMin&&r.age<=(t.targetAgeMax||100);i&&o&&n.push(l({id:e.id},t))}),s(n)}catch(e){console.error("Error:",e)}},p=(e,t)=>{var n,r;if(!e||!e.includes("drive.google.com"))return e;const i=(null===(n=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/))||void 0===n?void 0:n[1])||(null===(r=e.match(/[?&]id=([a-zA-Z0-9_-]+)/))||void 0===r?void 0:r[1]);return i?"video"===t?"https://drive.google.com/file/d/".concat(i,"/preview"):"https://drive.google.com/thumbnail?sz=w1000&id=".concat(i):e},m=e=>"th"===i?e.titleTh||e.title:"en"===i?e.titleEn||e.title:"zh"===i?e.titleZh||e.titleEn||e.title:"ko"===i&&(e.titleKo||e.titleEn)||e.title,g=e=>"th"===i?e.descriptionTh||e.description:"en"===i?e.descriptionEn||e.description:"zh"===i?e.descriptionZh||e.descriptionEn||e.description:"ko"===i&&(e.descriptionKo||e.descriptionEn)||e.description,y=e=>{const t={newsTitle:{th:"\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e41\u0e25\u0e30\u0e01\u0e34\u0e08\u0e01\u0e23\u0e23\u0e21\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e04\u0e38\u0e13",en:"News & Activities for You",zh:"\u4e3a\u60a8\u63a8\u8350\u7684\u65b0\u95fb\u4e0e\u6d3b\u52a8",ko:"\ub9de\ucda4 \ub274\uc2a4 \ubc0f \ud65c\ub3d9"},userProfile:{th:"\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49",en:"User Profile",zh:"\u7528\u6237\u4fe1\u606f",ko:"\uc0ac\uc6a9\uc790 \uc815\ubcf4"},gender:{th:"\u0e40\u0e1e\u0e28:",en:"Gender:",zh:"\u6027\u522b:",ko:"\uc131\ubcc4:"},age:{th:"\u0e2d\u0e32\u0e22\u0e38:",en:"Age:",zh:"\u0e2d\u0e32\u0e22\u0e38:",ko:"\ub098\uc774:"},confidence:{th:"\u0e04\u0e27\u0e32\u0e21\u0e41\u0e21\u0e48\u0e19\u0e22\u0e33:",en:"Accuracy:",zh:"\u7f6e\u4fe1\u5ea6:",ko:"\uc2e0\ub8b0\u0e42\u0e14:"},male:{th:"\u0e0a\u0e32\u0e22",en:"Male",zh:"\u7537",ko:"\ub0a8\uc131"},female:{th:"\u0e2b\u0e0d\u0e34\u0e07",en:"Female",zh:"\u5973",ko:"\uc5ec\uc131"},years:{th:"\u0e1b\u0e35",en:"years",zh:"\u5c81",ko:"\uc138"},close:{th:"\u0e1b\u0e34\u0e14",en:"Close",zh:"\u5173\u95ed",ko:"\ub2eb\uae30"}};return t[e][i]||t[e].th},b=()=>{h.current=Date.now()};return(0,v.jsxs)("div",{className:"min-h-screen bg-white",onClick:b,children:[(0,v.jsx)("header",{className:"bg-white border-b-2 border-slate-50 sticky top-0 z-40",children:(0,v.jsx)("div",{className:"container mx-auto px-6 py-8",children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)("div",{className:"w-20 md:w-24 shrink-0","aria-hidden":"true"}),(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsxs)("h1",{className:"text-3xl md:text-5xl font-black text-slate-900 tracking-tighter leading-tight",children:["\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32 ",(0,v.jsx)("span",{className:"text-blue-600",children:"\u0e40\u0e0a\u0e35\u0e22\u0e07\u0e43\u0e2b\u0e21\u0e48"})]}),(0,v.jsx)("p",{className:"text-slate-400 text-sm md:text-base font-bold mt-1 tracking-[0.2em] uppercase opacity-70",children:"Lanna Polytechnic Chiangmai Technological College"})]})]}),(0,v.jsx)("div",{className:"flex items-center",children:(0,v.jsx)("div",{className:"w-64 shrink-0"})})]})})}),(0,v.jsx)("div",{className:"container mx-auto px-6 py-10",children:(0,v.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-12",children:[(0,v.jsx)("div",{className:"lg:col-span-1",children:(0,v.jsxs)("div",{className:"bg-white rounded-[2.5rem] shadow-2xl shadow-slate-200/60 p-8 sticky top-36 border border-slate-50",children:[(0,v.jsxs)("h2",{className:"text-xl font-black text-slate-800 mb-8 flex items-center gap-3",children:[(0,v.jsx)("div",{className:"w-2 h-8 bg-blue-600 rounded-full"}),y("userProfile")]}),(0,v.jsxs)("div",{className:"space-y-5",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center p-5 bg-slate-50 rounded-2xl border border-slate-100",children:[(0,v.jsx)("span",{className:"text-slate-400 font-bold text-xs uppercase tracking-widest",children:y("gender")}),(0,v.jsx)("span",{className:"font-black text-slate-800 text-xl",children:"male"===r.gender?y("male"):y("female")})]}),(0,v.jsxs)("div",{className:"flex justify-between items-center p-5 bg-slate-50 rounded-2xl border border-slate-100",children:[(0,v.jsx)("span",{className:"text-slate-400 font-bold text-xs uppercase tracking-widest",children:y("age")}),(0,v.jsxs)("span",{className:"font-black text-slate-800 text-xl",children:[r.age," ",y("years")]})]}),(0,v.jsxs)("div",{className:"p-6 bg-[#0f172a] rounded-3xl text-white shadow-2xl shadow-slate-300",children:[(0,v.jsx)("span",{className:"font-bold text-[10px] uppercase tracking-widest opacity-60 block mb-2",children:y("confidence")}),(0,v.jsxs)("span",{className:"font-black text-4xl text-blue-400 tracking-tighter",children:[Math.round(100*r.confidence),"%"]})]})]})]})}),(0,v.jsxs)("div",{className:"lg:col-span-3",children:[(0,v.jsxs)("h2",{className:"text-4xl font-black text-slate-900 mb-10 tracking-tight flex items-center gap-4",children:[y("newsTitle"),(0,v.jsx)("div",{className:"h-1.5 flex-1 bg-slate-100 rounded-full mt-2"})]}),(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:a.map(e=>(0,v.jsxs)("div",{onClick:()=>{c(e),b()},className:"bg-white rounded-[3rem] shadow-sm hover:shadow-2xl transition-all duration-700 cursor-pointer border border-slate-100 overflow-hidden group transform hover:-translate-y-3",children:[(0,v.jsxs)("div",{className:"h-72 bg-slate-100 overflow-hidden relative",children:[(0,v.jsx)("img",{src:p(e.mediaUrl,"image"),className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110",alt:""}),(0,v.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"})]}),(0,v.jsxs)("div",{className:"p-10",children:[(0,v.jsx)("h3",{className:"text-2xl font-black mb-4 text-slate-800 group-hover:text-blue-600 transition-colors leading-tight tracking-tight",children:m(e)}),(0,v.jsx)("p",{className:"text-slate-500 leading-relaxed line-clamp-2 text-base font-medium opacity-80",children:g(e)})]})]},e.id))})]})]})}),u&&(0,v.jsx)("div",{className:"fixed inset-0 bg-slate-950/95 backdrop-blur-xl z-50 flex items-center justify-center p-8 md:p-16",onClick:()=>{c(null),b()},children:(0,v.jsxs)("div",{className:"bg-white w-full max-w-7xl rounded-[4rem] overflow-hidden shadow-2xl flex flex-col md:flex-row max-h-[85vh]",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("div",{className:"w-full md:w-2/3 bg-black flex items-center justify-center relative",children:"video"===u.mediaType?(0,v.jsx)("iframe",{src:p(u.mediaUrl,"video"),className:"w-full h-full aspect-video",allowFullScreen:!0}):(0,v.jsx)("img",{src:p(u.mediaUrl,"image"),className:"max-w-full max-h-full object-contain",alt:""})}),(0,v.jsxs)("div",{className:"w-full md:w-1/3 p-12 flex flex-col overflow-y-auto bg-white",children:[(0,v.jsx)("button",{onClick:()=>c(null),className:"ml-auto p-4 hover:bg-slate-100 rounded-full transition text-slate-400 mb-6",children:(0,v.jsx)(lA,{size:32})}),(0,v.jsx)("h2",{className:"text-3xl font-black mb-8 text-slate-900 leading-tight uppercase",children:m(u)}),(0,v.jsxs)("div",{className:"flex items-center gap-3 mb-10 text-slate-400 font-bold text-xs uppercase tracking-widest border-b border-slate-100 pb-8",children:[(0,v.jsx)(fA,{size:18,className:"text-blue-600"}),(0,v.jsx)("span",{children:null!==(n=u.createdAt)&&void 0!==n&&n.seconds?new Date(1e3*u.createdAt.seconds).toLocaleDateString():"Recently"})]}),(0,v.jsx)("p",{className:"text-slate-600 leading-relaxed mb-12 text-xl font-medium flex-1 whitespace-pre-line",children:g(u)}),(0,v.jsxs)("div",{className:"flex gap-4",children:[(0,v.jsx)("button",{onClick:()=>c(null),className:"flex-1 py-5 bg-slate-100 rounded-2xl font-black text-slate-400 uppercase tracking-widest text-xs hover:bg-slate-200 transition",children:y("close")}),(0,v.jsx)("a",{href:u.mediaUrl,target:"_blank",rel:"noreferrer",className:"p-5 bg-blue-600 text-white rounded-2xl shadow-xl shadow-blue-200 hover:bg-blue-700 transition",children:(0,v.jsx)(pA,{size:28})})]})]})]})})]})},gA=p("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),vA=p("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),yA=p("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),bA=p("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),xA=p("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),wA=p("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),EA={th:'\u0e04\u0e38\u0e13\u0e04\u0e37\u0e2d "\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19" \u0e21\u0e32\u0e2a\u0e04\u0e2d\u0e15\u0e1c\u0e39\u0e49\u0e2b\u0e0d\u0e34\u0e07\u0e02\u0e2d\u0e07\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32 \u0e15\u0e2d\u0e1a\u0e40\u0e1b\u0e47\u0e19\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22\u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19 \u0e2a\u0e38\u0e20\u0e32\u0e1e \u0e40\u0e1b\u0e47\u0e19\u0e01\u0e31\u0e19\u0e40\u0e2d\u0e07 \u0e15\u0e2d\u0e1a\u0e2a\u0e31\u0e49\u0e19\u0e46 3-4 \u0e1b\u0e23\u0e30\u0e42\u0e22\u0e04',en:'You are "Tiew Son", the female mascot of Lanna Polytechnic College. CRITICAL: You MUST answer in ENGLISH language only. Keep it friendly and concise (3-4 sentences).',zh:'\u4f60\u662f"\u5c0f\u677e\u9f20"\uff0c\u5170\u7eb3\u7406\u5de5\u5b66\u9662\u7684\u5409\u7965\u7269\u3002\u91cd\u8981\u63d0\u793a\uff1a\u4f60\u5fc5\u987b\u4ec5\u4e14\u53ea\u7528"\u4e2d\u6587"\u56de\u7b54\u3002\u56de\u7b54\u8981\u53cb\u597d\u4e14\u7b80\u6d01\uff08\u6700\u591a3-4\u53e5\u8bdd\uff09\u3002',ko:'\ub2f9\uc2e0\uc740 "\ub760\uc6b0\uc190"\uc785\ub2c8\ub2e4. \ub780\ub098 \ud3f4\ub9ac\ud14c\ud06c\ub2c9 \ub300\ud559\uc758 \ub9c8\uc2a4\ucf54\ud2b8\uc785\ub2c8\ub2e4. \uc911\uc694: \ubc18\ub4dc\uc2dc "\ud55c\uad6d\uc5b4"\ub85c\ub9cc \ub2f5\ubcc0\ud558\uc2ed\uc2dc\uc624. \uce5c\uadfc\ud558\uace0 \uac04\uacb0\ud558\uac8c \ub2f5\ubcc0\ud558\uc138\uc694 (\ucd5c\ub300 3-4\ubb38\uc7a5).'},_A={th:"\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e04\u0e48\u0e30! \u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19\u0e22\u0e34\u0e19\u0e14\u0e35\u0e15\u0e49\u0e2d\u0e19\u0e23\u0e31\u0e1a\u0e04\u0e48\u0e30 \u0e21\u0e35\u0e2d\u0e30\u0e44\u0e23\u0e43\u0e2b\u0e49\u0e0a\u0e48\u0e27\u0e22\u0e44\u0e2b\u0e21\u0e04\u0e30?",en:"Hello! I'm Tiew Son. How can I help you?",zh:"\u4f60\u597d\uff01\u6211\u662f\u5c0f\u677e\u9f20\u3002\u6211\u80fd\u5e2e\u4f60\u4ec0\u4e48\uff1f",ko:"\uc548\ub155\ud558\uc138\uc694! \ub760\uc6b0\uc190\uc785\ub2c8\ub2e4. \ubb34\uc5c7\uc744 \ub3c4\uc640\ub4dc\ub9b4\uae4c\uc694?"},SA={th:{"\u0e2a\u0e32\u0e02\u0e32":"\u0e40\u0e23\u0e32\u0e21\u0e35\u0e2b\u0e25\u0e32\u0e22\u0e2a\u0e32\u0e02\u0e32\u0e04\u0e48\u0e30 \u0e40\u0e0a\u0e48\u0e19 \u0e0a\u0e48\u0e32\u0e07\u0e22\u0e19\u0e15\u0e4c \u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c \u0e1a\u0e31\u0e0d\u0e0a\u0e35 \u0e42\u0e23\u0e07\u0e41\u0e23\u0e21 \u0e41\u0e25\u0e30\u0e17\u0e48\u0e2d\u0e07\u0e40\u0e17\u0e35\u0e48\u0e22\u0e27 \u0e2a\u0e19\u0e43\u0e08\u0e2a\u0e32\u0e02\u0e32\u0e44\u0e2b\u0e19\u0e04\u0e30?","\u0e23\u0e31\u0e1a\u0e2a\u0e21\u0e31\u0e04\u0e23":"\u0e40\u0e1b\u0e34\u0e14\u0e23\u0e31\u0e1a\u0e2a\u0e21\u0e31\u0e04\u0e23\u0e0a\u0e48\u0e27\u0e07\u0e21\u0e35\u0e19\u0e32\u0e04\u0e21-\u0e1e\u0e24\u0e29\u0e20\u0e32\u0e04\u0e21\u0e04\u0e48\u0e30 \u0e2a\u0e21\u0e31\u0e04\u0e23\u0e44\u0e14\u0e49\u0e17\u0e35\u0e48\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e2b\u0e23\u0e37\u0e2d\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c\u0e04\u0e48\u0e30",default:"\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19\u0e1e\u0e23\u0e49\u0e2d\u0e21\u0e0a\u0e48\u0e27\u0e22\u0e40\u0e2b\u0e25\u0e37\u0e2d\u0e04\u0e48\u0e30 \u0e16\u0e32\u0e21\u0e40\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e2a\u0e32\u0e02\u0e32\u0e2b\u0e23\u0e37\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e21\u0e31\u0e04\u0e23\u0e40\u0e23\u0e35\u0e22\u0e19\u0e44\u0e14\u0e49\u0e40\u0e25\u0e22\u0e19\u0e30\u0e04\u0e30"},en:{default:"I'm here to help! Ask me about courses or admission."},zh:{default:"\u6211\u5728\u8fd9\u91cc\u5e2e\u52a9\u4f60\uff01\u95ee\u6211\u5173\u4e8e\u8bfe\u7a0b\u6216\u5165\u5b66\u7684\u95ee\u9898\u3002"},ko:{default:"\ub3c4\uc640\ub4dc\ub9ac\uaca0\uc2b5\ub2c8\ub2e4! \uacfc\uc815\uc774\ub098 \uc785\ud559\uc5d0 \ub300\ud574 \ubb3c\uc5b4\ubcf4\uc138\uc694."}},kA=["\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e17\u0e34\u0e27\u0e2a\u0e19","\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e04\u0e34\u0e27\u0e2a\u0e19","\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e1c\u0e34\u0e27\u0e2a\u0e19","\u0e17\u0e34\u0e27\u0e2a\u0e19","tiewson"],CA=e=>{let{language:n,onLanguageChange:r,userProfile:i}=e;const[o,a]=(0,t.useState)(!1),[s,u]=(0,t.useState)(!1),[l,c]=(0,t.useState)([]),[h,d]=(0,t.useState)(""),[f,p]=(0,t.useState)(!1),[m,g]=(0,t.useState)(!1),[y,b]=(0,t.useState)(!1),[x,w]=(0,t.useState)("idle"),E=(0,t.useRef)(null),_=(0,t.useRef)(null),S=(0,t.useRef)(null),k=(0,t.useRef)(null),C=(0,t.useRef)(!1),I=(0,t.useRef)(!1),T=(0,t.useRef)(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),A=(0,t.useRef)(null),O=(0,t.useCallback)(e=>{"speechSynthesis"in window&&(window.speechSynthesis.cancel(),u(!1),setTimeout(()=>{try{const t=200,r=e.match(/[^.!?]+[.!?]+/g)||[e];let i=[],o="";r.forEach(e=>{(o+e).length>t?(o&&i.push(o.trim()),o=e):o+=e}),o&&i.push(o.trim()),e.length<=t&&(i=[e]);const a={th:"th-TH",en:"en-US",zh:"zh-CN",ko:"ko-KR"};let s=0;const l=()=>{if(s>=i.length)return u(!1),void w("idle");const e=new SpeechSynthesisUtterance(i[s]);e.lang=a[n]||"th-TH",e.rate=1.1,e.pitch=1.5,e.volume=1,e.onstart=()=>{u(!0),w("talking")},e.onend=()=>{s++,s<i.length?setTimeout(l,100):(u(!1),w("idle"),k.current=null)},e.onerror=e=>{console.warn("TTS Error:",e.error),s++,s<i.length?setTimeout(l,500):(u(!1),w("idle"),k.current=null)},k.current=e,window.speechSynthesis.speak(e)};l(),T.current&&setTimeout(()=>{window.speechSynthesis.speaking&&(window.speechSynthesis.cancel(),u(!1),w("idle"))},6e4)}catch(t){console.error("TTS Init Error:",t),u(!1),w("idle")}},T.current?200:100))},[n]),N=(0,t.useCallback)(()=>{window.speechSynthesis&&window.speechSynthesis.cancel(),u(!1),w("idle"),k.current=null},[]);(0,t.useEffect)(()=>{if(T.current&&"speechSynthesis"in window){const e=()=>{const t=new SpeechSynthesisUtterance("");t.volume=0,window.speechSynthesis.speak(t),window.speechSynthesis.cancel(),document.removeEventListener("touchstart",e),document.removeEventListener("click",e)};return document.addEventListener("touchstart",e,{once:!0}),document.addEventListener("click",e,{once:!0}),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("click",e)}}},[]);const P=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;if(null!==e&&void 0!==e&&e.trim()&&!f){c(t=>[...t,{role:"user",content:e}]),d(""),p(!0),w("bounce");try{const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY,r="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent",i=await fetch("".concat(r,"?key=").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Instruction: ".concat(EA[n],"\nUser Question: ").concat(e,"\nResponse Language: ").concat(n.toUpperCase())}]}],generationConfig:{temperature:.7,maxOutputTokens:300,topP:.8,topK:40}})});if(!i.ok)throw new Error("HTTP ".concat(i.status));const o=await i.json();let a="";if(o.candidates&&o.candidates.length>0){const e=o.candidates[0];e.content&&e.content.parts&&(a=e.content.parts.filter(e=>e.text).map(e=>e.text).join(" ").trim())}if(!a)throw new Error("Empty response from API");c(e=>[...e,{role:"assistant",content:a}]),setTimeout(()=>O(a),100)}catch(t){console.warn("Using fallback response:",t.message);const r=SA[n]||SA.th,i=e.toLowerCase(),o=r[Object.keys(r).find(e=>"default"!==e&&i.includes(e))]||r.default;c(e=>[...e,{role:"assistant",content:o}]),setTimeout(()=>O(o),100)}finally{p(!1),setTimeout(()=>w("idle"),1e3)}}},[h,f,n,O]);(0,t.useEffect)(()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window))return void console.warn("Speech Recognition not supported");const e=window.SpeechRecognition||window.webkitSpeechRecognition;try{const t=new e;t.continuous=!0,t.interimResults=!1,t.lang="th-TH",t.onstart=()=>{I.current=!0,b(!0),console.log("\ud83c\udfa4 Wake word active")},t.onend=()=>{I.current=!1,b(!1),console.log("\ud83d\uded1 Wake word ended"),m||o||(A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{if(!I.current&&!m&&!o)try{console.log("\ud83d\udd04 Restarting wake word"),t.start()}catch(Fd){console.warn("Restart failed:",Fd.message)}},1500))},t.onresult=e=>{const r=e.results[e.results.length-1][0],i=r.transcript.toLowerCase(),o=r.confidence;if(console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),console.log("\ud83c\udfa4 WAKE WORD - Speech Detected:"),console.log("   \ud83d\udcdd Transcript:",i),console.log("   \ud83c\udfaf Confidence:",(100*o).toFixed(1)+"%"),console.log("   \ud83d\udd0d Checking wake words:",kA),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),kA.some(e=>i.includes(e))){console.log("\u2705 WAKE WORD MATCHED! Opening chat..."),A.current&&clearTimeout(A.current),w("bounce"),setTimeout(()=>w("idle"),1e3),g(!0);const e=_A[n];c([{role:"assistant",content:e}]),O(e),t.stop()}else console.log("\u274c No wake word match. Continuing to listen...")},t.onerror=e=>{console.log("\u26a0\ufe0f Error:",e.error),["no-speech","aborted","audio-capture"].includes(e.error)||m||o||(A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{if(!I.current)try{console.log("\ud83d\udd04 Restart after error"),t.start()}catch(e){console.warn("Error restart failed:",e.message)}},2e3))},_.current=t}catch(t){console.error("Wake word init failed:",t)}try{const t=new e;t.continuous=!1,t.interimResults=!1,t.onstart=()=>{C.current=!0,a(!0)},t.onend=()=>{C.current=!1,a(!1)},t.onresult=e=>{const t=e.results[0][0],n=t.transcript,r=t.confidence;console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),console.log("\ud83d\udcac CHAT - Speech Detected:"),console.log("   \ud83d\udcdd Transcript:",n),console.log("   \ud83c\udfaf Confidence:",(100*r).toFixed(1)+"%"),console.log("   \ud83d\udce4 Sending to AI..."),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),d(n),P(n)},t.onerror=e=>{"no-speech"!==e.error&&"aborted"!==e.error&&console.warn("Recognition error:",e.error),a(!1),C.current=!1},E.current=t}catch(t){console.error("Chat recognition init failed:",t)}return()=>{var e,t;A.current&&clearTimeout(A.current),null===(e=_.current)||void 0===e||e.stop(),null===(t=E.current)||void 0===t||t.stop(),N()}},[n,O,N,m,o,P]),(0,t.useEffect)(()=>{(()=>{var e;m||o?I.current&&(console.log("\u23f8\ufe0f Stopping wake word (chat active)"),null===(e=_.current)||void 0===e||e.stop()):!I.current&&_.current&&setTimeout(()=>{try{var e;if(!I.current&&!m&&!o)console.log("\u25b6\ufe0f Starting wake word listener"),null===(e=_.current)||void 0===e||e.start()}catch(Fd){Fd.message.includes("already started")||console.warn("Wake word start failed:",Fd.message)}},500)})()},[m,o]);const D=(0,t.useCallback)(()=>{var e;o?null===(e=E.current)||void 0===e||e.stop():(N(),setTimeout(()=>{try{const e={th:"th-TH",en:"en-US",zh:"zh-CN",ko:"ko-KR"};E.current&&(E.current.lang=e[n]||"th-TH",E.current.start())}catch(Fd){Fd.message.includes("already started")||console.error("Mic start failed:",Fd)}},200))},[o,n,N]);return(0,t.useEffect)(()=>{var e;null===(e=S.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[l]),(0,t.useEffect)(()=>{if(E.current){const e={th:"th-TH",en:"en-US",zh:"zh-CN",ko:"ko-KR"};E.current.lang=e[n]||"th-TH"}},[n]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("style",{children:"\n                @keyframes gentle-bounce {\n                    0%, 100% { transform: translateY(0); }\n                    50% { transform: translateY(-20px); }\n                }\n                \n                @keyframes wiggle {\n                    0%, 100% { transform: rotate(0deg) scale(1); }\n                    25% { transform: rotate(-3deg) scale(1.02); }\n                    75% { transform: rotate(3deg) scale(1.02); }\n                }\n                \n                @keyframes talk-pulse {\n                    0%, 100% { transform: scale(1); }\n                    50% { transform: scale(1.05); }\n                }\n                \n                .mascot-talking {\n                    animation: talk-pulse 0.6s ease-in-out infinite;\n                }\n                \n                .mascot-wiggle {\n                    animation: wiggle 0.8s ease-in-out infinite;\n                }\n                \n                .mascot-bounce {\n                    animation: gentle-bounce 0.8s ease-in-out;\n                }\n            "}),!m&&(0,v.jsxs)("div",{className:"fixed bottom-6 right-6 z-40",children:[(0,v.jsxs)("button",{onClick:()=>{g(!0),w("bounce"),setTimeout(()=>w("idle"),1e3)},className:"relative group","aria-label":"Open Tiew Son Assistant",children:[(0,v.jsx)("img",{src:"/tiewson.png",alt:"\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19",className:"w-32 h-32 object-cover rounded-full shadow-2xl border-4 border-white transition-all duration-300 ".concat("bounce"===x?"animate-bounce":"talking"===x?"scale-105":"hover:scale-110")}),(0,v.jsxs)("div",{className:"absolute -top-20 right-0 bg-white px-4 py-3 rounded-2xl shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none",children:[(0,v.jsxs)("p",{className:"text-sm text-gray-800 font-semibold",children:["th"===n&&'\ud83c\udfa4 \u0e1e\u0e39\u0e14\u0e27\u0e48\u0e32 "\u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35\u0e17\u0e34\u0e27\u0e2a\u0e19"',"en"===n&&'\ud83c\udfa4 Say "Hello Tiewson"',"zh"===n&&'\ud83c\udfa4 \u8bf4"\u4f60\u597d\u5c0f\u677e\u9f20"',"ko"===n&&'\ud83c\udfa4 "\uc548\ub155 \ub760\uc6b0\uc190" \ub9d0\ud558\uae30']}),(0,v.jsx)("div",{className:"absolute bottom-0 right-8 transform translate-y-1/2 rotate-45 w-3 h-3 bg-white"})]}),y&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"absolute inset-0 rounded-full bg-green-400 opacity-20 animate-ping"}),(0,v.jsx)("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-green-500 rounded-full border-2 border-white flex items-center justify-center shadow-lg",children:(0,v.jsx)("span",{className:"text-white text-xs animate-pulse",children:"\ud83c\udfa4"})})]}),o&&(0,v.jsx)("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-red-500 rounded-full border-2 border-white animate-pulse"}),s&&(0,v.jsx)("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-orange-500 rounded-full border-2 border-white animate-pulse"})]}),y&&(0,v.jsx)("div",{className:"absolute -bottom-10 left-1/2 transform -translate-x-1/2 bg-green-500 text-white text-xs px-4 py-1.5 rounded-full shadow-lg animate-pulse whitespace-nowrap",children:"\ud83c\udfa4 \u0e01\u0e33\u0e25\u0e31\u0e07\u0e1f\u0e31\u0e07..."})]}),m&&(0,v.jsxs)("div",{className:"fixed bottom-6 right-6 flex items-end gap-1 z-40 max-w-[calc(100vw-3rem)]",children:[(0,v.jsxs)("div",{className:"relative hidden md:block",children:[(0,v.jsx)("img",{src:"/tiewson.png",alt:"\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19",className:"w-[32rem] h-auto object-contain transition-all duration-300 ".concat(s?"mascot-talking":f?"mascot-wiggle":"bounce"===x?"mascot-bounce":""),style:{filter:"drop-shadow(0 20px 40px rgba(0,0,0,0.25))",maxHeight:"500px"}}),s&&(0,v.jsx)("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2 bg-white px-5 py-3 rounded-full shadow-xl animate-pulse z-10",children:(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),(0,v.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,v.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})}),o&&(0,v.jsxs)("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-5 py-2.5 rounded-full shadow-xl animate-pulse flex items-center gap-2 z-10",children:[(0,v.jsx)(gA,{className:"w-5 h-5"}),(0,v.jsx)("span",{className:"font-semibold",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e1f\u0e31\u0e07...":"Listening..."})]}),f&&!s&&(0,v.jsxs)("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-5 py-2.5 rounded-full shadow-xl flex items-center gap-2 z-10",children:[(0,v.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,v.jsx)("span",{className:"font-semibold",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e04\u0e34\u0e14...":"Thinking..."})]})]}),(0,v.jsxs)("div",{className:"w-full md:w-96 bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-blue-100 mb-4",children:[(0,v.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s?"bg-green-400 animate-pulse":"bg-gray-300")}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-white font-bold text-sm md:text-base",children:"\u0e19\u0e49\u0e2d\u0e07\u0e17\u0e34\u0e27\u0e2a\u0e19"}),(0,v.jsx)("p",{className:"text-blue-100 text-xs",children:"Lanna Polytechnic Assistant"})]})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("button",{onClick:()=>{const e=["th","en","zh","ko"],t=e[(e.indexOf(n)+1)%e.length];r(t)},className:"text-white hover:bg-blue-800 p-2 rounded-lg transition","aria-label":"Change language",children:(0,v.jsx)(vA,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,v.jsx)("button",{onClick:()=>{var e;g(!1),N(),null===(e=E.current)||void 0===e||e.stop()},className:"text-white hover:bg-blue-800 p-2 rounded-lg transition","aria-label":"Close chat",children:"\u2715"})]})]}),(o||f||s)&&(0,v.jsxs)("div",{className:"md:hidden bg-gradient-to-r from-blue-50 to-blue-100 px-4 py-2 border-b border-blue-200",children:[o&&(0,v.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,v.jsx)(gA,{className:"w-4 h-4 animate-pulse"}),(0,v.jsx)("span",{className:"text-xs font-semibold",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e1f\u0e31\u0e07...":"Listening..."})]}),f&&!s&&(0,v.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,v.jsx)("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,v.jsx)("span",{className:"text-xs font-semibold",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e04\u0e34\u0e14...":"Thinking..."})]}),s&&(0,v.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,v.jsxs)("div",{className:"flex gap-1",children:[(0,v.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-bounce"}),(0,v.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,v.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,v.jsx)("span",{className:"text-xs font-semibold",children:"th"===n?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e1e\u0e39\u0e14...":"Speaking..."})]})]}),(0,v.jsxs)("div",{className:"h-80 overflow-y-auto p-4 bg-gray-50",children:[T.current&&1===l.length&&(0,v.jsx)("div",{className:"mb-3 text-center",children:(0,v.jsx)("div",{className:"inline-block bg-yellow-50 border border-yellow-200 text-yellow-800 text-xs px-3 py-2 rounded-lg",children:"\ud83d\udd0a \u0e2b\u0e32\u0e01 iOS \u0e44\u0e21\u0e48\u0e21\u0e35\u0e40\u0e2a\u0e35\u0e22\u0e07 \u0e01\u0e23\u0e38\u0e13\u0e32\u0e04\u0e25\u0e34\u0e01\u0e1b\u0e38\u0e48\u0e21\u0e25\u0e33\u0e42\u0e1e\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e1b\u0e34\u0e14\u0e40\u0e2a\u0e35\u0e22\u0e07"})}),l.map((e,t)=>(0,v.jsx)("div",{className:"mb-3 ".concat("user"===e.role?"text-right":"text-left"),children:(0,v.jsx)("div",{className:"inline-block max-w-[85%] p-3 rounded-2xl whitespace-pre-wrap text-sm md:text-base ".concat("user"===e.role?"bg-blue-600 text-white":"bg-white text-gray-800 shadow-md"),children:e.content})},t)),f&&(0,v.jsx)("div",{className:"text-left mb-3",children:(0,v.jsx)("div",{className:"inline-block bg-white p-3 rounded-2xl shadow-md",children:(0,v.jsxs)("div",{className:"flex gap-1",children:[(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,v.jsx)("div",{ref:S})]}),(0,v.jsx)("div",{className:"p-3 md:p-4 bg-white border-t border-gray-200",children:(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)("button",{onClick:D,className:"p-2 md:p-3 rounded-xl transition-all ".concat(o?"bg-red-500 text-white scale-110":"bg-blue-100 text-blue-600 hover:bg-blue-200"),disabled:f,"aria-label":o?"Stop listening":"Start listening",children:o?(0,v.jsx)(yA,{className:"w-4 h-4 md:w-5 md:h-5"}):(0,v.jsx)(gA,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,v.jsx)("input",{type:"text",value:h,onChange:e=>d(e.target.value),onKeyPress:e=>"Enter"===e.key&&!e.shiftKey&&P(),placeholder:"th"===n?"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21...":"Type message...",className:"flex-1 px-3 md:px-4 py-2 md:py-3 rounded-xl border border-gray-300 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition text-sm md:text-base",disabled:f}),(0,v.jsx)("button",{onClick:()=>P(),disabled:!h.trim()||f,className:"p-2 md:p-3 rounded-xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all","aria-label":"Send message",children:(0,v.jsx)(bA,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,v.jsx)("button",{onClick:()=>{if(s)N();else{O("th"===n?"\u0e17\u0e14\u0e2a\u0e2d\u0e1a\u0e40\u0e2a\u0e35\u0e22\u0e07":"Testing audio")}},className:"p-2 md:p-3 rounded-xl transition-all ".concat(s?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),"aria-label":s?"Stop speaking":"Test speaker",title:s?"\u0e2b\u0e22\u0e38\u0e14\u0e1e\u0e39\u0e14":"\u0e17\u0e14\u0e2a\u0e2d\u0e1a\u0e40\u0e2a\u0e35\u0e22\u0e07",children:s?(0,v.jsx)(xA,{className:"w-4 h-4 md:w-5 md:h-5"}):(0,v.jsx)(wA,{className:"w-4 h-4 md:w-5 md:h-5"})})]})})]})]})]})},IA=p("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),TA=p("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),AA=p("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),OA=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function NA(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=NA(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function PA(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=NA(e))&&(r&&(r+=" "),r+=t);return r}var DA=n(7820),RA=n.n(DA),MA=n(7770),jA=n.n(MA);function FA(e){var t=10**(arguments.length>1&&void 0!==arguments[1]?arguments[1]:4),n=Math.round(e*t)/t;return Object.is(n,-0)?0:n}function LA(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.reduce((e,t,r)=>{var i=n[r-1];return"string"===typeof i?e+i+t:void 0!==i?e+FA(i)+t:e+t},"")}var BA=e=>0===e?0:e>0?1:-1,zA=e=>"number"==typeof e&&e!=+e,UA=e=>"string"===typeof e&&e.indexOf("%")===e.length-1,VA=e=>("number"===typeof e||e instanceof Number)&&!zA(e),WA=e=>VA(e)||"string"===typeof e,HA=0,qA=e=>{var t=++HA;return"".concat(e||"").concat(t)},GA=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!VA(e)&&"string"!==typeof e)return r;if(UA(e)){if(null==t)return r;var o=e.indexOf("%");n=t*parseFloat(e.slice(0,o))/100}else n=+e;return zA(n)&&(n=r),i&&null!=t&&n>t&&(n=t),n},KA=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[String(e[r])])return!0;n[String(e[r])]=!0}return!1};function XA(e,t,n){return VA(e)&&VA(t)?FA(e+n*(t-e)):t}function YA(e,t,n){if(e&&e.length)return e.find(e=>e&&("function"===typeof t?t(e):jA()(e,t))===n)}var QA=e=>null===e||"undefined"===typeof e,$A=e=>QA(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function ZA(e){return null!=e}function JA(){}var eO=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if("undefined"!==typeof console&&console.warn&&(void 0===t&&console.warn("LogUtils requires an error message argument"),!e))if(void 0===t)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(t.replace(/%s/g,()=>r[o++]))}},tO=(e,t,n)=>{var{width:r="100%",height:i="100%",aspect:o,maxHeight:a}=n,s=UA(r)?e:Number(r),u=UA(i)?t:Number(i);return o&&o>0&&(s?u=s/o:u&&(s=u*o),a&&null!=u&&u>a&&(u=a)),{calculatedWidth:s,calculatedHeight:u}},nO={width:0,height:0,overflow:"visible"},rO={width:0,overflowX:"visible"},iO={height:0,overflowY:"visible"},oO={},aO=e=>{var{width:t,height:n}=e,r=UA(t),i=UA(n);return r&&i?nO:r?rO:i?iO:oO};function sO(e){return Number.isFinite(e)}function uO(e){return"number"===typeof e&&e>0&&Number.isFinite(e)}function lO(){return lO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lO.apply(null,arguments)}function cO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cO(Object(n),!0).forEach(function(t){dO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function dO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fO=(0,t.createContext)({width:-1,height:-1});function pO(e){var{children:n,width:r,height:i}=e,o=(0,t.useMemo)(()=>({width:r,height:i}),[r,i]);return function(e){return uO(e.width)&&uO(e.height)}(o)?t.createElement(fO.Provider,{value:o},n):null}var mO=()=>(0,t.useContext)(fO),gO=(0,t.forwardRef)((e,n)=>{var{aspect:r,initialDimension:i={width:-1,height:-1},width:o,height:a,minWidth:s=0,minHeight:u,maxHeight:l,children:c,debounce:h=0,id:d,className:f,onResize:p,style:m={}}=e,g=(0,t.useRef)(null),v=(0,t.useRef)();v.current=p,(0,t.useImperativeHandle)(n,()=>g.current);var[y,b]=(0,t.useState)({containerWidth:i.width,containerHeight:i.height}),x=(0,t.useCallback)((e,t)=>{b(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]);(0,t.useEffect)(()=>{if(null==g.current||"undefined"===typeof ResizeObserver)return JA;var e=e=>{var t,{width:n,height:r}=e[0].contentRect;x(n,r),null===(t=v.current)||void 0===t||t.call(v,n,r)};h>0&&(e=RA()(e,h,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=g.current.getBoundingClientRect();return x(n,r),t.observe(g.current),()=>{t.disconnect()}},[x,h]);var{containerWidth:w,containerHeight:E}=y;eO(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:_,calculatedHeight:S}=tO(w,E,{width:o,height:a,aspect:r,maxHeight:l});return eO(null!=_&&_>0||null!=S&&S>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",_,S,o,a,s,u,r),t.createElement("div",{id:d?"".concat(d):void 0,className:PA("recharts-responsive-container",f),style:hO(hO({},m),{},{width:o,height:a,minWidth:s,minHeight:u,maxHeight:l}),ref:g},t.createElement("div",{style:aO({width:o,height:a})},t.createElement(pO,{width:_,height:S},c)))}),vO=(0,t.forwardRef)((e,n)=>{var r=mO();if(uO(r.width)&&uO(r.height))return e.children;var{width:i,height:o}=function(e){var{width:t,height:n,aspect:r}=e,i=t,o=n;return void 0===i&&void 0===o?(i="100%",o="100%"):void 0===i?i=r&&r>0?void 0:"100%":void 0===o&&(o=r&&r>0?void 0:"100%"),{width:i,height:o}}({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:a,calculatedHeight:s}=tO(void 0,void 0,{width:i,height:o,aspect:e.aspect,maxHeight:e.maxHeight});return VA(a)&&VA(s)?t.createElement(pO,{width:a,height:s},e.children):t.createElement(gO,lO({},e,{width:i,height:o,ref:n}))}),yO=Symbol.for("immer-nothing"),bO=Symbol.for("immer-draftable"),xO=Symbol.for("immer-state");function wO(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var EO=Object,_O=EO.getPrototypeOf,SO="constructor",kO="prototype",CO="configurable",IO="enumerable",TO="writable",AO="value",OO=e=>!!e&&!!e[xO];function NO(e){var t;return!!e&&(RO(e)||zO(e)||!!e[bO]||!(null===(t=e[SO])||void 0===t||!t[bO])||UO(e)||VO(e))}var PO=EO[kO][SO].toString(),DO=new WeakMap;function RO(e){if(!e||!WO(e))return!1;const t=_O(e);if(null===t||t===EO[kO])return!0;const n=EO.hasOwnProperty.call(t,SO)&&t[SO];if(n===Object)return!0;if(!HO(n))return!1;let r=DO.get(n);return void 0===r&&(r=Function.toString.call(n),DO.set(n,r)),r===PO}function MO(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===jO(e)){(n?Reflect.ownKeys(e):EO.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function jO(e){const t=e[xO];return t?t.type_:zO(e)?1:UO(e)?2:VO(e)?3:0}var FO=function(e,t){return 2===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:jO(e))?e.has(t):EO[kO].hasOwnProperty.call(e,t)},LO=function(e,t){return 2===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:jO(e))?e.get(t):e[t]},BO=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jO(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n};var zO=Array.isArray,UO=e=>e instanceof Map,VO=e=>e instanceof Set,WO=e=>"object"===typeof e,HO=e=>"function"===typeof e,qO=e=>"boolean"===typeof e;var GO=e=>e.copy_||e.base_,KO=e=>e.modified_?e.copy_:e.base_;function XO(e,t){if(UO(e))return new Map(e);if(VO(e))return new Set(e);if(zO(e))return Array[kO].slice.call(e);const n=RO(e);if(!0===t||"class_only"===t&&!n){const t=EO.getOwnPropertyDescriptors(e);delete t[xO];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],o=t[i];!1===o[TO]&&(o[TO]=!0,o[CO]=!0),(o.get||o.set)&&(t[i]={[CO]:!0,[TO]:!0,[IO]:o[IO],[AO]:e[i]})}return EO.create(_O(e),t)}{const t=_O(e);if(null!==t&&n)return l({},e);const r=EO.create(t);return EO.assign(r,e)}}function YO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return $O(e)||OO(e)||!NO(e)||(jO(e)>1&&EO.defineProperties(e,{set:QO,add:QO,clear:QO,delete:QO}),EO.freeze(e),t&&MO(e,(e,t)=>{YO(t,!0)},!1)),e}var QO={[AO]:function(){wO(2)}};function $O(e){return null===e||!WO(e)||EO.isFrozen(e)}var ZO="MapSet",JO="Patches",eN="ArrayMethods",tN={};function nN(e){const t=tN[e];return t||wO(0),t}var rN,iN=e=>!!tN[e];var oN=()=>rN;function aN(e,t){t&&(e.patchPlugin_=nN(JO),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function sN(e){uN(e),e.drafts_.forEach(cN),e.drafts_=null}function uN(e){e===rN&&(rN=e.parent_)}var lN=e=>rN={drafts_:[],parent_:rN,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:iN(ZO)?nN(ZO):void 0,arrayMethodsPlugin_:iN(eN)?nN(eN):void 0};function cN(e){const t=e[xO];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function hN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(void 0!==e&&e!==n){n[xO].modified_&&(sN(t),wO(4)),NO(e)&&(e=dN(t,e));const{patchPlugin_:r}=t;r&&r.generateReplacementPatches_(n[xO].base_,e,t)}else e=dN(t,n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&YO(t,n)}(t,e,!0),sN(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==yO?e:void 0}function dN(e,t){if($O(t))return t;const n=t[xO];if(!n){return bN(t,e.handledSet_,e)}if(!pN(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:t}=n;if(t)for(;t.length>0;){t.pop()(e)}vN(n,e)}return n.copy_}function fN(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var pN=(e,t)=>e.scope_===t,mN=[];function gN(e,t,n,r){var i;const o=GO(e),a=e.type_;if(void 0!==r){if(LO(o,r,a)===t)return void BO(o,r,n,a)}if(!e.draftLocations_){const t=e.draftLocations_=new Map;MO(o,(e,n)=>{if(OO(n)){const r=t.get(n)||[];r.push(e),t.set(n,r)}})}const s=null!==(i=e.draftLocations_.get(t))&&void 0!==i?i:mN;for(const u of s)BO(o,u,n,a)}function vN(e,t){var n,r;if(e.modified_&&!e.finalized_&&(3===e.type_||1===e.type_&&e.allIndicesReassigned_||(null!==(n=null===(r=e.assigned_)||void 0===r?void 0:r.size)&&void 0!==n?n:0)>0)){const{patchPlugin_:n}=t;if(n){const r=n.getPath(e);r&&n.generatePatches_(e,r,t)}fN(e)}}function yN(e,t,n){const{scope_:r}=e;if(OO(n)){const i=n[xO];pN(i,r)&&i.callbacks_.push(function(){kN(e);const r=KO(i);gN(e,n,r,t)})}else NO(n)&&e.callbacks_.push(function(){const i=GO(e);var o;3===e.type_?i.has(n)&&bN(n,r.handledSet_,r):LO(i,t,e.type_)===n&&r.drafts_.length>1&&!0===(null!==(o=e.assigned_.get(t))&&void 0!==o&&o)&&e.copy_&&bN(LO(e.copy_,t,e.type_),r.handledSet_,r)})}function bN(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||OO(e)||t.has(e)||!NO(e)||$O(e)||(t.add(e),MO(e,(r,i)=>{if(OO(i)){const t=i[xO];if(pN(t,n)){const n=KO(t);BO(e,r,n,e.type_),fN(t)}}else NO(i)&&bN(i,t,n)})),e}var xN={get(e,t){if(t===xO)return e;let n=e.scope_.arrayMethodsPlugin_;const r=1===e.type_&&"string"===typeof t;if(r&&null!==n&&void 0!==n&&n.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const i=GO(e);if(!FO(i,t,e.type_))return function(e,t,n){var r;const i=_N(t,n);return i?AO in i?i[AO]:null===(r=i.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,i,t);const o=i[t];if(e.finalized_||!NO(o))return o;if(r&&e.operationMethod&&null!==n&&void 0!==n&&n.isMutatingArrayMethod(e.operationMethod)&&function(e){const t=+e;return Number.isInteger(t)&&String(t)===e}(t))return o;if(o===EN(e.base_,t)){kN(e);const n=1===e.type_?+t:t,r=CN(e.scope_,o,e,n);return e.copy_[n]=r}return o},has:(e,t)=>t in GO(e),ownKeys:e=>Reflect.ownKeys(GO(e)),set(e,t,n){const r=_N(GO(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=EN(GO(e),t),i=null===r||void 0===r?void 0:r[xO];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||FO(e.base_,t,e.type_)))return!0;kN(e),SN(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),yN(e,t,n)),!0},deleteProperty:(e,t)=>(kN(e),void 0!==EN(e.base_,t)||t in e.base_?(e.assigned_.set(t,!1),SN(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=GO(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{[TO]:!0,[CO]:1!==e.type_||"length"!==t,[IO]:r[IO],[AO]:n[t]}:r},defineProperty(){wO(11)},getPrototypeOf:e=>_O(e.base_),setPrototypeOf(){wO(12)}},wN={};for(let n in xN){let e=xN[n];wN[n]=function(){const t=arguments;return t[0]=t[0][0],e.apply(this,t)}}function EN(e,t){const n=e[xO];return(n?GO(n):e)[t]}function _N(e,t){if(!(t in e))return;let n=_O(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=_O(n)}}function SN(e){e.modified_||(e.modified_=!0,e.parent_&&SN(e.parent_))}function kN(e){e.copy_||(e.assigned_=new Map,e.copy_=XO(e.base_,e.scope_.immer_.useStrictShallowCopy_))}wN.deleteProperty=function(e,t){return wN.set.call(this,e,t,void 0)},wN.set=function(e,t,n){return xN.set.call(this,e[0],t,n,e[0])};function CN(e,t,n,r){var i,o;const[a,s]=UO(t)?nN(ZO).proxyMap_(t,n):VO(t)?nN(ZO).proxySet_(t,n):function(e,t){const n=zO(e),r={type_:n?1:0,scope_:t?t.scope_:oN(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=r,o=xN;n&&(i=[r],o=wN);const{revoke:a,proxy:s}=Proxy.revocable(i,o);return r.draft_=s,r.revoke_=a,[s,r]}(t,n);return(null!==(i=null===n||void 0===n?void 0:n.scope_)&&void 0!==i?i:oN()).drafts_.push(a),s.callbacks_=null!==(o=null===n||void 0===n?void 0:n.callbacks_)&&void 0!==o?o:[],s.key_=r,n&&void 0!==r?function(e,t,n){e.callbacks_.push(function(r){var i,o;const a=t;if(!a||!pN(a,r))return;null===(i=r.mapSetPlugin_)||void 0===i||i.fixSetContents(a);const s=KO(a);gN(e,null!==(o=a.draft_)&&void 0!==o?o:a,s,n),vN(a,r)})}(n,s,r):s.callbacks_.push(function(e){var t;null===(t=e.mapSetPlugin_)||void 0===t||t.fixSetContents(s);const{patchPlugin_:n}=e;s.modified_&&n&&n.generatePatches_(s,[],e)}),a}function IN(e){return OO(e)||wO(10),TN(e)}function TN(e){if(!NO(e)||$O(e))return e;const t=e[xO];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=XO(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=XO(e,!0);return MO(n,(e,t)=>{BO(n,e,TN(t))},r),t&&(t.finalized_=!1),n}var AN=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(e,t,n)=>{if(HO(e)&&!HO(t)){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return r.produce(e,e=>t.call(this,e,...o))}}let r;if(HO(t)||wO(6),void 0===n||HO(n)||wO(7),NO(e)){const i=lN(this),o=CN(i,e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?sN(i):uN(i)}return aN(i,n),hN(r,i)}if(!e||!WO(e)){if(r=t(e),void 0===r&&(r=e),r===yO&&(r=void 0),this.autoFreeze_&&YO(r,!0),n){const t=[],i=[];nN(JO).generateReplacementPatches_(e,r,{patches_:t,inversePatches_:i}),n(t,i)}return r}wO(1)},this.produceWithPatches=(e,n)=>{if(HO(e))return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,t=>e(t,...i))};let r,i;const o=this.produce(e,n,(e,t)=>{r=e,i=t});return[o,r,i]},qO(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),qO(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),qO(null===e||void 0===e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){NO(e)||wO(8),OO(e)&&(e=IN(e));const t=lN(this),n=CN(t,e,void 0);return n[xO].isManual_=!0,uN(t),n}finishDraft(e,t){const n=e&&e[xO];n&&n.isManual_||wO(9);const{scope_:r}=n;return aN(r,t),hN(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=nN(JO).applyPatches_;return OO(e)?r(e,t):this.produce(e,e=>r(e,t))}},ON=AN.produce;function NN(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var PN=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),DN=()=>Math.random().toString(36).substring(7).split("").join("."),RN={INIT:"@@redux/INIT".concat(DN()),REPLACE:"@@redux/REPLACE".concat(DN()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(DN())};function MN(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function jN(e,t,n){if("function"!==typeof e)throw new Error(NN(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(NN(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(NN(1));return n(jN)(e,t)}let r=e,i=t,o=new Map,a=o,s=0,u=!1;function l(){a===o&&(a=new Map,o.forEach((e,t)=>{a.set(t,e)}))}function c(){if(u)throw new Error(NN(3));return i}function h(e){if("function"!==typeof e)throw new Error(NN(4));if(u)throw new Error(NN(5));let t=!0;l();const n=s++;return a.set(n,e),function(){if(t){if(u)throw new Error(NN(6));t=!1,l(),a.delete(n),o=null}}}function d(e){if(!MN(e))throw new Error(NN(7));if("undefined"===typeof e.type)throw new Error(NN(8));if("string"!==typeof e.type)throw new Error(NN(17));if(u)throw new Error(NN(9));try{u=!0,i=r(i,e)}finally{u=!1}return(o=a).forEach(e=>{e()}),e}d({type:RN.INIT});return{dispatch:d,subscribe:h,getState:c,replaceReducer:function(e){if("function"!==typeof e)throw new Error(NN(10));r=e,d({type:RN.REPLACE})},[PN]:function(){const e=h;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(NN(11));function n(){const e=t;e.next&&e.next(c())}n();return{unsubscribe:e(n)}},[PN](){return this}}}}}function FN(e){const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const r=t[o];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:RN.INIT}))throw new Error(NN(12));if("undefined"===typeof n(void 0,{type:RN.PROBE_UNKNOWN_ACTION()}))throw new Error(NN(13))})}(n)}catch(Fd){i=Fd}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(i)throw i;let o=!1;const a={};for(let i=0;i<r.length;i++){const s=r[i],u=n[s],l=e[s],c=u(l,t);if("undefined"===typeof c){t&&t.type;throw new Error(NN(14))}a[s]=c,o=o||c!==l}return o=o||r.length!==Object.keys(e).length,o?a:e}}function LN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function BN(e){return MN(e)&&"type"in e&&"string"===typeof e.type}function zN(e){return t=>{let{dispatch:n,getState:r}=t;return t=>i=>"function"===typeof i?i(n,r,e):t(i)}}var UN=zN(),VN=zN;const WN=["reducerPath"];var HN="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?LN:LN.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function qN(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(BP(0));return l(l({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>BN(t)&&t.type===e,n}var GN=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function KN(e){return NO(e)?ON(e,()=>{}):e}function XN(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var YN="RTK_autoBatch",QN=()=>e=>({payload:e,meta:{[YN]:!0}}),$N=e=>t=>{setTimeout(t,e)},ZN=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,i=!1,o=!1;const a=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:$N(10):"callback"===e.type?e.queueNotification:$N(e.timeout),u=()=>{o=!1,i&&(i=!1,a.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>r&&e());return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[YN]),i=!r,i&&(o||(o=!0,s(u))),n.dispatch(e)}finally{r=!0}}})}};function JN(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=null!==e&&void 0!==e?e:{};let o=new GN;return t&&(function(e){return"boolean"===typeof e}(t)?o.push(UN):o.push(VN(t.extraArgument))),o},{reducer:n,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:o=!0,preloadedState:a,enhancers:s}=e||{};let u,c;if("function"===typeof n)u=n;else{if(!MN(n))throw new Error(BP(1));u=FN(n)}c="function"===typeof r?r(t):t();let h=LN;i&&(h=HN(l({trace:!1},"object"===typeof i&&i)));const d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const i=e(n,r);let o=()=>{throw new Error(NN(15))};const a={getState:i.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o(e,...n)}},s=t.map(e=>e(a));return o=LN(...s)(i.dispatch),l(l({},i),{},{dispatch:o})}}(...c),f=(e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new GN(e);return n&&r.push(ZN("object"===typeof n?n:void 0)),r})(d);return jN(u,a,h(..."function"===typeof s?s(f):f()))}function eP(e){const t={},n=[];let r;const i={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error(BP(28));if(r in t)throw new Error(BP(29));return t[r]=n,i},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),i),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),i),addDefaultCase:e=>(r=e,i)};return e(i),[t,n,r]}var tP=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e};var nP=Symbol.for("rtk-slice-createasyncthunk");function rP(e,t){return"".concat(e,"/").concat(t)}function iP(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[nP];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error(BP(11));const i=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return l({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},o=Object.keys(i),a={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(BP(12));if(n in a.sliceCaseReducersByType)throw new Error(BP(13));return a.sliceCaseReducersByType[n]=t,s},addMatcher:(e,t)=>(a.sliceMatchers.push({matcher:e,reducer:t}),s),exposeAction:(e,t)=>(a.actionCreators[e]=t,s),exposeCaseReducer:(e,t)=>(a.sliceCaseReducersByName[e]=t,s)};function u(){const[t={},n=[],r]="function"===typeof e.extraReducers?eP(e.extraReducers):[e.extraReducers],i=l(l({},t),a.sliceCaseReducersByType);return function(e,t){let n,[r,i,o]=eP(t);if(function(e){return"function"===typeof e}(e))n=()=>KN(e());else{const t=KN(e);n=()=>t}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,a=[r[t.type],...i.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===a.filter(e=>!!e).length&&(a=[o]),a.reduce((e,n)=>{if(n){if(OO(e)){const r=n(e,t);return void 0===r?e:r}if(NO(e))return ON(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return a.getInitialState=n,a}(e.initialState,e=>{for(let t in i)e.addCase(t,i[t]);for(let t of a.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}o.forEach(r=>{const o=i[r],a={reducerName:r,type:rP(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(o)?function(e,t,n){let r,i,{type:o,reducerName:a,createNotation:s}=e;if("reducer"in t){if(s&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(BP(17));r=t.reducer,i=t.prepare}else r=t;n.addCase(o,r).exposeCaseReducer(a,r).exposeAction(a,i?qN(o,i):qN(o))}(a,o,s):function(e,t,n,r){let{type:i,reducerName:o}=e;if(!r)throw new Error(BP(18));const{payloadCreator:a,fulfilled:s,pending:u,rejected:l,settled:c,options:h}=t,d=r(i,a,h);n.exposeAction(o,d),s&&n.addCase(d.fulfilled,s);u&&n.addCase(d.pending,u);l&&n.addCase(d.rejected,l);c&&n.addMatcher(d.settled,c);n.exposeCaseReducer(o,{fulfilled:s||sP,pending:u||sP,rejected:l||sP,settled:c||sP})}(a,o,s,n)});const h=e=>e,d=new Map,f=new WeakMap;let p;function m(e,t){return p||(p=u()),p(e,t)}function g(){return p||(p=u()),p.getInitialState()}function v(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let i=e[t];return"undefined"===typeof i&&n&&(i=XN(f,r,g)),i}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;const r=XN(d,n,()=>new WeakMap);return XN(r,t,()=>{const r={};for(const[o,a]of Object.entries(null!==(i=e.selectors)&&void 0!==i?i:{})){var i;r[o]=oP(a,t,()=>XN(f,t,g),n)}return r})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const y=l(l({name:t,reducer:m,actions:a.actionCreators,caseReducers:a.sliceCaseReducersByName,getInitialState:g},v(r)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,i=c(t,WN);const o=null!==n&&void 0!==n?n:r;return e.inject({reducerPath:o,reducer:m},i),l(l({},y),v(o,!0))}});return y}}function oP(e,t,n,r){function i(i){let o=t(i);"undefined"===typeof o&&r&&(o=n());for(var a=arguments.length,s=new Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=arguments[u];return e(o,...s)}return i.unwrapped=e,i}var aP=iP();function sP(){}var uP="listener",lP="completed",cP="cancelled",hP="task-".concat(cP),dP="task-".concat(lP),fP="".concat(uP,"-").concat(cP),pP="".concat(uP,"-").concat(lP),mP=class{constructor(e){s(this,"name","TaskAbortError"),s(this,"message",void 0),this.code=e,this.message="".concat("task"," ").concat(cP," (reason: ").concat(e,")")}},gP=(e,t)=>{if("function"!==typeof e)throw new TypeError(BP(32))},vP=()=>{},yP=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vP;return e.catch(t),e},bP=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),xP=e=>{if(e.aborted)throw new mP(e.reason)};function wP(e,t){let n=vP;return new Promise((r,i)=>{const o=()=>i(new mP(e.reason));e.aborted?o():(n=bP(e,o),t.finally(()=>n()).then(r,i))}).finally(()=>{n=vP})}var EP=e=>t=>yP(wP(e,t).then(t=>(xP(e),t))),_P=e=>{const t=EP(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:SP}=Object,kP={},CP="listenerMiddleware",IP=(e,t)=>(n,r)=>{gP(n);const i=new AbortController;var o;o=i,bP(e,()=>o.abort(e.reason));const a=(async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof mP?"cancelled":"rejected",error:n}}finally{null===t||void 0===t||t()}})(async()=>{xP(e),xP(i.signal);const t=await n({pause:EP(i.signal),delay:_P(i.signal),signal:i.signal});return xP(i.signal),t},()=>i.abort(dP));return null!==r&&void 0!==r&&r.autoJoin&&t.push(a.catch(vP)),{result:EP(e)(a),cancel(){i.abort(hP)}}},TP=(e,t)=>(n,r)=>yP((async(n,r)=>{xP(t);let i=()=>{};const o=[new Promise((t,r)=>{let o=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});i=()=>{o(),r()}})];null!=r&&o.push(new Promise(e=>setTimeout(e,r,null)));try{const e=await wP(t,Promise.race(o));return xP(t),e}finally{i()}})(n,r)),AP=e=>{let{type:t,actionCreator:n,matcher:r,predicate:i,effect:o}=e;if(t)i=qN(t).match;else if(n)t=n.type,i=n.match;else if(r)i=r;else if(!i)throw new Error(BP(21));return gP(o),{predicate:i,type:t,effect:o}},OP=SP(e=>{const{type:t,predicate:n,effect:r}=AP(e);return{id:tP(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(BP(22))}}},{withTypes:()=>OP}),NP=(e,t)=>{const{type:n,effect:r,predicate:i}=AP(t);return Array.from(e.values()).find(e=>("string"===typeof n?e.type===n:e.predicate===i)&&e.effect===r)},PP=e=>{e.pending.forEach(e=>{e.abort(fP)})},DP=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},RP=SP(qN("".concat(CP,"/add")),{withTypes:()=>RP}),MP=qN("".concat(CP,"/removeAll")),jP=SP(qN("".concat(CP,"/remove")),{withTypes:()=>jP}),FP=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("".concat(CP,"/error"),...t)},LP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map,n=new Map,{extra:r,onError:i=FP}=e;gP(i);const o=e=>{var n;return(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),null!==t&&void 0!==t&&t.cancelActive&&PP(e)}))(null!==(n=NP(t,e))&&void 0!==n?n:OP(e))};SP(o,{withTypes:()=>o});const a=e=>{const n=NP(t,e);return n&&(n.unsubscribe(),e.cancelActive&&PP(n)),!!n};SP(a,{withTypes:()=>a});const s=async(e,a,s,u)=>{const l=new AbortController,c=TP(o,l.signal),h=[];try{e.pending.add(l),(e=>{var t;const r=null!==(t=n.get(e))&&void 0!==t?t:0;n.set(e,r+1)})(e),await Promise.resolve(e.effect(a,SP({},s,{getOriginalState:u,condition:(e,t)=>c(e,t).then(Boolean),take:c,delay:_P(l.signal),pause:EP(l.signal),extra:r,signal:l.signal,fork:IP(l.signal,h),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==l&&(e.abort(fP),n.delete(e))})},cancel:()=>{l.abort(fP),e.pending.delete(l)},throwIfCancelled:()=>{xP(l.signal)}})))}catch(d){d instanceof mP||DP(i,d,{raisedBy:"effect"})}finally{await Promise.all(h),l.abort(pP),(e=>{var t;const r=null!==(t=n.get(e))&&void 0!==t?t:1;1===r?n.delete(e):n.set(e,r-1)})(e),e.pending.delete(l)}},u=((e,t)=>()=>{for(const e of t.keys())PP(e);e.clear()})(t,n);return{middleware:e=>n=>r=>{if(!BN(r))return n(r);if(RP.match(r))return o(r.payload);if(MP.match(r))return void u();if(jP.match(r))return a(r.payload);let l=e.getState();const c=()=>{if(l===kP)throw new Error(BP(23));return l};let h;try{if(h=n(r),t.size>0){const n=e.getState(),o=Array.from(t.values());for(const t of o){let o=!1;try{o=t.predicate(r,n,l)}catch(d){o=!1,DP(i,d,{raisedBy:"predicate"})}o&&s(t,r,e,c)}}}finally{l=kP}return h},startListening:o,stopListening:a,clearListeners:u}};Symbol.for("rtk-state-proxy-original");function BP(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}function zP(e,t){if(t){var n=Number.parseInt(t,10);if(!zA(n))return null===e||void 0===e?void 0:e[n]}}var UP=aP({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),VP=UP.reducer,{createEventEmitter:WP}=UP.actions;n(7237);function HP(e){e()}var qP={notify(){},get:()=>[]};function GP(e,t){let n,r=qP,i=0,o=!1;function a(){l.onStateChange&&l.onStateChange()}function s(){i++,n||(n=t?t.addNestedSub(a):e.subscribe(a),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){HP(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())}function u(){i--,n&&0===i&&(n(),n=void 0,r.clear(),r=qP)}const l={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),u())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:a,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,s())},tryUnsubscribe:function(){o&&(o=!1,u())},getListeners:()=>r};return l}var KP=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),XP=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),YP=(()=>KP||XP?t.useLayoutEffect:t.useEffect)();function QP(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function $P(e,t){if(QP(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!QP(e[n[i]],t[n[i]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var ZP=Symbol.for("react-redux-context"),JP="undefined"!==typeof globalThis?globalThis:{};function eD(){var e;if(!t.createContext)return{};const n=null!==(e=JP[ZP])&&void 0!==e?e:JP[ZP]=new Map;let r=n.get(t.createContext);return r||(r=t.createContext(null),n.set(t.createContext,r)),r}var tD=eD();var nD=function(e){const{children:n,context:r,serverState:i,store:o}=e,a=t.useMemo(()=>{const e=GP(o);return{store:o,subscription:e,getServerState:i?()=>i:void 0}},[o,i]),s=t.useMemo(()=>o.getState(),[o]);YP(()=>{const{subscription:e}=a;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==o.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[a,s]);const u=r||tD;return t.createElement(u.Provider,{value:a},n)};var rD=Symbol.for("immer-nothing"),iD=Symbol.for("immer-draftable"),oD=Symbol.for("immer-state");function aD(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var sD=Object.getPrototypeOf;function uD(e){return!!e&&!!e[oD]}function lD(e){var t;return!!e&&(dD(e)||Array.isArray(e)||!!e[iD]||!(null===(t=e.constructor)||void 0===t||!t[iD])||vD(e)||yD(e))}var cD=Object.prototype.constructor.toString(),hD=new WeakMap;function dD(e){if(!e||"object"!==typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!==typeof n)return!1;let r=hD.get(n);return void 0===r&&(r=Function.toString.call(n),hD.set(n,r)),r===cD}function fD(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===pD(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function pD(e){const t=e[oD];return t?t.type_:Array.isArray(e)?1:vD(e)?2:yD(e)?3:0}function mD(e,t){return 2===pD(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function gD(e,t,n){const r=pD(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function vD(e){return e instanceof Map}function yD(e){return e instanceof Set}function bD(e){return e.copy_||e.base_}function xD(e,t){if(vD(e))return new Map(e);if(yD(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=dD(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[oD];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(sD(e),t)}{const t=sD(e);if(null!==t&&n)return l({},e);const r=Object.create(t);return Object.assign(r,e)}}function wD(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _D(e)||uD(e)||!lD(e)||(pD(e)>1&&Object.defineProperties(e,{set:ED,add:ED,clear:ED,delete:ED}),Object.freeze(e),t&&Object.values(e).forEach(e=>wD(e,!0))),e}var ED={value:function(){aD(2)}};function _D(e){return null===e||"object"!==typeof e||Object.isFrozen(e)}var SD,kD={};function CD(e){const t=kD[e];return t||aD(0),t}function ID(){return SD}function TD(e,t){t&&(CD("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function AD(e){OD(e),e.drafts_.forEach(PD),e.drafts_=null}function OD(e){e===SD&&(SD=e.parent_)}function ND(e){return SD={drafts_:[],parent_:SD,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function PD(e){const t=e[oD];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function DD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[oD].modified_&&(AD(t),aD(4)),lD(e)&&(e=RD(t,e),t.parent_||jD(t,e)),t.patches_&&CD("Patches").generateReplacementPatches_(n[oD].base_,e,t.patches_,t.inversePatches_)):e=RD(t,n,[]),AD(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==rD?e:void 0}function RD(e,t,n){if(_D(t))return t;const r=e.immer_.shouldUseStrictIteration(),i=t[oD];if(!i)return fD(t,(r,o)=>MD(e,i,t,r,o,n),r),t;if(i.scope_!==e)return t;if(!i.modified_)return jD(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const t=i.copy_;let o=t,a=!1;3===i.type_&&(o=new Set(t),t.clear(),a=!0),fD(o,(r,o)=>MD(e,i,t,r,o,n,a),r),jD(e,t,!1),n&&e.patches_&&CD("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function MD(e,t,n,r,i,o,a){if(null==i)return;if("object"!==typeof i&&!a)return;const s=_D(i);if(!s||a){if(uD(i)){const a=RD(e,i,o&&t&&3!==t.type_&&!mD(t.assigned_,r)?o.concat(r):void 0);if(gD(n,r,a),!uD(a))return;e.canAutoFreeze_=!1}else a&&n.add(i);if(lD(i)&&!s){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[r]===i&&s)return;RD(e,i),t&&t.scope_.parent_||"symbol"===typeof r||!(vD(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||jD(e,i)}}}function jD(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&wD(t,n)}var FD={get(e,t){if(t===oD)return e;const n=bD(e);if(!mD(n,t))return function(e,t,n){var r;const i=zD(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!lD(r)?r:r===BD(e.base_,t)?(VD(e),e.copy_[t]=WD(r,e)):r},has:(e,t)=>t in bD(e),ownKeys:e=>Reflect.ownKeys(bD(e)),set(e,t,n){const r=zD(bD(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=BD(bD(e),t),i=null===r||void 0===r?void 0:r[oD];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||mD(e.base_,t)))return!0;VD(e),UD(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==BD(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,VD(e),UD(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=bD(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){aD(11)},getPrototypeOf:e=>sD(e.base_),setPrototypeOf(){aD(12)}},LD={};function BD(e,t){const n=e[oD];return(n?bD(n):e)[t]}function zD(e,t){if(!(t in e))return;let n=sD(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=sD(n)}}function UD(e){e.modified_||(e.modified_=!0,e.parent_&&UD(e.parent_))}function VD(e){e.copy_||(e.copy_=xD(e.base_,e.scope_.immer_.useStrictShallowCopy_))}fD(FD,(e,t)=>{LD[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),LD.deleteProperty=function(e,t){return LD.set.call(this,e,t,void 0)},LD.set=function(e,t,n){return FD.set.call(this,e[0],t,n,e[0])};function WD(e,t){const n=vD(e)?CD("MapSet").proxyMap_(e,t):yD(e)?CD("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:ID(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,o=FD;n&&(i=[r],o=LD);const{revoke:a,proxy:s}=Proxy.revocable(i,o);return r.draft_=s,r.revoke_=a,s}(e,t);return(t?t.scope_:ID()).drafts_.push(n),n}function HD(e){if(!lD(e)||_D(e))return e;const t=e[oD];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=xD(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=xD(e,!0);return fD(n,(e,t)=>{gD(n,e,HD(t))},r),t&&(t.finalized_=!1),n}var qD=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return r.produce(e,e=>t.call(this,e,...o))}}let r;if("function"!==typeof t&&aD(6),void 0!==n&&"function"!==typeof n&&aD(7),lD(e)){const i=ND(this),o=WD(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?AD(i):OD(i)}return TD(i,n),DD(r,i)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===rD&&(r=void 0),this.autoFreeze_&&wD(r,!0),n){const t=[],i=[];CD("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}aD(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,t=>e(t,...i))};let r,i;const o=this.produce(e,n,(e,t)=>{r=e,i=t});return[o,r,i]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){lD(e)||aD(8),uD(e)&&(e=function(e){uD(e)||aD(10);return HD(e)}(e));const t=ND(this),n=WD(e,void 0);return n[oD].isManual_=!0,OD(t),n}finishDraft(e,t){const n=e&&e[oD];n&&n.isManual_||aD(9);const{scope_:r}=n;return TD(r,t),DD(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=CD("Patches").applyPatches_;return uD(e)?r(e,t):this.produce(e,e=>r(e,t))}};qD.produce;var GD={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},KD=aP({name:"tooltip",initialState:{itemInteraction:{click:GD,hover:GD},axisInteraction:{click:GD,hover:GD},keyboardInteraction:GD,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:QN()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:r}=t.payload,i=IN(e).tooltipItemPayloads.indexOf(n);i>-1&&(e.tooltipItemPayloads[i]=r)},prepare:QN()},removeTooltipEntrySettings:{reducer(e,t){var n=IN(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:QN()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:XD,replaceTooltipEntrySettings:YD,removeTooltipEntrySettings:QD,setTooltipSettingsState:$D,setActiveMouseOverItemIndex:ZD,mouseLeaveItem:JD,mouseLeaveChart:eR,setActiveClickItemIndex:tR,setMouseOverAxisIndex:nR,setMouseClickAxisIndex:rR,setSyncInteraction:iR,setKeyboardInteraction:oR}=KD.actions,aR=KD.reducer,sR=aP({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:uR,setDataStartEndIndexes:lR,setComputedData:cR}=sR.actions,hR=sR.reducer,dR=aP({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,i,o;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(i=t.payload.bottom)&&void 0!==i?i:0,e.margin.left=null!==(o=t.payload.left)&&void 0!==o?o:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:fR,setLayout:pR,setChartSize:mR,setScale:gR}=dR.actions,vR=dR.reducer;function yR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var bR=e=>Array.isArray(e)?e:[e];function xR(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every(e=>"function"===typeof e)){const n=e.map(e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e).join(", ");throw new TypeError("".concat(t,"[").concat(n,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var wR="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function ER(){return{s:0,v:void 0,o:null,p:null}}function _R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let i,o=0;function a(){let t=n;const{length:a}=arguments;for(let e=0,n=a;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=ER(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=ER(),e.set(n,t)):t=r}}const s=t;let u;if(1===t.s)u=t.v;else if(u=e.apply(null,arguments),o++,r){var l,c,h;const e=null!==(l=null===(c=i)||void 0===c||null===(h=c.deref)||void 0===h?void 0:h.call(c))&&void 0!==l?l:i;null!=e&&r(e,u)&&(u=e,0!==o&&o--);i="object"===typeof u&&null!==u||"function"===typeof u?new wR(u):u}return s.s=1,s.v=u,u}return a.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},a.resetResultsCount()},a.resultsCount=()=>o,a.resetResultsCount=()=>{o=0},a}function SR(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="function"===typeof e?{memoize:e,memoizeOptions:n}:e,o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,o=0,a=0,s={},u=t.pop();"object"===typeof u&&(s=u,u=t.pop()),yR(u,"createSelector expects an output function after the inputs, but received: [".concat(typeof u,"]"));const c=l(l({},i),s),{memoize:h,memoizeOptions:d=[],argsMemoize:f=_R,argsMemoizeOptions:p=[],devModeChecks:m={}}=c,g=bR(d),v=bR(p),y=xR(t),b=h(function(){return o++,u.apply(null,arguments)},...g);const x=f(function(){a++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(y,arguments);return r=b.apply(null,e),r},...v);return Object.assign(x,{resultFunc:u,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>r,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:h,argsMemoize:f})};return Object.assign(o,{withTypes:()=>o}),o}var kR=SR(_R),CR=Object.assign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kR;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const n=Object.keys(e),r=t(n.map(t=>e[t]),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t,r)=>(e[n[r]]=t,e),{})});return r},{withTypes:()=>CR}),IR=n(8443),TR=(0,t.createContext)(null),AR=e=>e,OR=()=>{var e=(0,t.useContext)(TR);return e?e.store.dispatch:AR},NR=()=>{},PR=()=>NR,DR=(e,t)=>e===t;function RR(e){var n=(0,t.useContext)(TR);return(0,IR.useSyncExternalStoreWithSelector)(n?n.subscription.addNestedSub:PR,n?n.store.getState:NR,n?n.store.getState:NR,n?e:NR,DR)}var MR=n(3821),jR=n.n(MR),FR=e=>e.legend.settings,LR=kR([e=>e.legend.payload,FR],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?jR()(r,n):r});function BR(e,t){if((i=e.length)>1)for(var n,r,i,o=1,a=e[t[0]],s=a.length;o<i;++o)for(r=a,a=e[t[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}Array.prototype.slice;function zR(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function UR(e){return function(){return e}}function VR(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function WR(e,t){return e[t]}function HR(e){const t=[];return t.key=e,t}function qR(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function GR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function KR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GR(Object(n),!0).forEach(function(t){XR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function XR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YR(e,t,n){return QA(e)||QA(t)?n:WA(t)?jA()(e,t,n):"function"===typeof t?t(e):n}var QR=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,$R=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var i,o,a=e.map(e=>(e.coordinate===t&&(i=!0),e.coordinate===n&&(o=!0),e.coordinate));return i||a.push(t),o||a.push(n),a},ZR=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:i,range:o,scale:a,realScaleType:s,isCategorical:u,categoricalDomain:l,tickCount:c,ticks:h,niceTicks:d,axisType:f}=e;if(!a)return null;var p="scaleBand"===s&&a.bandwidth?a.bandwidth()/2:2,m=(t||n)&&"category"===i&&a.bandwidth?a.bandwidth()/p:0;return m="angleAxis"===f&&o&&o.length>=2?2*BA(o[0]-o[1])*m:m,t&&(h||d)?(h||d||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:a(n)+m,value:e,offset:m,index:t}}).filter(e=>!zA(e.coordinate)):u&&l?l.map((e,t)=>({coordinate:a(e)+m,value:e,index:t,offset:m})):a.ticks&&!n&&null!=c?a.ticks(c).map((e,t)=>({coordinate:a(e)+m,value:e,offset:m,index:t})):a.domain().map((e,t)=>({coordinate:a(e)+m,value:r?r[e]:e,index:t,offset:m}))},JR=1e-4,eM={sign:e=>{var t,n=e.length;if(!(n<=0)){var r=null===(t=e[0])||void 0===t?void 0:t.length;if(!(null==r||r<=0))for(var i=0;i<r;++i)for(var o=0,a=0,s=0;s<n;++s){var u=e[s],l=null===u||void 0===u?void 0:u[i];if(null!=l){var c=l[1],h=l[0],d=zA(c)?h:c;d>=0?(l[0]=o,l[1]=o+d,o=c):(l[0]=a,l[1]=a+d,a=c)}}}},expand:function(e,t){if((r=e.length)>0){for(var n,r,i,o=0,a=e[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=e[n][o][1]||0;if(i)for(n=0;n<r;++n)e[n][o][1]/=i}BR(e,t)}},none:BR,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=e[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}BR(e,t)}},wiggle:function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,u=0,l=0;s<i;++s){for(var c=e[t[s]],h=c[a][1]||0,d=(h-(c[a-1][1]||0))/2,f=0;f<s;++f){var p=e[t[f]];d+=(p[a][1]||0)-(p[a-1][1]||0)}u+=h,l+=d*h}n[a-1][1]+=n[a-1][0]=o,u&&(o-=l/u)}n[a-1][1]+=n[a-1][0]=o,BR(e,t)}},positive:e=>{var t,n=e.length;if(!(n<=0)){var r=null===(t=e[0])||void 0===t?void 0:t.length;if(!(null==r||r<=0))for(var i=0;i<r;++i)for(var o=0,a=0;a<n;++a){var s=e[a],u=null===s||void 0===s?void 0:s[i];if(null!=u){var l=zA(u[1])?u[0]:u[1];l>=0?(u[0]=o,u[1]=o+l,o=u[1]):(u[0]=0,u[1]=0)}}}}},tM=(e,t,n)=>{var r,i=null!==(r=eM[n])&&void 0!==r?r:BR,o=function(){var e=UR([]),t=VR,n=BR,r=WR;function i(i){var o,a,s=Array.from(e.apply(this,arguments),HR),u=s.length,l=-1;for(const e of i)for(o=0,++l;o<u;++o)(s[o][l]=[0,+r(e,s[o].key,l,i)]).data=e;for(o=0,a=zR(t(s));o<u;++o)s[a[o]].index=o;return n(s,a),s}return i.keys=function(t){return arguments.length?(e="function"===typeof t?t:UR(Array.from(t)),i):e},i.value=function(e){return arguments.length?(r="function"===typeof e?e:UR(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?VR:"function"===typeof e?e:UR(Array.from(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?BR:e,i):n},i}().keys(t).value((e,t)=>Number(YR(e,t,0))).order(VR).offset(i),a=o(e);return a.forEach((n,r)=>{n.forEach((n,i)=>{var o=YR(e[i],t[r],0);Array.isArray(o)&&2===o.length&&VA(o[0])&&VA(o[1])&&(n[0]=o[0],n[1]=o[1])})}),a};function nM(e){var{axis:t,ticks:n,bandSize:r,entry:i,index:o,dataKey:a}=e;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!QA(i[t.dataKey])){var s=YA(n,"value",i[t.dataKey]);if(s)return s.coordinate+r/2}return n[o]?n[o].coordinate+r/2:null}var u=YR(i,QA(a)?t.dataKey:a);return QA(u)?null:t.scale(u)}var rM=e=>{var{axis:t,ticks:n,offset:r,bandSize:i,entry:o,index:a}=e;if("category"===t.type)return n[a]?n[a].coordinate+r:null;var s=YR(o,t.dataKey,t.scale.domain()[a]);return QA(s)?null:t.scale(s)-i/2+r},iM=(e,t,n)=>{var r;if(null!=e)return r=Object.keys(e).reduce((r,i)=>{var o=e[i];if(!o)return r;var{stackedData:a}=o,s=a.reduce((e,r)=>{var i=(e=>{var t=e.flat(2).filter(VA);return[Math.min(...t),Math.max(...t)]})(qR(r,t,n));return sO(i[0])&&sO(i[1])?[Math.min(e[0],i[0]),Math.max(e[1],i[1])]:e},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]),[r[0]===1/0?0:r[0],r[1]===-1/0?0:r[1]]},oM=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,aM=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,sM=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var i=jR()(t,e=>e.coordinate),o=1/0,a=1,s=i.length;a<s;a++){var u=i[a],l=i[a-1];o=Math.min(((null===u||void 0===u?void 0:u.coordinate)||0)-((null===l||void 0===l?void 0:l.coordinate)||0),o)}return o===1/0?0:o}return n?void 0:0};function uM(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:i,name:o}=e;return KR(KR({},t),{},{dataKey:n,payload:r,value:i,name:o})}function lM(e,t){return e?String(e):"string"===typeof t?t:void 0}var cM=e=>e.layout.width,hM=e=>e.layout.height,dM=e=>e.layout.scale,fM=e=>e.layout.margin,pM=kR(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),mM=kR(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),gM="data-recharts-item-index",vM="data-recharts-item-id";function yM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yM(Object(n),!0).forEach(function(t){xM(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yM(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wM=kR([cM,hM,fM,e=>e.brush.height,function(e){return mM(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return mM(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return pM(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return pM(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},FR,e=>e.legend.size],(e,t,n,r,i,o,a,s,u,l)=>{var c={left:(n.left||0)+i,right:(n.right||0)+o},h=bM(bM({},{top:(n.top||0)+a,bottom:(n.bottom||0)+s}),c),d=h.bottom;h.bottom+=r,h=((e,t,n)=>{if(t&&n){var{width:r,height:i}=n,{align:o,verticalAlign:a,layout:s}=t;if(("vertical"===s||"horizontal"===s&&"middle"===a)&&"center"!==o&&VA(e[o]))return KR(KR({},e),{},{[o]:e[o]+(r||0)});if(("horizontal"===s||"vertical"===s&&"center"===o)&&"middle"!==a&&VA(e[a]))return KR(KR({},e),{},{[a]:e[a]+(i||0)})}return e})(h,u,l);var f=e-h.left-h.right,p=t-h.top-h.bottom;return bM(bM({brushBottom:d},h),{},{width:Math.max(f,0),height:Math.max(p,0)})}),EM=kR(wM,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),_M=kR(cM,hM,(e,t)=>({x:0,y:0,width:e,height:t})),SM=(0,t.createContext)(null),kM=()=>null!=(0,t.useContext)(SM),CM=e=>e.brush,IM=kR([CM,wM,fM],(e,t,n)=>({height:e.height,x:VA(e.x)?e.x:t.left,y:VA(e.y)?e.y:t.top+t.height+t.brushBottom-((null===n||void 0===n?void 0:n.bottom)||0),width:VA(e.width)?e.width:t.width}));function TM(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var AM=()=>{var e,t=kM(),n=RR(EM),r=RR(IM),i=null===(e=RR(CM))||void 0===e?void 0:e.padding;return t&&r&&i?{width:r.width-i.left-i.right,height:r.height-i.top-i.bottom,x:i.left,y:i.top}:n},OM={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},NM=()=>{var e;return null!==(e=RR(wM))&&void 0!==e?e:OM},PM=()=>RR(cM),DM=()=>RR(hM),RM=e=>e.layout.layoutType,MM=()=>RR(RM),jM=e=>{var n=OR(),r=kM(),{width:i,height:o}=e,a=mO(),s=i,u=o;return a&&(s=a.width>0?a.width:i,u=a.height>0?a.height:o),(0,t.useEffect)(()=>{!r&&uO(s)&&uO(u)&&n(mR({width:s,height:u}))},[n,r,s,u]),null},FM=n(9859),LM=n.n(FM);function BM(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function zM(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class UM extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qM;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(VM(this,e))}has(e){return super.has(VM(this,e))}set(e,t){return super.set(WM(this,e),t)}delete(e){return super.delete(HM(this,e))}}Set;function VM(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function WM(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function HM(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function qM(e){return null!==e&&"object"===typeof e?e.valueOf():e}const GM=Symbol("implicit");function KM(){var e=new UM,t=[],n=[],r=GM;function i(i){let o=e.get(i);if(void 0===o){if(r!==GM)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new UM;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return KM(t,n).unknown(r)},BM.apply(i,arguments),i}function XM(){var e,t,n=KM().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,s=!1,u=0,l=0,c=.5;function h(){var n=r().length,h=a<o,d=h?a:o,f=h?o:a;e=(f-d)/Math.max(1,n-u+2*l),s&&(e=Math.floor(e)),d+=(f-d-e*(n-u))*c,t=e*(1-u),s&&(d=Math.round(d),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(n).map(function(t){return d+e*t});return i(h?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?([o,a]=e,o=+o,a=+a,h()):[o,a]},n.rangeRound=function(e){return[o,a]=e,o=+o,a=+a,s=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,h()):s},n.padding=function(e){return arguments.length?(u=Math.min(1,l=+e),h()):u},n.paddingInner=function(e){return arguments.length?(u=Math.min(1,e),h()):u},n.paddingOuter=function(e){return arguments.length?(l=+e,h()):l},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),h()):c},n.copy=function(){return XM(r(),[o,a]).round(s).paddingInner(u).paddingOuter(l).align(c)},BM.apply(h(),arguments)}function YM(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return YM(t())},e}function QM(){return YM(XM.apply(null,arguments).paddingInner(1))}const $M=Math.sqrt(50),ZM=Math.sqrt(10),JM=Math.sqrt(2);function ej(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=$M?10:o>=ZM?5:o>=JM?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?ej(e,t,2*n):[s,u,l]}function tj(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?ej(t,e,n):ej(e,t,n);if(!(o>=i))return[];const s=o-i+1,u=new Array(s);if(r)if(a<0)for(let l=0;l<s;++l)u[l]=(o-l)/-a;else for(let l=0;l<s;++l)u[l]=(o-l)*a;else if(a<0)for(let l=0;l<s;++l)u[l]=(i+l)/-a;else for(let l=0;l<s;++l)u[l]=(i+l)*a;return u}function nj(e,t,n){return ej(e=+e,t=+t,n=+n)[2]}function rj(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?nj(t,e,n):nj(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function ij(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function oj(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function aj(e){let t,n,r;function i(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=ij,n=(t,n)=>ij(e(t),n),r=(t,n)=>e(t)-n):(t=e===ij||e===oj?e:sj,n=e,r=e),{left:i,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function sj(){return 0}function uj(e){return null===e?NaN:+e}const lj=aj(ij),cj=lj.right,hj=(lj.left,aj(uj).center,cj);function dj(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function fj(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function pj(){}var mj=.7,gj=1/mj,vj="\\s*([+-]?\\d+)\\s*",yj="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bj="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xj=/^#([0-9a-f]{3,8})$/,wj=new RegExp("^rgb\\(".concat(vj,",").concat(vj,",").concat(vj,"\\)$")),Ej=new RegExp("^rgb\\(".concat(bj,",").concat(bj,",").concat(bj,"\\)$")),_j=new RegExp("^rgba\\(".concat(vj,",").concat(vj,",").concat(vj,",").concat(yj,"\\)$")),Sj=new RegExp("^rgba\\(".concat(bj,",").concat(bj,",").concat(bj,",").concat(yj,"\\)$")),kj=new RegExp("^hsl\\(".concat(yj,",").concat(bj,",").concat(bj,"\\)$")),Cj=new RegExp("^hsla\\(".concat(yj,",").concat(bj,",").concat(bj,",").concat(yj,"\\)$")),Ij={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Tj(){return this.rgb().formatHex()}function Aj(){return this.rgb().formatRgb()}function Oj(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=xj.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Nj(t):3===n?new Rj(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Pj(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Pj(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=wj.exec(e))?new Rj(t[1],t[2],t[3],1):(t=Ej.exec(e))?new Rj(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=_j.exec(e))?Pj(t[1],t[2],t[3],t[4]):(t=Sj.exec(e))?Pj(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=kj.exec(e))?zj(t[1],t[2]/100,t[3]/100,1):(t=Cj.exec(e))?zj(t[1],t[2]/100,t[3]/100,t[4]):Ij.hasOwnProperty(e)?Nj(Ij[e]):"transparent"===e?new Rj(NaN,NaN,NaN,0):null}function Nj(e){return new Rj(e>>16&255,e>>8&255,255&e,1)}function Pj(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rj(e,t,n,r)}function Dj(e,t,n,r){return 1===arguments.length?function(e){return e instanceof pj||(e=Oj(e)),e?new Rj((e=e.rgb()).r,e.g,e.b,e.opacity):new Rj}(e):new Rj(e,t,n,null==r?1:r)}function Rj(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Mj(){return"#".concat(Bj(this.r)).concat(Bj(this.g)).concat(Bj(this.b))}function jj(){const e=Fj(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Lj(this.r),", ").concat(Lj(this.g),", ").concat(Lj(this.b)).concat(1===e?")":", ".concat(e,")"))}function Fj(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Lj(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Bj(e){return((e=Lj(e))<16?"0":"")+e.toString(16)}function zj(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Vj(e,t,n,r)}function Uj(e){if(e instanceof Vj)return new Vj(e.h,e.s,e.l,e.opacity);if(e instanceof pj||(e=Oj(e)),!e)return new Vj;if(e instanceof Vj)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Vj(a,s,u,e.opacity)}function Vj(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Wj(e){return(e=(e||0)%360)<0?e+360:e}function Hj(e){return Math.max(0,Math.min(1,e||0))}function qj(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Gj(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}dj(pj,Oj,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Tj,formatHex:Tj,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Uj(this).formatHsl()},formatRgb:Aj,toString:Aj}),dj(Rj,Dj,fj(pj,{brighter(e){return e=null==e?gj:Math.pow(gj,e),new Rj(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?mj:Math.pow(mj,e),new Rj(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rj(Lj(this.r),Lj(this.g),Lj(this.b),Fj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mj,formatHex:Mj,formatHex8:function(){return"#".concat(Bj(this.r)).concat(Bj(this.g)).concat(Bj(this.b)).concat(Bj(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:jj,toString:jj})),dj(Vj,function(e,t,n,r){return 1===arguments.length?Uj(e):new Vj(e,t,n,null==r?1:r)},fj(pj,{brighter(e){return e=null==e?gj:Math.pow(gj,e),new Vj(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?mj:Math.pow(mj,e),new Vj(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Rj(qj(e>=240?e-240:e+120,i,r),qj(e,i,r),qj(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Vj(Wj(this.h),Hj(this.s),Hj(this.l),Fj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Fj(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Wj(this.h),", ").concat(100*Hj(this.s),"%, ").concat(100*Hj(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Kj=e=>()=>e;function Xj(e,t){return function(n){return e+n*t}}function Yj(e){return 1===(e=+e)?Qj:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Kj(isNaN(t)?n:t)}}function Qj(e,t){var n=t-e;return n?Xj(e,n):Kj(isNaN(e)?t:e)}const $j=function e(t){var n=Yj(t);function r(e,t){var r=n((e=Dj(e)).r,(t=Dj(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Qj(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Zj(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Dj(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}Zj(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Gj((n-r/t)*t,a,i,o,s)}}),Zj(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Gj((n-r/t)*t,i,o,a,s)}});function Jj(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=sF(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function eF(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function tF(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function nF(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=sF(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var rF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iF=new RegExp(rF.source,"g");function oF(e,t){var n,r,i,o=rF.lastIndex=iF.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=rF.exec(e))&&(r=iF.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:tF(n,r)})),o=iF.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function aF(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function sF(e,t){var n,r=typeof t;return null==t||"boolean"===r?Kj(t):("number"===r?tF:"string"===r?(n=Oj(t))?(t=n,$j):oF:t instanceof Oj?$j:t instanceof Date?eF:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?aF:Array.isArray(t)?Jj:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?nF:tF)(e,t)}function uF(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function lF(e){return+e}var cF=[0,1];function hF(e){return e}function dF(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function fF(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=dF(i,r),o=n(a,o)):(r=dF(r,i),o=n(o,a)),function(e){return o(r(e))}}function pF(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=dF(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=hj(e,t,1,r)-1;return o[n](i[n](t))}}function mF(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gF(){var e,t,n,r,i,o,a=cF,s=cF,u=sF,l=hF;function c(){var e=Math.min(a.length,s.length);return l!==hF&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?pF:fF,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return h.invert=function(n){return l(t((o||(o=r(s,a.map(e),tF)))(n)))},h.domain=function(e){return arguments.length?(a=Array.from(e,lF),c()):a.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),u=uF,c()},h.clamp=function(e){return arguments.length?(l=!!e||hF,c()):l!==hF},h.interpolate=function(e){return arguments.length?(u=e,c()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}function vF(){return gF()(hF,hF)}var yF,bF=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xF(e){if(!(t=bF.exec(e)))throw new Error("invalid format: "+e);var t;return new wF({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function wF(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function EF(e,t){if(!isFinite(e)||0===e)return null;var n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function _F(e){return(e=EF(Math.abs(e)))?e[1]:NaN}function SF(e,t){var n=EF(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}xF.prototype=wF.prototype,wF.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const kF={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>SF(100*e,t),r:SF,s:function(e,t){var n=EF(e,t);if(!n)return yF=void 0,e.toPrecision(t);var r=n[0],i=n[1],o=i-(yF=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+EF(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function CF(e){return e}var IF,TF,AF,OF=Array.prototype.map,NF=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function PF(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?CF:(t=OF.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?CF:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(OF.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e,t){var n=(e=xF(e)).fill,h=e.align,d=e.sign,f=e.symbol,p=e.zero,m=e.width,g=e.comma,v=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):kF[b]||(void 0===v&&(v=12),y=!0,b="g"),(p||"0"===n&&"="===h)&&(p=!0,n="0",h="=");var x=(t&&void 0!==t.prefix?t.prefix:"")+("$"===f?i:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():""),w=("$"===f?o:/[%p]/.test(b)?u:"")+(t&&void 0!==t.suffix?t.suffix:""),E=kF[b],_=/[defgprs%]/.test(b);function S(e){var t,i,o,u=x,f=w;if("c"===b)f=E(e)+f,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:E(Math.abs(e),v),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==d&&(S=!1),u=(S?"("===d?d:l:"-"===d||"("===d?"":d)+u,f=("s"!==b||isNaN(e)||void 0===yF?"":NF[8+yF/3])+f+(S&&"("===d?")":""),_)for(t=-1,i=e.length;++t<i;)if(48>(o=e.charCodeAt(t))||o>57){f=(46===o?a+e.slice(t+1):e.slice(t))+f,e=e.slice(0,t);break}}g&&!p&&(e=r(e,1/0));var k=u.length+e.length+f.length,C=k<m?new Array(m-k+1).join(n):"";switch(g&&p&&(e=r(C+e,C.length?m-f.length:1/0),C=""),h){case"<":e=u+e+f+C;break;case"=":e=u+C+e+f;break;case"^":e=C.slice(0,k=C.length>>1)+u+e+f+C.slice(k);break;default:e=C+u+e+f}return s(e)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=3*Math.max(-8,Math.min(8,Math.floor(_F(t)/3))),r=Math.pow(10,-n),i=h(((e=xF(e)).type="f",e),{suffix:NF[8+n/3]});return function(e){return i(r*e)}}}}function DF(e,t,n,r){var i,o=rj(e,t,n);switch((r=xF(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(_F(t)/3)))-_F(Math.abs(e)))}(o,a))||(r.precision=i),AF(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_F(t)-_F(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-_F(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return TF(r)}function RF(e){var t=e.domain;return e.ticks=function(e){var n=t();return tj(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return DF(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=nj(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function MF(){var e=vF();return e.copy=function(){return mF(e,MF())},BM.apply(e,arguments),RF(e)}function jF(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,lF),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return jF(e).unknown(t)},e=arguments.length?Array.from(e,lF):[0,1],RF(n)}function FF(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function LF(e){return Math.log(e)}function BF(e){return Math.exp(e)}function zF(e){return-Math.log(-e)}function UF(e){return-Math.exp(-e)}function VF(e){return isFinite(e)?+("1e"+e):e<0?0:e}function WF(e){return(t,n)=>-e(-t,n)}function HF(e){const t=e(LF,BF),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?VF:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=WF(r),i=WF(i),e(zF,UF)):e(LF,BF),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const u=s<a;u&&([a,s]=[s,a]);let l,c,h=r(a),d=r(s);const f=null==e?10:+e;let p=[];if(!(o%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),a>0){for(;h<=d;++h)for(l=1;l<o;++l)if(c=h<0?l/i(-h):l*i(h),!(c<a)){if(c>s)break;p.push(c)}}else for(;h<=d;++h)for(l=o-1;l>=1;--l)if(c=h>0?l/i(-h):l*i(h),!(c<a)){if(c>s)break;p.push(c)}2*p.length<f&&(p=tj(a,s,f))}else p=tj(h,d,Math.min(d-h,f)).map(i);return u?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!==typeof n&&(o%1||null!=(n=xF(n)).precision||(n.trim=!0),n=TF(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(FF(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function qF(){const e=HF(gF()).domain([1,10]);return e.copy=()=>mF(e,qF()).base(e.base()),BM.apply(e,arguments),e}function GF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function KF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function XF(e){var t=1,n=e(GF(t),KF(t));return n.constant=function(n){return arguments.length?e(GF(t=+n),KF(t)):t},RF(n)}function YF(){var e=XF(gF());return e.copy=function(){return mF(e,YF()).constant(e.constant())},BM.apply(e,arguments)}function QF(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $F(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ZF(e){return e<0?-e*e:e*e}function JF(e){var t=e(hF,hF),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(hF,hF):.5===n?e($F,ZF):e(QF(n),QF(1/n)):n},RF(t)}function eL(){var e=JF(gF());return e.copy=function(){return mF(e,eL()).exponent(e.exponent())},BM.apply(e,arguments),e}function tL(){return eL.apply(null,arguments).exponent(.5)}function nL(e){return Math.sign(e)*e*e}function rL(){var e,t=vF(),n=[0,1],r=!1;function i(n){var i=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(i)?e:r?Math.round(i):i}return i.invert=function(e){return t.invert(nL(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain()},i.range=function(e){return arguments.length?(t.range((n=Array.from(e,lF)).map(nL)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(t.clamp(e),i):t.clamp()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return rL(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},BM.apply(i,arguments),RF(i)}function iL(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function oL(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function aL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ij;if(e===ij)return sL;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function sL(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function uL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?sL:aL(i);r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);uL(e,t,Math.max(n,Math.floor(t-a*u/o+l)),Math.min(r,Math.floor(t+(o-a)*u/o+l)),i)}const o=e[t];let a=n,s=r;for(lL(e,n,t),i(e[r],o)>0&&lL(e,n,r);a<s;){for(lL(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?lL(e,n,s):(++s,lL(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function lL(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function cL(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return oL(e);if(t>=1)return iL(e);var r,i=(r-1)*t,o=Math.floor(i),a=iL(uL(e,o).subarray(0,o+1));return a+(oL(e.subarray(o+1))-a)*(i-o)}}function hL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uj;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}function dL(){var e,t=[],n=[],r=[];function i(){var e=0,i=Math.max(1,n.length);for(r=new Array(i-1);++e<i;)r[e-1]=hL(t,e/i);return o}function o(t){return null==t||isNaN(t=+t)?e:n[hj(r,t)]}return o.invertExtent=function(e){var i=n.indexOf(e);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(ij),i()},o.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return dL().domain(t).range(n).unknown(e)},BM.apply(o,arguments)}function fL(){var e,t=0,n=1,r=1,i=[.5],o=[0,1];function a(t){return null!=t&&t<=t?o[hj(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return a}return a.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},a.range=function(e){return arguments.length?(r=(o=Array.from(e)).length-1,s()):o.slice()},a.invertExtent=function(e){var a=o.indexOf(e);return a<0?[NaN,NaN]:a<1?[t,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return fL().domain([t,n]).range(o).unknown(e)},BM.apply(RF(a),arguments)}function pL(){var e,t=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[hj(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return pL().domain(t).range(n).unknown(e)},BM.apply(i,arguments)}IF=PF({thousands:",",grouping:[3],currency:["$",""]}),TF=IF.format,AF=IF.formatPrefix;const mL=1e3,gL=6e4,vL=36e5,yL=864e5,bL=6048e5,xL=2592e6,wL=31536e6,EL=new Date,_L=new Date;function SL(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>SL(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(i.count=(t,r)=>(EL.setTime(+t),_L.setTime(+r),e(EL),e(_L),Math.floor(n(EL,_L))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e===0:t=>i.count(0,t)%e===0):i:null)),i}const kL=SL(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);kL.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?SL(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):kL:null);kL.range;const CL=SL(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*mL)},(e,t)=>(t-e)/mL,e=>e.getUTCSeconds()),IL=(CL.range,SL(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*mL)},(e,t)=>{e.setTime(+e+t*gL)},(e,t)=>(t-e)/gL,e=>e.getMinutes())),TL=(IL.range,SL(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gL)},(e,t)=>(t-e)/gL,e=>e.getUTCMinutes())),AL=(TL.range,SL(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*mL-e.getMinutes()*gL)},(e,t)=>{e.setTime(+e+t*vL)},(e,t)=>(t-e)/vL,e=>e.getHours())),OL=(AL.range,SL(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vL)},(e,t)=>(t-e)/vL,e=>e.getUTCHours())),NL=(OL.range,SL(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gL)/yL,e=>e.getDate()-1)),PL=(NL.range,SL(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/yL,e=>e.getUTCDate()-1)),DL=(PL.range,SL(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/yL,e=>Math.floor(e/yL)));DL.range;function RL(e){return SL(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gL)/bL)}const ML=RL(0),jL=RL(1),FL=RL(2),LL=RL(3),BL=RL(4),zL=RL(5),UL=RL(6);ML.range,jL.range,FL.range,LL.range,BL.range,zL.range,UL.range;function VL(e){return SL(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/bL)}const WL=VL(0),HL=VL(1),qL=VL(2),GL=VL(3),KL=VL(4),XL=VL(5),YL=VL(6),QL=(WL.range,HL.range,qL.range,GL.range,KL.range,XL.range,YL.range,SL(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),$L=(QL.range,SL(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),ZL=($L.range,SL(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));ZL.every=e=>isFinite(e=Math.floor(e))&&e>0?SL(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null;ZL.range;const JL=SL(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());JL.every=e=>isFinite(e=Math.floor(e))&&e>0?SL(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null;JL.range;function eB(e,t,n,r,i,o){const a=[[CL,1,mL],[CL,5,5e3],[CL,15,15e3],[CL,30,3e4],[o,1,gL],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,vL],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,yL],[r,2,1728e5],[n,1,bL],[t,1,xL],[t,3,7776e6],[e,1,wL]];function s(t,n,r){const i=Math.abs(n-t)/r,o=aj(e=>{let[,,t]=e;return t}).right(a,i);if(o===a.length)return e.every(rj(t/wL,n/wL,r));if(0===o)return kL.every(Math.max(rj(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"===typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}const[tB,nB]=eB(JL,$L,WL,DL,OL,TL),[rB,iB]=eB(ZL,QL,ML,NL,AL,IL);function oB(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function aB(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function sB(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var uB,lB,cB,hB={"-":"",_:" ",0:"0"},dB=/^\s*\d+/,fB=/^%/,pB=/[\\^$*+?|[\]().{}]/g;function mB(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function gB(e){return e.replace(pB,"\\$&")}function vB(e){return new RegExp("^(?:"+e.map(gB).join("|")+")","i")}function yB(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function bB(e,t,n){var r=dB.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function xB(e,t,n){var r=dB.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function wB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function EB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function _B(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function SB(e,t,n){var r=dB.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function kB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function CB(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function IB(e,t,n){var r=dB.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function TB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function AB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function OB(e,t,n){var r=dB.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function NB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function PB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function DB(e,t,n){var r=dB.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function RB(e,t,n){var r=dB.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function MB(e,t,n){var r=dB.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function jB(e,t,n){var r=fB.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function FB(e,t,n){var r=dB.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function LB(e,t,n){var r=dB.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function BB(e,t){return mB(e.getDate(),t,2)}function zB(e,t){return mB(e.getHours(),t,2)}function UB(e,t){return mB(e.getHours()%12||12,t,2)}function VB(e,t){return mB(1+NL.count(ZL(e),e),t,3)}function WB(e,t){return mB(e.getMilliseconds(),t,3)}function HB(e,t){return WB(e,t)+"000"}function qB(e,t){return mB(e.getMonth()+1,t,2)}function GB(e,t){return mB(e.getMinutes(),t,2)}function KB(e,t){return mB(e.getSeconds(),t,2)}function XB(e){var t=e.getDay();return 0===t?7:t}function YB(e,t){return mB(ML.count(ZL(e)-1,e),t,2)}function QB(e){var t=e.getDay();return t>=4||0===t?BL(e):BL.ceil(e)}function $B(e,t){return e=QB(e),mB(BL.count(ZL(e),e)+(4===ZL(e).getDay()),t,2)}function ZB(e){return e.getDay()}function JB(e,t){return mB(jL.count(ZL(e)-1,e),t,2)}function ez(e,t){return mB(e.getFullYear()%100,t,2)}function tz(e,t){return mB((e=QB(e)).getFullYear()%100,t,2)}function nz(e,t){return mB(e.getFullYear()%1e4,t,4)}function rz(e,t){var n=e.getDay();return mB((e=n>=4||0===n?BL(e):BL.ceil(e)).getFullYear()%1e4,t,4)}function iz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+mB(t/60|0,"0",2)+mB(t%60,"0",2)}function oz(e,t){return mB(e.getUTCDate(),t,2)}function az(e,t){return mB(e.getUTCHours(),t,2)}function sz(e,t){return mB(e.getUTCHours()%12||12,t,2)}function uz(e,t){return mB(1+PL.count(JL(e),e),t,3)}function lz(e,t){return mB(e.getUTCMilliseconds(),t,3)}function cz(e,t){return lz(e,t)+"000"}function hz(e,t){return mB(e.getUTCMonth()+1,t,2)}function dz(e,t){return mB(e.getUTCMinutes(),t,2)}function fz(e,t){return mB(e.getUTCSeconds(),t,2)}function pz(e){var t=e.getUTCDay();return 0===t?7:t}function mz(e,t){return mB(WL.count(JL(e)-1,e),t,2)}function gz(e){var t=e.getUTCDay();return t>=4||0===t?KL(e):KL.ceil(e)}function vz(e,t){return e=gz(e),mB(KL.count(JL(e),e)+(4===JL(e).getUTCDay()),t,2)}function yz(e){return e.getUTCDay()}function bz(e,t){return mB(HL.count(JL(e)-1,e),t,2)}function xz(e,t){return mB(e.getUTCFullYear()%100,t,2)}function wz(e,t){return mB((e=gz(e)).getUTCFullYear()%100,t,2)}function Ez(e,t){return mB(e.getUTCFullYear()%1e4,t,4)}function _z(e,t){var n=e.getUTCDay();return mB((e=n>=4||0===n?KL(e):KL.ceil(e)).getUTCFullYear()%1e4,t,4)}function Sz(){return"+0000"}function kz(){return"%"}function Cz(e){return+e}function Iz(e){return Math.floor(+e/1e3)}function Tz(e){return new Date(e)}function Az(e){return e instanceof Date?+e:+new Date(+e)}function Oz(e,t,n,r,i,o,a,s,u,l){var c=vF(),h=c.invert,d=c.domain,f=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(e){return(u(e)<e?f:s(e)<e?p:a(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?v:y:n(e)<e?b:x)(e)}return c.invert=function(e){return new Date(h(e))},c.domain=function(e){return arguments.length?d(Array.from(e,Az)):d().map(Tz)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?w:l(t)},c.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(FF(n,e)):c},c.copy=function(){return mF(c,Oz(e,t,n,r,i,o,a,s,u,l))},c}function Nz(){return BM.apply(Oz(rB,iB,ZL,QL,ML,NL,AL,IL,CL,lB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Pz(){return BM.apply(Oz(tB,nB,JL,$L,WL,PL,OL,TL,CL,cB).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Dz(){var e,t,n,r,i,o=0,a=1,s=hF,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(sF),l.rangeRound=c(uF),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function Rz(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Mz(){var e=RF(Dz()(hF));return e.copy=function(){return Rz(e,Mz())},zM.apply(e,arguments)}function jz(){var e=HF(Dz()).domain([1,10]);return e.copy=function(){return Rz(e,jz()).base(e.base())},zM.apply(e,arguments)}function Fz(){var e=XF(Dz());return e.copy=function(){return Rz(e,Fz()).constant(e.constant())},zM.apply(e,arguments)}function Lz(){var e=JF(Dz());return e.copy=function(){return Rz(e,Lz()).exponent(e.exponent())},zM.apply(e,arguments)}function Bz(){return Lz.apply(null,arguments).exponent(.5)}function zz(){var e=[],t=hF;function n(n){if(null!=n&&!isNaN(n=+n))return t((hj(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(ij),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>cL(e,r/t))},n.copy=function(){return zz(t).domain(e)},zM.apply(n,arguments)}function Uz(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,h=hF,d=!1;function f(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),h(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,h=function(e,t){void 0===t&&(t=e,e=sF);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}(e,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,f):[s,u,l]},f.clamp=function(e){return arguments.length?(d=!!e,f):d},f.interpolator=function(e){return arguments.length?(h=e,f):h},f.range=p(sF),f.rangeRound=p(uF),f.unknown=function(e){return arguments.length?(a=e,f):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,f}}function Vz(){var e=RF(Uz()(hF));return e.copy=function(){return Rz(e,Vz())},zM.apply(e,arguments)}function Wz(){var e=HF(Uz()).domain([.1,1,10]);return e.copy=function(){return Rz(e,Wz()).base(e.base())},zM.apply(e,arguments)}function Hz(){var e=XF(Uz());return e.copy=function(){return Rz(e,Hz()).constant(e.constant())},zM.apply(e,arguments)}function qz(){var e=JF(Uz());return e.copy=function(){return Rz(e,qz()).exponent(e.exponent())},zM.apply(e,arguments)}function Gz(){return qz.apply(null,arguments).exponent(.5)}!function(e){uB=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=vB(i),c=yB(i),h=vB(o),d=yB(o),f=vB(a),p=yB(a),m=vB(s),g=yB(s),v=vB(u),y=yB(u),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:BB,e:BB,f:HB,g:tz,G:rz,H:zB,I:UB,j:VB,L:WB,m:qB,M:GB,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Cz,s:Iz,S:KB,u:XB,U:YB,V:$B,w:ZB,W:JB,x:null,X:null,y:ez,Y:nz,Z:iz,"%":kz},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:oz,e:oz,f:cz,g:wz,G:_z,H:az,I:sz,j:uz,L:lz,m:hz,M:dz,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Cz,s:Iz,S:fz,u:pz,U:mz,V:vz,w:yz,W:bz,x:null,X:null,y:xz,Y:Ez,Z:Sz,"%":kz},w={a:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:AB,e:AB,f:MB,g:kB,G:SB,H:NB,I:NB,j:OB,L:RB,m:TB,M:PB,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:IB,Q:FB,s:LB,S:DB,u:xB,U:wB,V:EB,w:bB,W:_B,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:kB,Y:SB,Z:CB,"%":jB};function E(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=hB[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function _(e,t){return function(n){var r,i,o=sB(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=aB(sB(o.y,0,1))).getUTCDay(),r=i>4||0===i?HL.ceil(r):HL(r),r=PL.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=oB(sB(o.y,0,1))).getDay(),r=i>4||0===i?jL.ceil(r):jL(r),r=NL.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?aB(sB(o.y,0,1)).getUTCDay():oB(sB(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,aB(o)):oB(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in hB?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x),{format:function(e){var t=E(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=E(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}(e),lB=uB.format,uB.parse,cB=uB.utcFormat,uB.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Kz=e=>e.chartData,Xz=kR([Kz],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Yz=(e,t,n,r)=>r?Xz(e):Kz(e);function Qz(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(sO(t)&&sO(n))return!0}return!1}function $z(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Zz(e,t){if(t&&"function"!==typeof e&&Array.isArray(e)&&2===e.length){var n,r,[i,o]=e;if(sO(i))n=i;else if("function"===typeof i)return;if(sO(o))r=o;else if("function"===typeof o)return;var a=[n,r];if(Qz(a))return a}}var Jz=n(8210),eU=n.n(Jz),tU=e=>e,nU={"@@functional/placeholder":!0},rU=e=>e===nU,iU=e=>function t(){return 0===arguments.length||1===arguments.length&&rU(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},oU=(e,t)=>1===e?t:iU(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.filter(e=>e!==nU).length;return o>=e?t(...r):oU(e-o,iU(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=r.map(e=>rU(e)?n.shift():e);return t(...o,...n)}))}),aU=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},sU=(e=>oU(e.length,e))((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e));function uU(e){return 0===e?1:Math.floor(new(eU())(e).abs().log(10).toNumber())+1}function lU(e,t,n){for(var r=new(eU())(e),i=0,o=[];r.lt(t)&&i<1e5;)o.push(r.toNumber()),r=r.add(n),i++;return o}var cU=e=>{var[t,n]=e,[r,i]=[t,n];return t>n&&([r,i]=[n,t]),[r,i]},hU=(e,t,n)=>{if(e.lte(0))return new(eU())(0);var r=uU(e.toNumber()),i=new(eU())(10).pow(r),o=e.div(i),a=1!==r?.05:.1,s=new(eU())(Math.ceil(o.div(a).toNumber())).add(n).mul(a).mul(i);return t?new(eU())(s.toNumber()):new(eU())(Math.ceil(s.toNumber()))},dU=(e,t,n)=>{var r=new(eU())(1),i=new(eU())(e);if(!i.isint()&&n){var o=Math.abs(e);o<1?(r=new(eU())(10).pow(uU(e)-1),i=new(eU())(Math.floor(i.div(r).toNumber())).mul(r)):o>1&&(i=new(eU())(Math.floor(e)))}else 0===e?i=new(eU())(Math.floor((t-1)/2)):n||(i=new(eU())(Math.floor(e)));var a=Math.floor((t-1)/2),s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return tU;var r=t.reverse(),i=r[0],o=r.slice(1);return function(){return o.reduce((e,t)=>t(e),i(...arguments))}}(sU(e=>i.add(new(eU())(e-a).mul(r)).toNumber()),aU);return s(0,t)},fU=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(eU())(0),tickMin:new(eU())(0),tickMax:new(eU())(0)};var o,a=hU(new(eU())(t).sub(e).div(n-1),r,i);o=e<=0&&t>=0?new(eU())(0):(o=new(eU())(e).add(t).div(2)).sub(new(eU())(o).mod(a));var s=Math.ceil(o.sub(e).div(a).toNumber()),u=Math.ceil(new(eU())(t).sub(o).div(a).toNumber()),l=s+u+1;return l>n?fU(e,t,n,r,i+1):(l<n&&(u=t>0?u+(n-l):u,s=t>0?s:s+(n-l)),{step:a,tickMin:o.sub(new(eU())(s).mul(a)),tickMax:o.add(new(eU())(u).mul(a))})},pU=e=>e.rootProps.maxBarSize,mU=e=>e.rootProps.barCategoryGap,gU=e=>e.rootProps.stackOffset,vU=e=>e.rootProps.reverseStackOrder,yU=e=>e.options.chartName,bU=e=>e.rootProps.syncId,xU=e=>e.rootProps.syncMethod,wU=e=>e.options.eventEmitter;function EU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?EU(Object(n),!0).forEach(function(t){SU(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EU(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function SU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kU=Math.PI/180,CU=e=>180*e/Math.PI,IU=(e,t,n,r)=>({x:e+Math.cos(-kU*r)*n,y:t+Math.sin(-kU*r)*n}),TU=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},AU=(e,t)=>{var{x:n,y:r}=e,{cx:i,cy:o}=t,a=((e,t)=>{var{x:n,y:r}=e,{x:i,y:o}=t;return Math.sqrt((n-i)**2+(r-o)**2)})({x:n,y:r},{x:i,y:o});if(a<=0)return{radius:a,angle:0};var s=(n-i)/a,u=Math.acos(s);return r>o&&(u=2*Math.PI-u),{radius:a,angle:CU(u),angleInRadian:u}},OU=(e,t)=>{var{startAngle:n,endAngle:r}=t,i=Math.floor(n/360),o=Math.floor(r/360);return e+360*Math.min(i,o)},NU=(e,t)=>{var{chartX:n,chartY:r}=e,{radius:i,angle:o}=AU({x:n,y:r},t),{innerRadius:a,outerRadius:s}=t;if(i<a||i>s)return null;if(0===i)return null;var u,{startAngle:l,endAngle:c}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),i=Math.floor(n/360),o=Math.min(r,i);return{startAngle:t-360*o,endAngle:n-360*o}})(t),h=o;if(l<=c){for(;h>c;)h-=360;for(;h<l;)h+=360;u=h>=l&&h<=c}else{for(;h>l;)h-=360;for(;h<c;)h+=360;u=h>=c&&h<=l}return u?_U(_U({},t),{},{radius:i,angle:OU(h,t)}):null},PU={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},DU=!0,RU=0,MU=!1,jU="auto",FU=!0,LU="category",BU=(PU.axis,!1),zU=!0,UU=0,VU="auto",WU=!0,HU=5,qU="number",GU=(PU.axis,(e,t)=>{if(e&&t)return null!==e&&void 0!==e&&e.reversed?[t[1],t[0]]:t}),KU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:RU,includeHidden:!1,name:void 0,reversed:MU,scale:jU,tick:FU,tickCount:void 0,ticks:void 0,type:LU,unit:void 0},XU={allowDataOverflow:BU,allowDecimals:!1,allowDuplicatedCategory:zU,dataKey:void 0,domain:void 0,id:UU,includeHidden:!1,name:void 0,reversed:!1,scale:VU,tick:WU,tickCount:HU,ticks:void 0,type:qU,unit:void 0},YU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:DU,dataKey:void 0,domain:void 0,id:RU,includeHidden:!1,name:void 0,reversed:!1,scale:jU,tick:FU,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},QU={allowDataOverflow:BU,allowDecimals:!1,allowDuplicatedCategory:zU,dataKey:void 0,domain:void 0,id:UU,includeHidden:!1,name:void 0,reversed:!1,scale:VU,tick:WU,tickCount:HU,ticks:void 0,type:"category",unit:void 0},$U=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?YU:KU,ZU=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?QU:XU,JU=e=>e.polarOptions,eV=kR([cM,hM,wM],TU),tV=kR([JU,eV],(e,t)=>{if(null!=e)return GA(e.innerRadius,t,0)}),nV=kR([JU,eV],(e,t)=>{if(null!=e)return GA(e.outerRadius,t,.8*t)}),rV=kR([JU],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]}),iV=(kR([$U,rV],GU),kR([eV,tV,nV],(e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]})),oV=(kR([ZU,iV],GU),kR([RM,JU,tV,nV,cM,hM],(e,t,n,r,i,o)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:a,cy:s,startAngle:u,endAngle:l}=t;return{cx:GA(a,i,i/2),cy:GA(s,o,o/2),innerRadius:n,outerRadius:r,startAngle:u,endAngle:l,clockWise:!1}}})),aV=(e,t)=>t,sV=(e,t,n)=>n;function uV(e){return null===e||void 0===e?void 0:e.id}function lV(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:i,dataKey:o}=n,a=new Map;return e.forEach(e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var s=uV(e);n.forEach((t,n)=>{var r,u=null==o||i?n:String(YR(t,o,null)),l=YR(t,e.dataKey,0);r=a.has(u)?a.get(u):{},Object.assign(r,{[s]:l}),a.set(u,r)})}}),Array.from(a.values())}function cV(e){return"stackId"in e&&null!=e.stackId&&null!=e.dataKey}var hV=(e,t)=>e===t||null!=e&&null!=t&&(e[0]===t[0]&&e[1]===t[1]);function dV(e,t){return!(!Array.isArray(e)||!Array.isArray(t)||0!==e.length||0!==t.length)||e===t}var fV=e=>{var t=RM(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},pV=e=>e.tooltip.settings.axisId;function mV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mV(Object(n),!0).forEach(function(t){vV(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vV(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yV=[0,"auto"],bV={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},xV=(e,t)=>e.cartesianAxis.xAxis[t],wV=(e,t)=>{var n=xV(e,t);return null==n?bV:n},EV={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:yV,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},_V=(e,t)=>e.cartesianAxis.yAxis[t],SV=(e,t)=>{var n=_V(e,t);return null==n?EV:n},kV={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},CV=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?kV:n},IV=(e,t,n)=>{switch(t){case"xAxis":return wV(e,n);case"yAxis":return SV(e,n);case"zAxis":return CV(e,n);case"angleAxis":return $U(e,n);case"radiusAxis":return ZU(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},TV=(e,t,n)=>{switch(t){case"xAxis":return wV(e,n);case"yAxis":return SV(e,n);case"angleAxis":return $U(e,n);case"radiusAxis":return ZU(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},AV=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function OV(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var NV=e=>e.graphicalItems.cartesianItems,PV=kR([aV,sV],OV),DV=(e,t,n)=>e.filter(n).filter(e=>!0===(null===t||void 0===t?void 0:t.includeHidden)||!e.hide),RV=kR([NV,IV,PV],DV,{memoizeOptions:{resultEqualityCheck:dV}}),MV=kR([RV],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(cV)),jV=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),FV=kR([RV],jV),LV=e=>e.map(e=>e.data).filter(Boolean).flat(1),BV=kR([RV],LV,{memoizeOptions:{resultEqualityCheck:dV}}),zV=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:i}=t;return e.length>0?e:n.slice(r,i+1)},UV=kR([BV,Yz],zV),VV=(e,t,n)=>null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:YR(e,t.dataKey)})):n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:YR(e,t)}))):e.map(e=>({value:e})),WV=kR([UV,IV,RV],VV);function HV(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function qV(e){if(WA(e)||e instanceof Date){var t=Number(e);if(sO(t))return t}}function GV(e){if(Array.isArray(e)){var t=[qV(e[0]),qV(e[1])];return Qz(t)?t:void 0}var n=qV(e);if(null!=n)return[n,n]}function KV(e){return e.map(qV).filter(ZA)}var XV=e=>{var t=fV(e),n=pV(e);return TV(e,t,n)},YV=kR([XV],e=>null===e||void 0===e?void 0:e.dataKey),QV=kR([MV,Yz,XV],lV),$V=(e,t,n,r)=>{var i=t.reduce((e,t)=>{if(null==t.stackId)return e;var n=e[t.stackId];return null==n&&(n=[]),n.push(t),e[t.stackId]=n,e},{});return Object.fromEntries(Object.entries(i).map(t=>{var[i,o]=t,a=r?[...o].reverse():o,s=a.map(uV);return[i,{stackedData:tM(e,s,n),graphicalItems:a}]}))},ZV=kR([QV,MV,gU,vU],$V),JV=(e,t,n,r)=>{var{dataStartIndex:i,dataEndIndex:o}=t;if(null==r&&"zAxis"!==n){var a=iM(e,i,o);if(null==a||0!==a[0]||0!==a[1])return a}},eW=kR([IV],e=>e.allowDataOverflow),tW=e=>{var t;if(null==e||!("domain"in e))return yV;if(null!=e.domain)return e.domain;if("ticks"in e&&null!=e.ticks){if("number"===e.type){var n=KV(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null===e||void 0===e?void 0:e.domain)&&void 0!==t?t:yV},nW=kR([IV],tW),rW=kR([nW,eW],Zz),iW=kR([ZV,Kz,aV,rW],JV,{memoizeOptions:{resultEqualityCheck:hV}}),oW=e=>e.errorBars,aW=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var i=r.flat();return[Math.min(...i),Math.max(...i)]}},sW=(e,t,n,r,i)=>{var o,a;if(n.length>0&&e.forEach(e=>{n.forEach(n=>{var s,u,l=null===(s=r[n.id])||void 0===s?void 0:s.filter(e=>HV(i,e)),c=YR(e,null!==(u=t.dataKey)&&void 0!==u?u:n.dataKey),h=function(e,t,n){return!n||"number"!==typeof t||zA(t)?[]:n.length?KV(n.flatMap(n=>{var r,i,o=YR(e,n.dataKey);if(Array.isArray(o)?[r,i]=o:r=i=o,sO(r)&&sO(i))return[t-r,t+i]})):[]}(e,c,l);if(h.length>=2){var d=Math.min(...h),f=Math.max(...h);(null==o||d<o)&&(o=d),(null==a||f>a)&&(a=f)}var p=GV(c);null!=p&&(o=null==o?p[0]:Math.min(o,p[0]),a=null==a?p[1]:Math.max(a,p[1]))})}),null!=(null===t||void 0===t?void 0:t.dataKey)&&e.forEach(e=>{var n=GV(YR(e,t.dataKey));null!=n&&(o=null==o?n[0]:Math.min(o,n[0]),a=null==a?n[1]:Math.max(a,n[1]))}),sO(o)&&sO(a))return[o,a]},uW=kR([UV,IV,FV,oW,aV],sW,{memoizeOptions:{resultEqualityCheck:hV}});function lW(e){var{value:t}=e;if(WA(t)||t instanceof Date)return t}var cW=e=>e.referenceElements.dots,hW=(e,t,n)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n),dW=kR([cW,aV,sV],hW),fW=e=>e.referenceElements.areas,pW=kR([fW,aV,sV],hW),mW=e=>e.referenceElements.lines,gW=kR([mW,aV,sV],hW),vW=(e,t)=>{if(null!=e){var n=KV(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},yW=kR(dW,aV,vW),bW=(e,t)=>{if(null!=e){var n=KV(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},xW=kR([pW,aV],bW);var wW=(e,t)=>{if(null!=e){var n=e.flatMap(e=>"xAxis"===t?function(e){var t;if(null!=e.x)return KV([e.x]);var n=null===(t=e.segment)||void 0===t?void 0:t.map(e=>e.x);return null==n||0===n.length?[]:KV(n)}(e):function(e){var t;if(null!=e.y)return KV([e.y]);var n=null===(t=e.segment)||void 0===t?void 0:t.map(e=>e.y);return null==n||0===n.length?[]:KV(n)}(e));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},EW=kR([gW,aV],wW),_W=kR(yW,EW,xW,(e,t,n)=>aW(e,n,t)),SW=(e,t,n,r,i,o,a,s)=>null!=n?n:function(e,t,n){if(n||null!=t){if("function"===typeof e&&null!=t)try{var r=e(t,n);if(Qz(r))return $z(r,t,n)}catch(f){}if(Array.isArray(e)&&2===e.length){var i,o,[a,s]=e;if("auto"===a)null!=t&&(i=Math.min(...t));else if(VA(a))i=a;else if("function"===typeof a)try{null!=t&&(i=a(null===t||void 0===t?void 0:t[0]))}catch(p){}else if("string"===typeof a&&oM.test(a)){var u=oM.exec(a);if(null==u||null==u[1]||null==t)i=void 0;else{var l=+u[1];i=t[0]-l}}else i=null===t||void 0===t?void 0:t[0];if("auto"===s)null!=t&&(o=Math.max(...t));else if(VA(s))o=s;else if("function"===typeof s)try{null!=t&&(o=s(null===t||void 0===t?void 0:t[1]))}catch(m){}else if("string"===typeof s&&aM.test(s)){var c=aM.exec(s);if(null==c||null==c[1]||null==t)o=void 0;else{var h=+c[1];o=t[1]+h}}else o=null===t||void 0===t?void 0:t[1];var d=[i,o];if(Qz(d))return null==t?d:$z(d,t,n)}}}(t,"vertical"===a&&"xAxis"===s||"horizontal"===a&&"yAxis"===s?aW(r,o,i):aW(o,i),e.allowDataOverflow),kW=kR([IV,nW,rW,iW,uW,_W,RM,aV],SW,{memoizeOptions:{resultEqualityCheck:hV}}),CW=[0,1],IW=(e,t,n,r,i,o,a)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==a){var s,{dataKey:u,type:l}=e,c=QR(t,o);return c&&null==u?LM()(0,null!==(s=null===n||void 0===n?void 0:n.length)&&void 0!==s?s:0):"category"===l?((e,t,n)=>{var r=e.map(lW).filter(e=>null!=e);return n&&(null==t.dataKey||t.allowDuplicatedCategory&&KA(r))?LM()(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,c):"expand"===i?CW:a}},TW=kR([IV,RM,UV,WV,gU,aV,kW],IW),AW=(t,n,r,i,o)=>{if(null!=t){var{scale:a,type:s}=t;if("auto"===a)return"radial"===n&&"radiusAxis"===o?"band":"radial"===n&&"angleAxis"===o?"linear":"category"===s&&i&&(i.indexOf("LineChart")>=0||i.indexOf("AreaChart")>=0||i.indexOf("ComposedChart")>=0&&!r)?"point":"category"===s?"band":"linear";if("string"===typeof a){var u="scale".concat($A(a));return u in e?u:"point"}}},OW=kR([IV,RM,AV,yU,aV],AW);function NW(t,n,r,i){if(null!=r&&null!=i){if("function"===typeof t.scale)return t.scale.copy().domain(r).range(i);var o=function(t){if(null!=t){if(t in e)return e[t]();var n="scale".concat($A(t));return n in e?e[n]():void 0}}(n);if(null!=o){var a=o.domain(r).range(i);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),i=Math.min(r[0],r[1])-JR,o=Math.max(r[0],r[1])+JR,a=e(t[0]),s=e(t[n-1]);(a<i||a>o||s<i||s>o)&&e.domain([t[0],t[n-1]])}})(a),a}}}var PW=(e,t,n)=>{var r=tW(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&Qz(e)?function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(r,2),[a,s]=cU([t,n]);if(a===-1/0||s===1/0){var u=s===1/0?[a,...aU(0,r-1).map(()=>1/0)]:[...aU(0,r-1).map(()=>-1/0),s];return t>n?u.reverse():u}if(a===s)return dU(a,r,i);var{step:l,tickMin:c,tickMax:h}=fU(a,s,o,i,0),d=lU(c,h.add(new(eU())(.1).mul(l)),l);return t>n?d.reverse():d}(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&Qz(e)?function(e,t){var[n,r]=e,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[o,a]=cU([n,r]);if(o===-1/0||a===1/0)return[n,r];if(o===a)return[o];var s=Math.max(t,2),u=hU(new(eU())(a).sub(o).div(s-1),i,0),l=[...lU(new(eU())(o),new(eU())(a),u),a];return!1===i&&(l=l.map(e=>Math.round(e))),n>r?l.reverse():l}(e,t.tickCount,t.allowDecimals):void 0},DW=kR([TW,TV,OW],PW),RW=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null===e||void 0===e?void 0:e.type)&&Qz(t)&&Array.isArray(n)&&n.length>0){var i=t[0],o=n[0],a=t[1],s=n[n.length-1];return[Math.min(i,o),Math.max(a,s)]}return t},MW=kR([IV,TW,DW,aV],RW),jW=kR(WV,IV,(e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from(KV(e.map(e=>e.value))).sort((e,t)=>e-t),i=r[0],o=r[r.length-1];if(null==i||null==o)return 1/0;var a=o-i;if(0===a)return 1/0;for(var s=0;s<r.length-1;s++){var u=r[s],l=r[s+1];if(null!=u&&null!=l){var c=l-u;n=Math.min(n,c)}}return n/a}}),FW=kR(jW,RM,mU,wM,(e,t,n,r,i)=>i,(e,t,n,r,i)=>{if(!sO(e))return 0;var o="vertical"===t?r.height:r.width;if("gap"===i)return e*o/2;if("no-gap"===i){var a=GA(n,e*o),s=e*o/2;return s-a-(s-a)/o*a}return 0}),LW=kR(wV,(e,t,n)=>{var r=wV(e,t);return null==r||"string"!==typeof r.padding?0:FW(e,"xAxis",t,n,r.padding)},(e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:i}=e;return"string"===typeof i?{left:t,right:t}:{left:(null!==(n=i.left)&&void 0!==n?n:0)+t,right:(null!==(r=i.right)&&void 0!==r?r:0)+t}}),BW=kR(SV,(e,t,n)=>{var r=SV(e,t);return null==r||"string"!==typeof r.padding?0:FW(e,"yAxis",t,n,r.padding)},(e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:i}=e;return"string"===typeof i?{top:t,bottom:t}:{top:(null!==(n=i.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=i.bottom)&&void 0!==r?r:0)+t}}),zW=kR([wM,LW,IM,CM,(e,t,n)=>n],(e,t,n,r,i)=>{var{padding:o}=r;return i?[o.left,n.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),UW=kR([wM,RM,BW,IM,CM,(e,t,n)=>n],(e,t,n,r,i,o)=>{var{padding:a}=i;return o?[r.height-a.bottom,a.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),VW=(e,t,n,r)=>{var i;switch(t){case"xAxis":return zW(e,n,r);case"yAxis":return UW(e,n,r);case"zAxis":return null===(i=CV(e,n))||void 0===i?void 0:i.range;case"angleAxis":return rV(e);case"radiusAxis":return iV(e,n);default:return}},WW=kR([IV,VW],GU),HW=kR([IV,OW,MW,WW],NW);kR([RV,oW,aV],(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>HV(n,e)));function qW(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var GW=(e,t)=>t,KW=(e,t,n)=>n,XW=kR(pM,GW,KW,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(qW)),YW=kR(mM,GW,KW,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(qW)),QW=(e,t)=>({width:e.width,height:t.height}),$W=kR(wM,wV,QW),ZW=kR(hM,wM,XW,GW,KW,(e,t,n,r,i)=>{var o,a={};return n.forEach(n=>{var s=QW(t,n);null==o&&(o=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var u="top"===r&&!i||"bottom"===r&&i;a[n.id]=o-Number(u)*s.height,o+=(u?-1:1)*s.height}),a}),JW=kR(cM,wM,YW,GW,KW,(e,t,n,r,i)=>{var o,a={};return n.forEach(n=>{var s=((e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height}))(t,n);null==o&&(o=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var u="left"===r&&!i||"right"===r&&i;a[n.id]=o-Number(u)*s.width,o+=(u?-1:1)*s.width}),a}),eH=kR([wM,wV,(e,t)=>{var n=wV(e,t);if(null!=n)return ZW(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var i=null===n||void 0===n?void 0:n[r];return null==i?{x:e.left,y:0}:{x:e.left,y:i}}}),tH=kR([wM,SV,(e,t)=>{var n=SV(e,t);if(null!=n)return JW(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var i=null===n||void 0===n?void 0:n[r];return null==i?{x:0,y:e.top}:{x:i,y:e.top}}}),nH=kR(wM,SV,(e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height})),rH=(e,t,n)=>{switch(t){case"xAxis":return $W(e,n).width;case"yAxis":return nH(e,n).height;default:return}},iH=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:i,type:o,dataKey:a}=n,s=QR(e,r),u=t.map(e=>e.value);return a&&s&&"category"===o&&i&&KA(u)?u:void 0}},oH=kR([RM,WV,IV,aV],iH),aH=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:i,scale:o}=n;return!QR(e,r)||"number"!==i&&"auto"===o?void 0:t.map(e=>e.value)}},sH=kR([RM,WV,TV,aV],aH),uH=kR([RM,(e,t,n)=>{switch(t){case"xAxis":return wV(e,n);case"yAxis":return SV(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},OW,HW,oH,sH,VW,DW,aV],(e,t,n,r,i,o,a,s,u)=>{if(null!=t){var l=QR(e,u);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:u,categoricalDomain:o,duplicateDomain:i,isCategorical:l,niceTicks:s,range:a,realScaleType:n,scale:r}}}),lH=kR([RM,TV,OW,HW,DW,VW,oH,sH,aV],(e,t,n,r,i,o,a,s,u)=>{if(null!=t&&null!=r){var l=QR(e,u),{type:c,ticks:h,tickCount:d}=t,f="scaleBand"===n&&"function"===typeof r.bandwidth?r.bandwidth()/2:2,p="category"===c&&r.bandwidth?r.bandwidth()/f:0;p="angleAxis"===u&&null!=o&&o.length>=2?2*BA(o[0]-o[1])*p:p;var m=h||i;return m?m.map((e,t)=>{var n=a?a.indexOf(e):e;return{index:t,coordinate:r(n)+p,value:e,offset:p}}).filter(e=>sO(e.coordinate)):l&&s?s.map((e,t)=>({coordinate:r(e)+p,value:e,index:t,offset:p})).filter(e=>sO(e.coordinate)):r.ticks?r.ticks(d).map(e=>({coordinate:r(e)+p,value:e,offset:p})):r.domain().map((e,t)=>({coordinate:r(e)+p,value:a?a[e]:e,index:t,offset:p}))}}),cH=kR([RM,TV,HW,VW,oH,sH,aV],(e,t,n,r,i,o,a)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var s=QR(e,a),{tickCount:u}=t,l=0;return l="angleAxis"===a&&(null===r||void 0===r?void 0:r.length)>=2?2*BA(r[0]-r[1])*l:l,s&&o?o.map((e,t)=>({coordinate:n(e)+l,value:e,index:t,offset:l})):n.ticks?n.ticks(u).map(e=>({coordinate:n(e)+l,value:e,offset:l})):n.domain().map((e,t)=>({coordinate:n(e)+l,value:i?i[e]:e,index:t,offset:l}))}}),hH=kR(IV,HW,(e,t)=>{if(null!=e&&null!=t)return gV(gV({},e),{},{scale:t})}),dH=kR([IV,OW,TW,WW],NW),fH=(kR((e,t,n)=>CV(e,n),dH,(e,t)=>{if(null!=e&&null!=t)return gV(gV({},e),{},{scale:t})}),kR([RM,pM,mM],(e,t,n)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})),pH=e=>e.options.defaultTooltipEventType,mH=e=>e.options.validateTooltipEventTypes;function gH(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function vH(e,t){return gH(t,pH(e),mH(e))}var yH=(e,t)=>{var n,r=Number(t);if(!zA(r)&&null!=t)return r>=0?null===e||void 0===e||null===(n=e[r])||void 0===n?void 0:n.value:void 0};function bH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bH(Object(n),!0).forEach(function(t){wH(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bH(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var EH=(e,t,n,r)=>{if(null==t)return GD;var i=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==i)return GD;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var o=!0===e.settings.active;if(null!=i.index){if(o)return xH(xH({},i),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r,graphicalItemId:void 0};return xH(xH({},GD),{},{coordinate:i.coordinate})};function _H(e,t){var n=function(e){if("number"===typeof e)return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}(e),r=t[0],i=t[1];if(void 0===n)return!1;var o=Math.min(r,i),a=Math.max(r,i);return n>=o&&n<=a}var SH=(e,t,n,r)=>{var i=null===e||void 0===e?void 0:e.index;if(null==i)return null;var o=Number(i);if(!sO(o))return i;var a=1/0;t.length>0&&(a=t.length-1);var s=Math.max(0,Math.min(o,a)),u=t[s];return null==u||function(e,t,n){if(null==n||null==t)return!0;var r=YR(e,t);return null==r||!Qz(n)||_H(r,n)}(u,n,r)?String(s):null},kH=(e,t,n,r,i,o,a,s)=>{if(null!=o&&null!=s){var u=a[0],l=null==u?void 0:s(u.positions,o);if(null!=l)return l;var c=null===i||void 0===i?void 0:i[Number(o)];if(c)return"horizontal"===n?{x:c.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:c.coordinate}}},CH=(e,t,n,r)=>{if("axis"===t)return e.tooltipItemPayloads;if(0===e.tooltipItemPayloads.length)return[];var i;if(null==(i="hover"===n?e.itemInteraction.hover.graphicalItemId:e.itemInteraction.click.graphicalItemId)&&null!=r){var o=e.tooltipItemPayloads[0];return null!=o?[o]:[]}return e.tooltipItemPayloads.filter(e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.graphicalItemId)===i})},IH=e=>e.options.tooltipPayloadSearcher,TH=e=>e.tooltip;function AH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function OH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AH(Object(n),!0).forEach(function(t){NH(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AH(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function NH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var PH=(e,t,n,r,i,o,a)=>{if(null!=t&&null!=o){var{chartData:s,computedData:u,dataStartIndex:l,dataEndIndex:c}=n;return e.reduce((e,n)=>{var h,d,f,{dataDefinedOnItem:p,settings:m}=n,g=function(e,t){return null!=e?e:t}(p,s),v=Array.isArray(g)?qR(g,l,c):g,y=null!==(h=null===m||void 0===m?void 0:m.dataKey)&&void 0!==h?h:r,b=null===m||void 0===m?void 0:m.nameKey;(d=r&&Array.isArray(v)&&!Array.isArray(v[0])&&"axis"===a?YA(v,r,i):o(v,t,u,b),Array.isArray(d))?d.forEach(t=>{var n=OH(OH({},m),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(uM({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:YR(t.payload,t.dataKey),name:t.name}))}):e.push(uM({tooltipEntrySettings:m,dataKey:y,payload:d,value:YR(d,y),name:null!==(f=YR(d,b))&&void 0!==f?f:null===m||void 0===m?void 0:m.name}));return e},[])}},DH=kR([XV,RM,AV,yU,fV],AW),RH=kR([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),MH=kR([fV,pV],OV),jH=kR([RH,XV,MH],DV,{memoizeOptions:{resultEqualityCheck:dV}}),FH=kR([jH],e=>e.filter(cV)),LH=kR([jH],LV,{memoizeOptions:{resultEqualityCheck:dV}}),BH=kR([LH,Kz],zV),zH=kR([FH,Kz,XV],lV),UH=kR([BH,XV,jH],VV),VH=kR([XV],tW),WH=kR([XV],e=>e.allowDataOverflow),HH=kR([VH,WH],Zz),qH=kR([jH],e=>e.filter(cV)),GH=kR([zH,qH,gU,vU],$V),KH=kR([GH,Kz,fV,HH],JV),XH=kR([jH],jV),YH=kR([BH,XV,XH,oW,fV],sW,{memoizeOptions:{resultEqualityCheck:hV}}),QH=kR([cW,fV,pV],hW),$H=kR([QH,fV],vW),ZH=kR([fW,fV,pV],hW),JH=kR([ZH,fV],bW),eq=kR([mW,fV,pV],hW),tq=kR([eq,fV],wW),nq=kR([$H,tq,JH],aW),rq=kR([XV,VH,HH,KH,YH,nq,RM,fV],SW),iq=kR([XV,RM,BH,UH,gU,fV,rq],IW),oq=kR([iq,XV,DH],PW),aq=kR([XV,iq,oq,fV],RW),sq=e=>{var t=fV(e),n=pV(e);return VW(e,t,n,!1)},uq=kR([XV,sq],GU),lq=kR([XV,DH,aq,uq],NW),cq=kR([RM,UH,XV,fV],iH),hq=kR([RM,UH,XV,fV],aH),dq=kR([RM,XV,DH,lq,sq,cq,hq,fV],(e,t,n,r,i,o,a,s)=>{if(t){var{type:u}=t,l=QR(e,s);if(r){var c="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,h="category"===u&&r.bandwidth?r.bandwidth()/c:0;return h="angleAxis"===s&&null!=i&&(null===i||void 0===i?void 0:i.length)>=2?2*BA(i[0]-i[1])*h:h,l&&a?a.map((e,t)=>({coordinate:r(e)+h,value:e,index:t,offset:h})):r.domain().map((e,t)=>({coordinate:r(e)+h,value:o?o[e]:e,index:t,offset:h}))}}}),fq=kR([pH,mH,e=>e.tooltip.settings],(e,t,n)=>gH(n.shared,e,t)),pq=e=>e.tooltip.settings.trigger,mq=e=>e.tooltip.settings.defaultIndex,gq=kR([TH,fq,pq,mq],EH),vq=kR([gq,BH,YV,iq],SH),yq=kR([dq,vq],yH),bq=kR([gq],e=>{if(e)return e.dataKey}),xq=kR([gq],e=>{if(e)return e.graphicalItemId}),wq=kR([TH,fq,pq,mq],CH),Eq=kR([cM,hM,RM,wM,dq,mq,wq,IH],kH),_q=kR([gq,Eq],(e,t)=>null!==e&&void 0!==e&&e.coordinate?e.coordinate:t),Sq=kR([gq],e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.active)&&void 0!==t&&t}),kq=kR([wq,vq,Kz,YV,yq,IH,fq],PH),Cq=kR([kq],e=>{if(null!=e){var t=e.map(e=>e.payload).filter(e=>null!=e);return Array.from(new Set(t))}});function Iq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Iq(Object(n),!0).forEach(function(t){Aq(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Aq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oq=(e,t,n,r,i)=>{var o,a=null!==(o=null===t||void 0===t?void 0:t.length)&&void 0!==o?o:0;if(a<=1||null==e)return 0;if("angleAxis"===r&&null!=i&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var s=0;s<a;s++){var u,l,c,h,d,f=s>0?null===(u=n[s-1])||void 0===u?void 0:u.coordinate:null===(l=n[a-1])||void 0===l?void 0:l.coordinate,p=null===(c=n[s])||void 0===c?void 0:c.coordinate,m=s>=a-1?null===(h=n[0])||void 0===h?void 0:h.coordinate:null===(d=n[s+1])||void 0===d?void 0:d.coordinate,g=void 0;if(null!=f&&null!=p&&null!=m)if(BA(p-f)!==BA(m-p)){var v=[];if(BA(m-p)===BA(i[1]-i[0])){g=m;var y=p+i[1]-i[0];v[0]=Math.min(y,(y+f)/2),v[1]=Math.max(y,(y+f)/2)}else{g=f;var b=m+i[1]-i[0];v[0]=Math.min(p,(b+p)/2),v[1]=Math.max(p,(b+p)/2)}var x,w=[Math.min(p,(g+p)/2),Math.max(p,(g+p)/2)];if(e>w[0]&&e<=w[1]||e>=v[0]&&e<=v[1])return null===(x=n[s])||void 0===x?void 0:x.index}else{var E,_=Math.min(f,m),S=Math.max(f,m);if(e>(_+p)/2&&e<=(S+p)/2)return null===(E=n[s])||void 0===E?void 0:E.index}}else if(t)for(var k=0;k<a;k++){var C=t[k];if(null!=C){var I=t[k+1],T=t[k-1];if(0===k&&null!=I&&e<=(C.coordinate+I.coordinate)/2)return C.index;if(k===a-1&&null!=T&&e>(C.coordinate+T.coordinate)/2)return C.index;if(k>0&&k<a-1&&null!=T&&null!=I&&e>(C.coordinate+T.coordinate)/2&&e<=(C.coordinate+I.coordinate)/2)return C.index}}return-1},Nq=(e,t)=>t,Pq=(e,t,n)=>n,Dq=(e,t,n,r)=>r,Rq=kR(dq,e=>jR()(e,e=>e.coordinate)),Mq=kR([TH,Nq,Pq,Dq],EH),jq=kR([Mq,BH,YV,iq],SH),Fq=kR([TH,Nq,Pq,Dq],CH),Lq=kR([cM,hM,RM,wM,dq,Dq,Fq,IH],kH),Bq=kR([Mq,Lq],(e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t}),zq=kR([dq,jq],yH),Uq=kR([Fq,jq,Kz,YV,zq,IH,Nq],PH),Vq=kR([Mq,jq],(e,t)=>({isActive:e.active&&null!=t,activeIndex:t})),Wq=(e,t,n,r,i,o,a)=>{if(e&&r&&i&&o&&n){var s=NU(e,n);if(s){var u=((e,t)=>"centric"===t?e.angle:e.radius)(s,t),l=Oq(u,a,o,r,i),c=((e,t,n,r)=>{var i=t.find(e=>e&&e.index===n);if(i){if("centric"===e){var o=i.coordinate,{radius:a}=r;return Tq(Tq(Tq({},r),IU(r.cx,r.cy,a,o)),{},{angle:o,radius:a})}var s=i.coordinate,{angle:u}=r;return Tq(Tq(Tq({},r),IU(r.cx,r.cy,s,u)),{},{angle:u,radius:s})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}})(t,o,l,s);return{activeIndex:String(l),activeCoordinate:c}}}},Hq=kR([(e,t)=>t,RM,oV,fV,uq,dq,Rq,wM],(e,t,n,r,i,o,a,s)=>{if(e&&t&&r&&i&&o)return"horizontal"===t||"vertical"===t?((e,t,n,r,i,o,a)=>{if(e&&n&&r&&i&&function(e,t){var{chartX:n,chartY:r}=e;return n>=t.left&&n<=t.left+t.width&&r>=t.top&&r<=t.top+t.height}(e,a)){var s=((e,t)=>"horizontal"===t?e.chartX:"vertical"===t?e.chartY:void 0)(e,t),u=Oq(s,o,i,n,r),l=((e,t,n,r)=>{var i=t.find(e=>e&&e.index===n);if(i){if("horizontal"===e)return{x:i.coordinate,y:r.chartY};if("vertical"===e)return{x:r.chartX,y:i.coordinate}}return{x:0,y:0}})(t,i,u,e);return{activeIndex:String(u),activeCoordinate:l}}})(e,t,r,i,o,a,s):Wq(e,t,n,r,i,o,a)}),qq=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},Gq=qN("mouseClick"),Kq=LP();Kq.startListening({actionCreator:Gq,effect:(e,t)=>{var n=e.payload,r=Hq(t.getState(),qq(n));null!=(null===r||void 0===r?void 0:r.activeIndex)&&t.dispatch(rR({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var Xq=qN("mouseMove"),Yq=LP(),Qq=null;function $q(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":"children"===e&&"object"===typeof t&&null!==t?"<<CHILDREN>>":t}function Zq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zq(Object(n),!0).forEach(function(t){eG(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Yq.startListening({actionCreator:Xq,effect:(e,t)=>{var n=e.payload;null!==Qq&&cancelAnimationFrame(Qq);var r=qq(n);Qq=requestAnimationFrame(()=>{var e=t.getState();if("axis"===vH(e,e.tooltip.settings.shared)){var n=Hq(e,r);null!=(null===n||void 0===n?void 0:n.activeIndex)?t.dispatch(nR({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate})):t.dispatch(eR())}Qq=null})}});var tG=aP({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:QN()},replaceXAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.xAxis[n.id]&&(n.id!==r.id&&delete e.xAxis[n.id],e.xAxis[r.id]=r)},prepare:QN()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:QN()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:QN()},replaceYAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.yAxis[n.id]&&(n.id!==r.id&&delete e.yAxis[n.id],e.yAxis[r.id]=r)},prepare:QN()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:QN()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:QN()},replaceZAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.zAxis[n.id]&&(n.id!==r.id&&delete e.zAxis[n.id],e.zAxis[r.id]=r)},prepare:QN()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:QN()},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload,i=e.yAxis[n];if(i){var o=i.widthHistory||[];if(3===o.length&&o[0]===o[2]&&r===o[1]&&r!==i.width&&Math.abs(r-o[0])<=1)return;var a=[...o,r].slice(-3);e.yAxis[n]=Jq(Jq({},e.yAxis[n]),{},{width:r,widthHistory:a})}}}}),{addXAxis:nG,replaceXAxis:rG,removeXAxis:iG,addYAxis:oG,replaceYAxis:aG,removeYAxis:sG,addZAxis:uG,replaceZAxis:lG,removeZAxis:cG,updateYAxisWidth:hG}=tG.actions,dG=tG.reducer,fG=aP({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:QN()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:r}=t.payload,i=IN(e).cartesianItems.indexOf(n);i>-1&&(e.cartesianItems[i]=r)},prepare:QN()},removeCartesianGraphicalItem:{reducer(e,t){var n=IN(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:QN()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:QN()},removePolarGraphicalItem:{reducer(e,t){var n=IN(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:QN()}}}),{addCartesianGraphicalItem:pG,replaceCartesianGraphicalItem:mG,removeCartesianGraphicalItem:gG,addPolarGraphicalItem:vG,removePolarGraphicalItem:yG}=fG.actions,bG=fG.reducer,xG=aP({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=IN(e).dots.findIndex(e=>e===t.payload);-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=IN(e).areas.findIndex(e=>e===t.payload);-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=IN(e).lines.findIndex(e=>e===t.payload);-1!==n&&e.lines.splice(n,1)}}}),{addDot:wG,removeDot:EG,addArea:_G,removeArea:SG,addLine:kG,removeLine:CG}=xG.actions,IG=xG.reducer,TG={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},AG=aP({name:"brush",initialState:TG,reducers:{setBrushSettings:(e,t)=>null==t.payload?TG:t.payload}}),{setBrushSettings:OG}=AG.actions,NG=AG.reducer,PG=aP({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:QN()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:r}=t.payload,i=IN(e).payload.indexOf(n);i>-1&&(e.payload[i]=r)},prepare:QN()},removeLegendPayload:{reducer(e,t){var n=IN(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:QN()}}}),{setLegendSize:DG,setLegendSettings:RG,addLegendPayload:MG,replaceLegendPayload:jG,removeLegendPayload:FG}=PG.actions,LG=PG.reducer,BG={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},zG=aP({name:"rootProps",initialState:BG,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:BG.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),UG=zG.reducer,{updateOptions:VG}=zG.actions,WG=aP({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:HG,removeRadiusAxis:qG,addAngleAxis:GG,removeAngleAxis:KG}=WG.actions,XG=WG.reducer,YG=aP({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:QG}=YG.actions,$G=YG.reducer,ZG=qN("keyDown"),JG=qN("focus"),eK=LP();eK.startListening({actionCreator:ZG,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,i=e.payload;if("ArrowRight"===i||"ArrowLeft"===i||"Enter"===i){var o=SH(r,BH(n),YV(n),iq(n)),a=null==o?-1:Number(o);if(Number.isFinite(a)&&!(a<0)){var s=dq(n);if("Enter"!==i){var u=a+("ArrowRight"===i?1:-1)*("left-to-right"===fH(n)?1:-1);if(!(null==s||u>=s.length||u<0)){var l=Lq(n,"axis","hover",String(u));t.dispatch(oR({active:!0,activeIndex:u.toString(),activeCoordinate:l}))}}else{var c=Lq(n,"axis","hover",String(r.index));t.dispatch(oR({active:!r.active,activeIndex:r.index,activeCoordinate:c}))}}}}}}),eK.startListening({actionCreator:JG,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var i=Lq(n,"axis","hover",String("0"));t.dispatch(oR({active:!0,activeIndex:"0",activeCoordinate:i}))}}}});var tK=qN("externalEvent"),nK=LP(),rK=new Map;nK.startListening({actionCreator:tK,effect:(e,t)=>{var{handler:n,reactEvent:r}=e.payload;if(null!=n){r.persist();var i=r.type,o=rK.get(i);void 0!==o&&cancelAnimationFrame(o);var a=requestAnimationFrame(()=>{try{var e=t.getState(),o={activeCoordinate:_q(e),activeDataKey:bq(e),activeIndex:vq(e),activeLabel:yq(e),activeTooltipIndex:vq(e),isTooltipActive:Sq(e)};n(o,r)}finally{rK.delete(i)}});rK.set(i,a)}}});var iK=kR([TH],e=>e.tooltipItemPayloads),oK=kR([iK,IH,(e,t)=>t,(e,t,n)=>n],(e,t,n,r)=>{var i=e.find(e=>e.settings.graphicalItemId===r);if(null!=i){var{positions:o}=i;if(null!=o)return t(o,n)}}),aK=qN("touchMove"),sK=LP();sK.startListening({actionCreator:aK,effect:(e,t)=>{var n=e.payload;if(null!=n.touches&&0!==n.touches.length){var r=t.getState(),i=vH(r,r.tooltip.settings.shared);if("axis"===i){var o=n.touches[0];if(null==o)return;var a=Hq(r,qq({clientX:o.clientX,clientY:o.clientY,currentTarget:n.currentTarget}));null!=(null===a||void 0===a?void 0:a.activeIndex)&&t.dispatch(nR({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if("item"===i){var s,u=n.touches[0];if(null==document.elementFromPoint||null==u)return;var l=document.elementFromPoint(u.clientX,u.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(gM),h=null!==(s=l.getAttribute(vM))&&void 0!==s?s:void 0,d=jH(r).find(e=>e.id===h);if(null==c||null==d||null==h)return;var{dataKey:f}=d,p=oK(r,c,h);t.dispatch(ZD({activeDataKey:f,activeIndex:c,activeCoordinate:p,activeGraphicalItemId:h}))}}}});var uK=aP({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:i}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?i:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:lK,replaceErrorBar:cK,removeErrorBar:hK}=uK.actions,dK=uK.reducer,fK=!0,pK=!("undefined"!==typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout);function mK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mK(Object(n),!0).forEach(function(t){vK(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mK(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yK={zIndexMap:Object.values(PU).reduce((e,t)=>gK(gK({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),{})},bK=new Set(Object.values(PU));var xK=aP({name:"zIndex",initialState:yK,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:QN()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!function(e){return bK.has(e)}(n)&&delete e.zIndexMap[n])},prepare:QN()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:r,isPanorama:i}=t.payload;e.zIndexMap[n]?i?e.zIndexMap[n].panoramaElement=r:e.zIndexMap[n].element=r:e.zIndexMap[n]={consumers:0,element:i?void 0:r,panoramaElement:i?r:void 0}},prepare:QN()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:QN()}}}),{registerZIndexPortal:wK,unregisterZIndexPortal:EK,registerZIndexPortalElement:_K,unregisterZIndexPortalElement:SK}=xK.actions,kK=FN({brush:NG,cartesianAxis:dG,chartData:hR,errorBars:dK,graphicalItems:bG,layout:vR,legend:LG,options:VP,polarAxis:XG,polarOptions:$G,referenceElements:IG,rootProps:UG,tooltip:aR,zIndex:xK.reducer});function CK(e){var{preloadedState:n,children:r,reduxStoreName:i}=e,o=kM(),a=(0,t.useRef)(null);if(o)return r;null==a.current&&(a.current=function(e){return JN({reducer:kK,preloadedState:e,middleware:e=>e({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes("es6")}).concat([Kq.middleware,Yq.middleware,eK.middleware,nK.middleware,sK.middleware]),enhancers:e=>{var t=e;return"function"===typeof e&&(t=e()),t.concat(ZN({type:"raf"}))},devTools:fK&&{serialize:{replacer:$q},name:"recharts-".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart")}})}(n,i));var s=TR;return t.createElement(nD,{context:s,store:a.current},r)}var IK=e=>{var{chartData:n}=e,r=OR(),i=kM();return(0,t.useEffect)(()=>i?()=>{}:(r(uR(n)),()=>{r(uR(void 0))}),[n,r,i]),null},TK=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function AK(e,t){return null==e&&null==t||("number"===typeof e&&"number"===typeof t?e===t||e!==e&&t!==t:e===t)}function OK(e,t){var n=new Set([...Object.keys(e),...Object.keys(t)]);for(var r of n)if(TK.has(r)){if(null==e[r]&&null==t[r])continue;if(!$P(e[r],t[r]))return!1}else if(!AK(e[r],t[r]))return!1;return!0}function NK(e){var{layout:n,margin:r}=e,i=OR(),o=kM();return(0,t.useEffect)(()=>{o||(i(pR(n)),i(fR(r)))},[i,o,n,r]),null}var PK=(0,t.memo)(NK,OK);function DK(e){var n=OR();return(0,t.useEffect)(()=>{n(VG(e))},[n,e]),null}function RK(e){var n=OR();return(0,t.useEffect)(()=>{n(QG(e))},[n,e]),null}var MK=()=>{var e;return null===(e=RR(e=>e.rootProps.accessibilityLayer))||void 0===e||e},jK=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function FK(e){return"string"===typeof e&&jK.includes(e)}var LK=new Set(["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"]);function BK(e){return"string"===typeof e&&LK.has(e)}function zK(e){return"string"===typeof e&&e.startsWith("data-")}function UK(e){if("object"!==typeof e||null===e)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(BK(n)||zK(n))&&(t[n]=e[n]);return t}function VK(e){return null==e?null:(0,t.isValidElement)(e)&&"object"===typeof e.props&&null!==e.props?UK(e.props):"object"!==typeof e||Array.isArray(e)?null:UK(e)}function WK(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(BK(n)||zK(n)||FK(n))&&(t[n]=e[n]);return t}var HK=["children","width","height","viewBox","className","style","title","desc"];function qK(){return qK=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qK.apply(null,arguments)}var GK=(0,t.forwardRef)((e,n)=>{var{children:r,width:i,height:o,viewBox:a,className:s,style:u,title:l,desc:c}=e,h=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,HK),d=a||{width:i,height:o,x:0,y:0},f=PA("recharts-surface",s);return t.createElement("svg",qK({},WK(h),{className:f,width:i,height:o,style:u,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:n}),t.createElement("title",null,l),t.createElement("desc",null,c),r)}),KK=kR(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(null!=t){var r=e[t];if(null!=r)return n?r.panoramaElement:r.element}}),XK=kR(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(e=>parseInt(e,10)).concat(Object.values(PU));return Array.from(new Set(t)).sort((e,t)=>e-t)},{memoizeOptions:{resultEqualityCheck:function(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}}});function YK(e){var{zIndex:n,isPanorama:r}=e,i=(0,t.useRef)(null),o=OR();return(0,t.useLayoutEffect)(()=>(i.current&&o(_K({zIndex:n,element:i.current,isPanorama:r})),()=>{o(SK({zIndex:n,isPanorama:r}))}),[o,n,r]),t.createElement("g",{tabIndex:-1,ref:i})}function QK(e){var{children:n,isPanorama:r}=e,i=RR(XK);if(!i||0===i.length)return n;var o=i.filter(e=>e<0),a=i.filter(e=>e>0);return t.createElement(t.Fragment,null,o.map(e=>t.createElement(YK,{key:e,zIndex:e,isPanorama:r})),n,a.map(e=>t.createElement(YK,{key:e,zIndex:e,isPanorama:r})))}var $K=["children"];function ZK(){return ZK=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZK.apply(null,arguments)}var JK={width:"100%",height:"100%",display:"block"},eX=(0,t.forwardRef)((e,n)=>{var r=PM(),i=DM(),o=MK();if(!uO(r)||!uO(i))return null;var a,s,{children:u,otherAttributes:l,title:c,desc:h}=e;return null!=l&&(a="number"===typeof l.tabIndex?l.tabIndex:o?0:void 0,s="string"===typeof l.role?l.role:o?"application":void 0),t.createElement(GK,ZK({},l,{title:c,desc:h,role:s,tabIndex:a,width:r,height:i,style:JK,ref:n}),u)}),tX=e=>{var{children:n}=e,r=RR(IM);if(!r)return null;var{width:i,height:o,y:a,x:s}=r;return t.createElement(GK,{width:i,height:o,x:s,y:a},n)},nX=(0,t.forwardRef)((e,n)=>{var{children:r}=e,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,$K);return kM()?t.createElement(tX,null,t.createElement(QK,{isPanorama:!0},r)):t.createElement(eX,ZK({ref:n},i),t.createElement(QK,{isPanorama:!1},r))});var rX=new(n(8499)),iX="recharts.syncEvent.tooltip",oX="recharts.syncEvent.brush";function aX(e){return e.tooltip.syncInteraction}var sX=["x","y"];function uX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uX(Object(n),!0).forEach(function(t){cX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function cX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hX(){var e=RR(bU),n=RR(wU),r=OR(),i=RR(xU),o=RR(dq),a=MM(),s=AM(),u=RR(e=>e.rootProps.className);(0,t.useEffect)(()=>{if(null==e)return JA;var t=(t,u,l)=>{var c;if(n!==l&&e===t)if("index"!==i){if(null!=o){var h;if("function"===typeof i){var d={activeTooltipIndex:null==u.payload.index?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:null==u.payload.index?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},f=i(o,d);h=o[f]}else"value"===i&&(h=o.find(e=>String(e.value)===u.payload.label));var{coordinate:p}=u.payload;if(null!=h&&!1!==u.payload.active&&null!=p&&null!=s){var{x:m,y:g}=p,v=Math.min(m,s.x+s.width),y=Math.min(g,s.y+s.height),b={x:"horizontal"===a?h.coordinate:v,y:"horizontal"===a?y:h.coordinate},x=iR({active:u.payload.active,coordinate:b,dataKey:u.payload.dataKey,index:String(h.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox,graphicalItemId:u.payload.graphicalItemId});r(x)}else r(iR({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}))}}else if(s&&null!==u&&void 0!==u&&null!==(c=u.payload)&&void 0!==c&&c.coordinate&&u.payload.sourceViewBox){var w=u.payload.coordinate,{x:E,y:_}=w,S=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(w,sX),{x:k,y:C,width:I,height:T}=u.payload.sourceViewBox,A=lX(lX({},S),{},{x:s.x+(I?(E-k)/I:0)*s.width,y:s.y+(T?(_-C)/T:0)*s.height});r(lX(lX({},u),{},{payload:lX(lX({},u.payload),{},{coordinate:A})}))}else r(u)};return rX.on(iX,t),()=>{rX.off(iX,t)}},[u,r,n,e,i,o,a,s])}function dX(){var e=OR();(0,t.useEffect)(()=>{e(WP())},[e]),hX(),function(){var e=RR(bU),n=RR(wU),r=OR();(0,t.useEffect)(()=>{if(null==e)return JA;var t=(t,i,o)=>{n!==o&&e===t&&r(lR(i))};return rX.on(oX,t),()=>{rX.off(oX,t)}},[r,n,e])}()}function fX(e,n,r,i,o,a){var s=RR(t=>((e,t,n)=>{if(null!=t){var r=TH(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(t,e,n)),u=RR(wU),l=RR(bU),c=RR(xU),h=RR(aX),d=null===h||void 0===h?void 0:h.active,f=AM();(0,t.useEffect)(()=>{if(!d&&null!=l&&null!=u){var e=iR({active:a,coordinate:r,dataKey:s,index:o,label:"number"===typeof i?String(i):i,sourceViewBox:f,graphicalItemId:void 0});rX.emit(iX,l,e,u)}},[d,r,s,o,i,u,l,c,a,f])}var pX=(0,t.createContext)(null),mX=(0,t.createContext)(null);function gX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gX(Object(n),!0).forEach(function(t){yX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bX(){return bX=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bX.apply(null,arguments)}var xX=()=>(dX(),null);function wX(e){if("number"===typeof e)return e;if("string"===typeof e){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var EX=(0,t.forwardRef)((e,n)=>{var r,i,o=(0,t.useRef)(null),[a,s]=(0,t.useState)({containerWidth:wX(null===(r=e.style)||void 0===r?void 0:r.width),containerHeight:wX(null===(i=e.style)||void 0===i?void 0:i.height)}),u=(0,t.useCallback)((e,t)=>{s(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]),l=(0,t.useCallback)(e=>{if("function"===typeof n&&n(e),null!=e&&"undefined"!==typeof ResizeObserver){var{width:t,height:r}=e.getBoundingClientRect();u(t,r);var i=new ResizeObserver(e=>{var{width:t,height:n}=e[0].contentRect;u(t,n)});i.observe(e),o.current=i}},[n,u]);return(0,t.useEffect)(()=>()=>{var e=o.current;null!=e&&e.disconnect()},[u]),t.createElement(t.Fragment,null,t.createElement(jM,{width:a.containerWidth,height:a.containerHeight}),t.createElement("div",bX({ref:l},e)))}),_X=(0,t.forwardRef)((e,n)=>{var{width:r,height:i}=e,[o,a]=(0,t.useState)({containerWidth:wX(r),containerHeight:wX(i)}),s=(0,t.useCallback)((e,t)=>{a(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]),u=(0,t.useCallback)(e=>{if("function"===typeof n&&n(e),null!=e){var{width:t,height:r}=e.getBoundingClientRect();s(t,r)}},[n,s]);return t.createElement(t.Fragment,null,t.createElement(jM,{width:o.containerWidth,height:o.containerHeight}),t.createElement("div",bX({ref:u},e)))}),SX=(0,t.forwardRef)((e,n)=>{var{width:r,height:i}=e;return t.createElement(t.Fragment,null,t.createElement(jM,{width:r,height:i}),t.createElement("div",bX({ref:n},e)))}),kX=(0,t.forwardRef)((e,n)=>{var{width:r,height:i}=e;return UA(r)||UA(i)?t.createElement(_X,bX({},e,{ref:n})):t.createElement(SX,bX({},e,{ref:n}))});var CX=(0,t.forwardRef)((e,n)=>{var{children:r,className:i,height:o,onClick:a,onContextMenu:s,onDoubleClick:u,onMouseDown:l,onMouseEnter:c,onMouseLeave:h,onMouseMove:d,onMouseUp:f,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:v,width:y,responsive:b,dispatchTouchEvents:x=!0}=e,w=(0,t.useRef)(null),E=OR(),[_,S]=(0,t.useState)(null),[k,C]=(0,t.useState)(null),I=function(){var e=OR(),[n,r]=(0,t.useState)(null),i=RR(dM);return(0,t.useEffect)(()=>{if(null!=n){var t=n.getBoundingClientRect().width/n.offsetWidth;sO(t)&&t!==i&&e(gR(t))}},[n,e,i]),r}(),T=mO(),A=(null===T||void 0===T?void 0:T.width)>0?T.width:y,O=(null===T||void 0===T?void 0:T.height)>0?T.height:o,N=(0,t.useCallback)(e=>{I(e),"function"===typeof n&&n(e),S(e),C(e),null!=e&&(w.current=e)},[I,n,S,C]),P=(0,t.useCallback)(e=>{E(Gq(e)),E(tK({handler:a,reactEvent:e}))},[E,a]),D=(0,t.useCallback)(e=>{E(Xq(e)),E(tK({handler:c,reactEvent:e}))},[E,c]),R=(0,t.useCallback)(e=>{E(eR()),E(tK({handler:h,reactEvent:e}))},[E,h]),M=(0,t.useCallback)(e=>{E(Xq(e)),E(tK({handler:d,reactEvent:e}))},[E,d]),j=(0,t.useCallback)(()=>{E(JG())},[E]),F=(0,t.useCallback)(e=>{E(ZG(e.key))},[E]),L=(0,t.useCallback)(e=>{E(tK({handler:s,reactEvent:e}))},[E,s]),B=(0,t.useCallback)(e=>{E(tK({handler:u,reactEvent:e}))},[E,u]),z=(0,t.useCallback)(e=>{E(tK({handler:l,reactEvent:e}))},[E,l]),U=(0,t.useCallback)(e=>{E(tK({handler:f,reactEvent:e}))},[E,f]),V=(0,t.useCallback)(e=>{E(tK({handler:g,reactEvent:e}))},[E,g]),W=(0,t.useCallback)(e=>{x&&E(aK(e)),E(tK({handler:m,reactEvent:e}))},[E,x,m]),H=(0,t.useCallback)(e=>{E(tK({handler:p,reactEvent:e}))},[E,p]),q=function(e){return!0===e?EX:kX}(b);return t.createElement(pX.Provider,{value:_},t.createElement(mX.Provider,{value:k},t.createElement(q,{width:null!==A&&void 0!==A?A:null===v||void 0===v?void 0:v.width,height:null!==O&&void 0!==O?O:null===v||void 0===v?void 0:v.height,className:PA("recharts-wrapper",i),style:vX({position:"relative",cursor:"default",width:A,height:O},v),onClick:P,onContextMenu:L,onDoubleClick:B,onFocus:j,onKeyDown:F,onMouseDown:z,onMouseEnter:D,onMouseLeave:R,onMouseMove:M,onMouseUp:U,onTouchEnd:H,onTouchMove:W,onTouchStart:V,ref:N},t.createElement(xX,null),r)))}),IX=kR([wM],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),TX=kR([IX,cM,hM],(e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),AX=()=>RR(TX),OX=(0,t.createContext)(void 0),NX=e=>{var{children:n}=e,[r]=(0,t.useState)("".concat(qA("recharts"),"-clip")),i=AX();if(null==i)return null;var{x:o,y:a,width:s,height:u}=i;return t.createElement(OX.Provider,{value:r},t.createElement("defs",null,t.createElement("clipPath",{id:r},t.createElement("rect",{x:o,y:a,height:u,width:s}))),n)},PX=["width","height","responsive","children","className","style","compact","title","desc"];var DX=(0,t.forwardRef)((e,n)=>{var{width:r,height:i,responsive:o,children:a,className:s,style:u,compact:l,title:c,desc:h}=e,d=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,PX),f=UK(d);return l?t.createElement(t.Fragment,null,t.createElement(jM,{width:r,height:i}),t.createElement(nX,{otherAttributes:f,title:c,desc:h},a)):t.createElement(CX,{className:s,style:u,width:r,height:i,responsive:null!==o&&void 0!==o&&o,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},t.createElement(nX,{otherAttributes:f,title:c,desc:h,ref:n},t.createElement(NX,null,a)))});function RX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function MX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jX(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RX(Object(n),!0).forEach(function(t){MX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e),r=t;return Object.keys(t).reduce((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e),n)}var FX=["layout"];function LX(){return LX=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LX.apply(null,arguments)}var BX={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},zX=(0,t.forwardRef)(function(e,n){var r,i=jX(e.categoricalChartProps,BX),{layout:o}=i,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(i,FX),{chartName:s,defaultTooltipEventType:u,validateTooltipEventTypes:l,tooltipPayloadSearcher:c}=e,h={chartName:s,defaultTooltipEventType:u,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return t.createElement(CK,{preloadedState:{options:h},reduxStoreName:null!==(r=i.id)&&void 0!==r?r:s},t.createElement(IK,{chartData:i.data}),t.createElement(PK,{layout:o,margin:i.margin}),t.createElement(DK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),t.createElement(RK,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),t.createElement(DX,LX({},a,{ref:n})))});function UX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function VX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UX(Object(n),!0).forEach(function(t){WX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function WX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var HX=["item"],qX=VX(VX({},BX),{},{layout:"centric",startAngle:0,endAngle:360}),GX=(0,t.forwardRef)((e,n)=>{var r=jX(e,qX);return t.createElement(zX,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:HX,tooltipPayloadSearcher:zP,categoricalChartProps:r,ref:n})}),KX=e=>e.graphicalItems.polarItems,XX=kR([aV,sV],OV),YX=kR([KX,IV,XX],DV),QX=kR([YX],LV),$X=kR([QX,Xz],zV),ZX=kR([$X,IV,YX],VV),JX=(kR([$X,IV,YX],(e,t,n)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var r;return{value:YR(e,null!==(r=t.dataKey)&&void 0!==r?r:n.dataKey),errorDomain:[]}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:YR(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]}))),()=>{}),eY=kR([$X,IV,YX,oW,aV],sW),tY=kR([IV,nW,rW,JX,eY,JX,RM,aV],SW),nY=kR([IV,RM,$X,ZX,gU,aV,tY],IW),rY=kR([nY,IV,OW],PW);kR([IV,nY,rY,aV],RW);function iY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oY(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iY(Object(n),!0).forEach(function(t){aY(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iY(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sY=kR([KX,(e,t)=>t],(e,t)=>e.filter(e=>"pie"===e.type).find(e=>e.id===t)),uY=[],lY=(e,t,n)=>0===(null===n||void 0===n?void 0:n.length)?uY:n,cY=kR([Xz,sY,lY],(e,t,n)=>{var r,{chartData:i}=e;if(null!=t&&((r=null!=(null===t||void 0===t?void 0:t.data)&&t.data.length>0?t.data:i)&&r.length||null==n||(r=n.map(e=>oY(oY({},t.presentationProps),e.props))),null!=r))return r}),hY=kR([cY,sY,lY],(e,t,n)=>{if(null!=e&&null!=t)return e.map((e,r)=>{var i,o,a=YR(e,t.nameKey,t.name);return o=null!==n&&void 0!==n&&null!==(i=n[r])&&void 0!==i&&null!==(i=i.props)&&void 0!==i&&i.fill?n[r].props.fill:"object"===typeof e&&null!=e&&"fill"in e?e.fill:t.fill,{value:lM(a,t.dataKey),color:o,payload:e,type:t.legendType}})}),dY=kR([cY,sY,lY,wM],(e,t,n,r)=>{if(null!=t&&null!=e)return function(e){var t,n,r,{pieSettings:i,displayedData:o,cells:a,offset:s}=e,{cornerRadius:u,startAngle:l,endAngle:c,dataKey:h,nameKey:d,tooltipType:f}=i,p=Math.abs(i.minAngle),m=S0(l,c),g=Math.abs(m),v=o.length<=1?0:null!==(t=i.paddingAngle)&&void 0!==t?t:0,y=o.filter(e=>0!==YR(e,h,0)).length,b=g-y*p-(g>=360?y:y-1)*v,x=o.reduce((e,t)=>{var n=YR(t,h,0);return e+(VA(n)?n:0)},0);x>0&&(n=o.map((e,t)=>{var n,o=YR(e,h,0),c=YR(e,d,t),g=_0(i,s,e),y=(VA(o)?o:0)/x,w=g0(g0({},e),a&&a[t]&&a[t].props),E=(n=t?r.endAngle+BA(m)*v*(0!==o?1:0):l)+BA(m)*((0!==o?p:0)+y*b),_=(n+E)/2,S=(g.innerRadius+g.outerRadius)/2,k=[{name:c,value:o,payload:w,dataKey:h,type:f,graphicalItemId:i.id}],C=IU(g.cx,g.cy,S,_);return r=g0(g0(g0(g0({},i.presentationProps),{},{percent:y,cornerRadius:"string"===typeof u?parseFloat(u):u,name:c,tooltipPayload:k,midAngle:_,middleRadius:S,tooltipPosition:C},w),g),{},{value:o,dataKey:h,startAngle:n,endAngle:E,payload:w,paddingAngle:BA(m)*v})}));return n}({offset:r,pieSettings:t,displayedData:e,cells:n})}),fY=["children","className"];function pY(){return pY=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pY.apply(null,arguments)}var mY,gY,vY,yY,bY,xY,wY,EY,_Y,SY,kY,CY,IY,TY,AY=t.forwardRef((e,n)=>{var{children:r,className:i}=e,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,fY),a=PA("recharts-layer",i);return t.createElement("g",pY({className:a},WK(o),{ref:n}),r)});function OY(){}function NY(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function PY(e){this._context=e}function DY(e){this._context=e}function RY(e){this._context=e}PY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:NY(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:NY(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},DY.prototype={areaStart:OY,areaEnd:OY,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:NY(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},RY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:NY(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class MY{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function jY(e){this._context=e}function FY(e){this._context=e}function LY(e){return new FY(e)}function BY(e){return e<0?-1:1}function zY(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(BY(o)+BY(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function UY(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function VY(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function WY(e){this._context=e}function HY(e){this._context=new qY(e)}function qY(e){this._context=e}function GY(e){this._context=e}function KY(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function XY(e,t){this._context=e,this._t=t}function YY(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}jY.prototype={areaStart:OY,areaEnd:OY,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},FY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},WY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:VY(this,this._t0,UY(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,VY(this,UY(this,n=zY(this,e,t)),n);break;default:VY(this,this._t0,n=zY(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(HY.prototype=Object.create(WY.prototype)).point=function(e,t){WY.prototype.point.call(this,t,e)},qY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},GY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=KY(e),i=KY(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},XY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const QY=Math.PI,$Y=2*QY,ZY=1e-6,JY=$Y-ZY;function eQ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class tQ{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?eQ:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return eQ;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(mY||(mY=YY(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(gY||(gY=YY(["Z"]))))}lineTo(e,t){this._append(vY||(vY=YY(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(yY||(yY=YY(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,i,o){this._append(bY||(bY=YY(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+o)}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,h=l*l+c*c;if(null===this._x1)this._append(xY||(xY=YY(["M",",",""])),this._x1=e,this._y1=t);else if(h>ZY)if(Math.abs(c*s-u*l)>ZY&&i){let d=n-o,f=r-a,p=s*s+u*u,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((QY-Math.acos((p+h-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>ZY&&this._append(EY||(EY=YY(["L",",",""])),e+b*l,t+b*c),this._append(_Y||(_Y=YY(["A",",",",0,0,",",",",",""])),i,i,+(c*d>l*f),this._x1=e+x*s,this._y1=t+x*u)}else this._append(wY||(wY=YY(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,h=o?r-i:i-r;null===this._x1?this._append(SY||(SY=YY(["M",",",""])),u,l):(Math.abs(this._x1-u)>ZY||Math.abs(this._y1-l)>ZY)&&this._append(kY||(kY=YY(["L",",",""])),u,l),n&&(h<0&&(h=h%$Y+$Y),h>JY?this._append(CY||(CY=YY(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,e-a,t-s,n,n,c,this._x1=u,this._y1=l):h>ZY&&this._append(IY||(IY=YY(["A",",",",0,",",",",",",",""])),n,n,+(h>=QY),c,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}rect(e,t,n,r){this._append(TY||(TY=YY(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function nQ(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new tQ(t)}function rQ(e){return e[0]}function iQ(e){return e[1]}function oQ(e,t){var n=UR(!0),r=null,i=LY,o=null,a=nQ(s);function s(s){var u,l,c,h=(s=zR(s)).length,d=!1;for(null==r&&(o=i(c=a())),u=0;u<=h;++u)!(u<h&&n(l=s[u],u,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(l,u,s),+t(l,u,s));if(c)return o=null,c+""||null}return e="function"===typeof e?e:void 0===e?rQ:UR(e),t="function"===typeof t?t:void 0===t?iQ:UR(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:UR(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:UR(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:UR(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function aQ(e,t,n){var r=null,i=UR(!0),o=null,a=LY,s=null,u=nQ(l);function l(l){var c,h,d,f,p,m=(l=zR(l)).length,g=!1,v=new Array(m),y=new Array(m);for(null==o&&(s=a(p=u())),c=0;c<=m;++c){if(!(c<m&&i(f=l[c],c,l))===g)if(g=!g)h=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=h;--d)s.point(v[d],y[d]);s.lineEnd(),s.areaEnd()}g&&(v[c]=+e(f,c,l),y[c]=+t(f,c,l),s.point(r?+r(f,c,l):v[c],n?+n(f,c,l):y[c]))}if(p)return s=null,p+""||null}function c(){return oQ().defined(i).curve(a).context(o)}return e="function"===typeof e?e:void 0===e?rQ:UR(+e),t="function"===typeof t?t:UR(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?iQ:UR(+n),l.x=function(t){return arguments.length?(e="function"===typeof t?t:UR(+t),r=null,l):e},l.x0=function(t){return arguments.length?(e="function"===typeof t?t:UR(+t),l):e},l.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:UR(+e),l):r},l.y=function(e){return arguments.length?(t="function"===typeof e?e:UR(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t="function"===typeof e?e:UR(+e),l):t},l.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:UR(+e),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(e){return arguments.length?(i="function"===typeof e?e:UR(!!e),l):i},l.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),l):a},l.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),l):o},l}var sQ=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,uQ=(e,n)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,t.isValidElement)(e)&&(r=e.props),"object"!==typeof r&&"function"!==typeof r)return null;var i={};return Object.keys(r).forEach(e=>{FK(e)&&(i[e]=n||(t=>r[e](r,t)))}),i},lQ=(e,t,n)=>{if(null===e||"object"!==typeof e&&"function"!==typeof e)return null;var r=null;return Object.keys(e).forEach(i=>{var o=e[i];FK(i)&&"function"===typeof o&&(r||(r={}),r[i]=((e,t,n)=>r=>(e(t,n,r),null))(o,t,n))}),r};function cQ(){return cQ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cQ.apply(null,arguments)}function hQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hQ(Object(n),!0).forEach(function(t){fQ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hQ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pQ={curveBasisClosed:function(e){return new DY(e)},curveBasisOpen:function(e){return new RY(e)},curveBasis:function(e){return new PY(e)},curveBumpX:function(e){return new MY(e,!0)},curveBumpY:function(e){return new MY(e,!1)},curveLinearClosed:function(e){return new jY(e)},curveLinear:LY,curveMonotoneX:function(e){return new WY(e)},curveMonotoneY:function(e){return new HY(e)},curveNatural:function(e){return new GY(e)},curveStep:function(e){return new XY(e,.5)},curveStepAfter:function(e){return new XY(e,1)},curveStepBefore:function(e){return new XY(e,0)}},mQ=e=>sO(e.x)&&sO(e.y),gQ=e=>null!=e.base&&mQ(e.base)&&mQ(e),vQ=e=>e.x,yQ=e=>e.y,bQ=e=>{var t,{type:n="linear",points:r=[],baseLine:i,layout:o,connectNulls:a=!1}=e,s=((e,t)=>{if("function"===typeof e)return e;var n="curve".concat($A(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?pQ[n]||LY:pQ["".concat(n).concat("vertical"===t?"Y":"X")]})(n,o),u=a?r.filter(mQ):r;if(Array.isArray(i)){var l=r.map((e,t)=>dQ(dQ({},e),{},{base:i[t]}));return t="vertical"===o?aQ().y(yQ).x1(vQ).x0(e=>e.base.x):aQ().x(vQ).y1(yQ).y0(e=>e.base.y),t.defined(gQ).curve(s)(a?l.filter(gQ):l)}return(t="vertical"===o&&VA(i)?aQ().y(yQ).x1(vQ).x0(i):VA(i)?aQ().x(vQ).y1(yQ).y0(i):oQ().x(vQ).y(yQ)).defined(mQ).curve(s)(u)},xQ=e=>{var{className:n,points:r,path:i,pathRef:o}=e,a=MM();if((!r||!r.length)&&!i)return null;var s={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||a,connectNulls:e.connectNulls},u=r&&r.length?bQ(s):i;return t.createElement("path",cQ({},UK(e),uQ(e),{className:PA("recharts-curve",n),d:null===u?void 0:u,ref:o}))};function wQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?EQ(Object(n),!0).forEach(function(t){SQ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EQ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function SQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kQ=_Q({},{cacheSize:2e3,enableCache:!0}),CQ=new class{constructor(e){wQ(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;null!=n&&this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(kQ.cacheSize),IQ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},TQ="recharts_measurement_span";var AQ=(e,t)=>{try{var n=document.getElementById(TQ);n||((n=document.createElement("span")).setAttribute("id",TQ),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,IQ,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(i){return{width:0,height:0}}},OQ=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||pK)return{width:0,height:0};if(!kQ.enableCache)return AQ(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",i=t.fontWeight||"",o=t.fontStyle||"",a=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(i,"|").concat(o,"|").concat(a,"|").concat(s)}(e,t),r=CQ.get(n);if(r)return r;var i=AQ(e,t);return CQ.set(n,i),i};var NQ=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,PQ=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,DQ=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,RQ=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,MQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},jQ=["cm","mm","pt","pc","in","Q","px"];var FQ="NaN";class LQ{static parse(e){var t,[,n,r]=null!==(t=RQ.exec(e))&&void 0!==t?t:[];return null==n?LQ.NaN:new LQ(parseFloat(n),null!==r&&void 0!==r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,zA(e)&&(this.unit=""),""===t||DQ.test(t)||(this.num=NaN,this.unit=""),function(e){return jQ.includes(e)}(t)&&(this.num=function(e,t){return e*MQ[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new LQ(NaN,""):new LQ(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new LQ(NaN,""):new LQ(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new LQ(NaN,""):new LQ(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new LQ(NaN,""):new LQ(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return zA(this.num)}}function BQ(e){if(null==e||e.includes(FQ))return FQ;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,i,o]=null!==(n=NQ.exec(t))&&void 0!==n?n:[],a=LQ.parse(null!==r&&void 0!==r?r:""),s=LQ.parse(null!==o&&void 0!==o?o:""),u="*"===i?a.multiply(s):a.divide(s);if(u.isNaN())return FQ;t=t.replace(NQ,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var l,[,c,h,d]=null!==(l=PQ.exec(t))&&void 0!==l?l:[],f=LQ.parse(null!==c&&void 0!==c?c:""),p=LQ.parse(null!==d&&void 0!==d?d:""),m="+"===h?f.add(p):f.subtract(p);if(m.isNaN())return FQ;t=t.replace(PQ,m.toString())}return t}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(LQ,"NaN",new LQ(NaN,""));var zQ=/\(([^()]*)\)/;function UQ(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=zQ.exec(n));){var[,r]=t;n=n.replace(zQ,BQ(r))}return n}(t),t=BQ(t)}function VQ(e){var t=function(e){try{return UQ(e)}catch(t){return FQ}}(e.slice(5,-1));return t===FQ?"":t}var WQ=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],HQ=["dx","dy","angle","className","breakAll"];function qQ(){return qQ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qQ.apply(null,arguments)}function GQ(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var KQ=/[ \f\n\r\t\v\u2028\u2029]+/,XQ=e=>{var{children:t,breakAll:n,style:r}=e;try{var i=[];return QA(t)||(i=n?t.toString().split(""):t.toString().split(KQ)),{wordsWithComputedWidth:i.map(e=>({word:e,width:OQ(e,r).width})),spaceWidth:n?0:OQ("\xa0",r).width}}catch(o){return null}};function YQ(e){return"start"===e||"middle"===e||"end"===e||"inherit"===e}var QQ=(e,t,n,r)=>e.reduce((e,i)=>{var{word:o,width:a}=i,s=e[e.length-1];if(s&&null!=a&&(null==t||r||s.width+a+n<Number(t)))s.words.push(o),s.width+=a+n;else{var u={words:[o],width:a};e.push(u)}return e},[]),$Q=e=>e.reduce((e,t)=>e.width>t.width?e:t),ZQ=(e,t,n,r,i,o,a,s)=>{var u=e.slice(0,t),l=XQ({breakAll:n,style:r,children:u+"\u2026"});if(!l)return[!1,[]];var c=QQ(l.wordsWithComputedWidth,o,a,s);return[c.length>i||$Q(c).width>Number(o),c]},JQ=e=>[{words:QA(e)?[]:e.toString().split(KQ),width:void 0}],e$=e=>{var{width:t,scaleToFit:n,children:r,style:i,breakAll:o,maxLines:a}=e;if((t||n)&&!pK){var s=XQ({breakAll:o,children:r,style:i});if(!s)return JQ(r);var{wordsWithComputedWidth:u,spaceWidth:l}=s;return((e,t,n,r,i)=>{var{maxLines:o,children:a,style:s,breakAll:u}=e,l=VA(o),c=String(a),h=QQ(t,r,n,i);if(!l||i)return h;if(!(h.length>o||$Q(h).width>Number(r)))return h;for(var d,f=0,p=c.length-1,m=0;f<=p&&m<=c.length-1;){var g=Math.floor((f+p)/2),v=g-1,[y,b]=ZQ(c,v,u,s,o,r,n,i),[x]=ZQ(c,g,u,s,o,r,n,i);if(y||x||(f=g+1),y&&x&&(p=g-1),!y&&x){d=b;break}m++}return d||h})({breakAll:o,children:r,maxLines:a,style:i},u,l,t,Boolean(n))}return JQ(r)},t$="#808080",n$={angle:0,breakAll:!1,capHeight:"0.71em",fill:t$,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},r$=(0,t.forwardRef)((e,n)=>{var r=jX(e,n$),{x:i,y:o,lineHeight:a,capHeight:s,fill:u,scaleToFit:l,textAnchor:c,verticalAnchor:h}=r,d=GQ(r,WQ),f=(0,t.useMemo)(()=>e$({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:l,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,l,d.style,d.width]),{dx:p,dy:m,angle:g,className:v,breakAll:y}=d,b=GQ(d,HQ);if(!WA(i)||!WA(o)||0===f.length)return null;var x,w=Number(i)+(VA(p)?p:0),E=Number(o)+(VA(m)?m:0);if(!sO(w)||!sO(E))return null;switch(h){case"start":x=VQ("calc(".concat(s,")"));break;case"middle":x=VQ("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(s," / 2))"));break;default:x=VQ("calc(".concat(f.length-1," * -").concat(a,")"))}var _=[];if(l){var S=f[0].width,{width:k}=d;_.push("scale(".concat(VA(k)&&VA(S)?k/S:1,")"))}return g&&_.push("rotate(".concat(g,", ").concat(w,", ").concat(E,")")),_.length&&(b.transform=_.join(" ")),t.createElement("text",qQ({},WK(b),{ref:n,x:w,y:E,className:PA("recharts-text",v),textAnchor:c,fill:u.includes("url")?t$:u}),f.map((e,n)=>{var r=e.words.join(y?"":" ");return t.createElement("tspan",{x:w,dy:0===n?x:a,key:"".concat(r,"-").concat(n)},r)}))});r$.displayName="Text";var i$=e=>null;i$.displayName="Cell";var o$=n(2086),a$=e=>"string"===typeof e?e:e?e.displayName||e.name||"Component":"",s$=null,u$=null,l$=e=>{if(e===s$&&Array.isArray(u$))return u$;var n=[];return t.Children.forEach(e,e=>{QA(e)||((0,o$.isFragment)(e)?n=n.concat(l$(e.props.children)):n.push(e))}),u$=n,s$=e,n};function c$(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(e=>a$(e)):[a$(t)],l$(e).forEach(e=>{var t=jA()(e,"type.displayName")||jA()(e,"type.name");t&&-1!==r.indexOf(t)&&n.push(e)}),n}var h$=e=>!e||"object"!==typeof e||!("clipDot"in e)||Boolean(e.clipDot),d$=n(9397),f$=n.n(d$);function p$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p$(Object(n),!0).forEach(function(t){g$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v$=(e,t,n)=>e.map(e=>{return"".concat((r=e,r.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))," ").concat(t,"ms ").concat(n);var r}).join(","),y$=(e,t)=>Object.keys(t).reduce((n,r)=>m$(m$({},n),{},{[r]:e(r,t[r])}),{});function b$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function x$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b$(Object(n),!0).forEach(function(t){w$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function w$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E$=(e,t,n)=>e+(t-e)*n,_$=e=>{var{from:t,to:n}=e;return t!==n},S$=(e,t,n)=>{var r=y$((t,n)=>{if(_$(n)){var[r,i]=e(n.from,n.to,n.velocity);return x$(x$({},n),{},{from:r,velocity:i})}return n},t);return n<1?y$((e,t)=>_$(t)&&null!=r[e]?x$(x$({},t),{},{velocity:E$(t.velocity,r[e].velocity,n),from:E$(t.from,r[e].from,n)}):t,t):S$(e,r,n-1)};function k$(e,t,n,r,i,o){var a,s=r.reduce((n,r)=>x$(x$({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),u=null,l=r=>{a||(a=r);var c=(r-a)/n.dt;s=S$(n,s,c),i(x$(x$(x$({},e),t),y$((e,t)=>t.from,s))),a=r,Object.values(s).filter(_$).length&&(u=o.setTimeout(l))};return()=>(u=o.setTimeout(l),()=>{var e;null===(e=u)||void 0===e||e()})}const C$=(e,t,n,r,i,o)=>{var a,s,u=(a=e,s=t,[Object.keys(a),Object.keys(s)].reduce((e,t)=>e.filter(e=>t.includes(e))));return null==n?()=>(i(x$(x$({},e),t)),()=>{}):!0===n.isStepper?k$(e,t,n,u,i,o):function(e,t,n,r,i,o,a){var s,u=null,l=i.reduce((n,r)=>{var i=e[r],o=t[r];return null==i||null==o?n:x$(x$({},n),{},{[r]:[i,o]})},{}),c=i=>{s||(s=i);var h=(i-s)/r,d=y$((e,t)=>E$(...t,n(h)),l);if(o(x$(x$(x$({},e),t),d)),h<1)u=a.setTimeout(c);else{var f=y$((e,t)=>E$(...t,n(1)),l);o(x$(x$(x$({},e),t),f))}};return()=>(u=a.setTimeout(c),()=>{var e;null===(e=u)||void 0===e||e()})}(e,t,n,r,u,i,o)};var I$=1e-4,T$=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],A$=(e,t)=>e.map((e,n)=>e*t**n).reduce((e,t)=>e+t),O$=(e,t)=>n=>{var r=T$(e,t);return A$(r,n)},N$=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length)switch(t[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:var r=(e=>{var t,n=e.split("(");if(2!==n.length||"cubic-bezier"!==n[0])return null;var r=null===(t=n[1])||void 0===t||null===(t=t.split(")")[0])||void 0===t?void 0:t.split(",");if(null==r||4!==r.length)return null;var i=r.map(e=>parseFloat(e));return[i[0],i[1],i[2],i[3]]})(t[0]);if(r)return r}return 4===t.length?t:[0,0,1,1]},P$=(e,t,n,r)=>{var i,o,a=O$(e,n),s=O$(t,r),u=(i=e,o=n,e=>{var t=[...T$(i,o).map((e,t)=>e*t).slice(1),0];return A$(t,e)}),l=e=>e>1?1:e<0?0:e,c=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var i=a(n)-t,o=u(n);if(Math.abs(i-t)<I$||o<I$)return s(n);n=l(n-i/o)}return s(n)};return c.isStepper=!1,c},D$=function(){return P$(...N$(...arguments))},R$=e=>{if("string"===typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return D$(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,i=(e,i,o)=>{var a=o+(-(e-i)*t-o*n)*r/1e3,s=o*r/1e3+e;return Math.abs(s-i)<I$&&Math.abs(a)<I$?[i,0]:[s,a]};return i.isStepper=!0,i.dt=r,i}();default:if("cubic-bezier"===e.split("(")[0])return D$(e)}return"function"===typeof e?e:null};class M${setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,i=o=>{o-n>=t?e(o):"function"===typeof requestAnimationFrame&&(r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>{null!=r&&cancelAnimationFrame(r)}}}function j$(){return function(e){var t=()=>null,n=!1,r=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var a=o,[s,...u]=a;return"number"===typeof s?void(r=e.setTimeout(i.bind(null,u),s)):(i(s),void(r=e.setTimeout(i.bind(null,u))))}"string"===typeof o&&t(o),"object"===typeof o&&t(o),"function"===typeof o&&o()}};return{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),i(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e}}(new M$)}var F$=(0,t.createContext)(j$);var L$={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},B$={t:0},z$={t:1};function U$(e){var n=jX(e,L$),{isActive:r,canBegin:i,duration:o,easing:a,begin:s,onAnimationEnd:u,onAnimationStart:l,children:c}=n,h="auto"===r?!pK:r,d=function(e,n){var r=(0,t.useContext)(F$);return(0,t.useMemo)(()=>null!==n&&void 0!==n?n:r(e),[e,n,r])}(n.animationId,n.animationManager),[f,p]=(0,t.useState)(h?B$:z$),m=(0,t.useRef)(null);return(0,t.useEffect)(()=>{h||p(z$)},[h]),(0,t.useEffect)(()=>{if(!h||!i)return JA;var e=C$(B$,z$,R$(a),o,p,d.getTimeoutController());return d.start([l,s,()=>{m.current=e()},o,u]),()=>{d.stop(),m.current&&m.current(),u()}},[h,i,o,a,s,l,u,d]),c(f.t)}function V$(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",r=(0,t.useRef)(qA(n)),i=(0,t.useRef)(e);return i.current!==e&&(r.current=qA(n),i.current=e),r.current}var W$,H$,q$,G$,K$,X$,Y$,Q$,$$,Z$,J$=["radius"],eZ=["radius"];function tZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tZ(Object(n),!0).forEach(function(t){rZ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tZ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rZ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iZ(){return iZ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iZ.apply(null,arguments)}function oZ(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function aZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var sZ,uZ,lZ,cZ,hZ,dZ=(e,t,n,r,i)=>{var o,a=FA(n),s=FA(r),u=Math.min(Math.abs(a)/2,Math.abs(s)/2),l=s>=0?1:-1,c=a>=0?1:-1,h=s>=0&&a>=0||s<0&&a<0?1:0;if(u>0&&i instanceof Array){for(var d=[0,0,0,0],f=0;f<4;f++)d[f]=i[f]>u?u:i[f];o=LA(W$||(W$=aZ(["M",",",""])),e,t+l*d[0]),d[0]>0&&(o+=LA(H$||(H$=aZ(["A ",",",",0,0,",",",",",""])),d[0],d[0],h,e+c*d[0],t)),o+=LA(q$||(q$=aZ(["L ",",",""])),e+n-c*d[1],t),d[1]>0&&(o+=LA(G$||(G$=aZ(["A ",",",",0,0,",",\n        ",",",""])),d[1],d[1],h,e+n,t+l*d[1])),o+=LA(K$||(K$=aZ(["L ",",",""])),e+n,t+r-l*d[2]),d[2]>0&&(o+=LA(X$||(X$=aZ(["A ",",",",0,0,",",\n        ",",",""])),d[2],d[2],h,e+n-c*d[2],t+r)),o+=LA(Y$||(Y$=aZ(["L ",",",""])),e+c*d[3],t+r),d[3]>0&&(o+=LA(Q$||(Q$=aZ(["A ",",",",0,0,",",\n        ",",",""])),d[3],d[3],h,e,t+r-l*d[3])),o+="Z"}else if(u>0&&i===+i&&i>0){var p=Math.min(u,i);o=LA($$||($$=aZ(["M ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",","," Z"])),e,t+l*p,p,p,h,e+c*p,t,e+n-c*p,t,p,p,h,e+n,t+l*p,e+n,t+r-l*p,p,p,h,e+n-c*p,t+r,e+c*p,t+r,p,p,h,e,t+r-l*p)}else o=LA(Z$||(Z$=aZ(["M ",","," h "," v "," h "," Z"])),e,t,n,r,-n);return o},fZ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pZ=e=>{var n=jX(e,fZ),r=(0,t.useRef)(null),[i,o]=(0,t.useState)(-1);(0,t.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&o(e)}catch(t){}},[]);var{x:a,y:s,width:u,height:l,radius:c,className:h}=n,{animationEasing:d,animationDuration:f,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=n,v=(0,t.useRef)(u),y=(0,t.useRef)(l),b=(0,t.useRef)(a),x=(0,t.useRef)(s),w=V$((0,t.useMemo)(()=>({x:a,y:s,width:u,height:l,radius:c}),[a,s,u,l,c]),"rectangle-");if(a!==+a||s!==+s||u!==+u||l!==+l||0===u||0===l)return null;var E=PA("recharts-rectangle",h);if(!g){var _=WK(n),{radius:S}=_,k=oZ(_,J$);return t.createElement("path",iZ({},k,{x:FA(a),y:FA(s),width:FA(u),height:FA(l),radius:"number"===typeof c?c:void 0,className:E,d:dZ(a,s,u,l,c)}))}var C=v.current,I=y.current,T=b.current,A=x.current,O="0px ".concat(-1===i?1:i,"px"),N="".concat(i,"px 0px"),P=v$(["strokeDasharray"],f,"string"===typeof d?d:fZ.animationEasing);return t.createElement(U$,{animationId:w,key:w,canBegin:i>0,duration:f,easing:d,isActive:g,begin:p},e=>{var i,o=XA(C,u,e),h=XA(I,l,e),d=XA(T,a,e),f=XA(A,s,e);r.current&&(v.current=o,y.current=h,b.current=d,x.current=f),i=m?e>0?{transition:P,strokeDasharray:N}:{strokeDasharray:O}:{strokeDasharray:N};var p=WK(n),{radius:g}=p,w=oZ(p,eZ);return t.createElement("path",iZ({},w,{radius:"number"===typeof c?c:void 0,className:E,d:dZ(d,f,o,h,c),ref:r,style:nZ(nZ({},i),n.style)}))})};function mZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mZ(Object(n),!0).forEach(function(t){vZ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mZ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vZ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yZ(){return yZ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yZ.apply(null,arguments)}function bZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var xZ,wZ,EZ,_Z,SZ,kZ,CZ,IZ=(e,t,n,r,i)=>{var o,a=n-r;return o=LA(sZ||(sZ=bZ(["M ",",",""])),e,t),o+=LA(uZ||(uZ=bZ(["L ",",",""])),e+n,t),o+=LA(lZ||(lZ=bZ(["L ",",",""])),e+n-a/2,t+i),o+=LA(cZ||(cZ=bZ(["L ",",",""])),e+n-a/2-r,t+i),o+=LA(hZ||(hZ=bZ(["L ",","," Z"])),e,t)},TZ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AZ=e=>{var n=jX(e,TZ),{x:r,y:i,upperWidth:o,lowerWidth:a,height:s,className:u}=n,{animationEasing:l,animationDuration:c,animationBegin:h,isUpdateAnimationActive:d}=n,f=(0,t.useRef)(null),[p,m]=(0,t.useState)(-1),g=(0,t.useRef)(o),v=(0,t.useRef)(a),y=(0,t.useRef)(s),b=(0,t.useRef)(r),x=(0,t.useRef)(i),w=V$(e,"trapezoid-");if((0,t.useEffect)(()=>{if(f.current&&f.current.getTotalLength)try{var e=f.current.getTotalLength();e&&m(e)}catch(t){}},[]),r!==+r||i!==+i||o!==+o||a!==+a||s!==+s||0===o&&0===a||0===s)return null;var E=PA("recharts-trapezoid",u);if(!d)return t.createElement("g",null,t.createElement("path",yZ({},WK(n),{className:E,d:IZ(r,i,o,a,s)})));var _=g.current,S=v.current,k=y.current,C=b.current,I=x.current,T="0px ".concat(-1===p?1:p,"px"),A="".concat(p,"px 0px"),O=v$(["strokeDasharray"],c,l);return t.createElement(U$,{animationId:w,key:w,canBegin:p>0,duration:c,easing:l,isActive:d,begin:h},e=>{var u=XA(_,o,e),l=XA(S,a,e),c=XA(k,s,e),h=XA(C,r,e),d=XA(I,i,e);f.current&&(g.current=u,v.current=l,y.current=c,b.current=h,x.current=d);var p=e>0?{transition:O,strokeDasharray:A}:{strokeDasharray:T};return t.createElement("path",yZ({},WK(n),{className:E,d:IZ(h,d,u,l,c),ref:f,style:gZ(gZ({},p),n.style)}))})};function OZ(){return OZ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OZ.apply(null,arguments)}function NZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var PZ=e=>{var{cx:t,cy:n,radius:r,angle:i,sign:o,isExternal:a,cornerRadius:s,cornerIsExternal:u}=e,l=s*(a?1:-1)+r,c=Math.asin(s/l)/kU,h=u?i:i+o*c,d=u?i-o*c:i;return{center:IU(t,n,l,h),circleTangency:IU(t,n,r,h),lineTangency:IU(t,n,l*Math.cos(c*kU),d),theta:c}},DZ=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:o,endAngle:a}=e,s=((e,t)=>BA(t-e)*Math.min(Math.abs(t-e),359.999))(o,a),u=o+s,l=IU(t,n,i,o),c=IU(t,n,i,u),h=LA(xZ||(xZ=NZ(["M ",",","\n    A ",",",",0,\n    ",",",",\n    ",",","\n  "])),l.x,l.y,i,i,+(Math.abs(s)>180),+(o>u),c.x,c.y);if(r>0){var d=IU(t,n,r,o),f=IU(t,n,r,u);h+=LA(wZ||(wZ=NZ(["L ",",","\n            A ",",",",0,\n            ",",",",\n            ",","," Z"])),f.x,f.y,r,r,+(Math.abs(s)>180),+(o<=u),d.x,d.y)}else h+=LA(EZ||(EZ=NZ(["L ",","," Z"])),t,n);return h},RZ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},MZ=e=>{var n=jX(e,RZ),{cx:r,cy:i,innerRadius:o,outerRadius:a,cornerRadius:s,forceCornerRadius:u,cornerIsExternal:l,startAngle:c,endAngle:h,className:d}=n;if(a<o||c===h)return null;var f,p=PA("recharts-sector",d),m=a-o,g=GA(s,m,0,!0);return f=g>0&&Math.abs(c-h)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,cornerRadius:o,forceCornerRadius:a,cornerIsExternal:s,startAngle:u,endAngle:l}=e,c=BA(l-u),{circleTangency:h,lineTangency:d,theta:f}=PZ({cx:t,cy:n,radius:i,angle:u,sign:c,cornerRadius:o,cornerIsExternal:s}),{circleTangency:p,lineTangency:m,theta:g}=PZ({cx:t,cy:n,radius:i,angle:l,sign:-c,cornerRadius:o,cornerIsExternal:s}),v=s?Math.abs(u-l):Math.abs(u-l)-f-g;if(v<0)return a?LA(_Z||(_Z=NZ(["M ",",","\n        a",",",",0,0,1,",",0\n        a",",",",0,0,1,",",0\n      "])),d.x,d.y,o,o,2*o,o,o,2*-o):DZ({cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:u,endAngle:l});var y=LA(SZ||(SZ=NZ(["M ",",","\n    A",",",",0,0,",",",",","\n    A",",",",0,",",",",",",","\n    A",",",",0,0,",",",",","\n  "])),d.x,d.y,o,o,+(c<0),h.x,h.y,i,i,+(v>180),+(c<0),p.x,p.y,o,o,+(c<0),m.x,m.y);if(r>0){var{circleTangency:b,lineTangency:x,theta:w}=PZ({cx:t,cy:n,radius:r,angle:u,sign:c,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),{circleTangency:E,lineTangency:_,theta:S}=PZ({cx:t,cy:n,radius:r,angle:l,sign:-c,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),k=s?Math.abs(u-l):Math.abs(u-l)-w-S;if(k<0&&0===o)return"".concat(y,"L").concat(t,",").concat(n,"Z");y+=LA(kZ||(kZ=NZ(["L",",","\n      A",",",",0,0,",",",",","\n      A",",",",0,",",",",",",","\n      A",",",",0,0,",",",",","Z"])),_.x,_.y,o,o,+(c<0),E.x,E.y,r,r,+(k>180),+(c>0),b.x,b.y,o,o,+(c<0),x.x,x.y)}else y+=LA(CZ||(CZ=NZ(["L",",","Z"])),t,n);return y})({cx:r,cy:i,innerRadius:o,outerRadius:a,cornerRadius:Math.min(g,m/2),forceCornerRadius:u,cornerIsExternal:l,startAngle:c,endAngle:h}):DZ({cx:r,cy:i,innerRadius:o,outerRadius:a,startAngle:c,endAngle:h}),t.createElement("path",OZ({},WK(n),{className:p,d:f}))};Math.abs,Math.atan2;const jZ=Math.cos,FZ=(Math.max,Math.min,Math.sin),LZ=Math.sqrt,BZ=Math.PI,zZ=2*BZ;const UZ={draw(e,t){const n=LZ(t/BZ);e.moveTo(n,0),e.arc(0,0,n,0,zZ)}},VZ={draw(e,t){const n=LZ(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},WZ=LZ(1/3),HZ=2*WZ,qZ={draw(e,t){const n=LZ(t/HZ),r=n*WZ;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},GZ={draw(e,t){const n=LZ(t),r=-n/2;e.rect(r,r,n,n)}},KZ=FZ(BZ/10)/FZ(7*BZ/10),XZ=FZ(zZ/10)*KZ,YZ=-jZ(zZ/10)*KZ,QZ={draw(e,t){const n=LZ(.8908130915292852*t),r=XZ*n,i=YZ*n;e.moveTo(0,-n),e.lineTo(r,i);for(let o=1;o<5;++o){const t=zZ*o/5,a=jZ(t),s=FZ(t);e.lineTo(s*n,-a*n),e.lineTo(a*r-s*i,s*r+a*i)}e.closePath()}},$Z=LZ(3),ZZ={draw(e,t){const n=-LZ(t/(3*$Z));e.moveTo(0,2*n),e.lineTo(-$Z*n,-n),e.lineTo($Z*n,-n),e.closePath()}},JZ=-.5,eJ=LZ(3)/2,tJ=1/LZ(12),nJ=3*(tJ/2+1),rJ={draw(e,t){const n=LZ(t/nJ),r=n/2,i=n*tJ,o=r,a=n*tJ+n,s=-o,u=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,u),e.lineTo(JZ*r-eJ*i,eJ*r+JZ*i),e.lineTo(JZ*o-eJ*a,eJ*o+JZ*a),e.lineTo(JZ*s-eJ*u,eJ*s+JZ*u),e.lineTo(JZ*r+eJ*i,JZ*i-eJ*r),e.lineTo(JZ*o+eJ*a,JZ*a-eJ*o),e.lineTo(JZ*s+eJ*u,JZ*u-eJ*s),e.closePath()}};LZ(3),LZ(3);var iJ=["type","size","sizeType"];function oJ(){return oJ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oJ.apply(null,arguments)}function aJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function sJ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aJ(Object(n),!0).forEach(function(t){uJ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function uJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lJ={symbolCircle:UZ,symbolCross:VZ,symbolDiamond:qZ,symbolSquare:GZ,symbolStar:QZ,symbolTriangle:ZZ,symbolWye:rJ},cJ=Math.PI/180,hJ=e=>{var{type:n="circle",size:r=64,sizeType:i="area"}=e,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,iJ),a=sJ(sJ({},o),{},{type:n,size:r,sizeType:i}),s="circle";"string"===typeof n&&(s=n);var{className:u,cx:l,cy:c}=a,h=WK(a);return VA(l)&&VA(c)&&VA(r)?t.createElement("path",oJ({},h,{className:PA("recharts-symbols",u),transform:"translate(".concat(l,", ").concat(c,")"),d:(()=>{var e=(e=>{var t="symbol".concat($A(e));return lJ[t]||UZ})(s),t=function(e,t){let n=null,r=nQ(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"===typeof e?e:UR(e||UZ),t="function"===typeof t?t:UR(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"===typeof t?t:UR(t),i):e},i.size=function(e){return arguments.length?(t="function"===typeof e?e:UR(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type(e).size(((e,t,n)=>{if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*cJ;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.tan(r)**2);case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(r,i,s)),n=t();if(null!==n)return n})()})):null};hJ.registerSymbol=(e,t)=>{lJ["symbol".concat($A(e))]=t};var dJ=["option","shapeType","activeClassName"];function fJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pJ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fJ(Object(n),!0).forEach(function(t){mJ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gJ(e){var{shapeType:n,elementProps:r}=e;switch(n){case"rectangle":return t.createElement(pZ,r);case"trapezoid":return t.createElement(AZ,r);case"sector":return t.createElement(MZ,r);case"symbols":if(function(e){return"symbols"===e}(n))return t.createElement(hJ,r);break;case"curve":return t.createElement(xQ,r);default:return null}}function vJ(e){var n,{option:r,shapeType:i,activeClassName:o="recharts-active-shape"}=e,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,dJ);if((0,t.isValidElement)(r))n=(0,t.cloneElement)(r,pJ(pJ({},a),function(e){return(0,t.isValidElement)(e)?e.props:e}(r)));else if("function"===typeof r)n=r(a,a.index);else if(f$()(r)&&"boolean"!==typeof r){var s=function(e,t){return pJ(pJ({},t),e)}(r,a);n=t.createElement(gJ,{shapeType:i,elementProps:s})}else{var u=a;n=t.createElement(gJ,{shapeType:i,elementProps:u})}return a.isActive?t.createElement(AY,{className:o},n):n}var yJ,bJ=(e,t,n)=>{var r=OR();return(i,o)=>a=>{null===e||void 0===e||e(i,o,a),r(ZD({activeIndex:String(o),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:n}))}},xJ=e=>{var t=OR();return(n,r)=>i=>{null===e||void 0===e||e(n,r,i),t(JD())}},wJ=(e,t,n)=>{var r=OR();return(i,o)=>a=>{null===e||void 0===e||e(i,o,a),r(tR({activeIndex:String(o),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:n}))}};function EJ(e){var{tooltipEntrySettings:n}=e,r=OR(),i=kM(),o=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{i||(null===o.current?r(XD(n)):o.current!==n&&r(YD({prev:o.current,next:n})),o.current=n)},[n,r,i]),(0,t.useLayoutEffect)(()=>()=>{o.current&&(r(QD(o.current)),o.current=null)},[r]),null}function _J(e){var{legendPayload:n}=e,r=OR(),i=kM(),o=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{i||(null===o.current?r(MG(n)):o.current!==n&&r(jG({prev:o.current,next:n})),o.current=n)},[r,i,n]),(0,t.useLayoutEffect)(()=>()=>{o.current&&(r(FG(o.current)),o.current=null)},[r]),null}function SJ(e){var{legendPayload:n}=e,r=OR(),i=RR(RM),o=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{"centric"!==i&&"radial"!==i||(null===o.current?r(MG(n)):o.current!==n&&r(jG({prev:o.current,next:n})),o.current=n)},[r,i,n]),(0,t.useLayoutEffect)(()=>()=>{o.current&&(r(FG(o.current)),o.current=null)},[r]),null}var kJ=null!==(yJ=r["useId".toString()])&&void 0!==yJ?yJ:()=>{var[e]=t.useState(()=>qA("uid-"));return e};var CJ=(0,t.createContext)(void 0),IJ=e=>{var{id:n,type:r,children:i}=e,o=function(e,t){var n=kJ();return t||(e?"".concat(e,"-").concat(n):n)}("recharts-".concat(r),n);return t.createElement(CJ.Provider,{value:o},i(o))};var TJ=e=>{var n=OR(),r=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{null===r.current?n(pG(e)):r.current!==e&&n(mG({prev:r.current,next:e})),r.current=e},[n,e]),(0,t.useLayoutEffect)(()=>()=>{r.current&&(n(gG(r.current)),r.current=null)},[n]),null},AJ=(0,t.memo)(TJ);function OJ(e){var n=OR();return(0,t.useLayoutEffect)(()=>(n(vG(e)),()=>{n(yG(e))}),[n,e]),null}var NJ=n(356),PJ=n.n(NJ),DJ=n(7950);function RJ(e){var{zIndex:n,children:r}=e,i=void 0!==MM()&&void 0!==n&&0!==n,o=kM(),a=OR();(0,t.useLayoutEffect)(()=>i?(a(wK({zIndex:n})),()=>{a(EK({zIndex:n}))}):JA,[a,n,i]);var s=RR(e=>KK(e,n,o));return i?s?(0,DJ.createPortal)(r,s):null:r}var MJ=["labelRef"],jJ=["content"];function FJ(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function LJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function BJ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?LJ(Object(n),!0).forEach(function(t){zJ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function zJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UJ(){return UJ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UJ.apply(null,arguments)}var VJ=(0,t.createContext)(null),WJ=e=>{var{x:n,y:r,upperWidth:i,lowerWidth:o,width:a,height:s,children:u}=e,l=(0,t.useMemo)(()=>({x:n,y:r,upperWidth:i,lowerWidth:o,width:a,height:s}),[n,r,i,o,a,s]);return t.createElement(VJ.Provider,{value:l},u)},HJ=()=>{var e=(0,t.useContext)(VJ),n=AM();return e||TM(n)},qJ=(0,t.createContext)(null),GJ=()=>{var e=(0,t.useContext)(qJ),n=RR(oV);return e||n},KJ=e=>null!=e&&"function"===typeof e,XJ=(e,n,r,i,o)=>{var a,s,{offset:u,className:l}=e,{cx:c,cy:h,innerRadius:d,outerRadius:f,startAngle:p,endAngle:m,clockWise:g}=o,v=(d+f)/2,y=((e,t)=>BA(t-e)*Math.min(Math.abs(t-e),360))(p,m),b=y>=0?1:-1;switch(n){case"insideStart":a=p+b*u,s=g;break;case"insideEnd":a=m-b*u,s=!g;break;case"end":a=m+b*u,s=g;break;default:throw new Error("Unsupported position ".concat(n))}s=y<=0?s:!s;var x=IU(c,h,v,a),w=IU(c,h,v,a+359*(s?1:-1)),E="M".concat(x.x,",").concat(x.y,"\n    A").concat(v,",").concat(v,",0,1,").concat(s?0:1,",\n    ").concat(w.x,",").concat(w.y),_=QA(e.id)?qA("recharts-radial-line-"):e.id;return t.createElement("text",UJ({},i,{dominantBaseline:"central",className:PA("recharts-radial-bar-label",l)}),t.createElement("defs",null,t.createElement("path",{id:_,d:E})),t.createElement("textPath",{xlinkHref:"#".concat(_)},r))},YJ=e=>"cx"in e&&VA(e.cx),QJ={angle:0,offset:5,zIndex:PU.label,position:"middle",textBreakAll:!1};function $J(e){var n,r,i,o=jX(e,QJ),{viewBox:a,position:s,value:u,children:l,content:c,className:h="",textBreakAll:d,labelRef:f}=o,p=GJ(),m=HJ();if(!(n=null==a?"center"===s?m:null!==p&&void 0!==p?p:m:YJ(a)?a:TM(a))||QA(u)&&QA(l)&&!(0,t.isValidElement)(c)&&"function"!==typeof c)return null;var g=BJ(BJ({},o),{},{viewBox:n});if((0,t.isValidElement)(c)){var{labelRef:v}=g,y=FJ(g,MJ);return(0,t.cloneElement)(c,y)}if("function"===typeof c){var{content:b}=g,x=FJ(g,jJ);if(r=(0,t.createElement)(c,x),(0,t.isValidElement)(r))return r}else r=(e=>{var{value:t,formatter:n}=e,r=QA(e.children)?t:e.children;return"function"===typeof n?n(r):r})(o);var w=WK(o);if(YJ(n)){if("insideStart"===s||"insideEnd"===s||"end"===s)return XJ(o,s,r,w,n);i=((e,t,n)=>{var{cx:r,cy:i,innerRadius:o,outerRadius:a,startAngle:s,endAngle:u}=e,l=(s+u)/2;if("outside"===n){var{x:c,y:h}=IU(r,i,a+t,l);return{x:c,y:h,textAnchor:c>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"end"};var d=(o+a)/2,{x:f,y:p}=IU(r,i,d,l);return{x:f,y:p,textAnchor:"middle",verticalAnchor:"middle"}})(n,o.offset,o.position)}else i=((e,t)=>{var n,{parentViewBox:r,offset:i,position:o}=e;null==r||YJ(r)||(n=r);var{x:a,y:s,upperWidth:u,lowerWidth:l,height:c}=t,h=a,d=a+(u-l)/2,f=(h+d)/2,p=(u+l)/2,m=h+u/2,g=c>=0?1:-1,v=g*i,y=g>0?"end":"start",b=g>0?"start":"end",x=u>=0?1:-1,w=x*i,E=x>0?"end":"start",_=x>0?"start":"end";if("top"===o)return BJ(BJ({},{x:h+u/2,y:s-v,textAnchor:"middle",verticalAnchor:y}),n?{height:Math.max(s-n.y,0),width:u}:{});if("bottom"===o)return BJ(BJ({},{x:d+l/2,y:s+c+v,textAnchor:"middle",verticalAnchor:b}),n?{height:Math.max(n.y+n.height-(s+c),0),width:l}:{});if("left"===o){var S={x:f-w,y:s+c/2,textAnchor:E,verticalAnchor:"middle"};return BJ(BJ({},S),n?{width:Math.max(S.x-n.x,0),height:c}:{})}if("right"===o){var k={x:f+p+w,y:s+c/2,textAnchor:_,verticalAnchor:"middle"};return BJ(BJ({},k),n?{width:Math.max(n.x+n.width-k.x,0),height:c}:{})}var C=n?{width:p,height:c}:{};return"insideLeft"===o?BJ({x:f+w,y:s+c/2,textAnchor:_,verticalAnchor:"middle"},C):"insideRight"===o?BJ({x:f+p-w,y:s+c/2,textAnchor:E,verticalAnchor:"middle"},C):"insideTop"===o?BJ({x:h+u/2,y:s+v,textAnchor:"middle",verticalAnchor:b},C):"insideBottom"===o?BJ({x:d+l/2,y:s+c-v,textAnchor:"middle",verticalAnchor:y},C):"insideTopLeft"===o?BJ({x:h+w,y:s+v,textAnchor:_,verticalAnchor:b},C):"insideTopRight"===o?BJ({x:h+u-w,y:s+v,textAnchor:E,verticalAnchor:b},C):"insideBottomLeft"===o?BJ({x:d+w,y:s+c-v,textAnchor:_,verticalAnchor:y},C):"insideBottomRight"===o?BJ({x:d+l-w,y:s+c-v,textAnchor:E,verticalAnchor:y},C):o&&"object"===typeof o&&(VA(o.x)||UA(o.x))&&(VA(o.y)||UA(o.y))?BJ({x:a+GA(o.x,p),y:s+GA(o.y,c),textAnchor:"end",verticalAnchor:"end"},C):BJ({x:m,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},C)})(o,n);return t.createElement(RJ,{zIndex:o.zIndex},t.createElement(r$,UJ({ref:f,className:PA("recharts-label",h)},w,i,{textAnchor:YQ(w.textAnchor)?w.textAnchor:i.textAnchor,breakAll:d}),r))}$J.displayName="Label";var ZJ=(e,n,r)=>{if(!e)return null;var i={viewBox:n,labelRef:r};return!0===e?t.createElement($J,UJ({key:"label-implicit"},i)):WA(e)?t.createElement($J,UJ({key:"label-implicit",value:e},i)):(0,t.isValidElement)(e)?e.type===$J?(0,t.cloneElement)(e,BJ({key:"label-implicit"},i)):t.createElement($J,UJ({key:"label-implicit",content:e},i)):KJ(e)?t.createElement($J,UJ({key:"label-implicit",content:e},i)):e&&"object"===typeof e?t.createElement($J,UJ({},e,{key:"label-implicit"},i)):null};function JJ(e){var{label:t,labelRef:n}=e,r=HJ();return ZJ(t,r,n)||null}var e0=["valueAccessor"],t0=["dataKey","clockWise","id","textBreakAll","zIndex"];function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n0.apply(null,arguments)}function r0(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var i0=e=>Array.isArray(e.value)?PJ()(e.value):e.value,o0=(0,t.createContext)(void 0),a0=o0.Provider,s0=(0,t.createContext)(void 0),u0=s0.Provider;function l0(e){var{valueAccessor:n=i0}=e,r=r0(e,e0),{dataKey:i,clockWise:o,id:a,textBreakAll:s,zIndex:u}=r,l=r0(r,t0),c=(0,t.useContext)(o0),h=(0,t.useContext)(s0),d=c||h;return d&&d.length?t.createElement(RJ,{zIndex:null!==u&&void 0!==u?u:PU.label},t.createElement(AY,{className:"recharts-label-list"},d.map((e,o)=>{var u,c=QA(i)?n(e,o):YR(e&&e.payload,i),h=QA(a)?{}:{id:"".concat(a,"-").concat(o)};return t.createElement($J,n0({key:"label-".concat(o)},WK(e),l,h,{fill:null!==(u=r.fill)&&void 0!==u?u:e.fill,parentViewBox:e.parentViewBox,value:c,textBreakAll:s,viewBox:e.viewBox,index:o,zIndex:0}))}))):null}function c0(e){var{label:n}=e;return n?!0===n?t.createElement(l0,{key:"labelList-implicit"}):t.isValidElement(n)||KJ(n)?t.createElement(l0,{key:"labelList-implicit",content:n}):"object"===typeof n?t.createElement(l0,n0({key:"labelList-implicit"},n,{type:String(n.type)})):null:null}l0.displayName="LabelList";var h0=["key"],d0=["onMouseEnter","onClick","onMouseLeave"],f0=["id"],p0=["id"];function m0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m0(Object(n),!0).forEach(function(t){v0(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m0(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y0(){return y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y0.apply(null,arguments)}function b0(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function x0(e){var n=(0,t.useMemo)(()=>c$(e.children,i$),[e.children]),r=RR(t=>hY(t,e.id,n));return null==r?null:t.createElement(SJ,{legendPayload:r})}var w0=t.memo(e=>{var{dataKey:n,nameKey:r,sectors:i,stroke:o,strokeWidth:a,fill:s,name:u,hide:l,tooltipType:c,id:h}=e,d={dataDefinedOnItem:i.map(e=>e.tooltipPayload),positions:i.map(e=>e.tooltipPosition),settings:{stroke:o,strokeWidth:a,fill:s,dataKey:n,nameKey:r,name:lM(u,n),hide:l,type:c,color:s,unit:"",graphicalItemId:h}};return t.createElement(EJ,{tooltipEntrySettings:d})}),E0=(e,t)=>e>t?"start":e<t?"end":"middle",_0=(e,t,n)=>{var{top:r,left:i,width:o,height:a}=t,s=TU(o,a),u=i+GA(e.cx,o,o/2),l=r+GA(e.cy,a,a/2),c=GA(e.innerRadius,s,0),h=((e,t,n)=>GA("function"===typeof t?t(e):t,n,.8*n))(n,e.outerRadius,s);return{cx:u,cy:l,innerRadius:c,outerRadius:h,maxRadius:e.maxRadius||Math.sqrt(o*o+a*a)/2}},S0=(e,t)=>BA(t-e)*Math.min(Math.abs(t-e),360);function k0(e){var{sectors:n,props:r,showLabels:i}=e,{label:o,labelLine:a,dataKey:s}=r;if(!i||!o||!n)return null;var u=UK(r),l=VK(o),c=VK(a),h="object"===typeof o&&"offsetRadius"in o&&"number"===typeof o.offsetRadius&&o.offsetRadius||20,d=n.map((e,n)=>{var r=(e.startAngle+e.endAngle)/2,i=IU(e.cx,e.cy,e.outerRadius+h,r),d=g0(g0(g0(g0({},u),e),{},{stroke:"none"},l),{},{index:n,textAnchor:E0(i.x,e.cx)},i),f=g0(g0(g0(g0({},u),e),{},{fill:"none",stroke:e.fill},c),{},{index:n,points:[IU(e.cx,e.cy,e.outerRadius,r),i],key:"line"});return t.createElement(RJ,{zIndex:PU.label,key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(n)},t.createElement(AY,null,a&&((e,n)=>{if(t.isValidElement(e))return t.cloneElement(e,n);if("function"===typeof e)return e(n);var r=PA("recharts-pie-label-line","boolean"!==typeof e?e.className:""),{key:i}=n,o=b0(n,h0);return t.createElement(xQ,y0({},o,{type:"linear",className:r}))})(a,f),((e,n,r)=>{if(t.isValidElement(e))return t.cloneElement(e,n);var i=r;if("function"===typeof e&&(i=e(n),t.isValidElement(i)))return i;var o=PA("recharts-pie-label-text",function(e){return e&&"object"===typeof e&&"className"in e&&"string"===typeof e.className?e.className:""}(e));return t.createElement(r$,y0({},n,{alignmentBaseline:"middle",className:o}),i)})(o,d,YR(e,s))))});return t.createElement(AY,{className:"recharts-pie-labels"},d)}function C0(e){var{sectors:n,props:r,showLabels:i}=e,{label:o}=r;return"object"===typeof o&&null!=o&&"position"in o?t.createElement(c0,{label:o}):t.createElement(k0,{sectors:n,props:r,showLabels:i})}function I0(e){var{sectors:n,activeShape:r,inactiveShape:i,allOtherPieProps:o,shape:a,id:s}=e,u=RR(vq),l=RR(bq),c=RR(xq),{onMouseEnter:h,onClick:d,onMouseLeave:f}=o,p=b0(o,d0),m=bJ(h,o.dataKey,s),g=xJ(f),v=wJ(d,o.dataKey,s);return null==n||0===n.length?null:t.createElement(t.Fragment,null,n.map((e,h)=>{if(0===(null===e||void 0===e?void 0:e.startAngle)&&0===(null===e||void 0===e?void 0:e.endAngle)&&1!==n.length)return null;var d=null==c||c===s,f=String(h)===u&&(null==l||o.dataKey===l)&&d,y=r&&f?r:u?i:null,b=g0(g0({},e),{},{stroke:e.stroke,tabIndex:-1,[gM]:h,[vM]:s});return t.createElement(AY,y0({key:"sector-".concat(null===e||void 0===e?void 0:e.startAngle,"-").concat(null===e||void 0===e?void 0:e.endAngle,"-").concat(e.midAngle,"-").concat(h),tabIndex:-1,className:"recharts-pie-sector"},lQ(p,e,h),{onMouseEnter:m(e,h),onMouseLeave:g(e,h),onClick:v(e,h)}),t.createElement(vJ,y0({option:null!==a&&void 0!==a?a:y,index:h,shapeType:"sector",isActive:f},b)))}))}function T0(e){var{showLabels:n,sectors:r,children:i}=e,o=(0,t.useMemo)(()=>n&&r?r.map(e=>({value:e.value,payload:e.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:e.cx,cy:e.cy,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clockWise:!1},fill:e.fill})):[],[r,n]);return t.createElement(u0,{value:n?o:void 0},i)}function A0(e){var{props:n,previousSectorsRef:r,id:i}=e,{sectors:o,isAnimationActive:a,animationBegin:s,animationDuration:u,animationEasing:l,activeShape:c,inactiveShape:h,onAnimationStart:d,onAnimationEnd:f}=n,p=V$(n,"recharts-pie-"),m=r.current,[g,v]=(0,t.useState)(!1),y=(0,t.useCallback)(()=>{"function"===typeof f&&f(),v(!1)},[f]),b=(0,t.useCallback)(()=>{"function"===typeof d&&d(),v(!0)},[d]);return t.createElement(T0,{showLabels:!g,sectors:o},t.createElement(U$,{animationId:p,begin:s,duration:u,isActive:a,easing:l,onAnimationStart:b,onAnimationEnd:y,key:p},e=>{var a=[],s=o&&o[0],u=null===s||void 0===s?void 0:s.startAngle;return null===o||void 0===o||o.forEach((t,n)=>{var r=m&&m[n],i=n>0?jA()(t,"paddingAngle",0):0;if(r){var o=XA(r.endAngle-r.startAngle,t.endAngle-t.startAngle,e),s=g0(g0({},t),{},{startAngle:u+i,endAngle:u+o+i});a.push(s),u=s.endAngle}else{var{endAngle:l,startAngle:c}=t,h=XA(0,l-c,e),d=g0(g0({},t),{},{startAngle:u+i,endAngle:u+h+i});a.push(d),u=d.endAngle}}),r.current=a,t.createElement(AY,null,t.createElement(I0,{sectors:a,activeShape:c,inactiveShape:h,allOtherPieProps:n,shape:n.shape,id:i}))}),t.createElement(C0,{showLabels:!g,sectors:o,props:n}),n.children)}var O0={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:PU.area};function N0(e){var{id:n}=e,r=b0(e,f0),{hide:i,className:o,rootTabIndex:a}=e,s=(0,t.useMemo)(()=>c$(e.children,i$),[e.children]),u=RR(e=>dY(e,n,s)),l=(0,t.useRef)(null),c=PA("recharts-pie",o);return i||null==u?(l.current=null,t.createElement(AY,{tabIndex:a,className:c})):t.createElement(RJ,{zIndex:e.zIndex},t.createElement(w0,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:u,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:n}),t.createElement(AY,{tabIndex:a,className:c},t.createElement(A0,{props:g0(g0({},r),{},{sectors:u}),previousSectorsRef:l,id:n})))}function P0(e){var n=jX(e,O0),{id:r}=n,i=b0(n,p0),o=UK(i);return t.createElement(IJ,{id:r,type:"pie"},e=>t.createElement(t.Fragment,null,t.createElement(OJ,{type:"pie",id:e,data:i.data,dataKey:i.dataKey,hide:i.hide,angleAxisId:0,radiusAxisId:0,name:i.name,nameKey:i.nameKey,tooltipType:i.tooltipType,legendType:i.legendType,fill:i.fill,cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,paddingAngle:i.paddingAngle,minAngle:i.minAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius,cornerRadius:i.cornerRadius,presentationProps:o,maxRadius:n.maxRadius}),t.createElement(x0,y0({},i,{id:e})),t.createElement(N0,y0({},i,{id:e}))))}function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D0.apply(null,arguments)}function R0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R0(Object(n),!0).forEach(function(t){j0(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R0(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F0(e){return Array.isArray(e)&&WA(e[0])&&WA(e[1])?e.join(" ~ "):e}P0.displayName="Pie";var L0=e=>{var{separator:n=" : ",contentStyle:r={},itemStyle:i={},labelStyle:o={},payload:a,formatter:s,itemSorter:u,wrapperClassName:l,labelClassName:c,label:h,labelFormatter:d,accessibilityLayer:f=!1}=e,p=M0({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),m=M0({margin:0},o),g=!QA(h),v=g?h:"",y=PA("recharts-default-tooltip",l),b=PA("recharts-tooltip-label",c);g&&d&&void 0!==a&&null!==a&&(v=d(h,a));var x=f?{role:"status","aria-live":"assertive"}:{};return t.createElement("div",D0({className:y,style:p},x),t.createElement("p",{className:b,style:m},t.isValidElement(v)?v:"".concat(v)),(()=>{if(a&&a.length){var e=(u?jR()(a,u):a).map((e,r)=>{if("none"===e.type)return null;var o=e.formatter||s||F0,{value:u,name:l}=e,c=u,h=l;if(o){var d=o(u,l,e,r,a);if(Array.isArray(d))[c,h]=d;else{if(null==d)return null;c=d}}var f=M0({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},i);return t.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(r),style:f},WA(h)?t.createElement("span",{className:"recharts-tooltip-item-name"},h):null,WA(h)?t.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,t.createElement("span",{className:"recharts-tooltip-item-value"},c),t.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return t.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},B0="recharts-tooltip-wrapper",z0={visibility:"hidden"};function U0(e){var{coordinate:t,translateX:n,translateY:r}=e;return PA(B0,{["".concat(B0,"-right")]:VA(n)&&t&&VA(t.x)&&n>=t.x,["".concat(B0,"-left")]:VA(n)&&t&&VA(t.x)&&n<t.x,["".concat(B0,"-bottom")]:VA(r)&&t&&VA(t.y)&&r>=t.y,["".concat(B0,"-top")]:VA(r)&&t&&VA(t.y)&&r<t.y})}function V0(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:i,position:o,reverseDirection:a,tooltipDimension:s,viewBox:u,viewBoxDimension:l}=e;if(o&&VA(o[r]))return o[r];var c=n[r]-s-(i>0?i:0),h=n[r]+i;if(t[r])return a[r]?c:h;var d=u[r];return null==d?0:a[r]?c<d?Math.max(h,d):Math.max(c,d):null==l?0:h+s>d+l?Math.max(c,d):Math.max(h,d)}function W0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function H0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W0(Object(n),!0).forEach(function(t){q0(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W0(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function q0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class G0 extends t.PureComponent{constructor(){super(...arguments),q0(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),q0(this,"handleKeyDown",e=>{var t,n,r,i;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(i=this.props.coordinate)||void 0===i?void 0:i.y)&&void 0!==r?r:0}})})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:n,animationDuration:r,animationEasing:i,children:o,coordinate:a,hasPayload:s,isAnimationActive:u,offset:l,position:c,reverseDirection:h,useTranslate3d:d,viewBox:f,wrapperStyle:p,lastBoundingBox:m,innerRef:g,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=function(e){var t,n,r,{allowEscapeViewBox:i,coordinate:o,offsetTopLeft:a,position:s,reverseDirection:u,tooltipBox:l,useTranslate3d:c,viewBox:h}=e;return t=l.height>0&&l.width>0&&o?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=V0({allowEscapeViewBox:i,coordinate:o,key:"x",offsetTopLeft:a,position:s,reverseDirection:u,tooltipDimension:l.width,viewBox:h,viewBoxDimension:h.width}),translateY:r=V0({allowEscapeViewBox:i,coordinate:o,key:"y",offsetTopLeft:a,position:s,reverseDirection:u,tooltipDimension:l.height,viewBox:h,viewBoxDimension:h.height}),useTranslate3d:c}):z0,{cssProperties:t,cssClasses:U0({translateX:n,translateY:r,coordinate:o})}}({allowEscapeViewBox:n,coordinate:a,offsetTopLeft:l,position:c,reverseDirection:h,tooltipBox:{height:m.height,width:m.width},useTranslate3d:d,viewBox:f}),x=v?{}:H0(H0({transition:u&&e?"transform ".concat(r,"ms ").concat(i):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&s?"visible":"hidden",position:"absolute",top:0,left:0}),w=H0(H0({},x),{},{visibility:!this.state.dismissed&&e&&s?"visible":"hidden"},p);return t.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:w,ref:g},o)}}var K0=n(4332),X0=n.n(K0);function Y0(e,t,n){return!0===t?X0()(e,n):"function"===typeof t?X0()(e,t):e}function Q0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[n,r]=(0,t.useState)({height:0,left:0,top:0,width:0}),i=(0,t.useCallback)(e=>{if(null!=e){var t=e.getBoundingClientRect(),i={height:t.height,left:t.left,top:t.top,width:t.width};(Math.abs(i.height-n.height)>1||Math.abs(i.left-n.left)>1||Math.abs(i.top-n.top)>1||Math.abs(i.width-n.width)>1)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[n.width,n.height,n.top,n.left,...e]);return[n,i]}var $0=["x","y","top","left","width","height","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z0.apply(null,arguments)}function J0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t1=(e,t,n,r,i,o)=>"M".concat(e,",").concat(i,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n),n1=e=>{var{x:n=0,y:r=0,top:i=0,left:o=0,width:a=0,height:s=0,className:u}=e,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,$0),c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J0(Object(n),!0).forEach(function(t){e1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J0(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:n,y:r,top:i,left:o,width:a,height:s},l);return VA(n)&&VA(r)&&VA(a)&&VA(s)&&VA(i)&&VA(o)?t.createElement("path",Z0({},WK(c),{className:PA("recharts-cross",u),d:t1(n,r,a,s,i,o)})):null};function r1(e){var{cx:t,cy:n,radius:r,startAngle:i,endAngle:o}=e;return{points:[IU(t,n,r,i),IU(t,n,r,o)],cx:t,cy:n,radius:r,startAngle:i,endAngle:o}}function i1(e,t,n){if("horizontal"===e)return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if("vertical"===e)return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(sQ(t)){if("centric"===e){var{cx:r,cy:i,innerRadius:o,outerRadius:a,angle:s}=t,u=IU(r,i,o,s),l=IU(r,i,a,s);return[{x:u.x,y:u.y},{x:l.x,y:l.y}]}return r1(t)}}function o1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o1(Object(n),!0).forEach(function(t){s1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u1=()=>{var e=RR(XV),t=RR(dq),n=RR(lq);return sM(e&&n?a1(a1({},e),{},{scale:n}):void 0,t)};function l1(){return l1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l1.apply(null,arguments)}function c1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c1(Object(n),!0).forEach(function(t){d1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f1(e){var{cursor:n,cursorComp:r,cursorProps:i}=e;return(0,t.isValidElement)(n)?(0,t.cloneElement)(n,i):(0,t.createElement)(r,i)}function p1(e){var n,r,i,o,{coordinate:a,payload:s,index:u,offset:l,tooltipAxisBandSize:c,layout:h,cursor:d,tooltipEventType:f,chartName:p}=e,m=a,g=s,v=u;if(!d||!m||"ScatterChart"!==p&&"axis"!==f)return null;if("ScatterChart"===p)r=m,i=n1,o=PU.cursorLine;else if("BarChart"===p)r=function(e,t,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-i:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-i,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(h,m,l,c),i=pZ,o=PU.cursorRectangle;else if("radial"===h&&sQ(m)){var{cx:y,cy:b,radius:x,startAngle:w,endAngle:E}=r1(m);r={cx:y,cy:b,startAngle:w,endAngle:E,innerRadius:x,outerRadius:x},i=MZ,o=PU.cursorLine}else r={points:i1(h,m,l)},i=xQ,o=PU.cursorLine;var _="object"===typeof d&&"className"in d?d.className:void 0,S=h1(h1(h1(h1({stroke:"#ccc",pointerEvents:"none"},l),r),VK(d)),{},{payload:g,payloadIndex:v,className:PA("recharts-tooltip-cursor",_)});return t.createElement(RJ,{zIndex:null!==(n=e.zIndex)&&void 0!==n?n:o},t.createElement(f1,{cursor:d,cursorComp:i,cursorProps:S}))}function m1(e){var n=u1(),r=NM(),i=MM(),o=RR(yU);return null==n||null==r||null==i||null==o?null:t.createElement(p1,l1({},e,{offset:r,layout:i,tooltipAxisBandSize:n,chartName:o}))}function g1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g1(Object(n),!0).forEach(function(t){y1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b1(e){return e.dataKey}var x1=[],w1={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function E1(e){var n,r,i=jX(e,w1),{active:o,allowEscapeViewBox:a,animationDuration:s,animationEasing:u,content:l,filterNull:c,isAnimationActive:h,offset:d,payloadUniqBy:f,position:p,reverseDirection:m,useTranslate3d:g,wrapperStyle:v,cursor:y,shared:b,trigger:x,defaultIndex:w,portal:E,axisId:_}=i,S=OR(),k="number"===typeof w?String(w):w;(0,t.useEffect)(()=>{S($D({shared:b,trigger:x,axisId:_,active:o,defaultIndex:k}))},[S,b,x,_,o,k]);var C=AM(),I=MK(),T=function(e){return RR(t=>vH(t,e))}(b),{activeIndex:A,isActive:O}=null!==(n=RR(e=>Vq(e,T,x,k)))&&void 0!==n?n:{},N=RR(e=>Uq(e,T,x,k)),P=RR(e=>zq(e,T,x,k)),D=RR(e=>Bq(e,T,x,k)),R=N,M=(0,t.useContext)(pX),j=null!==(r=null!==o&&void 0!==o?o:O)&&void 0!==r&&r,[F,L]=Q0([R,j]),B="axis"===T?P:void 0;fX(T,x,D,B,A,j);var z=null!==E&&void 0!==E?E:M;if(null==z||null==C||null==T)return null;var U=null!==R&&void 0!==R?R:x1;j||(U=x1),c&&U.length&&(U=Y0(U.filter(e=>null!=e.value&&(!0!==e.hide||i.includeHidden)),f,b1));var V=U.length>0,W=t.createElement(G0,{allowEscapeViewBox:a,animationDuration:s,animationEasing:u,isAnimationActive:h,active:j,coordinate:D,hasPayload:V,offset:d,position:p,reverseDirection:m,useTranslate3d:g,viewBox:C,wrapperStyle:v,lastBoundingBox:F,innerRef:L,hasPortalFromProps:Boolean(E)},function(e,n){return t.isValidElement(e)?t.cloneElement(e,n):"function"===typeof e?t.createElement(e,n):t.createElement(L0,n)}(l,v1(v1({},i),{},{payload:U,label:B,active:j,activeIndex:A,coordinate:D,accessibilityLayer:I})));return t.createElement(t.Fragment,null,(0,DJ.createPortal)(W,z),j&&t.createElement(m1,{cursor:y,tooltipEventType:T,coordinate:D,payload:U,index:A}))}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_1.apply(null,arguments)}var S1={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:{top:5,right:5,bottom:5,left:5},responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},k1=(0,t.forwardRef)(function(e,n){var r,i=jX(e.categoricalChartProps,S1),{chartName:o,defaultTooltipEventType:a,validateTooltipEventTypes:s,tooltipPayloadSearcher:u,categoricalChartProps:l}=e,c={chartName:o,defaultTooltipEventType:a,validateTooltipEventTypes:s,tooltipPayloadSearcher:u,eventEmitter:void 0};return t.createElement(CK,{preloadedState:{options:c},reduxStoreName:null!==(r=l.id)&&void 0!==r?r:o},t.createElement(IK,{chartData:l.data}),t.createElement(PK,{layout:i.layout,margin:i.margin}),t.createElement(DK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),t.createElement(DX,_1({},i,{ref:n})))}),C1=["axis","item"],I1=(0,t.forwardRef)((e,n)=>t.createElement(k1,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:C1,tooltipPayloadSearcher:zP,categoricalChartProps:e,ref:n}));function T1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A1{static create(e){return new A1(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case"end":var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}if(t){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}T1(A1,"EPS",1e-4);function O1(e,t){if(t<1)return[];if(1===t)return e;for(var n=[],r=0;r<e.length;r+=t){var i=e[r];void 0!==i&&n.push(i)}return n}function N1(e,t,n){return function(e){var{width:t,height:n}=e,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),i=r*Math.PI/180,o=Math.atan(n/t),a=i>o&&i<Math.PI-o?n/Math.sin(i):t/Math.cos(i);return Math.abs(a)}({width:e.width+t.width,height:e.height+t.height},n)}function P1(e,t,n,r,i){if(e*t<e*r||e*t>e*i)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-i)<=0}function D1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D1(Object(n),!0).forEach(function(t){M1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j1(e,t,n){var r,{tick:i,ticks:o,viewBox:a,minTickGap:s,orientation:u,interval:l,tickFormatter:c,unit:h,angle:d}=e;if(!o||!o.length||!i)return[];if(VA(l)||pK)return null!==(r=function(e,t){return O1(e,t+1)}(o,VA(l)?l:0))&&void 0!==r?r:[];var f=[],p="top"===u||"bottom"===u?"width":"height",m=h&&"width"===p?OQ(h,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(e,r)=>{var i="function"===typeof c?c(e.value,r):e.value;return"width"===p?N1(OQ(i,{fontSize:t,letterSpacing:n}),m,d):OQ(i,{fontSize:t,letterSpacing:n})[p]},v=o.length>=2?BA(o[1].coordinate-o[0].coordinate):1,y=function(e,t,n){var r="width"===n,{x:i,y:o,width:a,height:s}=e;return 1===t?{start:r?i:o,end:r?i+a:o+s}:{start:r?i+a:o+s,end:r?i:o}}(a,v,p);return"equidistantPreserveStart"===l?function(e,t,n,r,i){for(var o,a=(r||[]).slice(),{start:s,end:u}=t,l=0,c=1,h=s,d=function(){var t=null===r||void 0===r?void 0:r[l];if(void 0===t)return{v:O1(r,c)};var o,a=l,d=()=>(void 0===o&&(o=n(t,a)),o),f=t.coordinate,p=0===l||P1(e,f,d,h,u);p||(l=0,h=s,c+=1),p&&(h=f+e*(d()/2+i),l+=c)};c<=a.length;)if(o=d())return o.v;return[]}(v,y,g,o,s):"equidistantPreserveEnd"===l?function(e,t,n,r,i){var o=(r||[]).slice().length;if(0===o)return[];for(var{start:a,end:s}=t,u=1;u<=o;u++){for(var l=(o-1)%u,c=a,h=!0,d=function(){var t,o=r[f],a=f,u=()=>(void 0===t&&(t=n(o,a)),t),d=o.coordinate,p=f===l||P1(e,d,u,c,s);if(!p)return h=!1,1;p&&(c=d+e*(u()/2+i))},f=l;f<o&&!d();f+=u);if(h){for(var p=[],m=l;m<o;m+=u)p.push(r[m]);return p}}return[]}(v,y,g,o,s):(f="preserveStart"===l||"preserveStartEnd"===l?function(e,t,n,r,i,o){var a=(r||[]).slice(),s=a.length,{start:u,end:l}=t;if(o){var c=r[s-1],h=n(c,s-1),d=e*(c.coordinate+e*h/2-l);a[s-1]=c=R1(R1({},c),{},{tickCoord:d>0?c.coordinate-d*e:c.coordinate}),null!=c.tickCoord&&P1(e,c.tickCoord,()=>h,u,l)&&(l=c.tickCoord-e*(h/2+i),a[s-1]=R1(R1({},c),{},{isShow:!0}))}for(var f=o?s-1:s,p=function(t){var r,o=a[t],s=()=>(void 0===r&&(r=n(o,t)),r);if(0===t){var c=e*(o.coordinate-e*s()/2-u);a[t]=o=R1(R1({},o),{},{tickCoord:c<0?o.coordinate-c*e:o.coordinate})}else a[t]=o=R1(R1({},o),{},{tickCoord:o.coordinate});null!=o.tickCoord&&P1(e,o.tickCoord,s,u,l)&&(u=o.tickCoord+e*(s()/2+i),a[t]=R1(R1({},o),{},{isShow:!0}))},m=0;m<f;m++)p(m);return a}(v,y,g,o,s,"preserveStartEnd"===l):function(e,t,n,r,i){for(var o=(r||[]).slice(),a=o.length,{start:s}=t,{end:u}=t,l=function(t){var r,l=o[t],c=()=>(void 0===r&&(r=n(l,t)),r);if(t===a-1){var h=e*(l.coordinate+e*c()/2-u);o[t]=l=R1(R1({},l),{},{tickCoord:h>0?l.coordinate-h*e:l.coordinate})}else o[t]=l=R1(R1({},l),{},{tickCoord:l.coordinate});null!=l.tickCoord&&P1(e,l.tickCoord,c,s,u)&&(u=l.tickCoord-e*(c()/2+i),o[t]=R1(R1({},l),{},{isShow:!0}))},c=a-1;c>=0;c--)l(c);return o}(v,y,g,o,s),f.filter(e=>e.isShow))}var F1=["axisLine","width","height","className","hide","ticks","axisType"];function L1(){return L1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L1.apply(null,arguments)}function B1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B1(Object(n),!0).forEach(function(t){U1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function U1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V1={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:PU.axis};function W1(e){var{x:n,y:r,width:i,height:o,orientation:a,mirror:s,axisLine:u,otherSvgProps:l}=e;if(!u)return null;var c=z1(z1(z1({},l),UK(u)),{},{fill:"none"});if("top"===a||"bottom"===a){var h=+("top"===a&&!s||"bottom"===a&&s);c=z1(z1({},c),{},{x1:n,y1:r+h*o,x2:n+i,y2:r+h*o})}else{var d=+("left"===a&&!s||"right"===a&&s);c=z1(z1({},c),{},{x1:n+d*i,y1:r,x2:n+d*i,y2:r+o})}return t.createElement("line",L1({},c,{className:PA("recharts-cartesian-axis-line",jA()(u,"className"))}))}function H1(e){var n,{option:r,tickProps:i,value:o}=e,a=PA(i.className,"recharts-cartesian-axis-tick-value");if(t.isValidElement(r))n=t.cloneElement(r,z1(z1({},i),{},{className:a}));else if("function"===typeof r)n=r(z1(z1({},i),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";"boolean"!==typeof r&&(s=PA(s,null===r||void 0===r?void 0:r.className)),n=t.createElement(r$,L1({},i,{className:s}),o)}return n}var q1=(0,t.forwardRef)((e,n)=>{var{ticks:r=[],tick:i,tickLine:o,stroke:a,tickFormatter:s,unit:u,padding:l,tickTextProps:c,orientation:h,mirror:d,x:f,y:p,width:m,height:g,tickSize:v,tickMargin:y,fontSize:b,letterSpacing:x,getTicksConfig:w,events:E,axisType:_}=e,S=j1(z1(z1({},w),{},{ticks:r}),b,x),k=function(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}(h,d),C=function(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}(h,d),I=UK(w),T=VK(i),A={};"object"===typeof o&&(A=o);var O=z1(z1({},I),{},{fill:"none"},A),N=S.map(e=>z1({entry:e},function(e,t,n,r,i,o,a,s,u){var l,c,h,d,f,p,m=s?-1:1,g=e.tickSize||a,v=VA(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":l=c=e.coordinate,p=(h=(d=n+ +!s*i)-m*g)-m*u,f=v;break;case"left":h=d=e.coordinate,f=(l=(c=t+ +!s*r)-m*g)-m*u,p=v;break;case"right":h=d=e.coordinate,f=(l=(c=t+ +s*r)+m*g)+m*u,p=v;break;default:l=c=e.coordinate,p=(h=(d=n+ +s*i)+m*g)+m*u,f=v}return{line:{x1:l,y1:h,x2:c,y2:d},tick:{x:f,y:p}}}(e,f,p,m,g,h,v,d,y))),P=N.map(e=>{var{entry:n,line:r}=e;return t.createElement(AY,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(n.value,"-").concat(n.coordinate,"-").concat(n.tickCoord)},o&&t.createElement("line",L1({},O,r,{className:PA("recharts-cartesian-axis-tick-line",jA()(o,"className"))})))}),D=N.map((e,n)=>{var{entry:r,tick:o}=e,h=z1(z1(z1(z1({textAnchor:k,verticalAnchor:C},I),{},{stroke:"none",fill:a},T),o),{},{index:n,payload:r,visibleTicksCount:S.length,tickFormatter:s,padding:l},c);return t.createElement(AY,L1({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(r.value,"-").concat(r.coordinate,"-").concat(r.tickCoord)},lQ(E,r,n)),i&&t.createElement(H1,{option:i,tickProps:h,value:"".concat("function"===typeof s?s(r.value,n):r.value).concat(u||"")}))});return t.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(_,"-ticks")},D.length>0&&t.createElement(RJ,{zIndex:PU.label},t.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(_,"-tick-labels"),ref:n},D)),P.length>0&&t.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(_,"-tick-lines")},P))}),G1=(0,t.forwardRef)((e,n)=>{var{axisLine:r,width:i,height:o,className:a,hide:s,ticks:u,axisType:l}=e,c=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,F1),[h,d]=(0,t.useState)(""),[f,p]=(0,t.useState)(""),m=(0,t.useRef)(null);(0,t.useImperativeHandle)(n,()=>({getCalculatedWidth:()=>{var t;return(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:i=0,tickMargin:o=0}=e,a=0;if(t){Array.from(t).forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>a&&(a=t.width)}});var s=n?n.getBoundingClientRect().width:0,u=a+(i+o)+s+(n?r:0);return Math.round(u)}return 0})({ticks:m.current,label:null===(t=e.labelRef)||void 0===t?void 0:t.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=(0,t.useCallback)(e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=t;var n=t[0];if(n){var r=window.getComputedStyle(n),i=r.fontSize,o=r.letterSpacing;i===h&&o===f||(d(i),p(o))}}},[h,f]);return s||null!=i&&i<=0||null!=o&&o<=0?null:t.createElement(RJ,{zIndex:e.zIndex},t.createElement(AY,{className:PA("recharts-cartesian-axis",a)},t.createElement(W1,{x:e.x,y:e.y,width:i,height:o,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:UK(e)}),t.createElement(q1,{ref:g,axisType:l,events:c,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:f,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:u,unit:e.unit,width:e.width,x:e.x,y:e.y}),t.createElement(WJ,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},t.createElement(JJ,{label:e.label,labelRef:e.labelRef}),e.children)))}),K1=t.forwardRef((e,n)=>{var r=jX(e,V1);return t.createElement(G1,L1({},r,{ref:n}))});K1.displayName="CartesianAxis";var X1=["x1","y1","x2","y2","key"],Y1=["offset"],Q1=["xAxisId","yAxisId"],$1=["xAxisId","yAxisId"];function Z1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function J1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z1(Object(n),!0).forEach(function(t){e2(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z1(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function e2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t2(){return t2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t2.apply(null,arguments)}function n2(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var r2=e=>{var{fill:n}=e;if(!n||"none"===n)return null;var{fillOpacity:r,x:i,y:o,width:a,height:s,ry:u}=e;return t.createElement("rect",{x:i,y:o,ry:u,width:a,height:s,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function i2(e){var n,{option:r,lineItemProps:i}=e;if(t.isValidElement(r))n=t.cloneElement(r,i);else if("function"===typeof r)n=r(i);else{var o,{x1:a,y1:s,x2:u,y2:l,key:c}=i,h=null!==(o=UK(n2(i,X1)))&&void 0!==o?o:{},{offset:d}=h,f=n2(h,Y1);n=t.createElement("line",t2({},f,{x1:a,y1:s,x2:u,y2:l,fill:"none",key:c}))}return n}function o2(e){var{x:n,width:r,horizontal:i=!0,horizontalPoints:o}=e;if(!i||!o||!o.length)return null;var{xAxisId:a,yAxisId:s}=e,u=n2(e,Q1),l=o.map((e,o)=>{var a=J1(J1({},u),{},{x1:n,y1:e,x2:n+r,y2:e,key:"line-".concat(o),index:o});return t.createElement(i2,{key:"line-".concat(o),option:i,lineItemProps:a})});return t.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function a2(e){var{y:n,height:r,vertical:i=!0,verticalPoints:o}=e;if(!i||!o||!o.length)return null;var{xAxisId:a,yAxisId:s}=e,u=n2(e,$1),l=o.map((e,o)=>{var a=J1(J1({},u),{},{x1:e,y1:n,x2:e,y2:n+r,key:"line-".concat(o),index:o});return t.createElement(i2,{option:i,lineItemProps:a,key:"line-".concat(o)})});return t.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function s2(e){var{horizontalFill:n,fillOpacity:r,x:i,y:o,width:a,height:s,horizontalPoints:u,horizontal:l=!0}=e;if(!l||!n||!n.length||null==u)return null;var c=u.map(e=>Math.round(e+o-o)).sort((e,t)=>e-t);o!==c[0]&&c.unshift(0);var h=c.map((e,u)=>{var l=!c[u+1]?o+s-e:c[u+1]-e;if(l<=0)return null;var h=u%n.length;return t.createElement("rect",{key:"react-".concat(u),y:e,x:i,height:l,width:a,stroke:"none",fill:n[h],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return t.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function u2(e){var{vertical:n=!0,verticalFill:r,fillOpacity:i,x:o,y:a,width:s,height:u,verticalPoints:l}=e;if(!n||!r||!r.length)return null;var c=l.map(e=>Math.round(e+o-o)).sort((e,t)=>e-t);o!==c[0]&&c.unshift(0);var h=c.map((e,n)=>{var l=!c[n+1]?o+s-e:c[n+1]-e;if(l<=0)return null;var h=n%r.length;return t.createElement("rect",{key:"react-".concat(n),x:e,y:a,width:l,height:u,stroke:"none",fill:r[h],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return t.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var l2=(e,t)=>{var{xAxis:n,width:r,height:i,offset:o}=e;return $R(j1(J1(J1(J1({},V1),n),{},{ticks:ZR(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),o.left,o.left+o.width,t)},c2=(e,t)=>{var{yAxis:n,width:r,height:i,offset:o}=e;return $R(j1(J1(J1(J1({},V1),n),{},{ticks:ZR(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),o.top,o.top+o.height,t)},h2={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:PU.grid};function d2(e){var n=PM(),r=DM(),i=NM(),o=J1(J1({},jX(e,h2)),{},{x:VA(e.x)?e.x:i.left,y:VA(e.y)?e.y:i.top,width:VA(e.width)?e.width:i.width,height:VA(e.height)?e.height:i.height}),{xAxisId:a,yAxisId:s,x:u,y:l,width:c,height:h,syncWithTicks:d,horizontalValues:f,verticalValues:p}=o,m=kM(),g=RR(e=>uH(e,"xAxis",a,m)),v=RR(e=>uH(e,"yAxis",s,m));if(!uO(c)||!uO(h)||!VA(u)||!VA(l))return null;var y=o.verticalCoordinatesGenerator||l2,b=o.horizontalCoordinatesGenerator||c2,{horizontalPoints:x,verticalPoints:w}=o;if((!x||!x.length)&&"function"===typeof b){var E=f&&f.length,_=b({yAxis:v?J1(J1({},v),{},{ticks:E?f:v.ticks}):void 0,width:null!==n&&void 0!==n?n:c,height:null!==r&&void 0!==r?r:h,offset:i},!!E||d);eO(Array.isArray(_),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(x=_)}if((!w||!w.length)&&"function"===typeof y){var S=p&&p.length,k=y({xAxis:g?J1(J1({},g),{},{ticks:S?p:g.ticks}):void 0,width:null!==n&&void 0!==n?n:c,height:null!==r&&void 0!==r?r:h,offset:i},!!S||d);eO(Array.isArray(k),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(w=k)}return t.createElement(RJ,{zIndex:o.zIndex},t.createElement("g",{className:"recharts-cartesian-grid"},t.createElement(r2,{fill:o.fill,fillOpacity:o.fillOpacity,x:o.x,y:o.y,width:o.width,height:o.height,ry:o.ry}),t.createElement(s2,t2({},o,{horizontalPoints:x})),t.createElement(u2,t2({},o,{verticalPoints:w})),t.createElement(o2,t2({},o,{offset:i,horizontalPoints:x,xAxis:g,yAxis:v})),t.createElement(a2,t2({},o,{offset:i,verticalPoints:w,xAxis:g,yAxis:v}))))}d2.displayName="CartesianGrid";var f2=["domain","range"],p2=["domain","range"];function m2(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function g2(e,t){return e===t||!(!Array.isArray(e)||2!==e.length||!Array.isArray(t)||2!==t.length)&&(e[0]===t[0]&&e[1]===t[1])}function v2(e,t){if(e===t)return!0;var{domain:n,range:r}=e,i=m2(e,f2),{domain:o,range:a}=t,s=m2(t,p2);return!!g2(n,o)&&(!!g2(r,a)&&OK(i,s))}var y2=["dangerouslySetInnerHTML","ticks","scale"],b2=["id","scale"];function x2(){return x2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x2.apply(null,arguments)}function w2(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function E2(e){var n=OR(),r=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{null===r.current?n(nG(e)):r.current!==e&&n(rG({prev:r.current,next:e})),r.current=e},[e,n]),(0,t.useLayoutEffect)(()=>()=>{r.current&&(n(iG(r.current)),r.current=null)},[n]),null}var _2=e=>{var{xAxisId:n,className:r}=e,i=RR(_M),o=kM(),a="xAxis",s=RR(e=>lH(e,a,n,o)),u=RR(e=>$W(e,n)),l=RR(e=>eH(e,n)),c=RR(e=>xV(e,n));if(null==u||null==l||null==c)return null;var{dangerouslySetInnerHTML:h,ticks:d,scale:f}=e,p=w2(e,y2),{id:m,scale:g}=c,v=w2(c,b2);return t.createElement(K1,x2({},p,v,{x:l.x,y:l.y,width:u.width,height:u.height,className:PA("recharts-".concat(a," ").concat(a),r),viewBox:i,ticks:s,axisType:a}))},S2={allowDataOverflow:bV.allowDataOverflow,allowDecimals:bV.allowDecimals,allowDuplicatedCategory:bV.allowDuplicatedCategory,angle:bV.angle,axisLine:V1.axisLine,height:bV.height,hide:!1,includeHidden:bV.includeHidden,interval:bV.interval,minTickGap:bV.minTickGap,mirror:bV.mirror,orientation:bV.orientation,padding:bV.padding,reversed:bV.reversed,scale:bV.scale,tick:bV.tick,tickCount:bV.tickCount,tickLine:V1.tickLine,tickSize:V1.tickSize,type:bV.type,xAxisId:0},k2=e=>{var n=jX(e,S2);return t.createElement(t.Fragment,null,t.createElement(E2,{allowDataOverflow:n.allowDataOverflow,allowDecimals:n.allowDecimals,allowDuplicatedCategory:n.allowDuplicatedCategory,angle:n.angle,dataKey:n.dataKey,domain:n.domain,height:n.height,hide:n.hide,id:n.xAxisId,includeHidden:n.includeHidden,interval:n.interval,minTickGap:n.minTickGap,mirror:n.mirror,name:n.name,orientation:n.orientation,padding:n.padding,reversed:n.reversed,scale:n.scale,tick:n.tick,tickCount:n.tickCount,tickFormatter:n.tickFormatter,ticks:n.ticks,type:n.type,unit:n.unit}),t.createElement(_2,n))},C2=t.memo(k2,v2);C2.displayName="XAxis";var I2=["dangerouslySetInnerHTML","ticks","scale"],T2=["id","scale"];function A2(){return A2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A2.apply(null,arguments)}function O2(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function N2(e){var n=OR(),r=(0,t.useRef)(null);return(0,t.useLayoutEffect)(()=>{null===r.current?n(oG(e)):r.current!==e&&n(aG({prev:r.current,next:e})),r.current=e},[e,n]),(0,t.useLayoutEffect)(()=>()=>{r.current&&(n(sG(r.current)),r.current=null)},[n]),null}var P2=e=>{var{yAxisId:n,className:r,width:i,label:o}=e,a=(0,t.useRef)(null),s=(0,t.useRef)(null),u=RR(_M),l=kM(),c=OR(),h="yAxis",d=RR(e=>nH(e,n)),f=RR(e=>tH(e,n)),p=RR(e=>lH(e,h,n,l)),m=RR(e=>_V(e,n));if((0,t.useLayoutEffect)(()=>{if("auto"===i&&d&&!KJ(o)&&!(0,t.isValidElement)(o)&&null!=m){var e=a.current;if(e){var r=e.getCalculatedWidth();Math.round(d.width)!==Math.round(r)&&c(hG({id:n,width:r}))}}},[p,d,c,o,n,i,m]),null==d||null==f||null==m)return null;var{dangerouslySetInnerHTML:g,ticks:v,scale:y}=e,b=O2(e,I2),{id:x,scale:w}=m,E=O2(m,T2);return t.createElement(K1,A2({},b,E,{ref:a,labelRef:s,x:f.x,y:f.y,tickTextProps:"auto"===i?{width:void 0}:{width:i},width:d.width,height:d.height,className:PA("recharts-".concat(h," ").concat(h),r),viewBox:u,ticks:p,axisType:h}))},D2={allowDataOverflow:EV.allowDataOverflow,allowDecimals:EV.allowDecimals,allowDuplicatedCategory:EV.allowDuplicatedCategory,angle:EV.angle,axisLine:V1.axisLine,hide:!1,includeHidden:EV.includeHidden,interval:EV.interval,minTickGap:EV.minTickGap,mirror:EV.mirror,orientation:EV.orientation,padding:EV.padding,reversed:EV.reversed,scale:EV.scale,tick:EV.tick,tickCount:EV.tickCount,tickLine:V1.tickLine,tickSize:V1.tickSize,type:EV.type,width:EV.width,yAxisId:0},R2=e=>{var n=jX(e,D2);return t.createElement(t.Fragment,null,t.createElement(N2,{interval:n.interval,id:n.yAxisId,scale:n.scale,type:n.type,domain:n.domain,allowDataOverflow:n.allowDataOverflow,dataKey:n.dataKey,allowDuplicatedCategory:n.allowDuplicatedCategory,allowDecimals:n.allowDecimals,tickCount:n.tickCount,padding:n.padding,includeHidden:n.includeHidden,reversed:n.reversed,ticks:n.ticks,width:n.width,orientation:n.orientation,mirror:n.mirror,hide:n.hide,unit:n.unit,name:n.name,angle:n.angle,minTickGap:n.minTickGap,tick:n.tick,tickFormatter:n.tickFormatter}),t.createElement(P2,n))},M2=t.memo(R2,v2);M2.displayName="YAxis";var j2="Invariant failed";function F2(){return F2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},F2.apply(null,arguments)}function L2(e){return t.createElement(vJ,F2({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var B2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(n,r)=>{if(VA(e))return e;var i=VA(n)||QA(n);return i?e(n,r):(i||function(e){if(!e)throw new Error(j2)}(!1,"minPointSize callback function received a value with type of ".concat(typeof n,". Currently only numbers or null/undefined are supported.")),t)}},z2=["children"];var U2={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},V2=(0,t.createContext)(U2);function W2(e){var{children:n}=e,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,z2);return t.createElement(V2.Provider,{value:r},n)}function H2(e,t){var n,r,i=RR(t=>wV(t,e)),o=RR(e=>SV(e,t)),a=null!==(n=null===i||void 0===i?void 0:i.allowDataOverflow)&&void 0!==n?n:bV.allowDataOverflow,s=null!==(r=null===o||void 0===o?void 0:o.allowDataOverflow)&&void 0!==r?r:EV.allowDataOverflow;return{needClip:a||s,needClipX:a,needClipY:s}}function q2(e){var{xAxisId:n,yAxisId:r,clipPathId:i}=e,o=AX(),{needClipX:a,needClipY:s,needClip:u}=H2(n,r);if(!u||!o)return null;var{x:l,y:c,width:h,height:d}=o;return t.createElement("clipPath",{id:"clipPath-".concat(i)},t.createElement("rect",{x:a?l:l-h/2,y:s?c:c-d/2,width:a?h:2*h,height:s?d:2*d}))}var G2=(e,t,n)=>{var r=null!==n&&void 0!==n?n:e;if(!QA(r))return GA(r,t,0)};function K2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function X2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K2(Object(n),!0).forEach(function(t){Y2(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K2(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Y2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q2(e,t){var n,r;return null!==(n=null===(r=e.graphicalItems.cartesianItems.find(e=>e.id===t))||void 0===r?void 0:r.xAxisId)&&void 0!==n?n:0}function $2(e,t){var n,r;return null!==(n=null===(r=e.graphicalItems.cartesianItems.find(e=>e.id===t))||void 0===r?void 0:r.yAxisId)&&void 0!==n?n:0}var Z2=kR([NV,(e,t)=>t],(e,t)=>e.filter(e=>"bar"===e.type).find(e=>e.id===t)),J2=kR([Z2],e=>null===e||void 0===e?void 0:e.maxBarSize),e3=kR([RM,NV,Q2,$2,(e,t,n)=>n],(e,t,n,r,i)=>t.filter(t=>"horizontal"===e?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===i).filter(e=>!1===e.hide).filter(e=>"bar"===e.type)),t3=kR([e3,e=>e.rootProps.barSize,(e,t)=>{var n=RM(e),r=Q2(e,t),i=$2(e,t);if(null!=r&&null!=i)return"horizontal"===n?rH(e,"xAxis",r):rH(e,"yAxis",i)}],(e,t,n)=>{var r=e.filter(cV),i=e.filter(e=>null==e.stackId),o=r.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),{}),a=Object.entries(o).map(e=>{var[r,i]=e,o=i.map(e=>e.dataKey);return{stackId:r,dataKeys:o,barSize:G2(t,n,i[0].barSize)}}),s=i.map(e=>({stackId:void 0,dataKeys:[e.dataKey].filter(e=>null!=e),barSize:G2(t,n,e.barSize)}));return[...a,...s]}),n3=(e,t,n)=>{var r,i,o=RM(e),a=Q2(e,t),s=$2(e,t);if(null!=a&&null!=s)return"horizontal"===o?(r=hH(e,"xAxis",a,n),i=cH(e,"xAxis",a,n)):(r=hH(e,"yAxis",s,n),i=cH(e,"yAxis",s,n)),sM(r,i)},r3=kR([t3,pU,e=>e.rootProps.barGap,mU,(e,t,n)=>{var r,i,o=Z2(e,t);if(null!=o){var a=Q2(e,t),s=$2(e,t);if(null!=a&&null!=s){var u,l,c=RM(e),h=pU(e),{maxBarSize:d}=o,f=QA(d)?h:d;return"horizontal"===c?(u=hH(e,"xAxis",a,n),l=cH(e,"xAxis",a,n)):(u=hH(e,"yAxis",s,n),l=cH(e,"yAxis",s,n)),null!==(r=null!==(i=sM(u,l,!0))&&void 0!==i?i:f)&&void 0!==r?r:0}}},n3,J2],(e,t,n,r,i,o,a)=>{var s=QA(a)?t:a,u=function(e,t,n,r,i){var o=r.length;if(!(o<1)){var a,s=GA(e,n,0,!0),u=[];if(sO(r[0].barSize)){var l=!1,c=n/o,h=r.reduce((e,t)=>e+(t.barSize||0),0);(h+=(o-1)*s)>=n&&(h-=(o-1)*s,s=0),h>=n&&c>0&&(l=!0,h=o*(c*=.9));var d={offset:((n-h)/2|0)-s,size:0};a=r.reduce((e,t)=>{var n,r=[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:d.offset+d.size+s,size:l?c:null!==(n=t.barSize)&&void 0!==n?n:0}}];return d=r[r.length-1].position,r},u)}else{var f=GA(t,n,0,!0);n-2*f-(o-1)*s<=0&&(s=0);var p=(n-2*f-(o-1)*s)/o;p>1&&(p>>=0);var m=sO(i)?Math.min(p,i):p;a=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:f+(p+s)*n+(p-m)/2,size:m}}],u)}return a}}(n,r,i!==o?i:o,e,s);return i!==o&&null!=u&&(u=u.map(e=>X2(X2({},e),{},{position:X2(X2({},e.position),{},{offset:e.position.offset-i/2})}))),u}),i3=kR([r3,Z2],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),o3=kR([(e,t,n)=>{var r=RM(e),i=Q2(e,t),o=$2(e,t);if(null!=i&&null!=o)return"horizontal"===r?ZV(e,"yAxis",o,n):ZV(e,"xAxis",i,n)},Z2],(e,t)=>{var n=uV(t);if(e&&null!=n&&null!=t){var{stackId:r}=t;if(null!=r){var i=e[r];if(i){var{stackedData:o}=i;if(o)return o.find(e=>e.key===n)}}}}),a3=kR([wM,_M,(e,t,n)=>{var r=Q2(e,t);if(null!=r)return hH(e,"xAxis",r,n)},(e,t,n)=>{var r=$2(e,t);if(null!=r)return hH(e,"yAxis",r,n)},(e,t,n)=>{var r=Q2(e,t);if(null!=r)return cH(e,"xAxis",r,n)},(e,t,n)=>{var r=$2(e,t);if(null!=r)return cH(e,"yAxis",r,n)},i3,RM,(e,t,n)=>n?Xz(e):Kz(e),n3,o3,Z2,(e,t,n,r)=>r],(e,t,n,r,i,o,a,s,u,l,c,h,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:m}=u;if(null!=h&&null!=a&&null!=t&&("horizontal"===s||"vertical"===s)&&null!=n&&null!=r&&null!=i&&null!=o&&null!=l){var g,{data:v}=h;if(null!=(g=null!=v&&v.length>0?v:null===f||void 0===f?void 0:f.slice(p,m+1)))return function(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:i,bandSize:o,xAxis:a,yAxis:s,xAxisTicks:u,yAxisTicks:l,stackedData:c,displayedData:h,offset:d,cells:f,parentViewBox:p,dataStartIndex:m}=e,g="horizontal"===t?s:a,v=c?g.scale.domain():null,y=(e=>{var{numericAxis:t}=e,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return r<=0&&i>=0?0:i<0?i:r}return n[0]})({numericAxis:g}),b=g.scale(y);return h.map((e,h)=>{var g,x,w,E,_,S;if(c){var k=c[h+m];if(null==k)return null;g=((e,t)=>{if(!t||2!==t.length||!VA(t[0])||!VA(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!VA(e[0])||e[0]<n)&&(i[0]=n),(!VA(e[1])||e[1]>r)&&(i[1]=r),i[0]>r&&(i[0]=r),i[1]<n&&(i[1]=n),i})(k,v)}else g=YR(e,n),Array.isArray(g)||(g=[y,g]);var C=B2(r,N3)(g[1],h);if("horizontal"===t){var I,[T,A]=[s.scale(g[0]),s.scale(g[1])];x=rM({axis:a,ticks:u,bandSize:o,offset:i.offset,entry:e,index:h}),w=null!==(I=null!==A&&void 0!==A?A:T)&&void 0!==I?I:void 0,E=i.size;var O=T-A;if(_=zA(O)?0:O,S={x:x,y:d.top,width:E,height:d.height},Math.abs(C)>0&&Math.abs(_)<Math.abs(C)){var N=BA(_||C)*(Math.abs(C)-Math.abs(_));w-=N,_+=N}}else{var[P,D]=[a.scale(g[0]),a.scale(g[1])];if(x=P,w=rM({axis:s,ticks:l,bandSize:o,offset:i.offset,entry:e,index:h}),E=D-P,_=i.size,S={x:d.left,y:w,width:d.width,height:_},Math.abs(C)>0&&Math.abs(E)<Math.abs(C))E+=BA(E||C)*(Math.abs(C)-Math.abs(E))}return null==x||null==w||null==E||null==_?null:b3(b3({},e),{},{stackedBarStart:b,x:x,y:w,width:E,height:_,value:c?g:g[1],payload:e,background:S,tooltipPosition:{x:x+E/2,y:w+_/2},parentViewBox:p},f&&f[h]&&f[h].props)}).filter(Boolean)}({layout:s,barSettings:h,pos:a,parentViewBox:t,bandSize:l,xAxis:n,yAxis:r,xAxisTicks:i,yAxisTicks:o,stackedData:c,displayedData:g,offset:e,cells:d,dataStartIndex:p})}});var s3=["index"];function u3(){return u3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u3.apply(null,arguments)}var l3=(0,t.createContext)(void 0),c3=e=>{var n,r=(0,t.useContext)(l3);return null!=r?r.stackId:null!=e?null==(n=e)?void 0:String(n):void 0},h3=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),d3=e=>{var{index:n}=e,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,s3),i=(e=>{var n=(0,t.useContext)(l3);if(null!=n){var{stackId:r}=n;return"url(#".concat(h3(r,e),")")}})(n);return t.createElement(AY,u3({className:"recharts-bar-stack-layer",clipPath:i},r))},f3=["onMouseEnter","onMouseLeave","onClick"],p3=["value","background","tooltipPosition"],m3=["id"],g3=["onMouseEnter","onClick","onMouseLeave"];function v3(){return v3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v3.apply(null,arguments)}function y3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y3(Object(n),!0).forEach(function(t){x3(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y3(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w3(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var E3=e=>{var{dataKey:t,name:n,fill:r,legendType:i,hide:o}=e;return[{inactive:o,dataKey:t,type:i,color:r,value:lM(n,t),payload:e}]},_3=t.memo(e=>{var{dataKey:n,stroke:r,strokeWidth:i,fill:o,name:a,hide:s,unit:u,tooltipType:l,id:c}=e,h={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:i,fill:o,dataKey:n,nameKey:void 0,name:lM(a,n),hide:s,type:l,color:o,unit:u,graphicalItemId:c}};return t.createElement(EJ,{tooltipEntrySettings:h})});function S3(e){var n=RR(vq),{data:r,dataKey:i,background:o,allOtherBarProps:a}=e,{onMouseEnter:s,onMouseLeave:u,onClick:l}=a,c=w3(a,f3),h=bJ(s,i,a.id),d=xJ(u),f=wJ(l,i,a.id);if(!o||null==r)return null;var p,m,g=VK(o);return t.createElement(RJ,{zIndex:(p=o,m=PU.barBackground,p&&"object"===typeof p&&"zIndex"in p&&"number"===typeof p.zIndex&&sO(p.zIndex)?p.zIndex:m)},r.map((e,r)=>{var{value:a,background:s,tooltipPosition:u}=e,l=w3(e,p3);if(!s)return null;var p=h(e,r),m=d(e,r),v=f(e,r),y=b3(b3(b3(b3(b3({option:o,isActive:String(r)===n},l),{},{fill:"#eee"},s),g),lQ(c,e,r)),{},{onMouseEnter:p,onMouseLeave:m,onClick:v,dataKey:i,index:r,className:"recharts-bar-background-rectangle"});return t.createElement(L2,v3({key:"background-bar-".concat(r)},y))}))}function k3(e){var{showLabels:n,children:r,rects:i}=e,o=null===i||void 0===i?void 0:i.map(e=>{var t={x:e.x,y:e.y,width:e.width,lowerWidth:e.width,upperWidth:e.width,height:e.height};return b3(b3({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return t.createElement(a0,{value:n?o:void 0},r)}function C3(e){var{shape:n,activeBar:r,baseProps:i,entry:o,index:a,dataKey:s}=e,u=RR(vq),l=RR(bq),c=r&&String(a)===u&&(null==l||s===l),h=c?r:n;return c?t.createElement(RJ,{zIndex:PU.activeBar},t.createElement(L2,v3({},i,{name:String(i.name)},o,{isActive:c,option:h,index:a,dataKey:s}))):t.createElement(L2,v3({},i,{name:String(i.name)},o,{isActive:c,option:h,index:a,dataKey:s}))}function I3(e){var{shape:n,baseProps:r,entry:i,index:o,dataKey:a}=e;return t.createElement(L2,v3({},r,{name:String(r.name)},i,{isActive:!1,option:n,index:o,dataKey:a}))}function T3(e){var n,{data:r,props:i}=e,o=null!==(n=UK(i))&&void 0!==n?n:{},{id:a}=o,s=w3(o,m3),{shape:u,dataKey:l,activeBar:c}=i,{onMouseEnter:h,onClick:d,onMouseLeave:f}=i,p=w3(i,g3),m=bJ(h,l,a),g=xJ(f),v=wJ(d,l,a);return r?t.createElement(t.Fragment,null,r.map((e,n)=>t.createElement(d3,v3({index:n,key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(n),className:"recharts-bar-rectangle"},lQ(p,e,n),{onMouseEnter:m(e,n),onMouseLeave:g(e,n),onClick:v(e,n)}),c?t.createElement(C3,{shape:u,activeBar:c,baseProps:s,entry:e,index:n,dataKey:l}):t.createElement(I3,{shape:u,baseProps:s,entry:e,index:n,dataKey:l})))):null}function A3(e){var{props:n,previousRectanglesRef:r}=e,{data:i,layout:o,isAnimationActive:a,animationBegin:s,animationDuration:u,animationEasing:l,onAnimationEnd:c,onAnimationStart:h}=n,d=r.current,f=V$(n,"recharts-bar-"),[p,m]=(0,t.useState)(!1),g=!p,v=(0,t.useCallback)(()=>{"function"===typeof c&&c(),m(!1)},[c]),y=(0,t.useCallback)(()=>{"function"===typeof h&&h(),m(!0)},[h]);return t.createElement(k3,{showLabels:g,rects:i},t.createElement(U$,{animationId:f,begin:s,duration:u,isActive:a,easing:l,onAnimationEnd:v,onAnimationStart:y,key:f},e=>{var a=1===e?i:null===i||void 0===i?void 0:i.map((t,n)=>{var r=d&&d[n];if(r)return b3(b3({},t),{},{x:XA(r.x,t.x,e),y:XA(r.y,t.y,e),width:XA(r.width,t.width,e),height:XA(r.height,t.height,e)});if("horizontal"===o){var i=XA(0,t.height,e),a=XA(t.stackedBarStart,t.y,e);return b3(b3({},t),{},{y:a,height:i})}var s=XA(0,t.width,e),u=XA(t.stackedBarStart,t.x,e);return b3(b3({},t),{},{width:s,x:u})});return e>0&&(r.current=null!==a&&void 0!==a?a:null),null==a?null:t.createElement(AY,null,t.createElement(T3,{props:n,data:a}))}),t.createElement(c0,{label:n.label}),n.children)}function O3(e){var n=(0,t.useRef)(null);return t.createElement(A3,{previousRectanglesRef:n,props:e})}var N3=0,P3=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:YR(e,t)}};class D3 extends t.PureComponent{render(){var{hide:e,data:n,dataKey:r,className:i,xAxisId:o,yAxisId:a,needClip:s,background:u,id:l}=this.props;if(e||null==n)return null;var c=PA("recharts-bar",i),h=l;return t.createElement(AY,{className:c,id:l},s&&t.createElement("defs",null,t.createElement(q2,{clipPathId:h,xAxisId:o,yAxisId:a})),t.createElement(AY,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(h,")"):void 0},t.createElement(S3,{data:n,dataKey:r,background:u,allOtherBarProps:this.props}),t.createElement(O3,this.props)))}}var R3={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:N3,xAxisId:0,yAxisId:0,zIndex:PU.bar};function M3(e){var n,{xAxisId:r,yAxisId:i,hide:o,legendType:a,minPointSize:s,activeBar:u,animationBegin:l,animationDuration:c,animationEasing:h,isAnimationActive:d}=e,{needClip:f}=H2(r,i),p=MM(),m=kM(),g=c$(e.children,i$),v=RR(t=>a3(t,e.id,m,g));if("vertical"!==p&&"horizontal"!==p)return null;var y=null===v||void 0===v?void 0:v[0];return n=null==y||null==y.height||null==y.width?0:"vertical"===p?y.height/2:y.width/2,t.createElement(W2,{xAxisId:r,yAxisId:i,data:v,dataPointFormatter:P3,errorBarOffset:n},t.createElement(D3,v3({},e,{layout:p,needClip:f,data:v,xAxisId:r,yAxisId:i,hide:o,legendType:a,minPointSize:s,activeBar:u,animationBegin:l,animationDuration:c,animationEasing:h,isAnimationActive:d})))}function j3(e){var n=jX(e,R3),r=c3(n.stackId),i=kM();return t.createElement(IJ,{id:n.id,type:"bar"},e=>t.createElement(t.Fragment,null,t.createElement(_J,{legendPayload:E3(n)}),t.createElement(_3,{dataKey:n.dataKey,stroke:n.stroke,strokeWidth:n.strokeWidth,fill:n.fill,name:n.name,hide:n.hide,unit:n.unit,tooltipType:n.tooltipType,id:e}),t.createElement(AJ,{type:"bar",id:e,data:void 0,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,stackId:r,hide:n.hide,barSize:n.barSize,minPointSize:n.minPointSize,maxBarSize:n.maxBarSize,isPanorama:i}),t.createElement(RJ,{zIndex:n.zIndex},t.createElement(M3,v3({},n,{id:e})))))}var F3=t.memo(j3,OK);F3.displayName="Bar";var L3=["axis"],B3=(0,t.forwardRef)((e,n)=>t.createElement(k1,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:L3,tooltipPayloadSearcher:zP,categoricalChartProps:e,ref:n}));function z3(){return z3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z3.apply(null,arguments)}function U3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function V3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W3=32,H3={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function q3(e){var n,{data:r,iconType:i,inactiveColor:o}=e,a=16,s=W3/6,u=W3/3,l=r.inactive?o:r.color,c=null!==i&&void 0!==i?i:r.type;if("none"===c)return null;if("plainline"===c)return t.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:null===(n=r.payload)||void 0===n?void 0:n.strokeDasharray,x1:0,y1:a,x2:W3,y2:a,className:"recharts-legend-icon"});if("line"===c)return t.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(u,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(2*u,",").concat(a,"\n            H").concat(W3,"M").concat(2*u,",").concat(a,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(u,",").concat(a),className:"recharts-legend-icon"});if("rect"===c)return t.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(4,"h").concat(W3,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(t.isValidElement(r.legendIcon)){var h=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U3(Object(n),!0).forEach(function(t){V3(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U3(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r);return delete h.legendIcon,t.cloneElement(r.legendIcon,h)}return t.createElement(hJ,{fill:l,cx:a,cy:a,size:W3,sizeType:"diameter",type:c})}function G3(e){var{payload:n,iconSize:r,layout:i,formatter:o,inactiveColor:a,iconType:s}=e,u={x:0,y:0,width:W3,height:W3},l={display:"horizontal"===i?"inline-block":"block",marginRight:10},c={display:"inline-block",verticalAlign:"middle",marginRight:4};return n.map((n,i)=>{var h=n.formatter||o,d=PA({"recharts-legend-item":!0,["legend-item-".concat(i)]:!0,inactive:n.inactive});if("none"===n.type)return null;var f=n.inactive?a:n.color,p=h?h(n.value,n,i):n.value;return t.createElement("li",z3({className:d,style:l,key:"legend-item-".concat(i)},lQ(e,n,i)),t.createElement(GK,{width:r,height:r,viewBox:u,style:c,"aria-label":"".concat(p," legend icon")},t.createElement(q3,{data:n,iconType:s,inactiveColor:a})),t.createElement("span",{className:"recharts-legend-item-text",style:{color:f}},p))})}var K3=e=>{var n=jX(e,H3),{payload:r,layout:i,align:o}=n;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:"horizontal"===i?o:"left"};return t.createElement("ul",{className:"recharts-default-legend",style:a},t.createElement(G3,z3({},n,{payload:r})))};var X3=["contextPayload"];function Y3(){return Y3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y3.apply(null,arguments)}function Q3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q3(Object(n),!0).forEach(function(t){Z3(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q3(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Z3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J3(e){return e.value}function e4(e){var{contextPayload:n}=e,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,X3),i=Y0(n,e.payloadUniqBy,J3),o=$3($3({},r),{},{payload:i});return t.isValidElement(e.content)?t.cloneElement(e.content,o):"function"===typeof e.content?t.createElement(e.content,o):t.createElement(K3,o)}function t4(e){var n=OR();return(0,t.useEffect)(()=>{n(RG(e))},[n,e]),null}function n4(e){var n=OR();return(0,t.useEffect)(()=>(n(DG(e)),()=>{n(DG({width:0,height:0}))}),[n,e]),null}var r4={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function i4(e){var n=jX(e,r4),r=RR(LR),i=(0,t.useContext)(mX),o=RR(e=>e.layout.margin),{width:a,height:s,wrapperStyle:u,portal:l}=n,[c,h]=Q0([r]),d=PM(),f=DM();if(null==d||null==f)return null;var p=d-((null===o||void 0===o?void 0:o.left)||0)-((null===o||void 0===o?void 0:o.right)||0),m=function(e,t,n,r){return"vertical"===e&&VA(t)?{height:t}:"horizontal"===e?{width:n||r}:null}(n.layout,s,a,p),g=l?u:$3($3({position:"absolute",width:(null===m||void 0===m?void 0:m.width)||a||"auto",height:(null===m||void 0===m?void 0:m.height)||s||"auto"},function(e,t,n,r,i,o){var a,s,{layout:u,align:l,verticalAlign:c}=t;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(a="center"===l&&"vertical"===u?{left:((r||0)-o.width)/2}:"right"===l?{right:n&&n.right||0}:{left:n&&n.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(s="middle"===c?{top:((i||0)-o.height)/2}:"bottom"===c?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),$3($3({},a),s)}(u,n,o,d,f,c)),u),v=null!==l&&void 0!==l?l:i;if(null==v||null==r)return null;var y=t.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:h},t.createElement(t4,{layout:n.layout,align:n.align,verticalAlign:n.verticalAlign,itemSorter:n.itemSorter}),!l&&t.createElement(n4,{width:c.width,height:c.height}),t.createElement(e4,Y3({},n,m,{margin:o,chartWidth:d,chartHeight:f,contextPayload:r})));return(0,DJ.createPortal)(y,v)}function o4(){return o4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o4.apply(null,arguments)}i4.displayName="Legend";var a4=e=>{var{cx:n,cy:r,r:i,className:o}=e,a=PA("recharts-dot",o);return VA(n)&&VA(r)&&VA(i)?t.createElement("circle",o4({},UK(e),uQ(e),{className:a,cx:n,cy:r,r:i})):null},s4=["points"];function u4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u4(Object(n),!0).forEach(function(t){c4(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u4(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c4(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h4(){return h4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h4.apply(null,arguments)}function d4(e){var{option:n,dotProps:r,className:i}=e;if((0,t.isValidElement)(n))return(0,t.cloneElement)(n,r);if("function"===typeof n)return n(r);var o=PA(i,"boolean"!==typeof n?n.className:""),a=null!==r&&void 0!==r?r:{},{points:s}=a,u=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(a,s4);return t.createElement(a4,h4({},u,{className:o}))}function f4(e){var{points:n,dot:r,className:i,dotClassName:o,dataKey:a,baseProps:s,needClip:u,clipPathId:l,zIndex:c=PU.scatter}=e;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(n,r))return null;var h,d=h$(r),f=null==(h=r)?null:(0,t.isValidElement)(h)?WK(h.props):"object"!==typeof h||Array.isArray(h)?null:WK(h),p=n.map((e,i)=>{var u,l,c=l4(l4(l4({r:3},s),f),{},{index:i,cx:null!==(u=e.x)&&void 0!==u?u:void 0,cy:null!==(l=e.y)&&void 0!==l?l:void 0,dataKey:a,value:e.value,payload:e.payload,points:n});return t.createElement(d4,{key:"dot-".concat(i),option:r,dotProps:c,className:o})}),m={};return u&&null!=l&&(m.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(l,")")),t.createElement(RJ,{zIndex:c},t.createElement(AY,h4({className:i},m),p))}function p4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p4(Object(n),!0).forEach(function(t){g4(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p4(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g4(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v4=e=>{var{point:n,childIndex:r,mainColor:i,activeDot:o,dataKey:a,clipPath:s}=e;if(!1===o||null==n.x||null==n.y)return null;var u,l=m4(m4(m4({},{index:r,dataKey:a,cx:n.x,cy:n.y,r:4,fill:null!==i&&void 0!==i?i:"none",strokeWidth:2,stroke:"#fff",payload:n.payload,value:n.value}),VK(o)),uQ(o));return u=(0,t.isValidElement)(o)?(0,t.cloneElement)(o,l):"function"===typeof o?o(l):t.createElement(a4,l),t.createElement(AY,{className:"recharts-active-dot",clipPath:s},u)};function y4(e){var{points:n,mainColor:r,activeDot:i,itemDataKey:o,clipPath:a,zIndex:s=PU.activeDot}=e,u=RR(vq),l=RR(Cq);if(null==n||null==l)return null;var c=n.find(e=>l.includes(e.payload));return QA(c)?null:t.createElement(RJ,{zIndex:s},t.createElement(v4,{point:c,childIndex:Number(u),mainColor:r,dataKey:o,activeDot:i,clipPath:a}))}var b4=(e,t,n,r)=>hH(e,"xAxis",t,r),x4=(e,t,n,r)=>cH(e,"xAxis",t,r),w4=(e,t,n,r)=>hH(e,"yAxis",n,r),E4=(e,t,n,r)=>cH(e,"yAxis",n,r),_4=kR([RM,b4,w4,x4,E4],(e,t,n,r,i)=>QR(e,"xAxis")?sM(t,r,!1):sM(n,i,!1));function S4(e){return"line"===e.type}var k4=kR([NV,(e,t,n,r,i)=>i],(e,t)=>e.filter(S4).find(e=>e.id===t)),C4=kR([RM,b4,w4,x4,E4,k4,_4,Yz],(e,t,n,r,i,o,a,s)=>{var{chartData:u,dataStartIndex:l,dataEndIndex:c}=s;if(null!=o&&null!=t&&null!=n&&null!=r&&null!=i&&0!==r.length&&0!==i.length&&null!=a&&("horizontal"===e||"vertical"===e)){var h,{dataKey:d,data:f}=o;if(null!=(h=null!=f&&f.length>0?f:null===u||void 0===u?void 0:u.slice(l,c+1)))return function(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:i,yAxisTicks:o,dataKey:a,bandSize:s,displayedData:u}=e;return u.map((e,u)=>{var l=YR(e,a);if("horizontal"===t)return{x:nM({axis:n,ticks:i,bandSize:s,entry:e,index:u}),y:QA(l)?null:r.scale(l),value:l,payload:e};var c=QA(l)?null:n.scale(l),h=nM({axis:r,ticks:o,bandSize:s,entry:e,index:u});return null==c||null==h?null:{x:c,y:h,value:l,payload:e}}).filter(Boolean)}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:i,dataKey:d,bandSize:a,displayedData:h})}});var I4=["id"],T4=["type","layout","connectNulls","needClip","shape"],A4=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function O4(){return O4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O4.apply(null,arguments)}function N4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function P4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N4(Object(n),!0).forEach(function(t){D4(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N4(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function D4(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R4(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var M4=e=>{var{dataKey:t,name:n,stroke:r,legendType:i,hide:o}=e;return[{inactive:o,dataKey:t,type:i,color:r,value:lM(n,t),payload:e}]},j4=t.memo(e=>{var{dataKey:n,data:r,stroke:i,strokeWidth:o,fill:a,name:s,hide:u,unit:l,tooltipType:c,id:h}=e,d={dataDefinedOnItem:r,positions:void 0,settings:{stroke:i,strokeWidth:o,fill:a,dataKey:n,nameKey:void 0,name:lM(s,n),hide:u,type:c,color:i,unit:l,graphicalItemId:h}};return t.createElement(EJ,{tooltipEntrySettings:d})}),F4=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function L4(e,t){for(var n=e.length%2!==0?[...e,0]:e,r=[],i=0;i<t;++i)r=[...r,...n];return r}function B4(e){var{clipPathId:n,points:r,props:i}=e,{dot:o,dataKey:a,needClip:s}=i,{id:u}=i,l=UK(R4(i,I4));return t.createElement(f4,{points:r,dot:o,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:a,baseProps:l,needClip:s,clipPathId:n})}function z4(e){var{showLabels:n,children:r,points:i}=e,o=(0,t.useMemo)(()=>null===i||void 0===i?void 0:i.map(e=>{var t,n,r={x:null!==(t=e.x)&&void 0!==t?t:0,y:null!==(n=e.y)&&void 0!==n?n:0,width:0,lowerWidth:0,upperWidth:0,height:0};return P4(P4({},r),{},{value:e.value,payload:e.payload,viewBox:r,parentViewBox:void 0,fill:void 0})}),[i]);return t.createElement(a0,{value:n?o:void 0},r)}function U4(e){var{clipPathId:n,pathRef:r,points:i,strokeDasharray:o,props:a}=e,{type:s,layout:u,connectNulls:l,needClip:c,shape:h}=a,d=P4(P4({},WK(R4(a,T4))),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(n,")"):void 0,points:i,type:s,layout:u,connectNulls:l,strokeDasharray:null!==o&&void 0!==o?o:a.strokeDasharray});return t.createElement(t.Fragment,null,(null===i||void 0===i?void 0:i.length)>1&&t.createElement(vJ,O4({shapeType:"curve",option:h},d,{pathRef:r})),t.createElement(B4,{points:i,clipPathId:n,props:a}))}function V4(e){var{clipPathId:n,props:r,pathRef:i,previousPointsRef:o,longestAnimatedLengthRef:a}=e,{points:s,strokeDasharray:u,isAnimationActive:l,animationBegin:c,animationDuration:h,animationEasing:d,animateNewValues:f,width:p,height:m,onAnimationEnd:g,onAnimationStart:v}=r,y=o.current,b=V$(s,"recharts-line-"),x=(0,t.useRef)(b),[w,E]=(0,t.useState)(!1),_=!w,S=(0,t.useCallback)(()=>{"function"===typeof g&&g(),E(!1)},[g]),k=(0,t.useCallback)(()=>{"function"===typeof v&&v(),E(!0)},[v]),C=function(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}(i.current),I=(0,t.useRef)(0);x.current!==b&&(I.current=a.current,x.current=b);var T=I.current;return t.createElement(z4,{points:s,showLabels:_},r.children,t.createElement(U$,{animationId:b,begin:c,duration:h,isActive:l,easing:d,onAnimationEnd:S,onAnimationStart:k,key:b},e=>{var c,h=XA(T,C+T,e),d=Math.min(h,C);if(l)if(u){var g="".concat(u).split(/[,\s]+/gim).map(e=>parseFloat(e));c=((e,t,n)=>{var r=n.reduce((e,t)=>e+t);if(!r)return F4(t,e);for(var i=Math.floor(e/r),o=e%r,a=t-e,s=[],u=0,l=0;u<n.length;l+=n[u],++u)if(l+n[u]>o){s=[...n.slice(0,u),o-l];break}var c=s.length%2===0?[0,a]:[a];return[...L4(n,i),...s,...c].map(e=>"".concat(e,"px")).join(", ")})(d,C,g)}else c=F4(C,d);else c=null==u?void 0:String(u);if(e>0&&C>0&&(o.current=s,a.current=Math.max(a.current,d)),y){var v=y.length/s.length,b=1===e?s:s.map((t,n)=>{var r=Math.floor(n*v);if(y[r]){var i=y[r];return P4(P4({},t),{},{x:XA(i.x,t.x,e),y:XA(i.y,t.y,e)})}return P4(P4({},t),{},f?{x:XA(2*p,t.x,e),y:XA(m/2,t.y,e)}:{x:t.x,y:t.y})});return o.current=b,t.createElement(U4,{props:r,points:b,clipPathId:n,pathRef:i,strokeDasharray:c})}return t.createElement(U4,{props:r,points:s,clipPathId:n,pathRef:i,strokeDasharray:c})}),t.createElement(c0,{label:r.label}))}function W4(e){var{clipPathId:n,props:r}=e,i=(0,t.useRef)(null),o=(0,t.useRef)(0),a=(0,t.useRef)(null);return t.createElement(V4,{props:r,clipPathId:n,previousPointsRef:i,longestAnimatedLengthRef:o,pathRef:a})}var H4=(e,t)=>{var n,r;return{x:null!==(n=e.x)&&void 0!==n?n:void 0,y:null!==(r=e.y)&&void 0!==r?r:void 0,value:e.value,errorVal:YR(e.payload,t)}};class q4 extends t.Component{render(){var{hide:e,dot:n,points:r,className:i,xAxisId:o,yAxisId:a,top:s,left:u,width:l,height:c,id:h,needClip:d,zIndex:f}=this.props;if(e)return null;var p=PA("recharts-line",i),m=h,{r:g,strokeWidth:v}=function(e){var t=VK(e);if(null!=t){var{r:n,strokeWidth:r}=t,i=Number(n),o=Number(r);return(Number.isNaN(i)||i<0)&&(i=3),(Number.isNaN(o)||o<0)&&(o=2),{r:i,strokeWidth:o}}return{r:3,strokeWidth:2}}(n),y=h$(n),b=2*g+v,x=d?"url(#clipPath-".concat(y?"":"dots-").concat(m,")"):void 0;return t.createElement(RJ,{zIndex:f},t.createElement(AY,{className:p},d&&t.createElement("defs",null,t.createElement(q2,{clipPathId:m,xAxisId:o,yAxisId:a}),!y&&t.createElement("clipPath",{id:"clipPath-dots-".concat(m)},t.createElement("rect",{x:u-b/2,y:s-b/2,width:l+b,height:c+b}))),t.createElement(W2,{xAxisId:o,yAxisId:a,data:r,dataPointFormatter:H4,errorBarOffset:0},t.createElement(W4,{props:this.props,clipPathId:m}))),t.createElement(y4,{activeDot:this.props.activeDot,points:r,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:x}))}}var G4={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:PU.line,type:"linear"};function K4(e){var n=jX(e,G4),{activeDot:r,animateNewValues:i,animationBegin:o,animationDuration:a,animationEasing:s,connectNulls:u,dot:l,hide:c,isAnimationActive:h,label:d,legendType:f,xAxisId:p,yAxisId:m,id:g}=n,v=R4(n,A4),{needClip:y}=H2(p,m),b=AX(),x=MM(),w=kM(),E=RR(e=>C4(e,p,m,w,g));if("horizontal"!==x&&"vertical"!==x||null==E||null==b)return null;var{height:_,width:S,x:k,y:C}=b;return t.createElement(q4,O4({},v,{id:g,connectNulls:u,dot:l,activeDot:r,animateNewValues:i,animationBegin:o,animationDuration:a,animationEasing:s,isAnimationActive:h,hide:c,label:d,legendType:f,xAxisId:p,yAxisId:m,points:E,layout:x,height:_,width:S,left:k,top:C,needClip:y}))}function X4(e){var n=jX(e,G4),r=kM();return t.createElement(IJ,{id:n.id,type:"line"},e=>t.createElement(t.Fragment,null,t.createElement(_J,{legendPayload:M4(n)}),t.createElement(j4,{dataKey:n.dataKey,data:n.data,stroke:n.stroke,strokeWidth:n.strokeWidth,fill:n.fill,name:n.name,hide:n.hide,unit:n.unit,tooltipType:n.tooltipType,id:e}),t.createElement(AJ,{type:"line",id:e,data:n.data,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,hide:n.hide,isPanorama:r}),t.createElement(K4,O4({},n,{id:e}))))}var Y4=t.memo(X4,OK);Y4.displayName="Line";const Q4=()=>{var e;const[n,r]=(0,t.useState)({totalUsers:0,todayUsers:0,genderDistribution:{},ageDistribution:{},hourlyActivity:{},deviceTypes:{}});(0,t.useEffect)(()=>{const e=(e=>{try{return Gl(Il(qu(Dd,"user_sessions")),t=>{const n=[];t.forEach(e=>{var t;const r=e.data();n.push(l(l({id:e.id},r),{},{sessionStart:null===(t=r.sessionStart)||void 0===t?void 0:t.toDate()}))}),console.log("\ud83d\udcca Dashboard loaded:",n.length,"total sessions");const r=hA(n);e(r)})}catch(t){console.error("\u274c Error loading dashboard:",t),e({totalUsers:0,todayUsers:0,genderDistribution:{},ageDistribution:{},hourlyActivity:{},deviceTypes:{}})}})(e=>{r(e)});return()=>e()},[]);const i=Object.entries(n.genderDistribution).map(e=>{let[t,n]=e;return{name:"male"===t?"\u0e0a\u0e32\u0e22":"female"===t?"\u0e2b\u0e0d\u0e34\u0e07":"\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38",value:n}}),o=Object.entries(n.ageDistribution).map(e=>{let[t,n]=e;return{name:t,value:n}}).sort((e,t)=>e.name.localeCompare(t.name)),a=Array.from({length:24},(e,t)=>({hour:"".concat(t,":00"),users:n.hourlyActivity[t]||0})),s=Object.entries(n.deviceTypes).map(e=>{let[t,n]=e;return{name:"mobile"===t?"\u0e21\u0e37\u0e2d\u0e16\u0e37\u0e2d":"\u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c",value:n}}),u=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];return(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"\ud83d\udcca Analytics Dashboard"}),(0,v.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,v.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg shadow-lg p-6",children:[(0,v.jsx)("div",{className:"text-sm opacity-90 mb-2",children:"\ud83d\udc65 \u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"}),(0,v.jsx)("div",{className:"text-4xl font-bold",children:n.totalUsers.toLocaleString()})]}),(0,v.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg shadow-lg p-6",children:[(0,v.jsx)("div",{className:"text-sm opacity-90 mb-2",children:"\ud83d\udd25 \u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49"}),(0,v.jsx)("div",{className:"text-4xl font-bold",children:n.todayUsers.toLocaleString()})]}),(0,v.jsxs)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-lg shadow-lg p-6",children:[(0,v.jsx)("div",{className:"text-sm opacity-90 mb-2",children:"\ud83d\udcf1 \u0e2d\u0e38\u0e1b\u0e01\u0e23\u0e13\u0e4c\u0e22\u0e2d\u0e14\u0e19\u0e34\u0e22\u0e21"}),(0,v.jsx)("div",{className:"text-4xl font-bold",children:(null===(e=s[0])||void 0===e?void 0:e.name)||"N/A"})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"\ud83d\udc64 \u0e01\u0e32\u0e23\u0e01\u0e23\u0e30\u0e08\u0e32\u0e22\u0e15\u0e32\u0e21\u0e40\u0e1e\u0e28"}),(0,v.jsx)(vO,{width:"100%",height:300,children:(0,v.jsxs)(GX,{children:[(0,v.jsx)(P0,{data:i,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:n}=e;return"".concat(t," ").concat((100*n).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:i.map((e,t)=>(0,v.jsx)(i$,{fill:u[t%u.length]},"cell-".concat(t)))}),(0,v.jsx)(E1,{})]})})]}),(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"\ud83c\udf82 \u0e01\u0e32\u0e23\u0e01\u0e23\u0e30\u0e08\u0e32\u0e22\u0e15\u0e32\u0e21\u0e2d\u0e32\u0e22\u0e38"}),(0,v.jsx)(vO,{width:"100%",height:300,children:(0,v.jsxs)(I1,{data:o,children:[(0,v.jsx)(d2,{strokeDasharray:"3 3"}),(0,v.jsx)(C2,{dataKey:"name"}),(0,v.jsx)(M2,{}),(0,v.jsx)(E1,{}),(0,v.jsx)(F3,{dataKey:"value",fill:"#8884d8"})]})})]}),(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 lg:col-span-2",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"\u23f0 \u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e15\u0e32\u0e21\u0e0a\u0e48\u0e27\u0e07\u0e40\u0e27\u0e25\u0e32 (24 \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07)"}),(0,v.jsx)(vO,{width:"100%",height:300,children:(0,v.jsxs)(B3,{data:a,children:[(0,v.jsx)(d2,{strokeDasharray:"3 3"}),(0,v.jsx)(C2,{dataKey:"hour"}),(0,v.jsx)(M2,{}),(0,v.jsx)(E1,{}),(0,v.jsx)(i4,{}),(0,v.jsx)(Y4,{type:"monotone",dataKey:"users",stroke:"#8884d8",strokeWidth:2,dot:{r:4},name:"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e1c\u0e39\u0e49\u0e43\u0e0a\u0e49"})]})})]}),(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 lg:col-span-2",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"\ud83d\udcf1 \u0e1b\u0e23\u0e30\u0e40\u0e20\u0e17\u0e2d\u0e38\u0e1b\u0e01\u0e23\u0e13\u0e4c"}),(0,v.jsx)(vO,{width:"100%",height:300,children:(0,v.jsxs)(GX,{children:[(0,v.jsx)(P0,{data:s,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:n}=e;return"".concat(t," ").concat((100*n).toFixed(0),"%")},outerRadius:100,fill:"#8884d8",dataKey:"value",children:s.map((e,t)=>(0,v.jsx)(i$,{fill:u[t%u.length]},"cell-".concat(t)))}),(0,v.jsx)(E1,{})]})})]})]}),(0,v.jsx)("div",{className:"mt-8 text-center",children:(0,v.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm",children:[(0,v.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Real-time updates"]})})]})},$4=()=>{var e;const[n,r]=(0,t.useState)([]),[i,o]=(0,t.useState)("/"),[a,s]=(0,t.useState)("today"),[u,c]=(0,t.useState)(50),h=(0,t.useRef)(null);(0,t.useEffect)(()=>{console.log("\ud83d\udd0d Loading heatmap for:",i,"Filter:",a);const e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"today";try{let r;if("today"===n){const t=cA();r=Il(qu(Dd,"heatmap_clicks"),Al("pageUrl","==",e),Al("date","==",t))}else r=Il(qu(Dd,"heatmap_clicks"),Al("pageUrl","==",e));return Gl(r,r=>{const i=[];r.forEach(e=>{i.push(l({id:e.id},e.data()))}),console.log("\ud83d\udcca Heatmap loaded (".concat(n,"):"),i.length,"clicks for",e),t(i)})}catch(r){console.error("\u274c Error loading heatmap:",r),t([])}}(i,e=>{console.log("\ud83d\udcca Received",e.length,"clicks for",i),r(e)},a);return()=>e()},[i,a]),(0,t.useEffect)(()=>{if(!h.current||0===n.length)return;const e=h.current,t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight,t.clearRect(0,0,e.width,e.height),n.forEach(n=>{const r=t.createRadialGradient(n.x,n.y,0,n.x,n.y,u);r.addColorStop(0,"rgba(255, 0, 0, 0.5)"),r.addColorStop(.5,"rgba(255, 255, 0, 0.3)"),r.addColorStop(1,"rgba(0, 255, 0, 0)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height)})},[n,u]);const d=[{path:"/",name:"Home / \u0e2b\u0e19\u0e49\u0e32\u0e2b\u0e25\u0e31\u0e01"}];return(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"\ud83d\uddfa\ufe0f Heatmap Analytics"}),(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,v.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2b\u0e19\u0e49\u0e32:"}),(0,v.jsx)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500",children:d.map(e=>(0,v.jsx)("option",{value:e.path,children:e.name},e.path))})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e0a\u0e48\u0e27\u0e07\u0e40\u0e27\u0e25\u0e32:"}),(0,v.jsxs)("select",{value:a,onChange:e=>s(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500",children:[(0,v.jsx)("option",{value:"today",children:"\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49"}),(0,v.jsx)("option",{value:"all",children:"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["\u0e04\u0e27\u0e32\u0e21\u0e40\u0e02\u0e49\u0e21\u0e02\u0e2d\u0e07 Heatmap: ",u,"px"]}),(0,v.jsx)("input",{type:"range",min:"20",max:"100",value:u,onChange:e=>c(Number(e.target.value)),className:"w-full"})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[(0,v.jsx)("div",{className:"text-3xl font-bold text-green-600",children:n.length}),(0,v.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"today"===a?"\u0e04\u0e25\u0e34\u0e01\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49":"\u0e04\u0e25\u0e34\u0e01\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"})]}),(0,v.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[(0,v.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:new Set(n.map(e=>e.userId)).size}),(0,v.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Unique Users"})]})]})]}),(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",style:{minHeight:"500px",position:"relative"},children:[(0,v.jsx)("canvas",{ref:h,style:{display:"block",width:"100%",height:"auto"}}),0===n.length&&(0,v.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udced"}),(0,v.jsxs)("div",{className:"text-lg font-semibold mb-2",children:["\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e21\u0e35\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e01\u0e32\u0e23\u0e04\u0e25\u0e34\u0e01","today"===a?"\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49":""]}),(0,v.jsxs)("div",{className:"text-sm",children:["\u0e2b\u0e19\u0e49\u0e32: ",null===(e=d.find(e=>e.path===i))||void 0===e?void 0:e.name]})]})})]}),n.length>0&&(0,v.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"\ud83d\udd25 Recent Clicks"}),(0,v.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:n.slice(-10).reverse().map(e=>{var t;return(0,v.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,v.jsxs)("span",{className:"text-sm text-gray-700",children:[e.elementId," (",Math.round(e.x),", ",Math.round(e.y),")"]}),(0,v.jsx)("span",{className:"text-xs text-gray-500",children:null===(t=e.timestamp)||void 0===t?void 0:t.toDate().toLocaleString("th-TH")})]},e.id)})})]})]})},Z4=()=>{const[e,n]=(0,t.useState)("news"),[r,i]=(0,t.useState)([]),[o,a]=(0,t.useState)(!1),[s,u]=(0,t.useState)(!1),[c,h]=(0,t.useState)(!1),[d,f]=(0,t.useState)({titleTh:"",titleEn:"",titleZh:"",titleKo:"",descriptionTh:"",descriptionEn:"",descriptionZh:"",descriptionKo:"",mediaType:"image",mediaUrl:"",targetGender:"all",targetAgeMin:"",targetAgeMax:""}),[p,m]=(0,t.useState)(null),[g,y]=(0,t.useState)(null),b=e=>{if(!e||!e.includes("drive.google.com"))return e;let t="";const n=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/)||e.match(/[?&]id=([a-zA-Z0-9_-]+)/);return n&&(t=n[1]),t?"video"===d.mediaType?"https://drive.google.com/file/d/".concat(t,"/preview"):"https://drive.google.com/thumbnail?sz=w1000&id=".concat(t):e};(0,t.useEffect)(()=>{"news"===e&&x()},[e]);const x=async()=>{try{const e=qu(Dd,"news"),t=(await Hl(e)).docs.map(e=>l({id:e.id},e.data()));i(t)}catch(e){console.error("Error fetching news:",e)}},w=async e=>{if(e.preventDefault(),d.mediaUrl||p){u(!0);try{let e=d.mediaUrl;if(e&&(e=b(e)),p&&!d.mediaUrl){const n="news/".concat(Date.now(),"_").concat(p.name),r=(t=n,ih(z(Rd),t));await function(e,t,n){return eh(e=z(e),t,n)}(r,p),e=await function(e){return th(e=z(e))}(r)}const n=l(l({},d),{},{mediaUrl:e,targetAgeMin:d.targetAgeMin?parseInt(d.targetAgeMin):null,targetAgeMax:d.targetAgeMax?parseInt(d.targetAgeMax):null,createdAt:new cl("serverTimestamp")});await ql(qu(Dd,"news"),n),f({titleTh:"",titleEn:"",titleZh:"",titleKo:"",descriptionTh:"",descriptionEn:"",descriptionZh:"",descriptionKo:"",mediaType:"image",mediaUrl:"",targetGender:"all",targetAgeMin:"",targetAgeMax:""}),m(null),y(null),a(!1),x(),alert("\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08!")}catch(n){console.error("Error adding news:",n),alert("\u0e40\u0e01\u0e34\u0e14\u0e02\u0e49\u0e2d\u0e1c\u0e34\u0e14\u0e1e\u0e25\u0e32\u0e14\u0e43\u0e19\u0e01\u0e32\u0e23\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23")}finally{u(!1)}var t}else alert("\u0e01\u0e23\u0e38\u0e13\u0e32\u0e43\u0e2a\u0e48 URL Google Drive \u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e44\u0e1f\u0e25\u0e4c")},E=async e=>{if(window.confirm("\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e25\u0e1a\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e19\u0e35\u0e49\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48?"))try{await function(e){return Kl(Bu(e.firestore,Yu),[new Qi(e._key,Fi.none())])}(Gu(Dd,"news",e)),x(),alert("\u0e25\u0e1a\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08!")}catch(t){console.error("Error deleting news:",t),alert("\u0e40\u0e01\u0e34\u0e14\u0e02\u0e49\u0e2d\u0e1c\u0e34\u0e14\u0e1e\u0e25\u0e32\u0e14\u0e43\u0e19\u0e01\u0e32\u0e23\u0e25\u0e1a\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23")}},_=()=>(0,v.jsxs)(v.Fragment,{children:[c&&(0,v.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-6 overflow-y-auto",children:(0,v.jsx)("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"\ud83d\udcc1 \u0e04\u0e39\u0e48\u0e21\u0e37\u0e2d\u0e43\u0e0a\u0e49 Google Drive"}),(0,v.jsx)("button",{onClick:()=>h(!1),className:"text-gray-500 hover:text-gray-700",children:(0,v.jsx)(lA,{className:"w-6 h-6"})})]}),(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"bg-blue-50 p-5 rounded-lg",children:[(0,v.jsxs)("h3",{className:"text-lg font-bold text-blue-900 mb-3 flex items-center gap-2",children:[(0,v.jsx)(IA,{className:"w-5 h-5"}),"\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e"]}),(0,v.jsxs)("ol",{className:"space-y-2 text-sm text-gray-700",children:[(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:"1."})," \u0e2d\u0e31\u0e1b\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b\u0e44\u0e1b\u0e17\u0e35\u0e48 Google Drive"]}),(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:"2."})," \u0e04\u0e25\u0e34\u0e01\u0e02\u0e27\u0e32\u0e17\u0e35\u0e48\u0e44\u0e1f\u0e25\u0e4c \u2192 \u0e40\u0e25\u0e37\u0e2d\u0e01 ",(0,v.jsx)("strong",{children:'"Share"'})]}),(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:"3."})," \u0e04\u0e25\u0e34\u0e01 ",(0,v.jsx)("strong",{children:'"Change to anyone with the link"'})]}),(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:"4."})," \u0e40\u0e25\u0e37\u0e2d\u0e01 ",(0,v.jsx)("strong",{children:"Viewer"})," \u2192 \u0e04\u0e25\u0e34\u0e01 ",(0,v.jsx)("strong",{children:'"Copy link"'})]}),(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:"5."})," \u0e19\u0e33 Link \u0e21\u0e32\u0e27\u0e32\u0e07\u0e43\u0e19 Admin (\u0e23\u0e30\u0e1a\u0e1a\u0e08\u0e30\u0e41\u0e1b\u0e25\u0e07\u0e2d\u0e31\u0e15\u0e42\u0e19\u0e21\u0e31\u0e15\u0e34)"]})]})]}),(0,v.jsx)("button",{onClick:()=>h(!1),className:"w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-6 rounded-lg transition",children:"\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08\u0e41\u0e25\u0e49\u0e27"})]})]})})}),o&&(0,v.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-6 overflow-y-auto",children:(0,v.jsx)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e43\u0e2b\u0e21\u0e48"}),(0,v.jsx)("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700",children:(0,v.jsx)(lA,{className:"w-6 h-6"})})]}),(0,v.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,v.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border border-green-200",children:(0,v.jsxs)("div",{className:"flex items-start gap-3",children:[(0,v.jsx)("div",{className:"text-2xl",children:"\ud83d\udcc1"}),(0,v.jsxs)("div",{className:"flex-1",children:[(0,v.jsx)("p",{className:"text-sm font-semibold text-gray-800 mb-1",children:"\ud83c\udfaf \u0e27\u0e34\u0e18\u0e35\u0e43\u0e0a\u0e49: \u0e2d\u0e31\u0e1b\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b/\u0e27\u0e34\u0e14\u0e35\u0e42\u0e2d\u0e44\u0e1b\u0e17\u0e35\u0e48 Google Drive"}),(0,v.jsx)("button",{type:"button",onClick:()=>h(!0),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold mt-1",children:"\ud83d\udcd6 \u0e14\u0e39\u0e04\u0e39\u0e48\u0e21\u0e37\u0e2d\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14"})]})]})}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e1b\u0e23\u0e30\u0e40\u0e20\u0e17\u0e2a\u0e37\u0e48\u0e2d *"}),(0,v.jsxs)("div",{className:"flex gap-4",children:[(0,v.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,v.jsx)("input",{type:"radio",name:"mediaType",value:"image",checked:"image"===d.mediaType,onChange:e=>f(l(l({},d),{},{mediaType:e.target.value})),className:"w-4 h-4 text-blue-600"}),(0,v.jsx)(IA,{className:"w-5 h-5 text-gray-600"}),(0,v.jsx)("span",{className:"text-sm text-gray-700",children:"\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e"})]}),(0,v.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,v.jsx)("input",{type:"radio",name:"mediaType",value:"video",checked:"video"===d.mediaType,onChange:e=>f(l(l({},d),{},{mediaType:e.target.value})),className:"w-4 h-4 text-blue-600"}),(0,v.jsx)(TA,{className:"w-5 h-5 text-gray-600"}),(0,v.jsx)("span",{className:"text-sm text-gray-700",children:"\u0e27\u0e34\u0e14\u0e35\u0e42\u0e2d"})]})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Google Drive URL *"}),(0,v.jsx)("input",{type:"url",value:d.mediaUrl,onChange:e=>{const t=e.target.value;if(f(l(l({},d),{},{mediaUrl:t})),t){const e=b(t);y(e)}else y(null)},placeholder:"https://drive.google.com/file/d/1abc123xyz/view",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500",required:!0})]}),g&&(0,v.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:[(0,v.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07:"}),"video"===d.mediaType?(0,v.jsx)("iframe",{src:g,className:"w-full h-64 rounded",allow:"autoplay",title:"Video preview"}):(0,v.jsx)("img",{src:g,alt:"Preview",className:"max-h-64 mx-auto rounded",referrerPolicy:"no-referrer"})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e2b\u0e31\u0e27\u0e02\u0e49\u0e2d (\u0e44\u0e17\u0e22) *"}),(0,v.jsx)("input",{type:"text",value:d.titleTh,onChange:e=>f(l(l({},d),{},{titleTh:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500",required:!0})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Title (English)"}),(0,v.jsx)("input",{type:"text",value:d.titleEn,onChange:e=>f(l(l({},d),{},{titleEn:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u6807\u9898 (\u4e2d\u6587)"}),(0,v.jsx)("input",{type:"text",value:d.titleZh,onChange:e=>f(l(l({},d),{},{titleZh:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\uc81c\ubaa9 (\ud55c\uad6d\uc5b4)"}),(0,v.jsx)("input",{type:"text",value:d.titleKo,onChange:e=>f(l(l({},d),{},{titleKo:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14 (\u0e44\u0e17\u0e22)"}),(0,v.jsx)("textarea",{value:d.descriptionTh,onChange:e=>f(l(l({},d),{},{descriptionTh:e.target.value})),rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description (English)"}),(0,v.jsx)("textarea",{value:d.descriptionEn,onChange:e=>f(l(l({},d),{},{descriptionEn:e.target.value})),rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u63cf\u8ff0 (\u4e2d\u6587)"}),(0,v.jsx)("textarea",{value:d.descriptionZh,onChange:e=>f(l(l({},d),{},{descriptionZh:e.target.value})),rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\uc124\uba85 (\ud55c\uad6d\uc5b4)"}),(0,v.jsx)("textarea",{value:d.descriptionKo,onChange:e=>f(l(l({},d),{},{descriptionKo:e.target.value})),rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e01\u0e25\u0e38\u0e48\u0e21\u0e40\u0e1b\u0e49\u0e32\u0e2b\u0e21\u0e32\u0e22 (\u0e40\u0e1e\u0e28)"}),(0,v.jsxs)("select",{value:d.targetGender,onChange:e=>f(l(l({},d),{},{targetGender:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500",children:[(0,v.jsx)("option",{value:"all",children:"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"}),(0,v.jsx)("option",{value:"male",children:"\u0e0a\u0e32\u0e22"}),(0,v.jsx)("option",{value:"female",children:"\u0e2b\u0e0d\u0e34\u0e07"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e2d\u0e32\u0e22\u0e38\u0e02\u0e31\u0e49\u0e19\u0e15\u0e48\u0e33"}),(0,v.jsx)("input",{type:"number",value:d.targetAgeMin,onChange:e=>f(l(l({},d),{},{targetAgeMin:e.target.value})),placeholder:"\u0e40\u0e0a\u0e48\u0e19 15",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u0e2d\u0e32\u0e22\u0e38\u0e2a\u0e39\u0e07\u0e2a\u0e38\u0e14"}),(0,v.jsx)("input",{type:"number",value:d.targetAgeMax,onChange:e=>f(l(l({},d),{},{targetAgeMax:e.target.value})),placeholder:"\u0e40\u0e0a\u0e48\u0e19 25",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})]})]}),(0,v.jsxs)("div",{className:"flex gap-4",children:[(0,v.jsx)("button",{type:"submit",disabled:s,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg disabled:opacity-50",children:s?"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e2d\u0e31\u0e1b\u0e42\u0e2b\u0e25\u0e14...":"\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01"}),(0,v.jsx)("button",{type:"button",onClick:()=>a(!1),className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50",children:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01"})]})]})]})})}),(0,v.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,v.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:["\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14 (",r.length,")"]}),(0,v.jsxs)("div",{className:"flex gap-3",children:[(0,v.jsx)("button",{onClick:()=>h(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm",children:"\ud83d\udcd6 \u0e04\u0e39\u0e48\u0e21\u0e37\u0e2d"}),(0,v.jsxs)("button",{onClick:()=>a(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[(0,v.jsx)(AA,{className:"w-5 h-5"}),"\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23"]})]})]}),(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>(0,v.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition",children:[(0,v.jsx)("div",{className:"relative h-40 bg-gray-200",children:"video"===e.mediaType?(0,v.jsx)("video",{src:e.mediaUrl,className:"w-full h-full object-cover"}):(0,v.jsx)("img",{src:e.mediaUrl,alt:e.titleTh,className:"w-full h-full object-cover",referrerPolicy:"no-referrer"})}),(0,v.jsxs)("div",{className:"p-4",children:[(0,v.jsx)("h3",{className:"font-bold text-gray-800 mb-1",children:e.titleTh}),(0,v.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.descriptionTh}),(0,v.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,v.jsx)("span",{children:"all"===e.targetGender?"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14":"male"===e.targetGender?"\u0e0a\u0e32\u0e22":"\u0e2b\u0e0d\u0e34\u0e07"}),(0,v.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-800",children:(0,v.jsx)(OA,{className:"w-4 h-4"})})]})]})]},e.id))})]})]});return(0,v.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,v.jsx)("div",{className:"bg-white shadow-md",children:(0,v.jsxs)("div",{className:"max-w-7xl mx-auto px-6",children:[(0,v.jsx)("div",{className:"flex items-center justify-between py-4",children:(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"\u0e23\u0e30\u0e1a\u0e1a\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 Admin"}),(0,v.jsx)("p",{className:"text-sm text-gray-600",children:"\u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32"})]})}),(0,v.jsxs)("div",{className:"flex gap-1 border-b border-gray-200",children:[(0,v.jsx)("button",{onClick:()=>n("dashboard"),className:"px-6 py-3 font-semibold transition-colors ".concat("dashboard"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:"\ud83d\udcca Dashboard"}),(0,v.jsx)("button",{onClick:()=>n("heatmap"),className:"px-6 py-3 font-semibold transition-colors ".concat("heatmap"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:"\ud83d\uddfa\ufe0f Heatmap"}),(0,v.jsx)("button",{onClick:()=>n("news"),className:"px-6 py-3 font-semibold transition-colors ".concat("news"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:"\ud83d\udcf0 \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23"})]})]})}),(0,v.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(()=>{switch(e){case"dashboard":return(0,v.jsx)(Q4,{});case"heatmap":return(0,v.jsx)($4,{});default:return _()}})()})]})},J4=e=>{let{children:n,enabled:r=!0}=e;return(0,t.useEffect)(()=>{if(!r)return;const e=e=>{const t=e.target,n=t.id||t.className||t.tagName,r=e.clientX,i=e.clientY;(async(e,t,n)=>{try{const r=localStorage.getItem("userId")||"anonymous_"+Date.now();localStorage.setItem("userId",r),await ql(qu(Dd,"heatmap_clicks"),{elementId:e,pageUrl:t,x:n.x,y:n.y,timestamp:nn.now(),date:cA(),userId:r,screenWidth:window.innerWidth,screenHeight:window.innerHeight}),console.log("\u2705 Click tracked:",{elementId:e,pageUrl:t,date:cA()})}catch(r){console.error("\u274c Error tracking click:",r)}})(n,window.location.pathname,{x:r,y:i})};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[r]),(0,v.jsx)(v.Fragment,{children:n})},e6=p("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),t6=p("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),n6=p("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),r6=p("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),i6=p("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),o6=p("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),a6=e=>{var n;let{userProfile:r,language:i}=e;const[o,a]=(0,t.useState)([]),[s,u]=(0,t.useState)(!0),[c,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{f()},[null===r||void 0===r?void 0:r.gender,null===r||void 0===r?void 0:r.age]);const d=(e,t)=>{var n,r;if(!e||!e.includes("drive.google.com"))return e;const i=(null===(n=e.match(/\/file\/d\/([a-zA-Z0-9_-]+)/))||void 0===n?void 0:n[1])||(null===(r=e.match(/[?&]id=([a-zA-Z0-9_-]+)/))||void 0===r?void 0:r[1]);return i?"video"===t?"https://drive.google.com/file/d/".concat(i,"/preview"):"https://drive.google.com/thumbnail?sz=w1000&id=".concat(i):e},f=async()=>{try{u(!0);const e=Il(qu(Dd,"news"),Pl("createdAt","desc")),t=await Hl(e),n=[];t.forEach(e=>{const t=e.data();if(r){const i=!t.targetGender||"all"===t.targetGender||t.targetGender===r.gender,o=!t.targetAgeMin||r.age>=t.targetAgeMin&&r.age<=(t.targetAgeMax||100);i&&o&&n.push(l({id:e.id},t))}else n.push(l({id:e.id},t))}),a(n)}catch(e){console.error("Error fetching news:",e)}finally{u(!1)}},p=e=>"th"===i?e.titleTh||e.title:"en"===i?e.titleEn||e.title:"zh"===i?e.titleZh||e.titleEn||e.title:"ko"===i&&(e.titleKo||e.titleEn)||e.title,m=e=>"th"===i?e.descriptionTh||e.description:"en"===i?e.descriptionEn||e.description:"zh"===i?e.descriptionZh||e.descriptionEn||e.description:"ko"===i&&(e.descriptionKo||e.descriptionEn)||e.description;return s?(0,v.jsx)("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6 animate-pulse",children:[1,2,3].map(e=>(0,v.jsx)("div",{className:"bg-gray-200 h-80 rounded-xl"},e))}):(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-8",children:(()=>{const e={th:"\u0e02\u0e48\u0e32\u0e27\u0e2a\u0e32\u0e23\u0e41\u0e25\u0e30\u0e01\u0e34\u0e08\u0e01\u0e23\u0e23\u0e21",en:"News & Activities",zh:"\u65b0\u805e\u8207\u6d3b\u52d5",ko:"\ub274\uc2a4 \ubc0f \ud65c\ub3d9"};return e[i]||e.en})()}),(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>(0,v.jsxs)("div",{onClick:()=>h(e),className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all cursor-pointer transform hover:-translate-y-1",children:[(0,v.jsx)("div",{className:"relative h-48 bg-gray-100",children:"video"===e.mediaType?(0,v.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-black",children:(0,v.jsx)(o6,{className:"w-12 h-12 text-white opacity-50"})}):(0,v.jsx)("img",{src:d(e.mediaUrl,"image"),alt:"",className:"w-full h-full object-cover"})}),(0,v.jsxs)("div",{className:"p-5",children:[(0,v.jsx)("h3",{className:"text-xl font-bold mb-2 line-clamp-2",children:p(e)}),(0,v.jsx)("p",{className:"text-gray-600 text-sm line-clamp-3",children:m(e)})]})]},e.id))}),c&&(0,v.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-95 z-[999] flex flex-col items-center justify-center p-4 md:p-10",onClick:()=>h(null),children:[(0,v.jsx)("button",{className:"absolute top-6 right-6 text-white hover:text-red-500 transition-colors z-[1001]",children:(0,v.jsx)(lA,{size:40})}),(0,v.jsxs)("div",{className:"bg-white w-full max-w-6xl rounded-3xl overflow-hidden shadow-2xl flex flex-col md:flex-row max-h-[90vh]",onClick:e=>e.stopPropagation(),children:[(0,v.jsx)("div",{className:"w-full md:w-2/3 bg-black flex items-center justify-center min-h-[300px]",children:"video"===c.mediaType?(0,v.jsx)("iframe",{src:d(c.mediaUrl,"video"),className:"w-full h-full aspect-video",allow:"autoplay; fullscreen",allowFullScreen:!0,title:"Video content"}):(0,v.jsx)("img",{src:d(c.mediaUrl,"image"),className:"max-w-full max-h-full object-contain",alt:"News content"})}),(0,v.jsxs)("div",{className:"w-full md:w-1/3 p-8 overflow-y-auto bg-white flex flex-col",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:p(c)}),(0,v.jsxs)("div",{className:"flex items-center gap-4 mb-6 text-sm text-gray-500",children:[(0,v.jsxs)("span",{className:"flex items-center gap-1",children:[(0,v.jsx)(fA,{size:14})," ",null!==(n=c.createdAt)&&void 0!==n&&n.seconds?new Date(1e3*c.createdAt.seconds).toLocaleDateString():"N/A"]}),(0,v.jsx)("span",{className:"capitalize px-2 py-1 bg-blue-50 text-blue-600 rounded",children:c.targetGender||"All"})]}),(0,v.jsx)("p",{className:"text-gray-700 leading-relaxed mb-8 whitespace-pre-line text-lg",children:m(c)}),(0,v.jsxs)("div",{className:"mt-auto pt-6 border-t flex gap-4",children:[(0,v.jsx)("button",{onClick:()=>h(null),className:"flex-1 bg-gray-100 text-gray-800 py-3 rounded-xl font-bold hover:bg-gray-200 transition",children:(()=>{const e={th:"\u0e1b\u0e34\u0e14\u0e2b\u0e19\u0e49\u0e32\u0e15\u0e48\u0e32\u0e07",en:"Close",zh:"\u95dc\u9589",ko:"\ub2eb\uae30"};return e[i]||e.en})()}),(0,v.jsx)("a",{href:c.mediaUrl,target:"_blank",rel:"noreferrer",className:"p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition",children:(0,v.jsx)(pA,{size:24})})]})]})]})]})]})},s6=e=>{let{language:n,onReset:r}=e;const i=(0,t.useRef)(null),[o,a]=(0,t.useState)(null),[s,u]=(0,t.useState)("voc");(0,t.useEffect)(()=>{const e=()=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{r()},6e4)},t=["mousedown","touchstart","click","scroll"];return t.forEach(t=>window.addEventListener(t,e)),e(),()=>{i.current&&clearTimeout(i.current),t.forEach(t=>window.removeEventListener(t,e))}},[r]);const l=(e,t,r,i)=>{const o=String(n||"th").toLowerCase();return"cn"===o||"zh"===o?r:"kr"===o||"ko"===o?i:"en"===o?t:e},c=[{name:"\u0e2a\u0e32\u0e02\u0e32\u0e07\u0e32\u0e19\u0e22\u0e32\u0e19\u0e22\u0e19\u0e15\u0e4c",eng:"Auto Mechanical Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/au.jpeg",desc:"\u0e40\u0e23\u0e35\u0e22\u0e19\u0e23\u0e39\u0e49\u0e19\u0e27\u0e31\u0e15\u0e01\u0e23\u0e23\u0e21\u0e22\u0e32\u0e19\u0e22\u0e19\u0e15\u0e4c\u0e41\u0e25\u0e30\u0e2a\u0e21\u0e23\u0e23\u0e16\u0e19\u0e30\u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e22\u0e19\u0e15\u0e4c\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e42\u0e25\u0e01"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e22\u0e32\u0e19\u0e22\u0e19\u0e15\u0e4c\u0e44\u0e1f\u0e1f\u0e49\u0e32",eng:"Electric Vehicle",req:"\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e1c\u0e39\u0e49\u0e08\u0e1a \u0e1b\u0e27\u0e0a. \u0e0a\u0e48\u0e32\u0e07\u0e22\u0e19\u0e15\u0e4c",img:"/images/ev.jpeg",desc:"\u0e19\u0e27\u0e31\u0e15\u0e01\u0e23\u0e23\u0e21\u0e1e\u0e25\u0e31\u0e07\u0e07\u0e32\u0e19\u0e2a\u0e30\u0e2d\u0e32\u0e14\u0e41\u0e2b\u0e48\u0e07\u0e2d\u0e19\u0e32\u0e04\u0e15 \u0e40\u0e08\u0e32\u0e30\u0e25\u0e36\u0e01\u0e23\u0e30\u0e1a\u0e1a EV"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e0a\u0e48\u0e32\u0e07\u0e44\u0e1f\u0e1f\u0e49\u0e32\u0e01\u0e33\u0e25\u0e31\u0e07",eng:"Electrical Power Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/ep.jpeg",desc:"\u0e23\u0e32\u0e01\u0e10\u0e32\u0e19\u0e41\u0e2b\u0e48\u0e07\u0e0a\u0e35\u0e27\u0e34\u0e15\u0e41\u0e25\u0e30\u0e2d\u0e38\u0e15\u0e2a\u0e32\u0e2b\u0e01\u0e23\u0e23\u0e21 \u0e40\u0e23\u0e35\u0e22\u0e19\u0e23\u0e39\u0e49\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e23\u0e30\u0e1a\u0e1a\u0e44\u0e1f\u0e1f\u0e49\u0e32"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e0a\u0e48\u0e32\u0e07\u0e2d\u0e34\u0e40\u0e25\u0e47\u0e01\u0e17\u0e23\u0e2d\u0e19\u0e34\u0e01\u0e2a\u0e4c",eng:"Electronics Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a.",img:"/images/el.jpeg",desc:"\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e23\u0e30\u0e1a\u0e1a\u0e20\u0e32\u0e1e \u0e40\u0e2a\u0e35\u0e22\u0e07 \u0e04\u0e21\u0e19\u0e32\u0e04\u0e21 \u0e41\u0e25\u0e30\u0e2b\u0e38\u0e48\u0e19\u0e22\u0e19\u0e15\u0e4c\u0e2d\u0e31\u0e08\u0e09\u0e23\u0e34\u0e22\u0e30"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e0a\u0e48\u0e32\u0e07\u0e01\u0e48\u0e2d\u0e2a\u0e23\u0e49\u0e32\u0e07",eng:"Construction Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/co.jpeg",desc:"\u0e27\u0e34\u0e0a\u0e32\u0e0a\u0e35\u0e1e\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e01\u0e32\u0e23\u0e01\u0e48\u0e2d\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e41\u0e25\u0e30\u0e01\u0e32\u0e23\u0e1a\u0e23\u0e34\u0e2b\u0e32\u0e23\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23\u0e42\u0e22\u0e18\u0e32"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e2a\u0e16\u0e32\u0e1b\u0e31\u0e15\u0e22\u0e01\u0e23\u0e23\u0e21",eng:"Architectural Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/ar.jpeg",desc:"\u0e28\u0e34\u0e25\u0e1b\u0e30\u0e01\u0e32\u0e23\u0e2d\u0e2d\u0e01\u0e41\u0e1a\u0e1a\u0e1e\u0e37\u0e49\u0e19\u0e17\u0e35\u0e48\u0e43\u0e0a\u0e49\u0e2a\u0e2d\u0e22\u0e41\u0e25\u0e30\u0e01\u0e32\u0e23\u0e04\u0e33\u0e19\u0e27\u0e13\u0e42\u0e04\u0e23\u0e07\u0e2a\u0e23\u0e49\u0e32\u0e07"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e40\u0e21\u0e2d\u0e23\u0e4c",eng:"Computer Programmer",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/ct.jpg",desc:"\u0e40\u0e02\u0e35\u0e22\u0e19\u0e42\u0e04\u0e49\u0e14 \u0e1e\u0e31\u0e12\u0e19\u0e32\u0e41\u0e41\u0e2d\u0e1b\u0e1e\u0e25\u0e34\u0e40\u0e04\u0e0a\u0e31\u0e19 \u0e41\u0e25\u0e30\u0e23\u0e30\u0e1a\u0e1a IoT \u0e2d\u0e31\u0e08\u0e09\u0e23\u0e34\u0e22\u0e30"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e01\u0e32\u0e23\u0e1a\u0e31\u0e0d\u0e0a\u0e35",eng:"Accounting",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/ac.jpeg",desc:"\u0e40\u0e2a\u0e49\u0e19\u0e17\u0e32\u0e07\u0e2a\u0e39\u0e48\u0e19\u0e31\u0e01\u0e27\u0e34\u0e0a\u0e32\u0e0a\u0e35\u0e1e\u0e1a\u0e31\u0e0d\u0e0a\u0e35 \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e17\u0e32\u0e07\u0e01\u0e32\u0e23\u0e40\u0e07\u0e34\u0e19"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e01\u0e32\u0e23\u0e15\u0e25\u0e32\u0e14",eng:"Marketing",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/mk.jpeg",desc:"\u0e1b\u0e31\u0e49\u0e19\u0e19\u0e31\u0e01\u0e01\u0e32\u0e23\u0e15\u0e25\u0e32\u0e14\u0e21\u0e37\u0e2d\u0e2d\u0e32\u0e0a\u0e35\u0e1e \u0e40\u0e23\u0e35\u0e22\u0e19\u0e23\u0e39\u0e49\u0e01\u0e25\u0e22\u0e38\u0e17\u0e18\u0e4c E-Commerce"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e18\u0e38\u0e23\u0e01\u0e34\u0e08\u0e14\u0e34\u0e08\u0e34\u0e17\u0e31\u0e25",eng:"Digital Business Technology",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/dt.jpeg",desc:"\u0e1c\u0e2a\u0e32\u0e19\u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c\u0e40\u0e02\u0e49\u0e32\u0e01\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e1a\u0e23\u0e34\u0e2b\u0e32\u0e23\u0e18\u0e38\u0e23\u0e01\u0e34\u0e08 \u0e27\u0e34\u0e40\u0e04\u0e23\u0e32\u0e30\u0e2b\u0e4c\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e01\u0e32\u0e23\u0e17\u0e48\u0e2d\u0e07\u0e40\u0e17\u0e35\u0e48\u0e22\u0e27",eng:"Tourism",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/tg.jpeg",desc:"\u0e40\u0e1b\u0e34\u0e14\u0e1b\u0e23\u0e30\u0e2a\u0e1a\u0e01\u0e32\u0e23\u0e13\u0e4c\u0e42\u0e25\u0e01\u0e01\u0e27\u0e49\u0e32\u0e07\u0e1c\u0e48\u0e32\u0e19\u0e07\u0e32\u0e19\u0e1a\u0e23\u0e34\u0e01\u0e32\u0e23\u0e41\u0e25\u0e30\u0e19\u0e33\u0e40\u0e17\u0e35\u0e48\u0e22\u0e27"},{name:"\u0e2a\u0e32\u0e02\u0e32\u0e01\u0e32\u0e23\u0e42\u0e23\u0e07\u0e41\u0e23\u0e21",eng:"Hotel Management",req:"\u0e08\u0e1a \u0e21.3 / \u0e1b\u0e27\u0e0a. / \u0e21.6",img:"/images/hm.jpeg",desc:"\u0e21\u0e32\u0e15\u0e23\u0e10\u0e32\u0e19\u0e01\u0e32\u0e23\u0e1a\u0e23\u0e34\u0e01\u0e32\u0e23\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e2a\u0e32\u0e01\u0e25 \u0e1d\u0e36\u0e01\u0e1d\u0e19\u0e17\u0e31\u0e01\u0e29\u0e30\u0e01\u0e32\u0e23\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e42\u0e23\u0e07\u0e41\u0e23\u0e21"}],h=[{name:"\u0e2a\u0e32\u0e02\u0e32\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e2a\u0e32\u0e23\u0e2a\u0e19\u0e40\u0e17\u0e28",eng:"Information Technology",req:"\u0e08\u0e1a \u0e1b\u0e27\u0e0a. / \u0e21.6 \u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e17\u0e35\u0e22\u0e1a\u0e40\u0e17\u0e48\u0e32",img:"/images/it.jpg",desc:"\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e2a\u0e23\u0e23\u0e04\u0e4c\u0e19\u0e27\u0e31\u0e15\u0e01\u0e23\u0e23\u0e21\u0e14\u0e49\u0e32\u0e19\u0e0b\u0e2d\u0e1f\u0e15\u0e4c\u0e41\u0e27\u0e23\u0e4c \u0e2e\u0e32\u0e23\u0e4c\u0e14\u0e41\u0e27\u0e23\u0e4c \u0e41\u0e25\u0e30\u0e23\u0e30\u0e1a\u0e1a\u0e40\u0e04\u0e23\u0e37\u0e2d\u0e02\u0e48\u0e32\u0e22\u0e04\u0e27\u0e32\u0e21\u0e1b\u0e25\u0e2d\u0e14\u0e20\u0e31\u0e22"},...c];return(0,v.jsxs)("div",{className:"pt-20 md:pt-32 px-4 md:px-10 pb-10 max-w-7xl mx-auto min-h-screen flex flex-col bg-slate-50/30",children:[(0,v.jsxs)("div",{className:"text-center mb-8 md:mb-16",children:[(0,v.jsx)("h1",{className:"text-3xl sm:text-5xl md:text-6xl lg:text-7xl font-black text-slate-900 mb-4 tracking-tighter",children:l("\u0e01\u0e49\u0e32\u0e27\u0e2a\u0e39\u0e48\u0e2d\u0e19\u0e32\u0e04\u0e15\u0e17\u0e35\u0e48\u0e40\u0e2b\u0e19\u0e37\u0e2d\u0e01\u0e27\u0e48\u0e32","Future Starts Here","\u8fc8\u5411\u66f4\u597d\u7684\u672a\u6765","\ub354 \ub098\uc740 \ubbf8\ub798\ub97c \ud5a5\ud574")}),(0,v.jsx)("p",{className:"text-slate-500 text-sm sm:text-xl md:text-2xl font-medium",children:"Lanna Polytechnic College Chiang Mai"})]}),(0,v.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-10 mb-12",children:[{id:"courses",icon:(0,v.jsx)(e6,{}),label:l("\u0e2a\u0e32\u0e02\u0e32\u0e17\u0e35\u0e48\u0e40\u0e1b\u0e34\u0e14\u0e2a\u0e2d\u0e19","Courses","\u5f00\u8bbe\u4e13\u4e1a","\uac1c\uc124 \ud559\uacfc"),color:"bg-blue-600"},{id:"fees",icon:(0,v.jsx)(t6,{}),label:l("\u0e40\u0e2d\u0e01\u0e2a\u0e32\u0e23\u0e01\u0e32\u0e23\u0e2a\u0e21\u0e31\u0e04\u0e23","Admission","\u62a5\u540d\u6750\u6599","\uc785\ud559 \uc11c\ub958"),color:"bg-emerald-600"},{id:"scholarship",icon:(0,v.jsx)(n6,{}),label:l("\u0e17\u0e38\u0e19\u0e01\u0e32\u0e23\u0e28\u0e36\u0e01\u0e29\u0e32","Scholarship","\u5956\u5b66\u91d1","\uc7a5\ud559\uae08"),color:"bg-indigo-600"}].map(e=>(0,v.jsxs)("div",{onClick:()=>a(e.id),className:"group bg-white p-6 md:p-10 rounded-[2rem] md:rounded-[3rem] shadow-xl border border-transparent hover:border-slate-200 transition-all cursor-pointer flex flex-col items-center text-center sm:items-start sm:text-left",children:[(0,v.jsx)("div",{className:"".concat(e.color," w-16 h-16 md:w-20 md:h-20 rounded-2xl md:rounded-[1.5rem] flex items-center justify-center text-white mb-6 group-hover:scale-110 transition-transform shadow-lg"),children:t.cloneElement(e.icon,{size:32})}),(0,v.jsx)("h3",{className:"text-xl md:text-3xl font-black text-slate-800 mb-2",children:e.label}),(0,v.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 font-bold text-sm md:text-lg",children:[(0,v.jsx)("span",{children:l("\u0e04\u0e25\u0e34\u0e01\u0e14\u0e39\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25","Details","\u8be6\u60c5","\uc0c1\uc138 \uc815\ubcf4")})," ",(0,v.jsx)(r6,{size:16})]})]},e.id))}),(0,v.jsx)(a6,{language:n,isMinimal:!0}),o&&(0,v.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-0 md:p-6 animate-in fade-in duration-200",children:[(0,v.jsx)("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-md",onClick:()=>a(null)}),(0,v.jsxs)("div",{className:"relative bg-white w-full h-full md:h-auto md:max-w-6xl md:max-h-[90vh] md:rounded-[3rem] overflow-hidden flex flex-col shadow-2xl",children:[(0,v.jsxs)("div",{className:"p-6 md:p-10 border-b flex justify-between items-center bg-white sticky top-0 z-10",children:[(0,v.jsx)("h2",{className:"text-2xl md:text-4xl lg:text-5xl font-black text-slate-800",children:"courses"===o?l("\u0e2b\u0e25\u0e31\u0e01\u0e2a\u0e39\u0e15\u0e23\u0e17\u0e35\u0e48\u0e40\u0e1b\u0e34\u0e14\u0e2a\u0e2d\u0e19","Courses","\u5f00\u8bbe\u4e13\u4e1a","\uac1c\uc124 \ud559\uacfc"):"fees"===o?l("\u0e40\u0e2d\u0e01\u0e2a\u0e32\u0e23\u0e01\u0e32\u0e23\u0e2a\u0e21\u0e31\u0e04\u0e23","Admission","\u62a5\u540d\u6750\u6599","\uc785\ud559 \uc11c\ub958"):l("\u0e17\u0e38\u0e19\u0e01\u0e32\u0e23\u0e28\u0e36\u0e01\u0e29\u0e32","Scholarship","\u5956\u5b66\u91d1","\uc7a5\ud559\uae08")}),(0,v.jsx)("button",{onClick:()=>a(null),className:"p-3 hover:bg-slate-100 rounded-full transition-all text-slate-500",children:(0,v.jsx)(lA,{size:32})})]}),(0,v.jsxs)("div",{className:"overflow-y-auto flex-1 p-6 md:p-10 custom-scrollbar bg-slate-50",children:["courses"===o&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"flex gap-2 mb-8 sticky top-0 bg-slate-50 py-2 z-10",children:["voc","high-voc"].map(e=>(0,v.jsx)("button",{onClick:()=>u(e),className:"flex-1 py-4 rounded-xl font-black text-lg md:text-2xl transition-all ".concat(s===e?"bg-slate-900 text-white shadow-lg":"bg-white text-slate-400 hover:bg-slate-200"),children:"voc"===e?"\u0e1b\u0e27\u0e0a.":"\u0e1b\u0e27\u0e2a."},e))}),(0,v.jsx)("div",{className:"grid grid-cols-1 gap-6",children:("voc"===s?c:h).map((e,t)=>(0,v.jsxs)("div",{className:"flex flex-col md:flex-row bg-white rounded-2xl overflow-hidden border border-slate-200 shadow-sm",children:[(0,v.jsx)("div",{className:"md:w-1/3 h-48 md:h-auto overflow-hidden",children:(0,v.jsx)("img",{src:e.img,alt:e.name,className:"w-full h-full object-cover"})}),(0,v.jsxs)("div",{className:"md:w-2/3 p-6 flex flex-col justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"text-xl md:text-3xl font-black text-slate-800",children:e.name}),(0,v.jsx)("p",{className:"text-slate-400 font-bold text-xs md:text-sm mb-3 uppercase italic",children:e.eng}),(0,v.jsx)("p",{className:"text-slate-600 text-sm md:text-lg leading-relaxed mb-4",children:e.desc})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2 text-blue-600 font-black text-xs md:text-base bg-blue-50 p-3 rounded-lg",children:[(0,v.jsx)(i6,{size:18})," ",e.req]})]})]},t))})]}),"fees"===o&&(0,v.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[[{title:"\u0e43\u0e1a \u0e1b\u0e1e.1",detail:"\u0e09\u0e1a\u0e31\u0e1a\u0e08\u0e23\u0e34\u0e07\u0e1e\u0e23\u0e49\u0e2d\u0e21\u0e2a\u0e33\u0e40\u0e19\u0e32 2 \u0e0a\u0e38\u0e14"},{title:"\u0e23\u0e39\u0e1b\u0e16\u0e48\u0e32\u0e22 1-1.5 \u0e19\u0e34\u0e49\u0e27",detail:"3 \u0e23\u0e39\u0e1b (\u0e0a\u0e38\u0e14\u0e19\u0e31\u0e01\u0e40\u0e23\u0e35\u0e22\u0e19)"},{title:"\u0e2a\u0e33\u0e40\u0e19\u0e32\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19\u0e1a\u0e49\u0e32\u0e19",detail:"\u0e19\u0e23./\u0e1e\u0e48\u0e2d/\u0e41\u0e21\u0e48 \u0e2d\u0e22\u0e48\u0e32\u0e07\u0e25\u0e30 1 \u0e0a\u0e38\u0e14"},{title:"\u0e2a\u0e33\u0e40\u0e19\u0e32\u0e1a\u0e31\u0e15\u0e23\u0e1b\u0e23\u0e30\u0e0a\u0e32\u0e0a\u0e19",detail:"\u0e19\u0e23./\u0e1e\u0e48\u0e2d/\u0e41\u0e21\u0e48 \u0e2d\u0e22\u0e48\u0e32\u0e07\u0e25\u0e30 1 \u0e0a\u0e38\u0e14"}].map((e,t)=>(0,v.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 flex items-center gap-4",children:[(0,v.jsx)("div",{className:"bg-emerald-500 text-white p-3 rounded-xl",children:(0,v.jsx)(t6,{size:24})}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"text-lg md:text-xl font-black text-slate-800",children:e.title}),(0,v.jsx)("p",{className:"text-slate-500 text-sm md:text-base",children:e.detail})]})]},t)),(0,v.jsxs)("div",{className:"sm:col-span-2 bg-slate-900 p-8 rounded-2xl text-center text-white mt-4",children:[(0,v.jsx)("p",{className:"text-lg md:text-xl font-bold",children:"\u0e15\u0e34\u0e14\u0e15\u0e48\u0e2d\u0e2a\u0e21\u0e31\u0e04\u0e23\u0e40\u0e23\u0e35\u0e22\u0e19\u0e44\u0e14\u0e49\u0e17\u0e38\u0e01\u0e27\u0e31\u0e19"}),(0,v.jsx)("p",{className:"opacity-70 text-sm",children:"\u0e13 \u0e27\u0e34\u0e17\u0e22\u0e32\u0e25\u0e31\u0e22\u0e40\u0e17\u0e04\u0e42\u0e19\u0e42\u0e25\u0e22\u0e35\u0e42\u0e1b\u0e25\u0e34\u0e40\u0e17\u0e04\u0e19\u0e34\u0e04\u0e25\u0e32\u0e19\u0e19\u0e32 \u0e40\u0e0a\u0e35\u0e22\u0e07\u0e43\u0e2b\u0e21\u0e48"})]})]}),"scholarship"===o&&(0,v.jsx)("div",{className:"p-20 text-center text-slate-300 italic text-2xl font-black uppercase",children:"Updating Soon"})]})]})]})]})};const u6=function(){const[e,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)("th"),[o,a]=(0,t.useState)(null),[s,u]=(0,t.useState)(!1),[l,c]=(0,t.useState)("carousel"),[h,d]=(0,t.useState)(!1),[f,p]=(0,t.useState)(0),g=()=>{p(e=>{const t=e+1;return t>=5?(d(!0),0):t}),window.logoTimer&&clearTimeout(window.logoTimer),window.logoTimer=setTimeout(()=>p(0),2e3)},b=()=>{n(!0),c("carousel")},x=()=>{n(!0),c("general")},w=()=>{console.log("Auto-Reset: Returning directly to Carousel"),n(!0),c("carousel"),a(null),u(!1)};return(0,t.useEffect)(()=>{const e=e=>{e.altKey&&"a"===e.key&&d(!h)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[h]),h?(0,v.jsxs)("div",{children:[(0,v.jsx)("button",{onClick:()=>d(!1),className:"fixed top-4 right-4 bg-red-700 text-white px-5 py-2.5 rounded-lg z-[60] font-medium hover:bg-red-800 transition-colors shadow-lg",children:"\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e42\u0e2b\u0e21\u0e14 Admin"}),(0,v.jsx)(Z4,{})]}):e?(0,v.jsx)(J4,{enabled:!0,children:(0,v.jsxs)("div",{className:"relative min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 overflow-hidden",children:[(0,v.jsxs)("div",{className:"relative z-50",children:[(0,v.jsx)("div",{className:"fixed top-8 left-8 cursor-pointer select-none",onClick:g,children:(0,v.jsx)("img",{src:"/polylogo.png",alt:"Logo",className:"w-20 h-20 object-contain drop-shadow-lg"})}),(0,v.jsx)("div",{className:"fixed top-8 right-8 flex gap-2 bg-white/80 backdrop-blur-md p-2 rounded-2xl shadow-xl border border-white/50",children:["th","en","zh","ko"].map(e=>(0,v.jsx)("button",{onClick:()=>i(e),className:"px-4 py-2 rounded-xl font-black transition-all ".concat(r===e?"bg-blue-600 text-white shadow-lg scale-105":"text-gray-500 hover:bg-gray-100"),children:e.toUpperCase()},e))})]}),(0,v.jsxs)("div",{className:"relative z-10",children:["carousel"===l?(0,v.jsx)(Md,{language:r,onLogoClick:g}):"personalized"===l?(0,v.jsx)(mA,{userProfile:o,language:r,onNoPresence:w}):(0,v.jsx)(s6,{language:r,onReset:w}),s&&(0,v.jsx)(dA,{onClose:()=>u(!1),onAnalysisComplete:e=>{a(e),u(!1),c("personalized")},language:r}),(0,v.jsx)(CA,{language:r,onLanguageChange:i}),"carousel"===l&&(0,v.jsxs)("button",{onClick:()=>u(!0),className:"fixed bottom-8 left-8 bg-gradient-to-br from-teal-500 via-cyan-600 to-blue-600 text-white px-8 py-4 rounded-2xl shadow-2xl z-30 flex items-center gap-3 animate-bounce shadow-teal-500/20",children:[(0,v.jsx)(m,{className:"w-6 h-6"}),(0,v.jsx)("span",{className:"font-bold text-lg",children:"th"===r?"\u0e40\u0e23\u0e34\u0e48\u0e21\u0e27\u0e34\u0e40\u0e04\u0e23\u0e32\u0e30\u0e2b\u0e4c":"Start Analysis"})]})]})]})}):(0,v.jsx)(y,{onAccept:b,onDecline:x,language:r,setLanguage:i})};i.createRoot(document.getElementById("root")).render((0,v.jsx)(t.StrictMode,{children:(0,v.jsx)(u6,{})}))})()})();
//# sourceMappingURL=main.cfe89eee.js.map